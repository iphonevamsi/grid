(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1e3:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var ListArrow_1=__importDefault(__webpack_require__(459));exports.default=ListArrow_1.default},1001:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var Checkbox_1=__importDefault(__webpack_require__(1002));exports.default=Checkbox_1.default},1002:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(33),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.CHECKBOX_CHECKED_ICON=exports.CHECKBOX_ICON=exports.CHECKBOX_ICON_DIM=void 0;var react_1=__importStar(__webpack_require__(1)),react_konva_1=__webpack_require__(14);exports.CHECKBOX_ICON_DIM=16;exports.CHECKBOX_ICON="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z",exports.CHECKBOX_CHECKED_ICON="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z";exports.default=function Checkbox(_ref){var _ref$x=_ref.x,x=void 0===_ref$x?0:_ref$x,_ref$y=_ref.y,y=void 0===_ref$y?0:_ref$y,_ref$width=_ref.width,width=void 0===_ref$width?0:_ref$width,_ref$height=_ref.height,height=void 0===_ref$height?0:_ref$height,_ref$checked=_ref.checked,checked=void 0!==_ref$checked&&_ref$checked,onChange=_ref.onChange,rowIndex=_ref.rowIndex,columnIndex=_ref.columnIndex,_react_1$useState2=_slicedToArray(react_1.useState(!1),2),isHovered=_react_1$useState2[0],setIsHovered=_react_1$useState2[1],dim=exports.CHECKBOX_ICON_DIM,posX=x+width/2-dim/2+.5-1.5,posY=y+height/2-dim/2+.5-1.5,handleMouseEnter=react_1.useCallback((function(){setIsHovered(!0)}),[]),handleMouseLeave=react_1.useCallback((function(){setIsHovered(!1)}),[]),handleClick=react_1.useCallback((function(){null==onChange||onChange({rowIndex:rowIndex,columnIndex:columnIndex},!checked)}),[checked,rowIndex,columnIndex]);return react_1.default.createElement(react_konva_1.Group,{onClick:handleClick,onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave},react_1.default.createElement(react_konva_1.Rect,{x:posX,y:posY,width:dim,height:dim,cornerRadius:2}),react_1.default.createElement(react_konva_1.Path,{data:checked?exports.CHECKBOX_CHECKED_ICON:exports.CHECKBOX_ICON,x:posX,y:posY,scaleY:.8,scaleX:.8,listening:!1,fill:isHovered?"#444":"#808080"}))}},1003:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var FilterComponent_1=__importDefault(__webpack_require__(1004));exports.default=FilterComponent_1.default},1004:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(55),__webpack_require__(25),__webpack_require__(38),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(381),__webpack_require__(18),__webpack_require__(24),__webpack_require__(33),__webpack_require__(8),__webpack_require__(10),__webpack_require__(208),__webpack_require__(45),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),core_1=__webpack_require__(62),constants_1=__webpack_require__(56),styled_1=__webpack_require__(120),react_list_1=__importDefault(__webpack_require__(1005)),sortFn=function sortFn(a,b){return"string"==typeof a&&"string"==typeof b?Intl.Collator().compare(a,b):a==b?0:a>b?1:-1};exports.default=function FilterComponent(_ref){var position=_ref.position,onChange=_ref.onChange,onCancel=_ref.onCancel,_ref$values=_ref.values,values=void 0===_ref$values?[]:_ref$values,filter=_ref.filter,columnIndex=_ref.columnIndex,index=_ref.index,width=_ref.width;if(!columnIndex)return null;var _react_1$useState2=_slicedToArray(react_1.useState(""),2),filterText=_react_1$useState2[0],setFilterText=_react_1$useState2[1],_ref2$values=(filter||{}).values,selectedValues=void 0===_ref2$values?[]:_ref2$values,_react_1$useState4=_slicedToArray(react_1.useState(filter?selectedValues:values),2),userValues=_react_1$useState4[0],setUserValues=_react_1$useState4[1],searchInputRef=react_1.useRef(null),theme=core_1.useTheme(),isLight="light"===core_1.useColorMode().colorMode,color=isLight?constants_1.DARK_MODE_COLOR:theme.colors.white,borderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600],bgColor=isLight?theme.colors.white:theme.colors.gray[700],_position$x=position.x,x=void 0===_position$x?0:_position$x,y=position.y,handleChange=react_1.useCallback((function(e){var _e$target=e.target,value=_e$target.value,checked=_e$target.checked;setUserValues(checked?function(prev){return prev.concat(value)}:function(prev){return prev.filter((function(v){return v!==value}))})}),[]);react_1.useEffect((function(){var _a;null===(_a=searchInputRef.current)||void 0===_a||_a.focus()}),[]);var handleSubmit=react_1.useCallback((function(){var selectedFilter=userValues.length===values.length?void 0:{values:userValues,operator:null==filter?void 0:filter.operator};null==onChange||onChange(index,columnIndex,selectedFilter)}),[userValues]),items=(values.length,userValues.length,values.filter((function(value){return new RegExp(filterText,"gi").test(value.toString())})).sort(sortFn)),itemRenderer=react_1.useCallback((function(index,key){var value=items[index],valueItem=value||"",isChecked=-1!==userValues.indexOf(valueItem),label=value||"(Blanks)";return react_1.default.createElement(core_1.Box,{key:key,pb:1,display:"flex"},react_1.default.createElement(core_1.Checkbox,{onChange:handleChange,value:valueItem,size:"sm",borderColor:borderColor,isChecked:isChecked,alignItems:"flex-start",lineHeight:"1rem",color:color},react_1.default.createElement(core_1.Box,{fontSize:12},label)))}),[items]);return react_1.default.createElement(core_1.Box,{left:0,top:0,position:"absolute",zIndex:1,transform:"translate(".concat(x,"px, ").concat(y,"px)")},react_1.default.createElement(core_1.Box,{shadow:"md",bg:bgColor,borderColor:borderColor,borderWidth:1,borderStyle:"solid",borderRadius:5,width:width},react_1.default.createElement(core_1.Box,{padding:3},react_1.default.createElement(styled_1.Button,{onClick:function onClick(){return setUserValues(values)},variant:"link",fontSize:12,mr:2,background:"none",size:"sm"},"Select all"),react_1.default.createElement(styled_1.Button,{onClick:function onClick(){return setUserValues([])},variant:"link",fontSize:12,background:"none",size:"sm"},"Clear"),react_1.default.createElement(core_1.InputGroup,{size:"sm",mt:2},react_1.default.createElement(core_1.InputLeftElement,{height:"26px",children:react_1.default.createElement(core_1.Icon,{name:"search",color:"gray.300"})}),react_1.default.createElement(core_1.Input,{type:"text",size:"sm",borderColor:borderColor,value:filterText,onChange:function onChange(e){setFilterText(e.target.value)},color:color,ref:searchInputRef,height:"26px"})),react_1.default.createElement(core_1.Box,{overflow:"auto",height:160,mt:2,mb:1,pt:2,pb:2,pl:1,pr:1},react_1.default.createElement(react_list_1.default,{itemRenderer:itemRenderer,length:items.length,type:"variable"})),react_1.default.createElement(core_1.Box,{pt:2},react_1.default.createElement(styled_1.Button,{size:"sm",variantColor:"green",variant:"solid",onClick:handleSubmit,mr:1},"Done"),react_1.default.createElement(styled_1.Button,{bg:borderColor,size:"sm",variant:"outline",onClick:onCancel},"Cancel")))))}},1006:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var Tabs_1=__importDefault(__webpack_require__(1007));exports.default=Tabs_1.default},1007:function(module,exports,__webpack_require__){"use strict";__webpack_require__(55),__webpack_require__(49),__webpack_require__(24),__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importDefault(__webpack_require__(1)),go_1=__webpack_require__(1008),md_1=__webpack_require__(206),core_1=__webpack_require__(62),constants_1=__webpack_require__(56),styled_1=__webpack_require__(120),core_2=__webpack_require__(62),TabItem_1=__importDefault(__webpack_require__(1009)),translations_1=__webpack_require__(441);exports.default=function Tabs(props){var sheets=props.sheets,onSelect=props.onSelect,onNewSheet=props.onNewSheet,selectedSheet=props.selectedSheet,onChangeSheetName=props.onChangeSheetName,onDeleteSheet=props.onDeleteSheet,onDuplicateSheet=props.onDuplicateSheet,allowNewSheet=props.allowNewSheet,onShowSheet=props.onShowSheet,onHideSheet=props.onHideSheet,onProtectSheet=props.onProtectSheet,onUnProtectSheet=props.onUnProtectSheet,onChangeTabColor=props.onChangeTabColor,_props$leftSpacing=props.leftSpacing,leftSpacing=void 0===_props$leftSpacing?0:_props$leftSpacing,theme=core_1.useTheme(),isLight="light"===core_1.useColorMode().colorMode,color=isLight?theme.colors.gray[900]:theme.colors.gray[300],visibleSheets=sheets.filter((function(sheet){return!sheet.hidden})),visibleSheetsLen=visibleSheets.length;return react_1.default.createElement(core_1.Flex,{pl:leftSpacing,alignItems:"center",minWidth:0,flex:1},allowNewSheet&&react_1.default.createElement(styled_1.Tooltip,{placement:"top-start",hasArrow:!0,"aria-label":translations_1.translations.add_sheet,label:translations_1.translations.add_sheet},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.add_sheet,icon:go_1.GoPlus,onClick:onNewSheet,variant:"ghost",color:color})),react_1.default.createElement(core_2.Popover,{placement:"top"},react_1.default.createElement(core_2.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{placement:"top-start",hasArrow:!0,"aria-label":translations_1.translations.all_sheets,label:translations_1.translations.all_sheets},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.all_sheets,icon:md_1.MdMenu,variant:"ghost",color:color})))),react_1.default.createElement(core_2.PopoverContent,{width:200,borderColor:isLight?void 0:constants_1.DARK_MODE_COLOR},react_1.default.createElement(core_2.PopoverArrow,null),react_1.default.createElement(core_2.PopoverBody,{overflow:"auto",maxHeight:400},sheets.map((function(sheet,idx){var name=sheet.name,hidden=sheet.hidden,id=sheet.id,isActive=selectedSheet===id;return react_1.default.createElement(styled_1.Button,{key:idx,fontWeight:"normal",size:"sm",variant:"ghost",background:"none",isFullWidth:!0,textAlign:"left",justifyContent:"left",borderRadius:0,title:name,onClick:function onClick(){hidden&&(null==onShowSheet||onShowSheet(id)),null==onSelect||onSelect(id)},opacity:hidden?.5:1},react_1.default.createElement(core_1.Box,{as:md_1.MdCheck,mr:2,flexShrink:0,visibility:isActive?"visible":"hidden"}),react_1.default.createElement(core_1.Box,{isTruncated:!0},name))}))))),react_1.default.createElement(core_1.Box,{overflow:"auto",display:"flex",pl:1,pr:1},visibleSheets.map((function(sheet,idx){var isActive=selectedSheet===sheet.id,locked=sheet.locked,tabColor=sheet.tabColor;return react_1.default.createElement(TabItem_1.default,{key:idx,id:sheet.id,tabColor:tabColor,name:sheet.name,isLight:isLight,onSelect:onSelect,isActive:isActive,onChangeSheetName:onChangeSheetName,onDeleteSheet:onDeleteSheet,onDuplicateSheet:onDuplicateSheet,onHideSheet:onHideSheet,onProtectSheet:onProtectSheet,onUnProtectSheet:onUnProtectSheet,onChangeTabColor:onChangeTabColor,locked:locked,canDelete:visibleSheetsLen>1,canHide:visibleSheetsLen>1})}))))}},1009:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(33),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),core_1=__webpack_require__(62),md_1=__webpack_require__(206),types_1=__webpack_require__(97),styled_1=__webpack_require__(120),Toolbar_1=__webpack_require__(433);exports.default=function TabItem(_ref){var name=_ref.name,isLight=_ref.isLight,isActive=_ref.isActive,id=_ref.id,onSelect=_ref.onSelect,onChangeSheetName=_ref.onChangeSheetName,onDeleteSheet=_ref.onDeleteSheet,onDuplicateSheet=_ref.onDuplicateSheet,onHideSheet=_ref.onHideSheet,onProtectSheet=_ref.onProtectSheet,onUnProtectSheet=_ref.onUnProtectSheet,_ref$locked=_ref.locked,locked=void 0!==_ref$locked&&_ref$locked,_ref$canHide=_ref.canHide,canHide=void 0===_ref$canHide||_ref$canHide,_ref$canDelete=_ref.canDelete,canDelete=void 0===_ref$canDelete||_ref$canDelete,_ref$tabColor=_ref.tabColor,tabColor=void 0===_ref$tabColor?"transparent":_ref$tabColor,onChangeTabColor=_ref.onChangeTabColor,canEditSheet=!locked,canDeleteSheet=!locked&&canDelete,canHideSheet=canHide,theme=core_1.useTheme(),_react_1$useState2=_slicedToArray(react_1.useState(!1),2),isEditmode=_react_1$useState2[0],setIsEditmode=_react_1$useState2[1],_react_1$useState4=_slicedToArray(react_1.useState(name),2),value=_react_1$useState4[0],setValue=_react_1$useState4[1],bg=isActive?"white":void 0,color=isActive||isLight?theme.colors.gray[900]:theme.colors.gray[300],shadow=isActive?"0 1px 3px 1px rgba(60,64,67,.15)":void 0,borderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600],enableEditmode=function enableEditmode(){canEditSheet&&setIsEditmode(!0)},disableEditmode=function disableEditmode(){return setIsEditmode(!1)};return react_1.default.createElement(core_1.Box,{position:"relative",display:"flex",alignItems:"center",height:"39px",background:bg,boxShadow:shadow},react_1.default.createElement(core_1.Box,{background:tabColor,position:"absolute",left:0,bottom:0,height:"4px",zIndex:1,right:0}),isEditmode?react_1.default.createElement(core_1.Input,{defaultValue:name,onChange:function onChange(e){return setValue(e.target.value)},width:"auto",onBlur:function onBlur(e){var value=e.currentTarget.value;value!==name&&(null==onChangeSheetName||onChangeSheetName(id,value)),disableEditmode()},height:"26px",background:"white",pl:1,pr:1,ml:2,mr:2,size:"sm",autoFocus:!0,onKeyDown:function onKeyDown(e){e.which===types_1.KeyCodes.Enter&&(null==onChangeSheetName||onChangeSheetName(id,value),disableEditmode()),e.which===types_1.KeyCodes.Escape&&disableEditmode()}}):react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(styled_1.Button,{as:"div",size:"sm",fontWeight:"normal",borderRadius:0,color:color,height:"39px",onDoubleClick:enableEditmode,onClick:function onClick(){return null==onSelect?void 0:onSelect(id)},background:bg,cursor:"pointer",_hover:{background:isActive?bg:isLight?theme.colors.gray[200]:theme.colors.gray[800]}},locked&&react_1.default.createElement(core_1.Box,{mr:1,justifyContent:"center",display:"flex"},react_1.default.createElement(md_1.MdLock,{fill:"green"})),name,react_1.default.createElement(core_1.Popover,{placement:"top",usePortal:!0},(function(_ref2){var onClose=_ref2.onClose;return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(styled_1.IconButton,{variant:"ghost",size:"sm",pl:0,pr:0,minWidth:4,height:4,ml:1,mr:-1,"aria-label":"More",icon:md_1.MdArrowDropDown,fontSize:20,color:"gray.400"})),react_1.default.createElement(styled_1.PopoverContent,{width:200,borderStyle:"solid",borderColor:borderColor},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.PopoverBody,null,react_1.default.createElement(styled_1.Button,{fontWeight:"normal",size:"sm",variant:"ghost",isFullWidth:!0,textAlign:"left",justifyContent:"left",borderRadius:0,background:"none",isDisabled:!canDeleteSheet,onClick:function onClick(e){null==onClose||onClose(),null==onDeleteSheet||onDeleteSheet(id),e.preventDefault(),e.stopPropagation()}},"Delete"),react_1.default.createElement(styled_1.Button,{fontWeight:"normal",size:"sm",variant:"ghost",background:"none",isFullWidth:!0,textAlign:"left",justifyContent:"left",borderRadius:0,onClick:function onClick(e){null==onClose||onClose(),null==onDuplicateSheet||onDuplicateSheet(id),e.preventDefault(),e.stopPropagation()}},"Duplicate"),react_1.default.createElement(core_1.Popover,{placement:"left",trigger:"hover"},react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(styled_1.Button,{fontWeight:"normal",size:"sm",variant:"ghost",isFullWidth:!0,textAlign:"left",background:"none",justifyContent:"left",borderRadius:0,isDisabled:!canEditSheet},react_1.default.createElement(core_1.Box,{flex:1},"Change color"),react_1.default.createElement(core_1.Icon,{name:"chevron-right"}))),react_1.default.createElement(styled_1.PopoverContent,{width:280,borderStyle:"solid",borderColor:borderColor},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.PopoverBody,null,react_1.default.createElement(Toolbar_1.ColorPicker,{color:tabColor,onChange:function onChange(value){null==onChangeTabColor||onChangeTabColor(id,value),null==onClose||onClose()}})))),react_1.default.createElement(styled_1.Button,{fontWeight:"normal",size:"sm",variant:"ghost",isFullWidth:!0,textAlign:"left",background:"none",justifyContent:"left",borderRadius:0,isDisabled:!canEditSheet,onClick:function onClick(e){enableEditmode(),e.preventDefault(),e.stopPropagation()}},"Rename"),react_1.default.createElement(styled_1.Button,{fontWeight:"normal",size:"sm",variant:"ghost",isFullWidth:!0,textAlign:"left",background:"none",justifyContent:"left",borderRadius:0,onClick:function onClick(e){locked?null==onUnProtectSheet||onUnProtectSheet(id):null==onProtectSheet||onProtectSheet(id),e.preventDefault(),e.stopPropagation()}},locked?"Unprotect sheet":"Protect sheet"),react_1.default.createElement(styled_1.Button,{fontWeight:"normal",size:"sm",variant:"ghost",isFullWidth:!0,textAlign:"left",background:"none",justifyContent:"left",borderRadius:0,isDisabled:!canHideSheet,onClick:function onClick(e){null==onHideSheet||onHideSheet(id),e.preventDefault(),e.stopPropagation()}},"Hide sheet"))))})))))}},1010:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var StatusBar_1=__importDefault(__webpack_require__(1011));exports.default=StatusBar_1.default},1011:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(49),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(89),__webpack_require__(1012),__webpack_require__(33),__webpack_require__(8),__webpack_require__(32),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),core_1=__webpack_require__(62),grid_1=__webpack_require__(7),constants_1=__webpack_require__(56),EMPTY_ARRAY=[],StatusBar=react_1.memo((function(_ref){for(var _a,_ref$selections=_ref.selections,selections=void 0===_ref$selections?EMPTY_ARRAY:_ref$selections,cells=_ref.cells,isLight="light"===core_1.useColorMode().colorMode,bg=isLight?"white":"#000",color=isLight?"#333":"#ccc",shadow=isLight?"0 0 2px 1px rgba(0,0,0,0.2)":"0 0 2px 1px rgba(255,255,255,0.2)",count=0,avg=0,sum=0,getMinMax=function getMinMax(o){var keys=Object.keys(null!=o?o:{}).map(Number);return[Math.min.apply(Math,_toConsumableArray(keys)),Math.max.apply(Math,_toConsumableArray(keys))]},_react_1$useMemo2=_slicedToArray(react_1.useMemo((function(){return getMinMax(cells)}),[cells]),2),minRow=_react_1$useMemo2[0],maxRow=_react_1$useMemo2[1],i=0;i<selections.length;i++)for(var bounds=selections[i].bounds,top=Math.max(minRow,bounds.top),bottom=Math.min(maxRow,bounds.bottom),j=top;j<=bottom;j++)for(var _getMinMax2=_slicedToArray(getMinMax(cells[j]),2),minCol=_getMinMax2[0],maxCol=_getMinMax2[1],left=Math.max(minCol,bounds.left),right=Math.min(maxCol,bounds.right),k=left;k<=right;k++){var cell=null===(_a=cells[j])||void 0===_a?void 0:_a[k];if(void 0!==cell&&!grid_1.isNull(cell)){var value="formula"===cell.datatype?cell.result:cell.text;!grid_1.isNull(value)&&constants_1.isNumeric(cell)&&(count+=1,sum+=Number(value))}}if(avg=sum/count,0===count&&0===sum&&0===avg)return null;var avgFixed=avg.toFixed(2);return react_1.default.createElement(core_1.Box,{display:"flex",alignItems:"center",pr:2,pl:2},0!==count&&react_1.default.createElement(core_1.Box,{ml:2,boxShadow:shadow,bg:bg,color:color,borderRadius:5,pl:2,pr:2,pt:1,pb:1},react_1.default.createElement(core_1.Text,{as:"div",fontSize:"xs"},"Count: ",count)),count>0&&react_1.default.createElement(core_1.Box,{ml:2,boxShadow:shadow,bg:bg,color:color,borderRadius:5,pl:2,pr:2,pt:1,pb:1},react_1.default.createElement(core_1.Text,{as:"div",fontSize:"xs"},"Sum: ",sum)),count>0&&react_1.default.createElement(core_1.Box,{ml:2,boxShadow:shadow,bg:bg,color:color,borderRadius:5,pl:2,pr:2,pt:1,pb:1},react_1.default.createElement(core_1.Text,{as:"div",fontSize:"xs"},"Avg: ",avgFixed)))}));exports.default=StatusBar},1015:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21),Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(1),WebFont=__webpack_require__(7).canUseDOM?__webpack_require__(1016):null,defaultConfig={google:{families:["Inconsolata"]}};exports.default=function useFonts(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:defaultConfig,_react_1$useState=react_1.useState(!1),_react_1$useState2=_slicedToArray(_react_1$useState,2),isFontActive=_react_1$useState2[0],setIsFontActive=_react_1$useState2[1];return react_1.useEffect((function(){config&&null!==WebFont&&WebFont.load(Object.assign({},config,{loading:function loading(){return setIsFontActive(!1)},active:function active(){return setIsFontActive(!0)}}))}),[config]),{isFontActive:isFontActive}}},1019:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var ContextMenu_1=__importDefault(__webpack_require__(1020));exports.default=ContextMenu_1.default},1020:function(module,exports,__webpack_require__){"use strict";__webpack_require__(30),__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importDefault(__webpack_require__(1)),core_1=__webpack_require__(62),md_1=__webpack_require__(206),styled_1=__webpack_require__(120);exports.default=function ContextMenu(_ref){var left=_ref.left,top=_ref.top,onInsertRow=_ref.onInsertRow,onDeleteRow=_ref.onDeleteRow,onInsertColumn=_ref.onInsertColumn,onDeleteColumn=_ref.onDeleteColumn,onCut=_ref.onCut,onCopy=_ref.onCopy,onPaste=_ref.onPaste,activeCell=_ref.activeCell,selections=_ref.selections,onRequestClose=_ref.onRequestClose,theme=core_1.useTheme(),isLight="light"===core_1.useColorMode().colorMode,color=isLight?theme.colors.gray[800]:theme.colors.gray[100],borderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600],dividerColor=isLight?theme.colors.gray[300]:"rgba(255, 255, 255, 0.16)";return react_1.default.createElement(core_1.Box,{left:0,top:0,position:"absolute",zIndex:1,transform:"translate(".concat(left,"px, ").concat(top,"px)")},react_1.default.createElement(core_1.Menu,{isOpen:!0},react_1.default.createElement(core_1.MenuList,{fontSize:14,color:color,borderColor:borderColor,borderStyle:"solid"},react_1.default.createElement(styled_1.MenuItem,{alignItems:"center",onClick:function onClick(){null==onCut||onCut(activeCell,selections),null==onRequestClose||onRequestClose()}},react_1.default.createElement(core_1.Box,{mr:2,as:md_1.MdContentCut}),"Cut"),react_1.default.createElement(styled_1.MenuItem,{onClick:function onClick(){null==onCopy||onCopy(activeCell,selections),null==onRequestClose||onRequestClose()}},react_1.default.createElement(core_1.Box,{mr:2,as:md_1.MdContentCopy}),"Copy"),react_1.default.createElement(styled_1.MenuItem,{onClick:function onClick(){null==onPaste||onPaste(activeCell,selections),null==onRequestClose||onRequestClose()}},react_1.default.createElement(core_1.Box,{mr:2,as:md_1.MdContentPaste}),"Paste"),react_1.default.createElement(core_1.MenuDivider,{borderColor:dividerColor}),react_1.default.createElement(styled_1.MenuItem,{onClick:function onClick(){null==onInsertRow||onInsertRow(activeCell,selections),null==onRequestClose||onRequestClose()}},"Insert row"),react_1.default.createElement(styled_1.MenuItem,{onClick:function onClick(){null==onInsertColumn||onInsertColumn(activeCell,selections),null==onRequestClose||onRequestClose()}},"Insert column"),react_1.default.createElement(core_1.MenuDivider,{borderColor:dividerColor}),react_1.default.createElement(styled_1.MenuItem,{onClick:function onClick(){null==onDeleteRow||onDeleteRow(activeCell,selections),null==onRequestClose||onRequestClose()}},"Delete row"),react_1.default.createElement(styled_1.MenuItem,{onClick:function onClick(){null==onDeleteColumn||onDeleteColumn(activeCell,selections),null==onRequestClose||onRequestClose()}},"Delete column"))))}},1021:function(module,exports,__webpack_require__){"use strict";__webpack_require__(26),__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(1),calc_1=__importDefault(__webpack_require__(309)),grid_1=__webpack_require__(7),formulas_1=__webpack_require__(475);exports.default=function useCalc(_ref){var formulas=_ref.formulas,getCellConfig=_ref.getCellConfig,getSheetRange=_ref.getSheetRange,engine=react_1.useRef(),getCellConfigRef=react_1.useRef();return getCellConfigRef.current=getCellConfig,react_1.useEffect((function(){engine.current=new calc_1.default({functions:Object.assign({},formulas_1.formulas,formulas),getSheetRange:getSheetRange})}),[]),react_1.useEffect((function(){engine.current&&(engine.current.parser.getSheetRange=getSheetRange)}),[getSheetRange]),{onCalculate:react_1.useCallback((function(value,sheet,cell){var _a,sheetId=grid_1.castToString(sheet);if(sheetId&&getCellConfigRef.current)return null===(_a=engine.current)||void 0===_a?void 0:_a.calculate(grid_1.castToString(value)||"",sheetId,cell,getCellConfigRef.current)}),[]),onCalculateBatch:react_1.useCallback((function(changes){var _a;if(getCellConfigRef.current)return null===(_a=engine.current)||void 0===_a?void 0:_a.calculateBatch(changes,getCellConfigRef.current)}),[]),initializeEngine:react_1.useCallback((function(changes){var _a;if(getCellConfigRef.current)return null===(_a=engine.current)||void 0===_a?void 0:_a.initialize(changes,getCellConfigRef.current)}),[]),supportedFormulas:react_1.useMemo((function(){var _a,_b;return null!==(_b=null===(_a=engine.current)||void 0===_a?void 0:_a.parser.formulaParser.supportedFunctions())&&void 0!==_b?_b:[]}),[engine.current]),getDepedencies:react_1.useCallback((function(text){var _a;return null===(_a=engine.current)||void 0===_a?void 0:_a.parser.getDependencies(text)}),[])}}},1022:function(module,exports,__webpack_require__){"use strict";function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(294),__webpack_require__(18),__webpack_require__(24),__webpack_require__(89),__webpack_require__(26),__webpack_require__(8),__webpack_require__(32),__webpack_require__(10),__webpack_require__(70),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21),__webpack_require__(80);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var parser_1=__webpack_require__(466),graph_1=__webpack_require__(1037),helpers_1=__webpack_require__(306),lodash_merge_1=__importDefault(__webpack_require__(474)),error_1=__importDefault(__webpack_require__(51));exports.default=function CalcEngine(options){var _this=this;!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CalcEngine),this.calculate=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(value,sheet,cell,getValue){var _a,_b,_c,_d,config,_cellAddress,node,_dependencies,_values,formula,cellAddress,parentNode,position,changes,dependencies,error,errorMessage,result,collides,collisionAddress,_iterator,_step,dep,_this$parser$sheetRan,rowCount,columnCount,_this$restrictRowRang,from,to,_sheet,i,j,curCell,address,_node,row,col,_sheet2,_address,cellNode,_node2,directDependencies,values;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(config=getValue(sheet,cell),void 0!==value&&!helpers_1.isNull(value)&&"formula"===(null==config?void 0:config.datatype)){_context.next=19;break}if(_cellAddress=helpers_1.cellToAddress(cell)){_context.next=5;break}return _context.abrupt("return",void 0);case 5:if(_this.mapping.has(_cellAddress,sheet)){_context.next=7;break}return _context.abrupt("return",void 0);case 7:if(node=_this.mapping.get(_cellAddress,sheet,cell)){_context.next=10;break}return _context.abrupt("return",void 0);case 10:if((_dependencies=_this.dag.visit([node])).delete(node),!(_dependencies.size>0)){_context.next=18;break}return _context.next=15,_this.calculateDependencies(_dependencies,getValue);case 15:return _values=_context.sent,_this.parser.clearCachedValues(),_context.abrupt("return",_values);case 18:return _context.abrupt("return",void 0);case 19:if(formula=value.substr(1),cellAddress=helpers_1.cellToAddress(cell)){_context.next=23;break}return _context.abrupt("return",void 0);case 23:if(parentNode=_this.mapping.get(cellAddress,sheet,cell)){_context.next=26;break}return _context.abrupt("return",void 0);case 26:position=helpers_1.createPosition(sheet,Number(cell.rowIndex),Number(cell.columnIndex)),(changes={})[sheet]=null!==(_a=changes[sheet])&&void 0!==_a?_a:{},changes[sheet][cell.rowIndex]=null!==(_b=changes[sheet][cell.rowIndex])&&void 0!==_b?_b:{},_context.prev=30,dependencies=_this.parser.getDependencies(formula,position),_context.next=41;break;case 34:return _context.prev=34,_context.t0=_context.catch(30),_context.t0 instanceof error_1.default?(error=_context.t0.error,errorMessage=_context.t0.message):(error=new error_1.default("#ERROR").toString(),errorMessage=_context.t0.toString()),helpers_1.log("Error parsing formula: ",formula,cell),changes[sheet][cell.rowIndex][cell.columnIndex]={error:error,errorMessage:errorMessage},_this.parser.clearCachedValues(),_context.abrupt("return",changes);case 41:return changes[sheet]=null!==(_c=changes[sheet])&&void 0!==_c?_c:{},changes[sheet][cell.rowIndex]=null!==(_d=changes[sheet][cell.rowIndex])&&void 0!==_d?_d:{},_context.next=45,_this.parser.parse(formula,position,getValue);case 45:if(result=_context.sent,!(collides=_this.detectCollision(result,sheet,cell,getValue))){_context.next=52;break}return collisionAddress=helpers_1.cellToAddress(collides),changes[sheet][cell.rowIndex][cell.columnIndex]={resultType:"error",timestamp:Date.now(),errorMessage:"Array result was not expanded because it would overwrite data in ".concat(collisionAddress),error:new error_1.default("#REF").toString()},_this.parser.clearCachedValues(),_context.abrupt("return",changes);case 52:_this.prepareResult(formula,result,sheet,cell,changes),_this.parser.cacheValues(changes),_iterator=_createForOfIteratorHelper(dependencies),_context.prev=55,_iterator.s();case 57:if((_step=_iterator.n()).done){_context.next=87;break}if(!(dep=_step.value).from){_context.next=80;break}_this$parser$sheetRan=_this.parser.sheetRange(dep.sheet),rowCount=_this$parser$sheetRan.rowCount,columnCount=_this$parser$sheetRan.columnCount,_this$restrictRowRang=_this.restrictRowRange(dep,rowCount),from=_this$restrictRowRang.from,to=_this$restrictRowRang.to,_sheet=_this$restrictRowRang.sheet,i=from.row;case 63:if(!(i<=to.row)){_context.next=78;break}j=Math.min(from.col,columnCount);case 65:if(!(j<=Math.min(to.col,columnCount))){_context.next=75;break}if(curCell={rowIndex:i,columnIndex:j},address=helpers_1.cellToAddress(curCell)){_context.next=70;break}return _context.abrupt("continue",72);case 70:null==(_node=_this.mapping.get(address,_sheet,curCell))||_node.children.add(parentNode);case 72:j++,_context.next=65;break;case 75:i++,_context.next=63;break;case 78:_context.next=85;break;case 80:row=dep.row,col=dep.col,_sheet2=dep.sheet,_address=helpers_1.cellToAddress({rowIndex:row,columnIndex:col}),cellNode={rowIndex:row,columnIndex:col},null==(_node2=_this.mapping.get(_address,_sheet2,cellNode))||_node2.children.add(parentNode);case 85:_context.next=57;break;case 87:_context.next=92;break;case 89:_context.prev=89,_context.t1=_context.catch(55),_iterator.e(_context.t1);case 92:return _context.prev=92,_iterator.f(),_context.finish(92);case 95:if((directDependencies=_this.dag.visit([parentNode])).delete(parentNode),values={},!(directDependencies.size>0)){_context.next=102;break}return _context.next=101,_this.calculateDependencies(directDependencies,getValue);case 101:values=_context.sent;case 102:return _this.parser.clearCachedValues(),_context.abrupt("return",_this.prepareOutput(lodash_merge_1.default(changes,values)));case 104:case"end":return _context.stop()}}),_callee,null,[[30,34],[55,89,92,95]])})));return function(_x,_x2,_x3,_x4){return _ref.apply(this,arguments)}}(),this.detectCollision=function(result,sheet,cell,getValue){var address=helpers_1.cellToAddress(cell);if("array"===result.resultType)for(var arrayResult=result.result,i=0;i<arrayResult.length;i++)for(var j=0;j<arrayResult[i].length;j++)if(0!==i||0!==j){var currentCell={rowIndex:cell.rowIndex+i,columnIndex:cell.columnIndex+j},currentConfig=getValue(sheet,currentCell);if(currentConfig&&!helpers_1.isNull(currentConfig.text)&&(null==currentConfig?void 0:currentConfig.parentCell)!==address)return currentCell}return!1},this.restrictRowRange=function(ref,rowCount){return Object.assign({},ref,{from:Object.assign({},ref.from,{row:Math.min(ref.from.row,rowCount)}),to:Object.assign({},ref.to,{row:Math.min(ref.to.row,rowCount)})})},this.prepareOutput=function(changes){if(Object.keys(changes).length)return changes},this.prepareResult=function(formula,result,sheet,cell,changes){var _a,_b,_c,_d;changes[sheet]=null!==(_a=changes[sheet])&&void 0!==_a?_a:{},changes[sheet][cell.rowIndex]=null!==(_b=changes[sheet][cell.rowIndex])&&void 0!==_b?_b:{};var parentCell=helpers_1.cellToAddress(cell),parentNode=_this.mapping.get(parentCell,sheet,cell);if(!parentCell||!parentNode)return changes;if("array"===result.resultType){var array=result.result,timestamp=result.timestamp,vLen=array.length,hLen=array[0].length;changes[sheet][cell.rowIndex][cell.columnIndex]=null!==(_c=changes[sheet][cell.rowIndex][cell.columnIndex])&&void 0!==_c?_c:{};for(var i=0;i<array.length;i++)for(var j=0;j<array[i].length;j++){var value=array[i][j],row=cell.rowIndex+i,col=cell.columnIndex+j,currentCell={rowIndex:row,columnIndex:col};changes[sheet][row]=null!==(_d=changes[sheet][row])&&void 0!==_d?_d:{},changes[sheet][row][col]=0===i&&0===j?{result:value,resultType:helpers_1.detectDataType(value),parentCell:parentCell,error:void 0,timestamp:timestamp}:{text:value,parentCell:parentCell,datatype:helpers_1.detectDataType(value)};var address=helpers_1.cellToAddress({rowIndex:row,columnIndex:col}),node=_this.mapping.get(address,sheet,currentCell);null==node||node.children.add(parentNode)}changes[sheet][cell.rowIndex][cell.columnIndex].formulaRange=[hLen,vLen]}else changes[sheet][cell.rowIndex][cell.columnIndex]=result;return changes},this.calculateDependencies=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(dependencies,getValue){var _a,_b,_c,_d,changes,_iterator2,_step2,_ref3,cell,sheet,config,position,formula,result,collides,collisionAddress;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:changes={},_iterator2=_createForOfIteratorHelper(dependencies),_context2.prev=2,_iterator2.s();case 4:if((_step2=_iterator2.n()).done){_context2.next=30;break}if(_ref3=_step2.value,cell=_ref3.cell,sheet=_ref3.sheet,config=getValue(sheet,cell),"formula"===(null==config?void 0:config.datatype)&&!helpers_1.isNull(null==config?void 0:config.text)&&void 0!==(null==config?void 0:config.text)){_context2.next=12;break}return _context2.abrupt("continue",28);case 12:if(position=helpers_1.createPosition(sheet,Number(cell.rowIndex),Number(cell.columnIndex)),null!==(formula=null!==(_b=null===(_a=helpers_1.castToString(null==config?void 0:config.text))||void 0===_a?void 0:_a.substr(1))&&void 0!==_b?_b:null)){_context2.next=16;break}return _context2.abrupt("continue",28);case 16:return _context2.next=18,_this.parser.parse(formula,position,getValue);case 18:if(result=_context2.sent,!(collides=_this.detectCollision(result,sheet,cell,getValue))){_context2.next=26;break}return changes[sheet]=null!==(_c=changes[sheet])&&void 0!==_c?_c:{},changes[sheet][cell.rowIndex]=null!==(_d=changes[sheet][cell.rowIndex])&&void 0!==_d?_d:{},collisionAddress=helpers_1.cellToAddress(collides),changes[sheet][cell.rowIndex][cell.columnIndex]={errorMessage:"Array result was not expanded because it would overwrite data in ".concat(collisionAddress),error:new error_1.default("#REF").toString()},_context2.abrupt("return",changes);case 26:_this.prepareResult(formula,result,sheet,cell,changes),_this.parser.cacheValues(changes);case 28:_context2.next=4;break;case 30:_context2.next=35;break;case 32:_context2.prev=32,_context2.t0=_context2.catch(2),_iterator2.e(_context2.t0);case 35:return _context2.prev=35,_iterator2.f(),_context2.finish(35);case 38:return _context2.abrupt("return",changes);case 39:case"end":return _context2.stop()}}),_callee2,null,[[2,32,35,38]])})));return function(_x5,_x6){return _ref2.apply(this,arguments)}}(),this.calculateBatch=function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(changes,getValue){var _a,values,sheet,rowIndex,columnIndex,cell,config,results;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:values={},_context3.t0=regeneratorRuntime.keys(changes);case 2:if((_context3.t1=_context3.t0()).done){_context3.next=24;break}sheet=_context3.t1.value,_context3.t2=regeneratorRuntime.keys(changes[sheet]);case 5:if((_context3.t3=_context3.t2()).done){_context3.next=22;break}rowIndex=_context3.t3.value,_context3.t4=regeneratorRuntime.keys(changes[sheet][rowIndex]);case 8:if((_context3.t5=_context3.t4()).done){_context3.next=20;break}if(columnIndex=_context3.t5.value,cell={rowIndex:Number(rowIndex),columnIndex:Number(columnIndex)},void 0!==(config=null!==(_a=getValue(sheet,cell))&&void 0!==_a?_a:changes[sheet][rowIndex][columnIndex])){_context3.next=14;break}return _context3.abrupt("continue",8);case 14:return _context3.next=16,_this.calculate(helpers_1.castToString(null==config?void 0:config.text),sheet,cell,getValue);case 16:results=_context3.sent,lodash_merge_1.default(values,results),_context3.next=8;break;case 20:_context3.next=5;break;case 22:_context3.next=2;break;case 24:return _context3.abrupt("return",_this.prepareOutput(values));case 25:case"end":return _context3.stop()}}),_callee3)})));return function(_x7,_x8){return _ref4.apply(this,arguments)}}(),this.initialize=function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(changes,getValue){var values,sheet,rowIndex,columnIndex,cellConfig,datatype,text,formula,cell,cellAddress,parentNode,position,result,dependents,_iterator3,_step3,dep,_this$parser$sheetRan2,rowCount,columnCount,_this$restrictRowRang2,from,to,_sheet3,i,j,_cell,address,node,row,col,_sheet4,_address2,_cell2,_node3;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:_this.mapping.clearAll(),values={},_context4.t0=regeneratorRuntime.keys(changes);case 3:if((_context4.t1=_context4.t0()).done){_context4.next=83;break}sheet=_context4.t1.value,_context4.t2=regeneratorRuntime.keys(changes[sheet]);case 6:if((_context4.t3=_context4.t2()).done){_context4.next=80;break}rowIndex=_context4.t3.value,_context4.t4=regeneratorRuntime.keys(changes[sheet][rowIndex]);case 9:if((_context4.t5=_context4.t4()).done){_context4.next=78;break}if(columnIndex=_context4.t5.value,cellConfig=changes[sheet][rowIndex][columnIndex],datatype=null==cellConfig?void 0:cellConfig.datatype,text=null==cellConfig?void 0:cellConfig.text,helpers_1.isNull(text)||"formula"!==datatype){_context4.next=76;break}if(formula=text.substr(1),cell={rowIndex:Number(rowIndex),columnIndex:Number(columnIndex)},cellAddress=helpers_1.cellToAddress(cell)){_context4.next=20;break}return _context4.abrupt("continue",9);case 20:if(parentNode=_this.mapping.get(cellAddress,sheet,cell),cellAddress&&parentNode){_context4.next=23;break}return _context4.abrupt("continue",9);case 23:return position=helpers_1.createPosition(sheet,Number(rowIndex),Number(columnIndex)),_context4.next=26,_this.calculate(text,sheet,cell,getValue);case 26:result=_context4.sent,lodash_merge_1.default(values,result),_context4.prev=28,dependents=_this.parser.getDependencies(formula,position),_iterator3=_createForOfIteratorHelper(dependents),_context4.prev=31,_iterator3.s();case 33:if((_step3=_iterator3.n()).done){_context4.next=63;break}if(!(dep=_step3.value).from){_context4.next=56;break}_this$parser$sheetRan2=_this.parser.sheetRange(dep.sheet),rowCount=_this$parser$sheetRan2.rowCount,columnCount=_this$parser$sheetRan2.columnCount,_this$restrictRowRang2=_this.restrictRowRange(dep,rowCount),from=_this$restrictRowRang2.from,to=_this$restrictRowRang2.to,_sheet3=_this$restrictRowRang2.sheet,i=from.row;case 39:if(!(i<=to.row)){_context4.next=54;break}j=Math.min(from.col,columnCount);case 41:if(!(j<=Math.min(to.col,columnCount))){_context4.next=51;break}if(_cell={rowIndex:i,columnIndex:j},address=helpers_1.cellToAddress(_cell)){_context4.next=46;break}return _context4.abrupt("continue",48);case 46:null==(node=_this.mapping.get(address,_sheet3,_cell))||node.children.add(parentNode);case 48:j++,_context4.next=41;break;case 51:i++,_context4.next=39;break;case 54:_context4.next=61;break;case 56:row=dep.row,col=dep.col,_sheet4=dep.sheet,_address2=helpers_1.cellToAddress({rowIndex:row,columnIndex:col}),_cell2={rowIndex:row,columnIndex:col},null==(_node3=_this.mapping.get(_address2,_sheet4,_cell2))||_node3.children.add(parentNode);case 61:_context4.next=33;break;case 63:_context4.next=68;break;case 65:_context4.prev=65,_context4.t6=_context4.catch(31),_iterator3.e(_context4.t6);case 68:return _context4.prev=68,_iterator3.f(),_context4.finish(68);case 71:_context4.next=76;break;case 73:_context4.prev=73,_context4.t7=_context4.catch(28),helpers_1.log("Error parsing formula ",_context4.t7);case 76:_context4.next=9;break;case 78:_context4.next=6;break;case 80:return _context4.abrupt("return",values);case 83:case"end":return _context4.stop()}}),_callee4,null,[[28,73],[31,65,68,71]])})));return function(_x9,_x10){return _ref5.apply(this,arguments)}}(),this.parser=new parser_1.FormulaParser(options),this.dag=new graph_1.Dag((function(node){return node.children})),this.mapping=new graph_1.DependencyMapping}},1037:function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(49),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(201),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19),__webpack_require__(130),__webpack_require__(16),__webpack_require__(21),Object.defineProperty(exports,"__esModule",{value:!0}),exports.DependencyMapping=exports.Node=exports.Dag=void 0;var Dag=function(){function Dag(preVisit){_classCallCheck(this,Dag),this.preVisit=preVisit}return _createClass(Dag,[{key:"visit",value:function visit(nodes){for(var nodesToVisit=_toConsumableArray(nodes),visited=new Set,stack=[];nodesToVisit.length>0;){var current=nodesToVisit[0];if(visited.has(current)){var stackLen=stack.length;if(stackLen>0){stack[stackLen-1];nodesToVisit.shift(),stack.pop()}else nodesToVisit.shift()}else{stack.push(current),visited.add(current);for(var children=Array.from(this.preVisit(current)),i=children.length-1;i>=0;i--){var child=children[i];visited.has(child)||nodesToVisit.unshift(child)}}}return visited}}]),Dag}();exports.Dag=Dag;var Node=function(){function Node(address,sheet,cell){_classCallCheck(this,Node),this.address=address,this.sheet=sheet,this.cell=cell,this.children=new Set}return _createClass(Node,[{key:"add",value:function add(node){this.children.has(node)||this.children.add(node)}},{key:"delete",value:function _delete(node){this.children.delete(node)}}]),Node}();exports.Node=Node;var DependencyMapping=function(){function DependencyMapping(){_classCallCheck(this,DependencyMapping),this.map=new Map}return _createClass(DependencyMapping,[{key:"clearAll",value:function clearAll(){this.map=new Map}},{key:"get",value:function get(address,sheet,cell){var key="".concat(sheet,"!").concat(address);return this.map.has(key)||this.set(key,new Node(address,sheet,cell)),this.map.get(key)}},{key:"has",value:function has(address,sheet){var key="".concat(sheet,"!").concat(address);return this.map.get(key)}},{key:"set",value:function set(key,node){return this.map.set(key,node),this}}]),DependencyMapping}();exports.DependencyMapping=DependencyMapping},1038:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8),Object.defineProperty(exports,"__esModule",{value:!0})},1040:function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(134),__webpack_require__(117),__webpack_require__(47),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(163),__webpack_require__(49),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(201),__webpack_require__(89),__webpack_require__(26),__webpack_require__(33),__webpack_require__(8),__webpack_require__(32),__webpack_require__(10),__webpack_require__(116),__webpack_require__(299),__webpack_require__(70),__webpack_require__(45),__webpack_require__(19),__webpack_require__(16),__webpack_require__(115),__webpack_require__(88),__webpack_require__(118),__webpack_require__(48),__webpack_require__(21),__webpack_require__(80);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createExcelFileFromSheets=exports.parseExcel=exports.hasBorder=exports.removeHex=exports.getTypeFromDataType=exports.getDataTypeFromType=void 0;var exceljs_1=__importStar(__webpack_require__(1041)),spreadsheet_1=__webpack_require__(52),grid_1=__webpack_require__(7);exports.getDataTypeFromType=function(type){switch(type){case exceljs_1.ValueType.Number:return"number";case exceljs_1.ValueType.Date:return"date";case exceljs_1.ValueType.Formula:return"formula";case exceljs_1.ValueType.Hyperlink:return"hyperlink";case exceljs_1.ValueType.Null:return"null";default:return"string"}},exports.getTypeFromDataType=function(datatype){switch(datatype){case"number":return exceljs_1.ValueType.Number;case"date":return exceljs_1.ValueType.Date;default:return exceljs_1.ValueType.String}};var getCellText=function getCellText(cell,sheet){var _a,_b;switch(cell.type){case exceljs_1.ValueType.Null:return"";case exceljs_1.ValueType.Formula:var isSharedFormula=cell.value.sharedFormula;return"=".concat(isSharedFormula?sheet.getCell(isSharedFormula).formula:cell.value.formula);case exceljs_1.ValueType.Hyperlink:var text=cell.value.text;return"string"==typeof text?text:"Unable to parse";case exceljs_1.ValueType.Date:return null===(_a=cell.value)||void 0===_a?void 0:_a.toString();case exceljs_1.ValueType.RichText:return cell.value.richText.map((function(value){return value.text})).join(" ");default:return null===(_b=cell.value)||void 0===_b?void 0:_b.toString()}},getCellAttributes=function getCellAttributes(cell){var attrs={};switch(cell.type){case exceljs_1.ValueType.Formula:attrs.result=cell.value.result,attrs.error=function parseFormulaError(cell){return Object.values(exceljs_1.ErrorValue).find((function(val){return val===cell.value.result}))}(cell);break;case exceljs_1.ValueType.Hyperlink:attrs.hyperlink=cell.value.hyperlink}return attrs};exports.removeHex=function(str){return str.replace("#","")},exports.hasBorder=function(cell){return cell.strokeTopWidth||cell.strokeBottomWidth||cell.strokeLeftWidth||cell.strokeRightWidth},exports.parseExcel=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(_ref){var file,resolver,sheetPromise,wb,reader,sheets;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return file=_ref.file,sheetPromise=new Promise((function(resolve){return resolver=resolve})),wb=new exceljs_1.default.Workbook,reader=new FileReader,sheets=[],reader.onload=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var buffer;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if((buffer=reader.result)&&"string"!=typeof buffer){_context.next=4;break}return console.warn("Invalid file",buffer),_context.abrupt("return");case 4:return _context.next=6,wb.xlsx.load(buffer);case 6:_context.sent.eachSheet((function(sheet){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,_y,_z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_10,_11,_12,_13,_14,_15,_16,_17,_18;if("hidden"!==sheet.state){var _sheet={id:spreadsheet_1.uuid(),name:sheet.name,cells:{},activeCell:null,selections:[],mergedCells:[],hiddenRows:[],hiddenColumns:[],filterViews:[],rowSizes:{},columnSizes:{},rowCount:Math.max(spreadsheet_1.DEFAULT_ROW_COUNT,sheet.rowCount),columnCount:Math.max(spreadsheet_1.DEFAULT_COLUMN_COUNT,null!==(_b=null===(_a=sheet.columns)||void 0===_a?void 0:_a.length)&&void 0!==_b?_b:0)},mergedCellMap=new Map;if(sheet.hasMerges)for(var address in sheet._merges){var _step,bounds=sheet._merges[address].model,top=bounds.top,bottom=bounds.bottom,left=bounds.left,right=bounds.right,_iterator=_createForOfIteratorHelper(grid_1.getBoundedCells(bounds));try{for(_iterator.s();!(_step=_iterator.n()).done;){var cell=_step.value;mergedCellMap.set(cell,bounds)}}catch(err){_iterator.e(err)}finally{_iterator.f()}null===(_c=_sheet.mergedCells)||void 0===_c||_c.push({top:top,bottom:bottom,left:left,right:right})}if(sheet.autoFilter){var _sheet$autoFilter$rep2=_slicedToArray(sheet.autoFilter.replace(/\$/gi,"").split(":"),2),from=_sheet$autoFilter$rep2[0],to=_sheet$autoFilter$rep2[1],topBound=spreadsheet_1.addressToCell(from),bottomBound=spreadsheet_1.addressToCell(to);topBound&&bottomBound&&(null===(_d=_sheet.filterViews)||void 0===_d||_d.push({bounds:{top:null==topBound?void 0:topBound.rowIndex,left:null==topBound?void 0:topBound.columnIndex,right:null==bottomBound?void 0:bottomBound.columnIndex,bottom:null==bottomBound?void 0:bottomBound.rowIndex}}))}for(var isMergedCell=function isMergedCell(_ref4){var rowIndex=_ref4.rowIndex,columnIndex=_ref4.columnIndex;return mergedCellMap.has(grid_1.cellIdentifier(rowIndex,columnIndex))},views=sheet.views,i=0;i<views.length;i++){var view=views[i],activeCell=view.activeCell;activeCell&&(_sheet.activeCell=spreadsheet_1.addressToCell(activeCell));var xSplit=view.xSplit,ySplit=view.ySplit;void 0!==xSplit&&(_sheet.frozenColumns=xSplit),void 0!==ySplit&&(_sheet.frozenRows=ySplit)}for(var rowCount=sheet.rowCount,_i2=1;_i2<=rowCount;_i2++){var row=sheet.getRow(_i2),rowId=row.number,columnCount=row.cellCount;row.height&&(_sheet.rowSizes=null!==(_e=_sheet.rowSizes)&&void 0!==_e?_e:{},_sheet.rowSizes[rowId]=spreadsheet_1.pointToPixel(row.height)),row.hidden&&(null===(_f=_sheet.hiddenRows)||void 0===_f||_f.push(rowId)),_sheet.cells[rowId]={};for(var j=1;j<=columnCount;j++){var _cell=row.getCell(j),currentCell={rowIndex:rowId,columnIndex:j};if(isMergedCell(currentCell)){var mergedBounds=mergedCellMap.get(grid_1.cellIdentifier(currentCell.rowIndex,currentCell.columnIndex));if(mergedBounds.top!==currentCell.rowIndex||mergedBounds.left!==currentCell.columnIndex)continue}var format=null!==(_g=_cell.style.numFmt)&&void 0!==_g?_g:void 0,fill=void 0,color=void 0,strokes={},fontConfig={},fillType=_cell.style.fill,datatype=exports.getDataTypeFromType(_cell.type),resultType="formula"===datatype?exports.getDataTypeFromType(_cell.effectiveType):void 0,border=_cell.style.border;if(void 0!==fillType&&"pattern"===(null===(_h=_cell.style.fill)||void 0===_h?void 0:_h.type)){var fillValue=null===(_k=null===(_j=_cell.style.fill.bgColor)||void 0===_j?void 0:_j.argb)||void 0===_k?void 0:_k.slice(2);fillValue&&(fill="#"+fillValue)}if((null===(_l=_cell.font)||void 0===_l?void 0:_l.size)&&(fontConfig.fontSize=_cell.font.size),null===(_m=_cell.font)||void 0===_m?void 0:_m.color){var colorValue=null===(_o=_cell.font.color.argb)||void 0===_o?void 0:_o.slice(2);colorValue&&(color="#"+colorValue)}if((null===(_p=_cell.font)||void 0===_p?void 0:_p.bold)&&(fontConfig.bold=_cell.font.bold),(null===(_q=_cell.font)||void 0===_q?void 0:_q.italic)&&(fontConfig.italic=_cell.font.italic),(null===(_r=_cell.font)||void 0===_r?void 0:_r.underline)&&(fontConfig.underline=!!_cell.font.underline),(null===(_s=_cell.font)||void 0===_s?void 0:_s.name)&&(fontConfig.fontFamily=_cell.font.name),(null===(_t=_cell.alignment)||void 0===_t?void 0:_t.horizontal)&&(fontConfig.horizontalAlign=_cell.alignment.horizontal),(null===(_u=_cell.alignment)||void 0===_u?void 0:_u.vertical)&&(fontConfig.verticalAlign=_cell.alignment.vertical),border)for(var key in border)"bottom"===key&&(strokes.strokeBottomDash="dotted"===(null===(_v=border[key])||void 0===_v?void 0:_v.style)||"hair"===(null===(_w=border[key])||void 0===_w?void 0:_w.style)?spreadsheet_1.dotArray:[],strokes.strokeBottomWidth=1,strokes.strokeBottomColor="#"+(null!==(_0=null===(_z=null===(_y=null===(_x=border[key])||void 0===_x?void 0:_x.color)||void 0===_y?void 0:_y.argb)||void 0===_z?void 0:_z.slice(2))&&void 0!==_0?_0:"black")),"top"===key&&(strokes.strokeTopDash="dotted"===(null===(_1=border[key])||void 0===_1?void 0:_1.style)||"hair"===(null===(_2=border[key])||void 0===_2?void 0:_2.style)?spreadsheet_1.dotArray:[],strokes.strokeTopWidth=1,strokes.strokeTopColor="#"+(null!==(_6=null===(_5=null===(_4=null===(_3=border[key])||void 0===_3?void 0:_3.color)||void 0===_4?void 0:_4.argb)||void 0===_5?void 0:_5.slice(2))&&void 0!==_6?_6:"black")),"left"===key&&(strokes.strokeLeftDash="dotted"===(null===(_7=border[key])||void 0===_7?void 0:_7.style)||"hair"===(null===(_8=border[key])||void 0===_8?void 0:_8.style)?spreadsheet_1.dotArray:[],strokes.strokeLeftWidth=1,strokes.strokeLeftColor="#"+(null!==(_12=null===(_11=null===(_10=null===(_9=border[key])||void 0===_9?void 0:_9.color)||void 0===_10?void 0:_10.argb)||void 0===_11?void 0:_11.slice(2))&&void 0!==_12?_12:"black")),"right"===key&&(strokes.strokeRightDash="dotted"===(null===(_13=border[key])||void 0===_13?void 0:_13.style)||"hair"===(null===(_14=border[key])||void 0===_14?void 0:_14.style)?spreadsheet_1.dotArray:[],strokes.strokeRightWidth=1,strokes.strokeRightColor="#"+(null!==(_18=null===(_17=null===(_16=null===(_15=border[key])||void 0===_15?void 0:_15.color)||void 0===_16?void 0:_16.argb)||void 0===_17?void 0:_17.slice(2))&&void 0!==_18?_18:"black"));var result=void 0;"formula"===datatype&&(result=_cell.value.result);var text=getCellText(_cell,sheet),attributes=getCellAttributes(_cell);_sheet.cells[rowId][j]=Object.assign({text:text,fill:fill,color:color,datatype:datatype,resultType:resultType,result:result,format:format},strokes,fontConfig,attributes)}}sheets.push(_sheet)}})),resolver({sheets:sheets});case 9:case"end":return _context.stop()}}),_callee)}))),reader.readAsArrayBuffer(file),_context2.abrupt("return",sheetPromise);case 8:case"end":return _context2.stop()}}),_callee2)})));return function(_x2){return _ref2.apply(this,arguments)}}(),exports.createExcelFileFromSheets=function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(sheets){var _a,_b,_c,workbook,_loop,i,buffer;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:for(workbook=new exceljs_1.default.Workbook,_loop=function _loop(i){var sheet=sheets[i],name=sheet.name,cells=sheet.cells,_sheet$frozenColumns=sheet.frozenColumns,frozenColumns=void 0===_sheet$frozenColumns?0:_sheet$frozenColumns,_sheet$frozenRows=sheet.frozenRows,frozenRows=void 0===_sheet$frozenRows?0:_sheet$frozenRows,_sheet$mergedCells=sheet.mergedCells,mergedCells=void 0===_sheet$mergedCells?[]:_sheet$mergedCells,_sheet$hiddenRows=sheet.hiddenRows,hiddenRows=void 0===_sheet$hiddenRows?[]:_sheet$hiddenRows,_sheet$hiddenColumns=sheet.hiddenColumns,hiddenColumns=void 0===_sheet$hiddenColumns?[]:_sheet$hiddenColumns,rowCount=Math.max.apply(Math,[0].concat(_toConsumableArray(Object.keys(null!=cells?cells:{}).map(Number)))),workSheet=workbook.addWorksheet(name),viewState=frozenColumns>0||frozenRows>0?"frozen":"normal";if(workSheet.views.push({state:viewState,xSplit:frozenColumns,ySplit:frozenRows}),mergedCells.length)for(var _i3=0;_i3<mergedCells.length;_i3++){var cur=mergedCells[_i3],topLeft=spreadsheet_1.cellToAddress({rowIndex:cur.top,columnIndex:cur.left}),bottomRight=spreadsheet_1.cellToAddress({rowIndex:cur.bottom,columnIndex:cur.right});workSheet.mergeCells("".concat(topLeft,":").concat(bottomRight))}hiddenRows.length&&hiddenRows.forEach((function(id){return workSheet.getRow(id).hidden=!0})),hiddenColumns.length&&hiddenColumns.forEach((function(id){return workSheet.getColumn(id).hidden=!0}));for(var j=1;j<=rowCount;j++)for(var row=cells[j],cellCount=Math.max.apply(Math,[0].concat(_toConsumableArray(Object.keys(null!=row?row:{}).map(Number)))),k=1;k<=cellCount;k++){var cell=row[k];if(void 0!==cell){var address=spreadsheet_1.cellToAddress({rowIndex:j,columnIndex:k});if(null!==address){var newCell=workSheet.getCell(address),value="number"===cell.datatype&&void 0!==cell.text?parseFloat(cell.text.toString()):cell.text;void 0!==value&&(newCell.value=value),cell.format&&(newCell.numFmt=cell.format),newCell.font=null!==(_a=newCell.font)&&void 0!==_a?_a:{},cell.fontFamily&&(newCell.font.name=cell.fontFamily),cell.bold&&(newCell.font.bold=cell.bold),cell.italic&&(newCell.font.italic=cell.italic),cell.underline&&(newCell.font.underline=cell.underline),(cell.horizontalAlign||cell.verticalAlign)&&(newCell.alignment=null!==(_b=newCell.alignment)&&void 0!==_b?_b:{},newCell.alignment.horizontal=cell.horizontalAlign,newCell.alignment.vertical=cell.verticalAlign),cell.color&&(newCell.font.color={argb:"FF"+exports.removeHex(cell.color)}),cell.fill&&(newCell.fill={type:"pattern",pattern:"solid",bgColor:{argb:"FF"+exports.removeHex(cell.fill)},fgColor:{argb:"FF"+exports.removeHex(cell.fill)}}),exports.hasBorder(cell)&&(newCell.border=null!==(_c=newCell.border)&&void 0!==_c?_c:{},cell.strokeTopWidth&&cell.strokeTopColor&&(newCell.border.top={style:"thin",color:{argb:"FF"+exports.removeHex(cell.strokeTopColor)}}),cell.strokeBottomWidth&&cell.strokeBottomColor&&(newCell.border.bottom={style:"thin",color:{argb:"FF"+exports.removeHex(cell.strokeBottomColor)}}),cell.strokeLeftWidth&&cell.strokeLeftColor&&(newCell.border.left={style:"thin",color:{argb:"FF"+exports.removeHex(cell.strokeLeftColor)}}),cell.strokeRightWidth&&cell.strokeRightColor&&(newCell.border.right={style:"thin",color:{argb:"FF"+exports.removeHex(cell.strokeRightColor)}}))}}}},i=0;i<sheets.length;i++)_loop(i);return _context3.next=5,workbook.xlsx.writeBuffer();case 5:return buffer=_context3.sent,_context3.abrupt("return",buffer);case 7:case"end":return _context3.stop()}}),_callee3)})));return function(_x3){return _ref5.apply(this,arguments)}}()},1042:function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(163),__webpack_require__(49),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(89),__webpack_require__(8),__webpack_require__(32),__webpack_require__(10),__webpack_require__(70),__webpack_require__(45),__webpack_require__(19),__webpack_require__(16),__webpack_require__(88),__webpack_require__(21),__webpack_require__(80),Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseCSV=exports.createCSVFromSheets=void 0;var spreadsheet_1=__webpack_require__(52);exports.createCSVFromSheets=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(sheets){var cells,rowCount,csv,i,row,cellCount,rowCells,j,cell;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(0!==sheets.length){_context.next=2;break}return _context.abrupt("return","");case 2:for(cells=sheets[0].cells,rowCount=Math.max.apply(Math,[0].concat(_toConsumableArray(Object.keys(null!=cells?cells:{}).map(Number)))),csv="",i=1;i<=rowCount;i++){for(row=cells[i],cellCount=Math.max.apply(Math,[0].concat(_toConsumableArray(Object.keys(null!=row?row:{}).map(Number)))),rowCells=[],j=1;j<=cellCount;j++)cell=null==row?void 0:row[j],rowCells.push(void 0===cell?"":cell.text);csv+=rowCells.join(",")+"\n"}return _context.abrupt("return",csv);case 7:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}(),exports.parseCSV=function(_ref2){var resolver,file=_ref2.file,sheetPromise=new Promise((function(resolve){return resolver=resolve})),reader=new FileReader,sheet=spreadsheet_1.createNewSheet({count:1});return reader.onload=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var text,rows,rowCount,i,rowIndex,row,columns,columnCount,j,columnIndex;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:text=reader.result,rows=text.split("\n"),rowCount=rows.length,sheet.rowCount=Math.max(spreadsheet_1.DEFAULT_ROW_COUNT,rowCount),i=0;case 5:if(!(i<rowCount)){_context2.next=26;break}if(rowIndex=i+1,sheet.cells[rowIndex]={},void 0!==(row=rows[i])){_context2.next=11;break}return _context2.abrupt("continue",23);case 11:columns=row.split(","),columnCount=columns.length,j=0;case 14:if(!(j<columnCount)){_context2.next=23;break}if(columnIndex=j+1,void 0!==columns[j]){_context2.next=19;break}return _context2.abrupt("continue",20);case 19:sheet.cells[rowIndex][columnIndex]={text:columns[j]};case 20:j++,_context2.next=14;break;case 23:i++,_context2.next=5;break;case 26:resolver({sheets:[sheet]});case 27:case"end":return _context2.stop()}}),_callee2)}))),reader.readAsText(file),sheetPromise}},1043:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Borders",(function(){return Borders}));__webpack_require__(9),__webpack_require__(38),__webpack_require__(26),__webpack_require__(32);var react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_4__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_5__);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_exports__.default={title:"Styling",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_5___default.a};var Borders=function Borders(){var App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_4__.useRef)(),_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_5__.useSelection)({gridRef:gridRef}),selections=_useSelection.selections,selectionProps=_objectWithoutProperties(_useSelection,["selections"]);return react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_5___default.a,_extends({ref:gridRef,rowCount:100,columnCount:100,selections:selections,borderStyles:[{bounds:{top:1,left:1,right:1,bottom:1},style:{strokeWidth:1,stroke:"red"}},{bounds:{top:5,left:5,right:8,bottom:8},style:{strokeWidth:1,stroke:"green",fill:"red"}}]},selectionProps))};return react__WEBPACK_IMPORTED_MODULE_4___default.a.createElement(App,null)};Borders.story={name:"Borders"}},1044:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ThemedGrid",(function(){return ThemedGrid}));__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21);var react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_15__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(7),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_16__);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_exports__.default={title:"Themes",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_16___default.a};var darkTheme={cellColor:"#ccc",cellBackground:"#181E20",cellOddBackground:"#444"},lightTheme={cellColor:"#333",cellBackground:"white",cellOddBackground:"#eee"},ThemeContext=Object(react__WEBPACK_IMPORTED_MODULE_15__.createContext)(lightTheme),ThemedGrid=function ThemedGrid(){var App=function App(){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_15__.useState)(lightTheme),2),theme=_useState2[0],setTheme=_useState2[1],gridRef=Object(react__WEBPACK_IMPORTED_MODULE_15__.useRef)(null);return react__WEBPACK_IMPORTED_MODULE_15___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_15___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_15___default.a.createElement("button",{type:"button",onClick:function switchTheme(){setTheme((function(prev){return prev===lightTheme?darkTheme:lightTheme}))}},"Switch to ",theme===lightTheme?"Dark":"Light"),react__WEBPACK_IMPORTED_MODULE_15___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_16___default.a,{ref:gridRef,rowCount:100,columnCount:100,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_15___default.a.createElement(ThemedCell,props)},wrapper:function wrapper(children){return react__WEBPACK_IMPORTED_MODULE_15___default.a.createElement(ThemeContext.Provider,{value:theme},children)}}))};return react__WEBPACK_IMPORTED_MODULE_15___default.a.createElement(App,null)},ThemedCell=function ThemedCell(props){var theme=Object(react__WEBPACK_IMPORTED_MODULE_15__.useContext)(ThemeContext),fill=props.rowIndex%2==0?theme.cellBackground:theme.cellOddBackground;return react__WEBPACK_IMPORTED_MODULE_15___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_16__.Cell,_extends({},props,{value:"".concat(props.rowIndex," x ").concat(props.columnIndex),fill:fill,textColor:theme.cellColor}))};ThemedGrid.story={name:"Dark mode"}},1045:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"TickingGrid",(function(){return TickingGrid}));__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(55),__webpack_require__(47),__webpack_require__(25),__webpack_require__(38),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(68),__webpack_require__(8),__webpack_require__(132),__webpack_require__(133),__webpack_require__(32),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(48),__webpack_require__(21),__webpack_require__(204);var react__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_24___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_24__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(7),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25__);function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}__webpack_exports__.default={title:"Ticking",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25___default.a};var generateKey=function generateKey(){var min=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,rowIndex=Math.floor(30*Math.random())+min,columnIndex=Math.floor(30*Math.random())+min;return[rowIndex,columnIndex]},DataCell=Object(react__WEBPACK_IMPORTED_MODULE_24__.memo)((function(props){var color=props.value>0?"green":"red";return react__WEBPACK_IMPORTED_MODULE_24___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25__.Cell,_extends({},props,{textColor:color,align:"right",padding:5}))})),TickingGrid=function TickingGrid(){var _useState3,_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_24__.useState)((_defineProperty(_useState3={},[0,0],1),_defineProperty(_useState3,[0,2],-20),_useState3)),2),data=_useState2[0],setData=_useState2[1],gridRef=Object(react__WEBPACK_IMPORTED_MODULE_24__.useRef)();Object(react__WEBPACK_IMPORTED_MODULE_24__.useEffect)((function(){var interval=setInterval((function(){setData((function(prev){var _objectSpread2,isNegative=Math.random()<.5?-1:1,key=generateKey(),key2=generateKey();return _objectSpread(_objectSpread({},prev),{},(_defineProperty(_objectSpread2={},key,isNegative*Math.floor(100*Math.random())+1),_defineProperty(_objectSpread2,key2,isNegative*Math.floor(100*Math.random())+1),_objectSpread2))}))}),20);return function(){return clearInterval(interval)}}),[]);var getValue=Object(react__WEBPACK_IMPORTED_MODULE_24__.useCallback)((function(_ref){var rowIndex=_ref.rowIndex,columnIndex=_ref.columnIndex;return data[[rowIndex,columnIndex]]}),[data]),_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25__.useSelection)({gridRef:gridRef,rowCount:200,columnCount:200}),selections=_useSelection.selections,selectionProps=_objectWithoutProperties(_useSelection,["selections"]);return react__WEBPACK_IMPORTED_MODULE_24___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25___default.a,_extends({ref:gridRef,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_24___default.a.createElement(DataCell,_extends({},props,{value:getValue({rowIndex:props.rowIndex,columnIndex:props.columnIndex})}))},rowCount:200,columnCount:200,selections:selections},selectionProps))};TickingGrid.story={name:"Default"}},1046:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"TouchGrid",(function(){return TouchGrid}));__webpack_require__(9),__webpack_require__(30),__webpack_require__(38),__webpack_require__(26),__webpack_require__(32);var react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_5__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(7),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6__);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_exports__.default={title:"Mobile (touch)",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6___default.a};var TouchGrid=function TouchGrid(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_5__.useRef)(),_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6__.useSelection)({gridRef:gridRef,rowCount:200,columnCount:200}),selections=_useSelection.selections,selectionProps=_objectWithoutProperties(_useSelection,["selections"]),touchProps=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6__.useTouch)({gridRef:gridRef});return react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6___default.a,_extends({ref:gridRef,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6__.Cell,_extends({},props,{value:"".concat(props.rowIndex,":").concat(props.columnIndex)}))},rowCount:200,columnCount:200,selections:selections},selectionProps,touchProps))};TouchGrid.story={name:"Default"}},1047:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"TreeTable",(function(){return TreeTable})),__webpack_require__.d(__webpack_exports__,"ExpandCollapseRows",(function(){return ExpandCollapseRows}));__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(55),__webpack_require__(47),__webpack_require__(25),__webpack_require__(86),__webpack_require__(38),__webpack_require__(20),__webpack_require__(13),__webpack_require__(96),__webpack_require__(23),__webpack_require__(296),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(68),__webpack_require__(8),__webpack_require__(132),__webpack_require__(133),__webpack_require__(32),__webpack_require__(10),__webpack_require__(45),__webpack_require__(19),__webpack_require__(87),__webpack_require__(16),__webpack_require__(88),__webpack_require__(48),__webpack_require__(21);var react__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_30___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_30__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(7),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_31___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_31__),react_konva__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(14);function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_exports__.default={title:"Treetable",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_31___default.a};var TreeTable=function TreeTable(){var ColumnHeader=function ColumnHeader(_ref){var _data,rowIndex=_ref.rowIndex,columnIndex=_ref.columnIndex,x=_ref.x,y=_ref.y,width=_ref.width,height=_ref.height,data=_ref.data,headers=_ref.headers,onToggleNode=_ref.onToggleNode,treeState=_ref.treeState,column=headers[columnIndex]&&headers[columnIndex].name,datapoint=data[rowIndex-2],text=column&&data[rowIndex-2]?data[rowIndex-2].text:null,hasKids=datapoint&&datapoint.kids,isOpen=!!data[rowIndex-2]&&treeState.open.includes(data[rowIndex-2].id),paddingLeft=8+12*((null===(_data=data[rowIndex-2])||void 0===_data?void 0:_data.depth)||0);return react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_32__.Group,null,react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_32__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"#ccc",strokeWidth:.5}),hasKids&&react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_32__.RegularPolygon,{x:x+paddingLeft,y:y+10,sides:3,radius:5,rotation:isOpen?180:90,fill:"#333",onClick:function onClick(){return onToggleNode(data[rowIndex-2].id,!isOpen)},hitStrokeWidth:20}),text&&react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_32__.Text,{x:x+paddingLeft+8,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"left"}))},RowHeader=function RowHeader(_ref2){_ref2.rowIndex;var columnIndex=_ref2.columnIndex,x=_ref2.x,y=_ref2.y,width=_ref2.width,height=_ref2.height,headers=_ref2.headers,text=headers[columnIndex]&&headers[columnIndex].header[columnIndex-1].name,_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_30__.useState)(!1),2),setIsHovered=(_useState2[0],_useState2[1]);return react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_32__.Group,{onMouseEnter:function onMouseEnter(){return setIsHovered(!0)},onMouseLeave:function onMouseLeave(){return setIsHovered(!1)}},react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_32__.Rect,{x:x,y:y,height:height,width:width,fill:"#eee",stroke:"#ccc",strokeWidth:.5}),text&&react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_30___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_32__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"})))},Cell=function Cell(_ref3){var rowIndex=_ref3.rowIndex,columnIndex=_ref3.columnIndex,x=_ref3.x,y=_ref3.y,width=_ref3.width,height=_ref3.height,data=(_ref3.isHovered,_ref3.data),headers=_ref3.headers,frozenRows=_ref3.frozenRows,column=headers[columnIndex]&&headers[columnIndex].name,text=column&&data[rowIndex-frozenRows]?data[rowIndex-frozenRows][column]:null;return react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_30___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_32__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"#ccc",strokeWidth:.5}),text&&react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_32__.Text,{x:x,y:y,offsetX:10,height:height,width:width,text:text,verticalAlign:"middle",align:"right"}))},EmptyCell=function EmptyCell(_ref4){var rowIndex=_ref4.rowIndex,columnIndex=_ref4.columnIndex,x=_ref4.x,y=_ref4.y,width=_ref4.width,height=_ref4.height;"".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_30___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_32__.Rect,{x:x,y:y,height:height,width:width,fill:"#eee",stroke:"#ccc",strokeWidth:.5}))},App=function App(){var _useState4=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_30__.useState)({open:[]}),2),treeState=_useState4[0],setTreeState=_useState4[1],headers=[{name:"id",header:["id"]},{name:"Aggregate",header:[{name:"Group Header"},{name:"Aggregated Value"}]},{name:"Aggregate",header:[null,{name:"Aggregated Value 2"}]}],data=[{id:"Parent",text:"Parent",Aggregate:.2012312312,parent:"",leaf:!1,kids:!0,depth:0},{id:"Parent_Child",text:"Child",Aggregate:12.02,parent:"Parent",leaf:!0,kids:!0,depth:1},{id:"Parent_Child_GrandChild",text:"Grandchild",Aggregate:12.02,parent:"Parent_Child",leaf:!0,kids:!1,depth:2}].filter((function(item){var grandParents=item.parent.split("_").reduce((function(acc,item,index,arr){var prev=arr[index-1]?arr[index-1]+"_":"";return acc.push(prev+item),acc}),[]);return!item.parent||!grandParents.some((function(id){return!treeState.open.includes(id)}))&&treeState.open.includes(item.parent)})),gridRef=Object(react__WEBPACK_IMPORTED_MODULE_30__.useRef)(),_useState6=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_30__.useState)({rowIndex:0,columnIndex:0}),2),setHoveredCell=(_useState6[0],_useState6[1]),rowCount=data.length+2,columnCount=headers.length+1,_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_31__.useSelection)({gridRef:gridRef,rowCount:rowCount,columnCount:columnCount}),selection=_useSelection.selection,selectionProps=_objectWithoutProperties(_useSelection,["selection"]),onToggleNode=Object(react__WEBPACK_IMPORTED_MODULE_30__.useCallback)((function(id,isOpen){setTreeState((function(prev){return _objectSpread(_objectSpread({},prev),{},{open:isOpen?prev.open.concat(id):prev.open.filter((function(item){return item!==id}))})}))}),[]);return react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_31___default.a,_extends({ref:gridRef,width:900,height:600,columnCount:columnCount,rowCount:rowCount,selection:selection,frozenRows:2,frozenColumns:1,mergedCells:[{top:0,left:0,right:0,bottom:1},{top:0,left:1,right:2,bottom:0}],columnWidth:function columnWidth(index){return 150},onMouseMove:function onMouseMove(_,rowIndex,columnIndex){return setHoveredCell({rowIndex:rowIndex,columnIndex:columnIndex})},itemRenderer:function itemRenderer(props){return props.rowIndex<2&&props.columnIndex<1?react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(EmptyCell,props):props.rowIndex<2?react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(RowHeader,_extends({headers:headers},props)):props.columnIndex<1?react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(ColumnHeader,_extends({treeState:treeState,data:data,headers:headers,onToggleNode:onToggleNode},props)):react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(Cell,_extends({frozenRows:2,data:data,headers:headers},props))},rowHeight:function rowHeight(index){return 20}},selectionProps))};return react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(App,null)},ExpandCollapseRows=function ExpandCollapseRows(){var App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_30__.useRef)(),_useState8=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_30__.useState)([]),2),open=_useState8[0],toggleOpen=_useState8[1],headers=[{name:"Title"},{name:"Year"},{name:"Votes"}],data=[{id:1,Title:"The Shawshank Redemption",Year:"1994",Votes:"678790"},{parentId:1,Details:"Andy Dufresne, a successful banker, is arrested for the murders of his wife and her lover, and is sentenced to life imprisonment at the Shawshank prison. He becomes the most unconventional prisoner."},{id:2,Title:"The Godfather",Year:1972,Votes:511495},{parentId:2,Details:"Don Vito Corleone, head of a mafia family, decides to hand over his empire to his youngest son Michael. However, his decision unintentionally puts the lives of his loved ones in grave danger."},{id:3,Title:"The Godfather: Part II",Year:"1974",Votes:319352},{parentId:3,Details:"Michael, Vito Corleone's son, attempts to expand his family's criminal empire. While he strikes a business deal with gangster Hyman Roth, he remains unaware of the lurking danger."}].filter((function(row){return!row.parentId||open.includes(row.parentId)})),rowCount=data.length+1,columnCount=headers.length,_useSelection2=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_31__.useSelection)({gridRef:gridRef,rowCount:rowCount,columnCount:columnCount}),selections=_useSelection2.selections,selectionProps=_objectWithoutProperties(_useSelection2,["selections"]),mergedCells=data.reduce((function(acc,row,index){return row.parentId&&acc.push({top:index+1,left:0,right:columnCount-1,bottom:index+1}),acc}),[]),handleToggle=Object(react__WEBPACK_IMPORTED_MODULE_30__.useCallback)((function(rowIndex,columnIndex){var row=data[rowIndex];row&&row.id&&(toggleOpen((function(prev){return prev.includes(row.id)?prev.filter((function(id){return id!==row.id})):[].concat(_toConsumableArray(prev),[row.id])})),gridRef.current.resetAfterIndices({rowIndex:rowIndex},!0))}),[data]);return react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_31___default.a,_extends({mergedCells:mergedCells,ref:gridRef,rowCount:rowCount,columnCount:columnCount,columnWidth:function columnWidth(columnIndex){return 0===columnIndex?300:100},rowHeight:function rowHeight(rowIndex){var item=data[rowIndex-1];return item&&item.Details?40:20},itemRenderer:function itemRenderer(props){var _headers$columnIndex2,_data$dataStartRowInd,_headers$columnIndex,rowIndex=props.rowIndex,columnIndex=props.columnIndex;if(props.rowIndex<1)return react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_31__.Cell,_extends({},props,{align:"left",value:null===(_headers$columnIndex=headers[columnIndex])||void 0===_headers$columnIndex?void 0:_headers$columnIndex.name,fill:"#eee"}));var dataStartRowIndex=rowIndex-1,key=null===(_headers$columnIndex2=headers[columnIndex])||void 0===_headers$columnIndex2?void 0:_headers$columnIndex2.name,id=null===(_data$dataStartRowInd=data[dataStartRowIndex])||void 0===_data$dataStartRowInd?void 0:_data$dataStartRowInd.id,details=data[dataStartRowIndex]?data[dataStartRowIndex].Details:null,value=key&&data[dataStartRowIndex]?data[dataStartRowIndex][key]:"",isOpen=open.includes(id),toggleable=0===columnIndex&&value&&!details;return react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_31__.Cell,_extends({onClick:function onClick(){return handleToggle(dataStartRowIndex,columnIndex)},verticalAlign:details?"top":"middle",value:value||details},props,{align:"left",padding:toggleable?20:5,wrap:"word"}),0===columnIndex&&value&&!details?react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_32__.RegularPolygon,{x:props.x+10,y:props.y+10,sides:3,radius:5,fill:"black",rotation:isOpen?180:90,hitStrokeWidth:20}):null)},frozenRows:1,selections:selections},selectionProps))};return react__WEBPACK_IMPORTED_MODULE_30___default.a.createElement(App,null)};ExpandCollapseRows.story={name:"Expand collapse rows"}},1048:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"UndoRedo",(function(){return UndoRedo}));__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(55),__webpack_require__(47),__webpack_require__(25),__webpack_require__(38),__webpack_require__(20),__webpack_require__(13),__webpack_require__(96),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(68),__webpack_require__(8),__webpack_require__(132),__webpack_require__(133),__webpack_require__(32),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(48),__webpack_require__(21);var react__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_24___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_24__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(7),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25__);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_exports__.default={title:"Undo Redo",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25___default.a};var UndoRedo=function UndoRedo(){var App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_24__.useRef)(),_useUndo=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25__.useUndo)({onUndo:function onUndo(patches){var path=patches.path,value=patches.value,_path=_slicedToArray(path,2),key=_path[0],_path$=_path[1],rowIndex=_path$.rowIndex,columnIndex=_path$.columnIndex;"data"===key&&(setData((function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},[rowIndex,columnIndex],value))})),setActiveCell({rowIndex:rowIndex,columnIndex:columnIndex}))},onRedo:function onRedo(patches){var path=patches.path,value=patches.value,_path2=_slicedToArray(path,2),key=_path2[0],_path2$=_path2[1],rowIndex=_path2$.rowIndex,columnIndex=_path2$.columnIndex;"data"===key&&(setData((function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},[rowIndex,columnIndex],value))})),setActiveCell({rowIndex:rowIndex,columnIndex:columnIndex}))}}),undo=_useUndo.undo,redo=_useUndo.redo,addToUndoStack=_useUndo.add,canUndo=_useUndo.canUndo,canRedo=_useUndo.canRedo,undoProps=_objectWithoutProperties(_useUndo,["undo","redo","add","canUndo","canRedo"]),_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_24__.useState)({"1,1":"Hello"}),2),data=_useState2[0],setData=_useState2[1],getCellValue=Object(react__WEBPACK_IMPORTED_MODULE_24__.useCallback)((function(_ref){var rowIndex=_ref.rowIndex,columnIndex=_ref.columnIndex;return data[[rowIndex,columnIndex]]}),[data]),cellValueRef=Object(react__WEBPACK_IMPORTED_MODULE_24__.useRef)();cellValueRef.current=getCellValue;var _useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25__.useSelection)({rowCount:100,columnCount:100,gridRef:gridRef}),selections=_useSelection.selections,activeCell=_useSelection.activeCell,setActiveCell=_useSelection.setActiveCell,selectionProps=_objectWithoutProperties(_useSelection,["selections","activeCell","setActiveCell"]),_useEditable=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25__.useEditable)({gridRef:gridRef,getValue:getCellValue,selections:selections,activeCell:activeCell,onDelete:function onDelete(activeCell,selections){if(selections.length){var newValues=selections.reduce((function(acc,_ref2){for(var sel=_ref2.bounds,i=sel.top;i<=sel.bottom;i++)for(var j=sel.left;j<=sel.right;j++)acc[[i,j]]="";return acc}),{});setData((function(prev){return _objectSpread(_objectSpread({},prev),newValues)}));var selectionBounds=selections[0].bounds;gridRef.current.resetAfterIndices({columnIndex:selectionBounds.left,rowIndex:selectionBounds.top},!0)}else activeCell&&(addToUndoStack(Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25__.createPatches)(["data",activeCell],void 0,cellValueRef.current(activeCell))),setData((function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},[activeCell.rowIndex,activeCell.columnIndex],""))})),gridRef.current.resetAfterIndices(activeCell))},onSubmit:function onSubmit(value,cell,nextActiveCell){var rowIndex=cell.rowIndex,columnIndex=cell.columnIndex,previousValue=cellValueRef.current(cell);setData((function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},[rowIndex,columnIndex],value))})),gridRef.current.resizeColumns([columnIndex]),addToUndoStack(Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25__.createPatches)(["data",cell],value,previousValue)),nextActiveCell&&setActiveCell(nextActiveCell)}}),editorComponent=_useEditable.editorComponent,editableProps=(_useEditable.editingCell,_useEditable.isEditInProgress,_objectWithoutProperties(_useEditable,["editorComponent","editingCell","isEditInProgress"]));return react__WEBPACK_IMPORTED_MODULE_24___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_24___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25___default.a,_extends({ref:gridRef,activeCell:activeCell,rowCount:100,columnCount:100,selections:selections,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_24___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_25__.Cell,_extends({},props,{padding:0,value:getCellValue({rowIndex:props.rowIndex,columnIndex:props.columnIndex})}))}},selectionProps,editableProps,{onKeyDown:function onKeyDown(){selectionProps.onKeyDown.apply(selectionProps,arguments),editableProps.onKeyDown.apply(editableProps,arguments),undoProps.onKeyDown.apply(undoProps,arguments)},onMouseDown:function onMouseDown(){selectionProps.onMouseDown.apply(selectionProps,arguments),editableProps.onMouseDown.apply(editableProps,arguments)}})),editorComponent,react__WEBPACK_IMPORTED_MODULE_24___default.a.createElement("button",{disabled:!canUndo,onClick:undo},"Undo"),react__WEBPACK_IMPORTED_MODULE_24___default.a.createElement("button",{disabled:!canRedo,onClick:redo},"Redo"))};return react__WEBPACK_IMPORTED_MODULE_24___default.a.createElement(App,null)};UndoRedo.story={name:"Default"}},120:function(module,exports,__webpack_require__){"use strict";function _templateObject10(){var data=_taggedTemplateLiteral(["\n        font-family: ",";\n        line-height: 1.2;\n        background: transparent;\n        cursor: pointer;\n        line-height: inherit;\n        overflow: visible;\n        text-transform: none;\n        border-style: none;\n      "]);return _templateObject10=function _templateObject10(){return data},data}function _templateObject9(){var data=_taggedTemplateLiteral(["\n  font-family: ",";\n  line-height: 1.2;\n  font-size: 0.8rem;\n  padding-top: 4px;\n  padding-bottom: 4px;\n"]);return _templateObject9=function _templateObject9(){return data},data}function _templateObject8(){var data=_taggedTemplateLiteral(["\n        font-family: ",";\n        line-height: 1.2;\n        font-weight: normal;\n        cursor: pointer;\n        text-transform: none;\n        border-style: none;\n        text-overflow: ellipsis;\n      "]);return _templateObject8=function _templateObject8(){return data},data}function _templateObject7(){var data=_taggedTemplateLiteral(["\n        font-family: ",";\n        color: ",";\n      "]);return _templateObject7=function _templateObject7(){return data},data}function _templateObject6(){var data=_taggedTemplateLiteral(["\n        font-family: ",";\n        line-height: 1.2;\n        // background-color: transparent;\n        cursor: pointer;\n        line-height: inherit;\n        overflow: visible;\n        text-transform: none;\n        border-style: none;\n      "]);return _templateObject6=function _templateObject6(){return data},data}function _templateObject5(){var data=_taggedTemplateLiteral(["\n  position: relative;\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n"]);return _templateObject5=function _templateObject5(){return data},data}function _templateObject4(){var data=_taggedTemplateLiteral(["\n  display: flex;\n  flex: 1;\n  min-width: 0;\n  height: 40px;\n"]);return _templateObject4=function _templateObject4(){return data},data}function _templateObject3(){var data=_taggedTemplateLiteral(["\n  height: 2px;\n  background: ",";\n  width: 20px;\n  margin-top: 0;\n  position: relative;\n  top: 2px;\n"]);return _templateObject3=function _templateObject3(){return data},data}function _templateObject2(){var data=_taggedTemplateLiteral(["\n  border-color: ",";\n  border-width: 0 1px 0 0;\n  height: 24px;\n  border-style: solid;\n  margin: 0 ",";\n"]);return _templateObject2=function _templateObject2(){return data},data}function _templateObject(){var data=_taggedTemplateLiteral(["\n  min-height: 40px;\n  border-color: ",";\n  border-style: solid;\n  background: ",";\n  border-width: 1px 0;\n  display: flex;\n  align-items: center;\n  min-width: 0;\n  border-bottom-width: 0;\n"]);return _templateObject=function _templateObject(){return data},data}function _taggedTemplateLiteral(strings,raw){return raw||(raw=strings.slice(0)),Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}__webpack_require__(23),__webpack_require__(26),__webpack_require__(33),__webpack_require__(68),__webpack_require__(8),__webpack_require__(128);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.MenuItem=exports.Tooltip=exports.Button=exports.PopoverContent=exports.IconButton=exports.MergeCellsIcon=exports.WrapIcon=exports.WrapClipIcon=exports.DecreaseDecimalIcon=exports.IncreaseDecimalIcon=exports.PercentIcon=exports.GridWrapper=exports.BottomPanel=exports.Rect=exports.Separator=exports.StyledToolbar=void 0;var react_1=__importStar(__webpack_require__(1)),styled_1=__importDefault(__webpack_require__(91)),core_1=__webpack_require__(62),core_2=__webpack_require__(62),constants_1=__webpack_require__(56),core_3=__webpack_require__(3),styled=styled_1.default;exports.default=styled;exports.StyledToolbar=styled((function Toolbar(props){return react_1.default.createElement(core_2.Box,Object.assign({},props))}))(_templateObject(),(function(props){return props.borderColor}),(function(props){return props.backgroundColor}));exports.Separator=styled((function SeparatorComponent(props){return react_1.default.createElement("div",{className:props.className},props.children)}))(_templateObject2(),(function(props){return props.borderColor}),(function(props){return props.theme.space[1]})),exports.Rect=styled(core_2.Box)(_templateObject3(),(function(props){return props.color})),exports.BottomPanel=styled(core_2.Box)(_templateObject4()),exports.GridWrapper=styled.div(_templateObject5()),exports.PercentIcon=function(){return react_1.default.createElement(react_1.default.Fragment,null,"%")},exports.IncreaseDecimalIcon=function(){return react_1.default.createElement("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 -6 24 24","aria-hidden":"true",focusable:"false",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg"},react_1.default.createElement("path",{d:"M0,7 L1.99632026,7 L1.99632026,9 L0,9 L0,7 Z M10,12 L15,12 L15,14 L10,14 L10,12 Z M16.9694527,11.9570946 L18,13.0188246 L16.9734025,14.0389803 L15,16 L15,10 L16.9694527,11.9570946 Z M2.99264052,2.99686968 C2.99264052,1.34174426 4.33709312,-1.59872116e-14 5.98804084,-1.59872116e-14 C7.64235476,-1.59872116e-14 8.98344117,1.34739093 8.98344117,2.99686968 L8.98344117,6.00313032 C8.98344117,7.65825574 7.63898856,9 5.98804084,9 C4.33372692,9 2.99264052,7.65260907 2.99264052,6.00313032 L2.99264052,2.99686968 Z M4.5,2.99857602 L4.5,6.00142398 C4.5,6.83497024 5.17157288,7.5 6,7.5 C6.83420277,7.5 7.5,6.82906466 7.5,6.00142398 L7.5,2.99857602 C7.5,2.16502976 6.82842712,1.5 6,1.5 C5.16579723,1.5 4.5,2.17093534 4.5,2.99857602 Z M9.99264052,2.99686968 C9.99264052,1.34174426 11.3370931,-1.59872116e-14 12.9880408,-1.59872116e-14 C14.6423548,-1.59872116e-14 15.9834412,1.34739093 15.9834412,2.99686968 L15.9834412,6.00313032 C15.9834412,7.65825574 14.6389886,9 12.9880408,9 C11.3337269,9 9.99264052,7.65260907 9.99264052,6.00313032 L9.99264052,2.99686968 Z M11.5,2.99857602 L11.5,6.00142398 C11.5,6.83497024 12.1715729,7.5 13,7.5 C13.8342028,7.5 14.5,6.82906466 14.5,6.00142398 L14.5,2.99857602 C14.5,2.16502976 13.8284271,1.5 13,1.5 C12.1657972,1.5 11.5,2.17093534 11.5,2.99857602 Z"}))},exports.DecreaseDecimalIcon=function(){return react_1.default.createElement("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 -6 24 24","aria-hidden":"true",focusable:"false",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg"},react_1.default.createElement("path",{d:"M11.0119846,13 L16,13 L16,15 L11.0119846,15 L11.0119846,16.9944804 L9.03685276,15.0409865 L7.98433567,14 L9.03289155,12.9629313 L11.0119846,11.0055196 L11.0119846,13 Z M1,8 L2.99632026,8 L2.99632026,10 L1,10 L1,8 Z M3.99264052,3.99686968 C3.99264052,2.34174426 5.33709312,1 6.98804084,1 C8.64235476,1 9.98344117,2.34739093 9.98344117,3.99686968 L9.98344117,7.00313032 C9.98344117,8.65825574 8.63898856,10 6.98804084,10 C5.33372692,10 3.99264052,8.65260907 3.99264052,7.00313032 L3.99264052,3.99686968 Z M5.5,3.99857602 L5.5,7.00142398 C5.5,7.83497024 6.17157288,8.5 7,8.5 C7.83420277,8.5 8.5,7.82906466 8.5,7.00142398 L8.5,3.99857602 C8.5,3.16502976 7.82842712,2.5 7,2.5 C6.16579723,2.5 5.5,3.17093534 5.5,3.99857602 Z"}))},exports.WrapClipIcon=function(){return react_1.default.createElement("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 -6 24 24","aria-hidden":"true",focusable:"false",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg"},react_1.default.createElement("path",{d:"M0,0 L2,0 L2,14 L0,14 L0,0 Z M12,0 L14,0 L14,14 L12,14 L12,0 Z M4,6 L12,6 L12,8 L4,8 L4,6 Z"}))},exports.WrapIcon=function(){return react_1.default.createElement("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 -6 24 24","aria-hidden":"true",focusable:"false",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg"},react_1.default.createElement("path",{d:"M14,0 L0,0 L0,2 L14,2 L14,0 Z M0,12 L4,12 L4,10 L0,10 L0,12 Z M11.5,5 L0,5 L0,7 L11.75,7 C12.58,7 13.25,7.67 13.25,8.5 C13.25,9.33 12.58,10 11.75,10 L9,10 L9,8 L6,11 L9,14 L9,12 L11.5,12 C13.43,12 15,10.43 15,8.5 C15,6.57 13.43,5 11.5,5 Z"}))},exports.MergeCellsIcon=function(){return react_1.default.createElement("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"-1 -1 20 20","aria-hidden":"true",focusable:"false",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg"},react_1.default.createElement("path",{d:"M3,6 L1,6 L1,2 L8,2 L8,4 L3,4 L3,6 Z M10,4 L10,2 L17,2 L17,6 L15,6 L15,4 L10,4 Z M10,14 L15,14 L15,12 L17,12 L17,16 L10,16 L10,14 Z M1,12 L3,12 L3,14 L8,14 L8,16 L1,16 L1,12 Z M1,8 L5,8 L5,6 L8,9 L5,12 L5,10 L1,10 L1,8 Z M10,9 L13,6 L13,8 L17,8 L17,10 L13,10 L13,12 L10,9 Z"}))},exports.IconButton=react_1.forwardRef((function(props,ref){return react_1.default.createElement(core_1.IconButton,Object.assign({ref:ref,css:core_3.css(_templateObject6(),constants_1.SYSTEM_FONT),background:"none"},props))})),exports.PopoverContent=react_1.forwardRef((function(props,ref){var colorMode=core_1.useColorMode().colorMode;return react_1.default.createElement(core_1.PopoverContent,Object.assign({ref:ref,css:core_3.css(_templateObject7(),constants_1.SYSTEM_FONT,"light"===colorMode?"#333":"white")},props))})),exports.Button=react_1.forwardRef((function(props,ref){return react_1.default.createElement(core_1.Button,Object.assign({ref:ref,css:core_3.css(_templateObject8(),constants_1.SYSTEM_FONT)},props))})),exports.Tooltip=styled(core_1.Tooltip)(_templateObject9(),constants_1.SYSTEM_FONT),exports.MenuItem=react_1.forwardRef((function(props,ref){return react_1.default.createElement(core_1.MenuItem,Object.assign({css:core_3.css(_templateObject10(),constants_1.SYSTEM_FONT),ref:ref},props))}))},121:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8),Object.defineProperty(exports,"__esModule",{value:!0}),exports.ErrorValue=exports.STROKE_FORMATTING=exports.TEXT_DECORATION=exports.FONT_STYLE=exports.FONT_WEIGHT=exports.FORMATTING_TYPE=void 0,function(FORMATTING_TYPE){FORMATTING_TYPE.BOLD="bold",FORMATTING_TYPE.ITALIC="italic",FORMATTING_TYPE.HORIZONTAL_ALIGN="horizontalAlign",FORMATTING_TYPE.VERTICAL_ALIGN="verticalAlign",FORMATTING_TYPE.STRIKE="strike",FORMATTING_TYPE.UNDERLINE="underline",FORMATTING_TYPE.FILL="fill",FORMATTING_TYPE.COLOR="color",FORMATTING_TYPE.DECIMALS="decimals",FORMATTING_TYPE.FONT_SIZE="fontSize",FORMATTING_TYPE.FONT_FAMILY="fontFamily",FORMATTING_TYPE.CUSTOM_FORMAT="format",FORMATTING_TYPE.WRAP="wrap",FORMATTING_TYPE.ROTATION="rotation"}(exports.FORMATTING_TYPE||(exports.FORMATTING_TYPE={})),function(FONT_WEIGHT){FONT_WEIGHT.BOLD="bold",FONT_WEIGHT.NORMAL="normal"}(exports.FONT_WEIGHT||(exports.FONT_WEIGHT={})),function(FONT_STYLE){FONT_STYLE.ITALIC="italic",FONT_STYLE.NORMAL="normal"}(exports.FONT_STYLE||(exports.FONT_STYLE={})),function(TEXT_DECORATION){TEXT_DECORATION.STRIKE="line-through",TEXT_DECORATION.NONE="",TEXT_DECORATION.UNDERLINE="underline"}(exports.TEXT_DECORATION||(exports.TEXT_DECORATION={})),function(STROKE_FORMATTING){STROKE_FORMATTING.STROKE="stroke",STROKE_FORMATTING.STROKE_TOP_COLOR="strokeTopColor",STROKE_FORMATTING.STROKE_RIGHT_COLOR="strokeRightColor",STROKE_FORMATTING.STROKE_BOTTOM_COLOR="strokeBottomColor",STROKE_FORMATTING.STROKE_LEFT_COLOR="strokeLeftColor",STROKE_FORMATTING.STROKE_WIDTH="strokeWidth",STROKE_FORMATTING.STROKE_TOP_WIDTH="strokeTopWidth",STROKE_FORMATTING.STROKE_RIGHT_WIDTH="strokeRightWidth",STROKE_FORMATTING.STROKE_BOTTOM_WIDTH="strokeBottomWidth",STROKE_FORMATTING.STROKE_LEFT_WIDTH="strokeLeftWidth",STROKE_FORMATTING.STROKE_DASH="strokeDash",STROKE_FORMATTING.STROKE_TOP_DASH="strokeTopDash",STROKE_FORMATTING.STROKE_RIGHT_DASH="strokeRightDash",STROKE_FORMATTING.STROKE_BOTTOM_DASH="strokeBottomDash",STROKE_FORMATTING.STROKE_LEFT_DASH="strokeLeftDash"}(exports.STROKE_FORMATTING||(exports.STROKE_FORMATTING={})),function(ErrorValue){ErrorValue.NotApplicable="#N/A",ErrorValue.Ref="#REF!",ErrorValue.Name="#NAME?",ErrorValue.DivZero="#DIV/0!",ErrorValue.Null="#NULL!",ErrorValue.Value="#VALUE!",ErrorValue.Num="#NUM!"}(exports.ErrorValue||(exports.ErrorValue={}))},169:function(module,exports,__webpack_require__){"use strict";function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}__webpack_require__(13),__webpack_require__(8),__webpack_require__(10),__webpack_require__(70),__webpack_require__(16),__webpack_require__(21),__webpack_require__(403),__webpack_require__(80),Object.defineProperty(exports,"__esModule",{value:!0}),exports.parse=exports.download=exports.canUseDOM=exports.MIMETYPES=exports.parseCSV=exports.parseExcel=void 0;var excel_1=__webpack_require__(1040);Object.defineProperty(exports,"parseExcel",{enumerable:!0,get:function get(){return excel_1.parseExcel}});var MIMETYPES,csv_1=__webpack_require__(1042);Object.defineProperty(exports,"parseCSV",{enumerable:!0,get:function get(){return csv_1.parseCSV}}),function(MIMETYPES){MIMETYPES.CSV="text/csv",MIMETYPES.EXCEL="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}(MIMETYPES=exports.MIMETYPES||(exports.MIMETYPES={})),exports.canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement),exports.download=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(_ref){var _ref$sheets,sheets,_ref$filename,filename,_ref$type,type,buffer,blob,url,anchor,_buffer,_blob,_url,_anchor;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:_ref$sheets=_ref.sheets,sheets=void 0===_ref$sheets?[]:_ref$sheets,_ref$filename=_ref.filename,filename=void 0===_ref$filename?"download":_ref$filename,_ref$type=_ref.type,type=void 0===_ref$type?"excel":_ref$type,_context.t0=type,_context.next="excel"===_context.t0?4:"csv"===_context.t0?16:27;break;case 4:return _context.next=6,excel_1.createExcelFileFromSheets(sheets);case 6:if(buffer=_context.sent,blob=new Blob([buffer],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),exports.canUseDOM){_context.next=10;break}return _context.abrupt("return",blob);case 10:return url=window.URL.createObjectURL(blob),(anchor=document.createElement("a")).href=url,anchor.download="".concat(filename,".xlsx"),anchor.dispatchEvent(new MouseEvent("click")),_context.abrupt("break",27);case 16:return _context.next=18,csv_1.createCSVFromSheets(sheets);case 18:if(_buffer=_context.sent,_blob=new Blob([_buffer],{type:"text/csv"}),exports.canUseDOM){_context.next=22;break}return _context.abrupt("return",_blob);case 22:_url=window.URL.createObjectURL(_blob),(_anchor=document.createElement("a")).href=_url,_anchor.download="".concat(filename,".csv"),_anchor.dispatchEvent(new MouseEvent("click"));case 27:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref2.apply(this,arguments)}}(),exports.parse=function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(_ref3){var file;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(file=_ref3.file){_context2.next=3;break}throw"File is invalid";case 3:_context2.t0=file.type,_context2.next=_context2.t0===MIMETYPES.CSV?6:_context2.t0===MIMETYPES.EXCEL?7:8;break;case 6:return _context2.abrupt("return",csv_1.parseCSV({file:file}));case 7:return _context2.abrupt("return",excel_1.parseExcel({file:file}));case 8:throw"File type is not supported. Supported file types are xlsx and csv";case 9:case"end":return _context2.stop()}}),_callee2)})));return function(_x2){return _ref4.apply(this,arguments)}}()},209:function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(117),__webpack_require__(25),__webpack_require__(86),__webpack_require__(20),__webpack_require__(13),__webpack_require__(49),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(8),__webpack_require__(10),__webpack_require__(208),__webpack_require__(45),__webpack_require__(19),__webpack_require__(87),__webpack_require__(16),__webpack_require__(115),__webpack_require__(21);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.tokenVocabulary=exports.operatorTokenNames=exports.operators=exports.getNextToken=exports.getPreviousToken=exports.getCurrentToken=exports.getSurroundingTokens=exports.isCurrentPositionACell=exports.showCellSuggestions=exports.getCurrentCursorOffset=exports.isTokenACell=exports.functionSuggestion=exports.moveMergedCells=exports.cleanFunctionToken=exports.formulaToRelativeReference=exports.isAbsoluteRowReference=exports.isAbsoluteColumnReference=exports.detokenize=exports.tokenize=exports.normalizeTokens=exports.getSelectionsFromInput=exports.selectionToAddress=exports.selectionFromCells=exports.getSelectionColorAtIndex=exports.TOKEN_TYPE_CELL=void 0;var lexing_1=__webpack_require__(988);Object.defineProperty(exports,"tokenVocabulary",{enumerable:!0,get:function get(){return lexing_1.tokenVocabulary}});var constants_1=__webpack_require__(56),slate_1=__webpack_require__(6),error_1=__importDefault(__webpack_require__(210));exports.TOKEN_TYPE_CELL="Cell",exports.getSelectionColorAtIndex=function(key){for(var hash=0,colors=["#11a9cc","#a61d4c","#4285f4","#f4b400","#65b045","#e51c23","#e91e63","#9c27b0","#673ab7","#3f51b5","#5677fc","#03a9f4","#00bcd4","#009688","#259b24","#8bc34a","#afb42b","#ff9800","#ff5722","#795548","#607d8b","#880e4f","#827717","#f7981d","#7e3794"],str=key.toString(),i=0;i<str.length;i++)hash=str.charCodeAt(i)+((hash<<5)-hash),hash&=hash;return colors[hash=(hash%colors.length+colors.length)%colors.length]},exports.selectionFromCells=function(start){var end=arguments.length>1&&void 0!==arguments[1]?arguments[1]:start,sheetName=arguments.length>2?arguments[2]:void 0;return end||(end=start),{bounds:{top:Math.min(start.rowIndex,end.rowIndex),left:start.columnIndex,right:end.columnIndex,bottom:Math.max(start.rowIndex,end.rowIndex)},sheet:constants_1.desanitizeSheetName(sheetName)}},exports.selectionToAddress=function(sel){if(!sel)return null;var _sel$bounds=sel.bounds,top=_sel$bounds.top,left=_sel$bounds.left,right=_sel$bounds.right,bottom=_sel$bounds.bottom,from=constants_1.cellToAddress({rowIndex:top,columnIndex:left}),to=constants_1.cellToAddress({rowIndex:bottom,columnIndex:right});return from===to?from:"".concat(from,":").concat(to||"")},exports.getSelectionsFromInput=function(text,sheet){var _a,_b,selections=[];try{for(var tokens=exports.tokenize(text).tokens,len=tokens.length,i=0,activeSheet=null;i<len;){var token=tokens[i],image=token.image,tokenType=token.tokenType;if(tokenType.name!==lexing_1.tokenVocabulary.Sheet.name&&tokenType.name!==lexing_1.tokenVocabulary.SheetQuoted.name){if(tokenType.name===lexing_1.tokenVocabulary.Cell.name){var startCell=constants_1.addressToCell(image);if(!startCell){i++;continue}var endCell=void 0,isRange=(null===(_a=tokens[i+1])||void 0===_a?void 0:_a.tokenType.name)===lexing_1.tokenVocabulary.Colon.name;if(isRange){var toImage=null===(_b=tokens[i+2])||void 0===_b?void 0:_b.image;endCell=constants_1.addressToCell(toImage)}var sheetName=(null==activeSheet?void 0:activeSheet.image.slice(0,-1))||sheet,sel=exports.selectionFromCells(startCell,endCell,sheetName);if(selections.push(sel),isRange){i+=3;continue}}activeSheet=null,i++}else activeSheet=token,i++}return selections}catch(err){return selections}},exports.normalizeTokens=function(text){var _a,_b,normalizedTokens=[];if(void 0===text)return normalizedTokens;try{for(var tokens=exports.tokenize(text).tokens,len=tokens.length,i=0,selIndex=-1,activeSheet=null;i<len;){var token=tokens[i],image=token.image,tokenType=token.tokenType,toImage=void 0;if(tokenType.name!==lexing_1.tokenVocabulary.Sheet.name&&tokenType.name!==lexing_1.tokenVocabulary.SheetQuoted.name){if(tokenType.name===lexing_1.tokenVocabulary.Cell.name){var startCell=constants_1.addressToCell(image);if(!startCell){i++;continue}var endCell=void 0,isRange=(null===(_a=tokens[i+1])||void 0===_a?void 0:_a.tokenType.name)===lexing_1.tokenVocabulary.Colon.name;isRange&&(toImage=null===(_b=tokens[i+2])||void 0===_b?void 0:_b.image,endCell=constants_1.addressToCell(toImage));var sheetName=null==activeSheet?void 0:activeSheet.image,sel=exports.selectionFromCells(startCell,endCell,sheetName);if(normalizedTokens.push(Object.assign({},token,{image:(activeSheet?activeSheet.image:"")+(isRange?"".concat(image,":").concat(toImage||""):image),endColumn:isRange?token.endColumn+":".concat(toImage||"").length:token.endColumn,endOffset:isRange?token.endOffset+":".concat(toImage||"").length:token.endOffset,startOffset:activeSheet?activeSheet.startOffset:token.startOffset,index:++selIndex,sheetName:sheetName,range:isRange,sel:sel})),isRange){i+=3;continue}}else normalizedTokens.push(token);activeSheet=null,i++}else activeSheet=token,i++}return normalizedTokens}catch(err){return normalizedTokens}},exports.tokenize=function(text){try{return lexing_1.lex(text)}catch(err){return{tokens:[]}}},exports.detokenize=function(tokens){for(var prevOffset,str="",i=0;i<tokens.length;i++){var token=tokens[i];str+=(prevOffset&&prevOffset!==token.startOffset?" ":"")+token.image,prevOffset=token.endColumn}return str},exports.isAbsoluteColumnReference=function(formula){return!!formula&&/\$[A-Z]+/gi.test(formula)},exports.isAbsoluteRowReference=function(formula){return!!formula&&/\$\d+/gi.test(formula)},exports.formulaToRelativeReference=function(formula,sourceCell,destinationCell,mode,insertionIndex){if(void 0===formula)return formula;for(var tokens=exports.tokenize(formula).tokens,newTokens=[],hasCircularReference=!1,hasReferenceExistsError=!1,i=0;i<tokens.length;i++){var token=tokens[i];if(token.tokenType.name===lexing_1.tokenVocabulary.Cell.name){var cell=constants_1.addressToCell(token.image),isAbsoluteRow=exports.isAbsoluteRowReference(token.image),isAbsoluteColumn=exports.isAbsoluteColumnReference(token.image);if(cell){if(void 0!==mode&&void 0!==insertionIndex){if("row"===mode&&cell.rowIndex<insertionIndex){newTokens.push(token);continue}if("column"===mode&&cell.columnIndex<insertionIndex){newTokens.push(token);continue}}var rowDelta=sourceCell.rowIndex-cell.rowIndex,columnDelta=sourceCell.columnIndex-cell.columnIndex;isAbsoluteRow||(cell.rowIndex=destinationCell.rowIndex-rowDelta),isAbsoluteColumn||(cell.columnIndex=destinationCell.columnIndex-columnDelta),cell.columnIndex===destinationCell.columnIndex&&cell.rowIndex===destinationCell.rowIndex&&(hasCircularReference=!0);var address=constants_1.cellToAddress(cell,isAbsoluteColumn,isAbsoluteRow);null===address||cell.rowIndex<=0||cell.columnIndex<=0?(hasReferenceExistsError=!0,token.image="#REF!"):token.image=address}}newTokens.push(token)}var finalFormula=exports.detokenize(newTokens);if(hasCircularReference)throw new error_1.default("#REF!",constants_1.ERROR_CIRCULAR_DEPENDENCY,finalFormula);if(hasReferenceExistsError)throw new error_1.default("#REF!",constants_1.ERROR_REFERENCE,finalFormula);return finalFormula},exports.cleanFunctionToken=function(text){return text.replace(new RegExp(/\(|\)/,"gi"),"")},exports.moveMergedCells=function(mergedCells,op,referenceIndex){switch(op){case"column-insert":return null==mergedCells?void 0:mergedCells.map((function(area){return area.left>=referenceIndex?Object.assign({},area,{left:area.left+1,right:area.right+1}):area}));case"row-insert":return null==mergedCells?void 0:mergedCells.map((function(area){return area.top>=referenceIndex?Object.assign({},area,{top:area.top+1,bottom:area.bottom+1}):area}));case"column-remove":return null==mergedCells?void 0:mergedCells.map((function(area){return area.left>=referenceIndex?Object.assign({},area,{left:area.left-1,right:area.right-1}):area}));case"row-remove":return null==mergedCells?void 0:mergedCells.map((function(area){return area.top>=referenceIndex?Object.assign({},area,{top:area.top-1,bottom:area.bottom-1}):area}))}return mergedCells},exports.functionSuggestion=function(tokens,editor){var start=exports.getCurrentCursorOffset(editor);if(start){var charBefore=slate_1.Editor.before(editor,start,{unit:"character"}),range=slate_1.Editor.range(editor,start,charBefore),str=slate_1.Editor.string(editor,range),token=tokens.find((function(token){return start.offset>=token.startOffset&&start.offset<=token.endColumn}));return!token||"("===str||"Column"!==token.tokenType.name&&"Name"!==token.tokenType.name&&"Function"!==token.tokenType.name&&"ExcelRefFunction"!==token.tokenType.name&&"ExcelConditionalRefFunction"!==token.tokenType.name?void 0:token}},exports.isTokenACell=function(token){return token&&"Cell"===token.tokenType.name},exports.getCurrentCursorOffset=function(editor){var selection=editor.selection;if(selection&&slate_1.Range.isCollapsed(selection))return _slicedToArray(slate_1.Range.edges(selection),1)[0]},exports.showCellSuggestions=function(editor,tokens){var _exports$getSurroundi2=_slicedToArray(exports.getSurroundingTokens(tokens,editor),3),prev=_exports$getSurroundi2[0],cur=_exports$getSurroundi2[1],next=_exports$getSurroundi2[2],start=exports.getCurrentCursorOffset(editor),ops=[].concat(_toConsumableArray(exports.operators),["Comma","Function","ExcelRefFunction","ExcelConditionalRefFunction","QuoteS"]),nextOps=["Comma"].concat(["CloseParen","CloseSquareParen","CloseCurlyParen","QuoteS"]);if(next&&"Cell"===next.tokenType.name)return!1;var curTokenIsFn=cur&&("Function"===cur.tokenType.name||"ExcelRefFunction"===cur.tokenType.name);return!(start&&cur&&curTokenIsFn&&start.offset<cur.endColumn)&&(!(start&&cur&&"Cell"===cur.tokenType.name&&start.offset<cur.endColumn)&&(!(next&&nextOps.includes(next.tokenType.name)&&cur&&"Comma"!==cur.tokenType.name&&"Function"!==cur.tokenType.name&&cur.tokenType.name!==next.tokenType.name)&&((!next||!["Cell","Function","ExcelRefFunction","OpenParens","Number"].includes(next.tokenType.name))&&(start&&prev&&ops.includes(prev.tokenType.name)&&start.offset>prev.endOffset||next&&nextOps.includes(next.tokenType.name)))))},exports.isCurrentPositionACell=function(editor,tokens){var token=exports.getCurrentToken(tokens,editor);return exports.isTokenACell(token)},exports.getSurroundingTokens=function(tokens,editor){return[exports.getPreviousToken(tokens,editor),exports.getCurrentToken(tokens,editor),exports.getNextToken(tokens,editor)]},exports.getCurrentToken=function(tokens,editor){var selection=editor.selection;if(selection&&slate_1.Range.isCollapsed(selection)){var start=_slicedToArray(slate_1.Range.edges(selection),1)[0];return tokens.find((function(token){return token.endColumn>=start.offset}))}},exports.getPreviousToken=function(tokens,editor){var token,start=exports.getCurrentCursorOffset(editor),i=0;if(start){for(;i<tokens.length;){if((token=tokens[i]).startColumn>start.offset){token=tokens[i-1];break}i++}return token}},exports.getNextToken=function(tokens,editor){var start=exports.getCurrentCursorOffset(editor);if(start)return tokens.find((function(token){return token.startOffset>=start.offset}))},exports.operators=["MulOp","PlusOp","DivOp","MinOp","ConcatOp","ExOp","MulOp","PercentOp","NeqOp","GteOp","LteOp","GtOp","EqOp","LtOp"],exports.operatorTokenNames=["At","Comma","Cell","Function","ExcelRefFunction","OpenParen"].concat(_toConsumableArray(exports.operators))},303:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var Cell_1=__importDefault(__webpack_require__(998));exports.default=Cell_1.default},304:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(33),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.FILTER_ICON_DIM=void 0;var react_1=__importStar(__webpack_require__(1)),react_konva_1=__webpack_require__(14);exports.FILTER_ICON_DIM=16;exports.default=function FilterIcon(_ref){var _ref$x=_ref.x,x=void 0===_ref$x?0:_ref$x,_ref$y=_ref.y,y=void 0===_ref$y?0:_ref$y,_ref$width=_ref.width,width=void 0===_ref$width?0:_ref$width,_ref$height=_ref.height,height=void 0===_ref$height?0:_ref$height,rowIndex=_ref.rowIndex,columnIndex=_ref.columnIndex,onClick=_ref.onClick,isActive=_ref.isActive,_react_1$useState2=_slicedToArray(react_1.useState(!1),2),isHovered=_react_1$useState2[0],setIsHovered=_react_1$useState2[1],padding=(height-exports.FILTER_ICON_DIM)/2,posX=x+width-exports.FILTER_ICON_DIM-2,posY=y+padding+.5,handleMouseEnter=react_1.useCallback((function(){setIsHovered(!0)}),[]),handleMouseLeave=react_1.useCallback((function(){setIsHovered(!1)}),[]);return react_1.default.createElement(react_konva_1.Group,{onClick:function handleClick(e){null==onClick||onClick({rowIndex:rowIndex,columnIndex:columnIndex})},onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave},react_1.default.createElement(react_konva_1.Rect,{x:posX,y:posY,width:exports.FILTER_ICON_DIM,height:exports.FILTER_ICON_DIM,fill:isHovered?"green":"white",cornerRadius:2}),react_1.default.createElement(react_konva_1.Path,{data:isActive?"M19 6h-14c-1.1 0-1.4.6-.6 1.4l4.2 4.2c.8.8 1.4 2.3 1.4 3.4v5l4-2v-3.5c0-.8.6-2.1 1.4-2.9l4.2-4.2c.8-.8.5-1.4-.6-1.4z":"M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z",x:posX+1,y:posY+1,fill:isHovered?"white":"green",scaleY:.6,scaleX:.6,listening:!1}))}},306:function(module,exports,__webpack_require__){"use strict";__webpack_require__(30),__webpack_require__(47),__webpack_require__(20),__webpack_require__(96),__webpack_require__(89),__webpack_require__(8),__webpack_require__(164),__webpack_require__(45),__webpack_require__(88),__webpack_require__(48),Object.defineProperty(exports,"__esModule",{value:!0}),exports.log=exports.castToString=exports.createPosition=exports.alpha2number=exports.number2Alpha=exports.cellToAddress=exports.addressToCell=exports.detectDataType=exports.ERROR_REFERENCE=exports.ERROR_CIRCULAR_DEPENDENCY=exports.isNull=void 0,exports.isNull=function(value){return null==value||""===value},exports.ERROR_CIRCULAR_DEPENDENCY="Circular dependency detected.",exports.ERROR_REFERENCE="Reference does not exist.",exports.detectDataType=function(value){if(!exports.isNull(value))return isNaN(Number(value))?"TRUE"===value||"FALSE"===value?"boolean":Array.isArray(value)?"array":"string":"number"},exports.addressToCell=function(address){for(var m,regex=/([A-Z]+)(\d+)/gim,matches=[];null!==(m=regex.exec(address));)m.index===regex.lastIndex&&regex.lastIndex++,m.forEach((function(match,groupIndex){groupIndex>0&&matches.push(match)}));if(!matches.length)return null;var columnAlpha=matches[0],rowIndex=matches[1];return{rowIndex:parseInt(rowIndex),columnIndex:exports.alpha2number(columnAlpha)}},exports.cellToAddress=function(cell){return cell?"".concat(exports.number2Alpha(cell.columnIndex-1)).concat(cell.rowIndex):null},exports.number2Alpha=function(i){return((i>=26?exports.number2Alpha((i/26>>0)-1):"")+"abcdefghijklmnopqrstuvwxyz"[i%26>>0]).toUpperCase()},exports.alpha2number=function(letters){return letters.split("").reduce((function(r,a){return 26*r+parseInt(a,36)-9}),0)},exports.createPosition=function(id){var row=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,col=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return{sheet:id,row:row,col:col}},exports.castToString=function(value){if(null!=value)return"string"!=typeof value?""+value:value},exports.log=function(){}},309:function(module,exports,__webpack_require__){"use strict";__webpack_require__(33),__webpack_require__(8);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.FormulaParser=void 0;var calc_1=__importDefault(__webpack_require__(1022)),parser_1=__webpack_require__(466);Object.defineProperty(exports,"FormulaParser",{enumerable:!0,get:function get(){return parser_1.FastFormulaParser}}),exports.default=calc_1.default,__exportStar(__webpack_require__(1038),exports),__exportStar(__webpack_require__(306),exports)},407:function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(25),__webpack_require__(38),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(201),__webpack_require__(26),__webpack_require__(33),__webpack_require__(8),__webpack_require__(32),__webpack_require__(10),__webpack_require__(19),__webpack_require__(130),__webpack_require__(16),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.RESET_SCROLL_EVENTS_DEBOUNCE_INTERVAL=void 0;var react_1=__importStar(__webpack_require__(1)),ReactKonvaCore_1=__webpack_require__(408),helpers_1=__webpack_require__(90),Cell_1=__webpack_require__(415),CellOverlay_1=__webpack_require__(420),Selection_1=__importDefault(__webpack_require__(421)),FillHandle_1=__importDefault(__webpack_require__(844)),GridLine_1=__importDefault(__webpack_require__(845)),utils_1=__webpack_require__(422),tiny_invariant_1=__importDefault(__webpack_require__(295)),types_1=__webpack_require__(97),defaultShadowSettings={strokeWidth:1},defaultRowHeight=function defaultRowHeight(){return 20},defaultColumnWidth=function defaultColumnWidth(){return 60},defaultSelectionRenderer=function defaultSelectionRenderer(props){return react_1.default.createElement(Selection_1.default,Object.assign({},props))},defaultGridLineRenderer=function defaultGridLineRenderer(props){return react_1.default.createElement(GridLine_1.default,Object.assign({},props))};exports.RESET_SCROLL_EVENTS_DEBOUNCE_INTERVAL=150;var EMPTY_ARRAY=[],Grid=react_1.memo(react_1.forwardRef((function(props,forwardedRef){var _props$width=props.width,containerWidth=void 0===_props$width?800:_props$width,_props$height=props.height,containerHeight=void 0===_props$height?600:_props$height,estimatedColumnWidth=props.estimatedColumnWidth,estimatedRowHeight=props.estimatedRowHeight,_props$rowHeight=props.rowHeight,rowHeight=void 0===_props$rowHeight?defaultRowHeight:_props$rowHeight,_props$columnWidth=props.columnWidth,columnWidth=void 0===_props$columnWidth?defaultColumnWidth:_props$columnWidth,_props$rowCount=props.rowCount,rowCount=void 0===_props$rowCount?0:_props$rowCount,_props$columnCount=props.columnCount,columnCount=void 0===_props$columnCount?0:_props$columnCount,_props$scrollbarSize=props.scrollbarSize,scrollbarSize=void 0===_props$scrollbarSize?13:_props$scrollbarSize,onScroll=props.onScroll,onImmediateScroll=props.onImmediateScroll,_props$showScrollbar=props.showScrollbar,showScrollbar=void 0===_props$showScrollbar||_props$showScrollbar,_props$selectionBackg=props.selectionBackgroundColor,selectionBackgroundColor=void 0===_props$selectionBackg?"rgb(14, 101, 235, 0.1)":_props$selectionBackg,_props$selectionBorde=props.selectionBorderColor,selectionBorderColor=void 0===_props$selectionBorde?"#1a73e8":_props$selectionBorde,_props$selectionStrok=props.selectionStrokeWidth,selectionStrokeWidth=void 0===_props$selectionStrok?1:_props$selectionStrok,_props$activeCellStro=props.activeCellStrokeWidth,activeCellStrokeWidth=void 0===_props$activeCellStro?2:_props$activeCellStro,activeCell=props.activeCell,_props$selections=props.selections,selections=void 0===_props$selections?EMPTY_ARRAY:_props$selections,_props$frozenRows=props.frozenRows,frozenRows=void 0===_props$frozenRows?0:_props$frozenRows,_props$frozenColumns=props.frozenColumns,frozenColumns=void 0===_props$frozenColumns?0:_props$frozenColumns,_props$itemRenderer=props.itemRenderer,itemRenderer=void 0===_props$itemRenderer?Cell_1.CellRenderer:_props$itemRenderer,_props$enableCellOver=props.enableCellOverlay,enableCellOverlay=void 0!==_props$enableCellOver&&_props$enableCellOver,_props$overlayRendere=props.overlayRenderer,overlayRenderer=void 0===_props$overlayRendere?CellOverlay_1.CellRenderer:_props$overlayRendere,_props$mergedCells=props.mergedCells,mergedCells=void 0===_props$mergedCells?EMPTY_ARRAY:_props$mergedCells,_props$snap=props.snap,snap=void 0!==_props$snap&&_props$snap,_props$scrollThrottle=props.scrollThrottleTimeout,scrollThrottleTimeout=void 0===_props$scrollThrottle?80:_props$scrollThrottle,onViewChange=props.onViewChange,_props$selectionRende=props.selectionRenderer,selectionRenderer=void 0===_props$selectionRende?defaultSelectionRenderer:_props$selectionRende,onBeforeRenderRow=props.onBeforeRenderRow,_props$showFrozenShad=props.showFrozenShadow,showFrozenShadow=void 0!==_props$showFrozenShad&&_props$showFrozenShad,_props$shadowSettings=props.shadowSettings,shadowSettings=void 0===_props$shadowSettings?defaultShadowSettings:_props$shadowSettings,_props$borderStyles=props.borderStyles,borderStyles=void 0===_props$borderStyles?EMPTY_ARRAY:_props$borderStyles,children=props.children,stageProps=props.stageProps,_props$wrapper=props.wrapper,wrapper=void 0===_props$wrapper?function(children){return children}:_props$wrapper,_props$cellAreas=props.cellAreas,cellAreas=void 0===_props$cellAreas?EMPTY_ARRAY:_props$cellAreas,_props$showFillHandle=props.showFillHandle,showFillHandle=void 0!==_props$showFillHandle&&_props$showFillHandle,fillSelection=props.fillSelection,_props$overscanCount=props.overscanCount,overscanCount=void 0===_props$overscanCount?1:_props$overscanCount,fillHandleProps=props.fillHandleProps,_props$fillhandleBord=props.fillhandleBorderColor,fillhandleBorderColor=void 0===_props$fillhandleBord?"white":_props$fillhandleBord,_props$showGridLines=props.showGridLines,showGridLines=void 0!==_props$showGridLines&&_props$showGridLines,_props$gridLineColor=props.gridLineColor,gridLineColor=void 0===_props$gridLineColor?"#E3E2E2":_props$gridLineColor,_props$gridLineWidth=props.gridLineWidth,gridLineWidth=void 0===_props$gridLineWidth?1:_props$gridLineWidth,_props$gridLineRender=props.gridLineRenderer,gridLineRenderer=void 0===_props$gridLineRender?defaultGridLineRenderer:_props$gridLineRender,isHiddenRow=props.isHiddenRow,isHiddenColumn=props.isHiddenColumn,isHiddenCell=props.isHiddenCell,_props$scale=props.scale,scale=void 0===_props$scale?1:_props$scale,rest=_objectWithoutProperties(props,["width","height","estimatedColumnWidth","estimatedRowHeight","rowHeight","columnWidth","rowCount","columnCount","scrollbarSize","onScroll","onImmediateScroll","showScrollbar","selectionBackgroundColor","selectionBorderColor","selectionStrokeWidth","activeCellStrokeWidth","activeCell","selections","frozenRows","frozenColumns","itemRenderer","enableCellOverlay","overlayRenderer","mergedCells","snap","scrollThrottleTimeout","onViewChange","selectionRenderer","onBeforeRenderRow","showFrozenShadow","shadowSettings","borderStyles","children","stageProps","wrapper","cellAreas","showFillHandle","fillSelection","overscanCount","fillHandleProps","fillhandleBorderColor","showGridLines","gridLineColor","gridLineWidth","gridLineRenderer","isHiddenRow","isHiddenColumn","isHiddenCell","scale"]);tiny_invariant_1.default(!(children&&"function"!=typeof children),"Children should be a function"),react_1.useImperativeHandle(forwardedRef,(function(){return{scrollTo:scrollTo,scrollBy:scrollBy,scrollToItem:scrollToItem,stage:stageRef.current,container:containerRef.current,resetAfterIndices:resetAfterIndices,getScrollPosition:getScrollPosition,isMergedCell:isMergedCell,getCellBounds:getCellBounds,getCellCoordsFromOffset:getCellCoordsFromOffset,getCellOffsetFromCoords:getCellOffsetFromCoords,getActualCellCoords:getActualCellCoords,focus:focusContainer,resizeColumns:resizeColumns,resizeRows:resizeRows,getViewPort:getViewPort,getRelativePositionFromOffset:getRelativePositionFromOffset,scrollToTop:scrollToTop,getDimensions:getDimensions}}));var instanceProps=react_1.useRef({columnMetadataMap:{},rowMetadataMap:{},lastMeasuredColumnIndex:-1,lastMeasuredRowIndex:-1,estimatedColumnWidth:estimatedColumnWidth||50,estimatedRowHeight:estimatedRowHeight||50,recalcColumnIndices:[],recalcRowIndices:[]}),stageRef=react_1.useRef(null),containerRef=react_1.useRef(null),verticalScrollRef=react_1.useRef(null),wheelingRef=react_1.useRef(null),horizontalScrollRef=react_1.useRef(null),_react_1$useReducer2=_slicedToArray(react_1.useReducer((function(s){return s+1}),0),2),forceRender=(_react_1$useReducer2[0],_react_1$useReducer2[1]),_react_1$useState2=_slicedToArray(react_1.useState({scrollTop:0,scrollLeft:0,isScrolling:!1,verticalScrollDirection:types_1.Direction.Down,horizontalScrollDirection:types_1.Direction.Right}),2),scrollState=_react_1$useState2[0],setScrollState=_react_1$useState2[1],scrollSnapRefs=react_1.useRef(null),scrollTop=scrollState.scrollTop,scrollLeft=scrollState.scrollLeft,isScrolling=scrollState.isScrolling,verticalScrollDirection=scrollState.verticalScrollDirection,horizontalScrollDirection=scrollState.horizontalScrollDirection,isMounted=react_1.useRef(!1),focusContainer=react_1.useCallback((function(){var _a;return null===(_a=containerRef.current)||void 0===_a?void 0:_a.focus()}),[]);react_1.useEffect((function(){isMounted.current&&(null==onScroll||onScroll({scrollTop:scrollTop,scrollLeft:scrollLeft}))}),[scrollTop,scrollLeft]),react_1.useEffect((function(){var _a;return null===(_a=containerRef.current)||void 0===_a||_a.addEventListener("wheel",handleWheel,{passive:!1}),isMounted.current=!0,function(){var _a;null===(_a=containerRef.current)||void 0===_a||_a.removeEventListener("wheel",handleWheel)}}),[]);var getScrollPosition=react_1.useCallback((function(){return{scrollTop:scrollTop,scrollLeft:scrollLeft}}),[scrollTop,scrollLeft]),resetAfterIndices=react_1.useCallback((function(_ref){var columnIndex=_ref.columnIndex,rowIndex=_ref.rowIndex,shouldForceUpdate=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];"number"==typeof columnIndex&&(instanceProps.current.recalcColumnIndices=[],instanceProps.current.lastMeasuredColumnIndex=Math.min(instanceProps.current.lastMeasuredColumnIndex,columnIndex-1)),"number"==typeof rowIndex&&(instanceProps.current.recalcRowIndices=[],instanceProps.current.lastMeasuredRowIndex=Math.min(instanceProps.current.lastMeasuredRowIndex,rowIndex-1)),shouldForceUpdate&&forceRender()}),[]),mergedCellMap=react_1.useMemo((function(){for(var mergedCellMap=new Map,i=0;i<mergedCells.length;i++){var _step,bounds=mergedCells[i],_iterator=_createForOfIteratorHelper(helpers_1.getBoundedCells(bounds));try{for(_iterator.s();!(_step=_iterator.n()).done;){var cell=_step.value;mergedCellMap.set(cell,bounds)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}return mergedCellMap}),[mergedCells]),isMergedCell=react_1.useCallback((function(_ref2){var rowIndex=_ref2.rowIndex,columnIndex=_ref2.columnIndex;return mergedCellMap.has(helpers_1.cellIdentifier(rowIndex,columnIndex))}),[mergedCells]),getCellBounds=react_1.useCallback((function(_ref3){var rowIndex=_ref3.rowIndex,columnIndex=_ref3.columnIndex,spanMerges=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(spanMerges){var isMerged=isMergedCell({rowIndex:rowIndex,columnIndex:columnIndex});if(isMerged)return mergedCellMap.get(helpers_1.cellIdentifier(rowIndex,columnIndex))}return{top:rowIndex,left:columnIndex,right:columnIndex,bottom:rowIndex}}),[mergedCellMap]),getActualCellCoords=react_1.useCallback((function(_ref4){var rowIndex=_ref4.rowIndex,columnIndex=_ref4.columnIndex;if(isMergedCell({rowIndex:rowIndex,columnIndex:columnIndex})){var cell=mergedCellMap.get(helpers_1.cellIdentifier(rowIndex,columnIndex));return{rowIndex:null==cell?void 0:cell.top,columnIndex:null==cell?void 0:cell.left}}return{rowIndex:rowIndex,columnIndex:columnIndex}}),[mergedCellMap]),_getVerticalRangeToRe2=_slicedToArray(function getVerticalRangeToRender(){var frozenRowHeight=helpers_1.getRowOffset({index:frozenRows,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),startIndex=helpers_1.getRowStartIndexForOffset({rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps.current,offset:scrollTop+frozenRowHeight,scale:scale}),stopIndex=helpers_1.getRowStopIndexForStartIndex({startIndex:startIndex,rowCount:rowCount,rowHeight:rowHeight,columnWidth:columnWidth,scrollTop:scrollTop,containerHeight:containerHeight,instanceProps:instanceProps.current,scale:scale}),overscanBackward=isScrolling&&verticalScrollDirection!==types_1.Direction.Up?1:Math.max(1,overscanCount),overscanForward=isScrolling&&verticalScrollDirection!==types_1.Direction.Down?1:Math.max(1,overscanCount);return[Math.max(0,startIndex-overscanBackward),Math.max(0,Math.min(rowCount-1,stopIndex+overscanForward)),startIndex,stopIndex]}(),4),rowStartIndex=_getVerticalRangeToRe2[0],rowStopIndex=_getVerticalRangeToRe2[1],visibleRowStartIndex=_getVerticalRangeToRe2[2],visibleRowStopIndex=_getVerticalRangeToRe2[3],_getHorizontalRangeTo2=_slicedToArray(function getHorizontalRangeToRender(){var frozenColumnWidth=helpers_1.getColumnOffset({index:frozenColumns,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),startIndex=helpers_1.getColumnStartIndexForOffset({rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps.current,offset:scrollLeft+frozenColumnWidth,scale:scale}),stopIndex=helpers_1.getColumnStopIndexForStartIndex({startIndex:startIndex,columnCount:columnCount,rowHeight:rowHeight,columnWidth:columnWidth,scrollLeft:scrollLeft,containerWidth:containerWidth,instanceProps:instanceProps.current,scale:scale}),overscanBackward=isScrolling&&horizontalScrollDirection!==types_1.Direction.Left?1:Math.max(1,overscanCount),overscanForward=isScrolling&&horizontalScrollDirection!==types_1.Direction.Right?1:Math.max(1,overscanCount);return[Math.max(0,startIndex-overscanBackward),Math.max(0,Math.min(columnCount-1,stopIndex+overscanForward)),startIndex,stopIndex]}(),4),columnStartIndex=_getHorizontalRangeTo2[0],columnStopIndex=_getHorizontalRangeTo2[1],visibleColumnStartIndex=_getHorizontalRangeTo2[2],visibleColumnStopIndex=_getHorizontalRangeTo2[3],estimatedTotalHeight=helpers_1.getEstimatedTotalHeight(rowCount,instanceProps.current),estimatedTotalWidth=helpers_1.getEstimatedTotalWidth(columnCount,instanceProps.current),getDimensions=react_1.useCallback((function(){return{containerWidth:containerWidth,containerHeight:containerHeight,estimatedTotalWidth:estimatedTotalWidth,estimatedTotalHeight:estimatedTotalHeight}}),[containerWidth,containerHeight,estimatedTotalWidth,estimatedTotalHeight]);react_1.useEffect((function(){snap&&(scrollSnapRefs.current={visibleRowStartIndex:visibleRowStartIndex,rowCount:rowCount,frozenRows:frozenRows,visibleColumnStartIndex:visibleColumnStartIndex,columnCount:columnCount,frozenColumns:frozenColumns,isHiddenRow:isHiddenRow,isHiddenColumn:isHiddenColumn})}),[snap,visibleRowStartIndex,rowCount,frozenRows,visibleColumnStartIndex,columnCount,frozenColumns,isHiddenRow,isHiddenColumn]);var snapToRowFn=react_1.useCallback((function(_ref5){var deltaY=_ref5.deltaY;if(verticalScrollRef.current&&scrollSnapRefs.current&&0!==deltaY){var direction=deltaY<0?types_1.Direction.Up:types_1.Direction.Down,_scrollSnapRefs$curre=scrollSnapRefs.current,_visibleRowStartIndex=_scrollSnapRefs$curre.visibleRowStartIndex,_rowCount=_scrollSnapRefs$curre.rowCount,_isHiddenRow=_scrollSnapRefs$curre.isHiddenRow,nextRowIndex=direction===types_1.Direction.Up?Math.max(0,_visibleRowStartIndex-1):Math.min(_visibleRowStartIndex,_rowCount-1);nextRowIndex=helpers_1.clampIndex(nextRowIndex,_isHiddenRow,direction);var _rowHeight=helpers_1.getRowHeight(nextRowIndex,instanceProps.current);verticalScrollRef.current.scrollTop+=(direction===types_1.Direction.Up?-1:1)*_rowHeight}}),[]),snapToColumnFn=react_1.useCallback((function(_ref6){var deltaX=_ref6.deltaX;if(horizontalScrollRef.current&&scrollSnapRefs.current&&0!==deltaX){var _scrollSnapRefs$curre2=scrollSnapRefs.current,_visibleColumnStartIndex=_scrollSnapRefs$curre2.visibleColumnStartIndex,_columnCount=_scrollSnapRefs$curre2.columnCount,_isHiddenColumn=_scrollSnapRefs$curre2.isHiddenColumn,direction=deltaX<0?types_1.Direction.Left:types_1.Direction.Right,nextColumnIndex=direction===types_1.Direction.Left?Math.max(0,_visibleColumnStartIndex-1):Math.min(_visibleColumnStartIndex,_columnCount-1);nextColumnIndex=helpers_1.clampIndex(nextColumnIndex,_isHiddenColumn,direction);var _columnWidth=helpers_1.getColumnWidth(nextColumnIndex,instanceProps.current);horizontalScrollRef.current.scrollLeft+=(direction===types_1.Direction.Left?-1:1)*_columnWidth}}),[]),snapToRowThrottler=react_1.useRef(),snapToColumnThrottler=react_1.useRef();react_1.useEffect((function(){return snap&&(snapToRowThrottler.current=helpers_1.throttle(snapToRowFn,scrollThrottleTimeout),snapToColumnThrottler.current=helpers_1.throttle(snapToColumnFn,scrollThrottleTimeout)),function(){snapToRowThrottler.current=void 0,snapToColumnThrottler.current=void 0}}),[snap]);var frozenColumnWidth=helpers_1.getColumnOffset({index:frozenColumns,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),frozenRowHeight=helpers_1.getRowOffset({index:frozenRows,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),isWithinFrozenColumnBoundary=react_1.useCallback((function(x){return frozenColumns>0&&x<frozenColumnWidth}),[frozenColumns,frozenColumnWidth]),isWithinFrozenRowBoundary=react_1.useCallback((function(y){return frozenRows>0&&y<frozenRowHeight}),[frozenRows,frozenRowHeight]),getRelativePositionFromOffset=react_1.useCallback((function(left,top){var _a;if(tiny_invariant_1.default("number"==typeof left&&"number"==typeof top,"Top and left should be a number"),!stageRef.current)return null;var stage=stageRef.current.getStage(),rect=null===(_a=containerRef.current)||void 0===_a?void 0:_a.getBoundingClientRect();rect&&(left-=rect.x,top-=rect.y);var _stage$getAbsoluteTra=stage.getAbsoluteTransform().copy().invert().point({x:left,y:top});return{x:_stage$getAbsoluteTra.x,y:_stage$getAbsoluteTra.y}}),[]),getCellCoordsFromOffset=react_1.useCallback((function(left,top){var pos=getRelativePositionFromOffset(left,top);if(!pos)return null;var x=pos.x,y=pos.y,rowOffset=isWithinFrozenRowBoundary(y)?y:y+scrollTop,columnOffset=isWithinFrozenColumnBoundary(x)?x:x+scrollLeft;if(rowOffset>estimatedTotalHeight||columnOffset>estimatedTotalWidth)return null;var rowIndex=helpers_1.getRowStartIndexForOffset({rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps.current,offset:rowOffset,scale:scale}),columnIndex=helpers_1.getColumnStartIndexForOffset({rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps.current,offset:columnOffset,scale:scale}),bounds=getCellBounds({rowIndex:rowIndex,columnIndex:columnIndex});return{rowIndex:bounds.top,columnIndex:bounds.left}}),[scrollLeft,rowHeight,columnWidth,scrollTop,rowCount,estimatedTotalHeight,estimatedTotalWidth,columnCount,mergedCellMap]),getCellOffsetFromCoords=react_1.useCallback((function(cell){var _getCellBounds=getCellBounds(cell),rowIndex=_getCellBounds.top,columnIndex=_getCellBounds.left,right=_getCellBounds.right,bottom=_getCellBounds.bottom,x=helpers_1.getColumnOffset({index:columnIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),y=helpers_1.getRowOffset({index:rowIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});return{x:x,y:y,width:helpers_1.getColumnOffset({index:right+1,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-x,height:helpers_1.getRowOffset({index:bottom+1,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-y}}),[mergedCellMap]),resizeColumns=react_1.useCallback((function(indices){var leftMost=Math.min.apply(Math,_toConsumableArray(indices));instanceProps.current.recalcColumnIndices=indices,resetAfterIndices({columnIndex:leftMost},!1),forceRender()}),[]),resizeRows=react_1.useCallback((function(indices){var topMost=Math.min.apply(Math,_toConsumableArray(indices));instanceProps.current.recalcRowIndices=indices,resetAfterIndices({rowIndex:topMost},!1),forceRender()}),[]);react_1.useEffect((function(){instanceProps.current.recalcColumnIndices.length&&(instanceProps.current.recalcColumnIndices.length=0),instanceProps.current.recalcRowIndices.length&&(instanceProps.current.recalcRowIndices.length=0)}),[rowStopIndex,columnStopIndex,scale]);var getViewPort=react_1.useCallback((function(){return{rowStartIndex:rowStartIndex,rowStopIndex:rowStopIndex,columnStartIndex:columnStartIndex,columnStopIndex:columnStopIndex,visibleRowStartIndex:visibleRowStartIndex,visibleRowStopIndex:visibleRowStopIndex,visibleColumnStartIndex:visibleColumnStartIndex,visibleColumnStopIndex:visibleColumnStopIndex}}),[rowStartIndex,rowStopIndex,columnStartIndex,columnStopIndex,visibleRowStartIndex,visibleRowStopIndex,visibleColumnStartIndex,visibleColumnStopIndex]),resetIsScrollingTimeoutID=react_1.useRef(null),resetIsScrollingDebounced=react_1.useCallback((function(){null!==resetIsScrollingTimeoutID.current&&helpers_1.cancelTimeout(resetIsScrollingTimeoutID.current),resetIsScrollingTimeoutID.current=helpers_1.requestTimeout(resetIsScrolling,exports.RESET_SCROLL_EVENTS_DEBOUNCE_INTERVAL)}),[]),resetIsScrolling=react_1.useCallback((function(){resetIsScrollingTimeoutID.current=null,setScrollState((function(prev){return Object.assign({},prev,{isScrolling:!1})}))}),[]),handleScroll=react_1.useCallback((function(e){var scrollTop=e.target.scrollTop;setScrollState((function(prev){return Object.assign({},prev,{isScrolling:!0,verticalScrollDirection:prev.scrollTop>scrollTop?types_1.Direction.Up:types_1.Direction.Down,scrollTop:scrollTop})})),null==onImmediateScroll||onImmediateScroll({scrollTop:scrollTop,scrollLeft:scrollLeft}),resetIsScrollingDebounced()}),[scrollLeft]),handleScrollLeft=react_1.useCallback((function(e){var scrollLeft=e.target.scrollLeft;setScrollState((function(prev){return Object.assign({},prev,{isScrolling:!0,horizontalScrollDirection:prev.scrollLeft>scrollLeft?types_1.Direction.Left:types_1.Direction.Right,scrollLeft:scrollLeft})})),null==onImmediateScroll||onImmediateScroll({scrollLeft:scrollLeft,scrollTop:scrollTop}),resetIsScrollingDebounced()}),[scrollTop]),scrollTo=react_1.useCallback((function(_ref7){var scrollTop=_ref7.scrollTop,scrollLeft=_ref7.scrollLeft;showScrollbar?(horizontalScrollRef.current&&void 0!==scrollLeft&&(horizontalScrollRef.current.scrollLeft=scrollLeft),verticalScrollRef.current&&void 0!==scrollTop&&(verticalScrollRef.current.scrollTop=scrollTop)):setScrollState((function(prev){return Object.assign({},prev,{scrollLeft:null==scrollLeft?prev.scrollLeft:scrollLeft,scrollTop:null==scrollTop?prev.scrollTop:scrollTop})}))}),[showScrollbar]),scrollToTop=react_1.useCallback((function(){scrollTo({scrollTop:0,scrollLeft:0})}),[]),scrollBy=react_1.useCallback((function(_ref8){var x=_ref8.x,y=_ref8.y;showScrollbar?(horizontalScrollRef.current&&void 0!==x&&(horizontalScrollRef.current.scrollLeft+=x),verticalScrollRef.current&&void 0!==y&&(verticalScrollRef.current.scrollTop+=y)):setScrollState((function(prev){return Object.assign({},prev,{scrollLeft:null==x?prev.scrollLeft:prev.scrollLeft+x,scrollTop:null==y?prev.scrollTop:prev.scrollTop+y})}))}),[]),scrollToItem=react_1.useCallback((function(_ref9){var rowIndex=_ref9.rowIndex,columnIndex=_ref9.columnIndex,align=arguments.length>1&&void 0!==arguments[1]?arguments[1]:helpers_1.Align.smart,isFrozenRow=rowIndex&&rowIndex<frozenRows,isFrozenColumn=columnIndex&&columnIndex<frozenColumns,frozenColumnOffset=helpers_1.getColumnOffset({index:frozenColumns,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),width=(columnIndex&&helpers_1.getColumnOffset({index:columnIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),rowIndex&&helpers_1.getRowOffset({index:rowIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),columnIndex?helpers_1.getColumnWidth(columnIndex,instanceProps.current):0),height=rowIndex?helpers_1.getRowHeight(rowIndex,instanceProps.current):0,columnAlign=width>containerWidth?helpers_1.Align.start:align,rowAlign=height>containerHeight?helpers_1.Align.start:align,newScrollLeft=void 0===columnIndex||isFrozenColumn?void 0:helpers_1.getOffsetForColumnAndAlignment({index:columnIndex,containerHeight:containerHeight,containerWidth:containerWidth,columnCount:columnCount,columnWidth:columnWidth,rowCount:rowCount,rowHeight:rowHeight,scrollOffset:scrollLeft,instanceProps:instanceProps.current,scrollbarSize:scrollbarSize,frozenOffset:frozenColumnOffset,align:columnAlign,scale:scale}),frozenRowOffset=helpers_1.getRowOffset({index:frozenRows,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),newScrollTop=void 0===rowIndex||isFrozenRow?void 0:helpers_1.getOffsetForRowAndAlignment({index:rowIndex,containerHeight:containerHeight,containerWidth:containerWidth,columnCount:columnCount,columnWidth:columnWidth,rowCount:rowCount,rowHeight:rowHeight,scrollOffset:scrollTop,instanceProps:instanceProps.current,scrollbarSize:scrollbarSize,frozenOffset:frozenRowOffset,align:rowAlign,scale:scale}),coords={scrollLeft:newScrollLeft,scrollTop:newScrollTop},isOutsideViewport=void 0!==rowIndex&&rowIndex>rowStopIndex+(rowStopIndex-rowStartIndex)||void 0!==columnIndex&&columnIndex>columnStopIndex+(columnStopIndex-columnStartIndex);isOutsideViewport?window.requestAnimationFrame((function(){scrollTo(coords)})):scrollTo(coords)}),[containerHeight,containerWidth,rowCount,columnCount,scrollbarSize,scrollLeft,scrollTop,frozenRows,frozenColumns]),handleWheel=react_1.useCallback((function(event){var _a,_b,_c,_d,isScrollingHorizontally=event.shiftKey;event.preventDefault();var deltaX=event.deltaX,deltaY=event.deltaY,deltaMode=event.deltaMode;if(!wheelingRef.current){var dx=isScrollingHorizontally?deltaY:deltaX,dy=deltaY,isHorizontal=isScrollingHorizontally||Math.abs(dx)>Math.abs(dy);if(snap)isHorizontal?null===(_a=snapToColumnThrottler.current)||void 0===_a||_a.call(snapToColumnThrottler,{deltaX:deltaX}):null===(_b=snapToRowThrottler.current)||void 0===_b||_b.call(snapToRowThrottler,{deltaY:deltaY});else if(1===deltaMode&&(dy*=scrollbarSize),horizontalScrollRef.current&&verticalScrollRef.current){var currentScroll=isHorizontal?null===(_c=horizontalScrollRef.current)||void 0===_c?void 0:_c.scrollLeft:null===(_d=verticalScrollRef.current)||void 0===_d?void 0:_d.scrollTop;wheelingRef.current=window.requestAnimationFrame((function(){wheelingRef.current=null,isHorizontal?horizontalScrollRef.current&&(horizontalScrollRef.current.scrollLeft=currentScroll+dx):verticalScrollRef.current&&(verticalScrollRef.current.scrollTop=currentScroll+dy)}))}}}),[]);react_1.useEffect((function(){null==onViewChange||onViewChange({rowStartIndex:rowStartIndex,rowStopIndex:rowStopIndex,columnStartIndex:columnStartIndex,columnStopIndex:columnStopIndex,visibleRowStartIndex:visibleRowStartIndex,visibleRowStopIndex:visibleRowStopIndex,visibleColumnStartIndex:visibleColumnStartIndex,visibleColumnStopIndex:visibleColumnStopIndex})}),[rowStartIndex,rowStopIndex,columnStartIndex,columnStopIndex,visibleRowStartIndex,visibleRowStopIndex,visibleColumnStartIndex,visibleColumnStopIndex]);var gridLines=[],gridLinesFrozenRow=[],gridLinesFrozenColumn=[],gridLinesFrozenIntersection=[];if(showGridLines){for(var rowIndex=rowStartIndex;rowIndex<=rowStopIndex;rowIndex++)if(!(rowIndex<frozenRows||(null==isHiddenRow?void 0:isHiddenRow(rowIndex)))){var x1=helpers_1.getColumnOffset({index:frozenColumns,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),x2=helpers_1.getColumnOffset({index:Math.min(columnStopIndex+1,columnCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),y1=helpers_1.getRowOffset({index:Math.min(rowIndex+1,rowCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),y2=y1;gridLines.push(gridLineRenderer({points:[x1,y1,x2,y2],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetY:-.5,key:helpers_1.itemKey({rowIndex:rowIndex,columnIndex:y1})})),gridLinesFrozenColumn.push(gridLineRenderer({points:[0,y1,x2,y2],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetY:-.5,key:helpers_1.itemKey({rowIndex:rowIndex,columnIndex:y1})}))}for(var columnIndex=columnStartIndex;columnIndex<=columnStopIndex;columnIndex++){var _x=helpers_1.getColumnOffset({index:Math.min(columnIndex+1,columnCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_x2=_x,_y=helpers_1.getRowOffset({index:frozenRows,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_y2=helpers_1.getRowOffset({index:Math.min(rowStopIndex+1,rowCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});gridLines.push(gridLineRenderer({points:[_x,_y,_x2,_y2],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetX:-.5,key:helpers_1.itemKey({rowIndex:_x,columnIndex:columnIndex})})),gridLinesFrozenRow.push(gridLineRenderer({points:[_x,0,_x2,_y2],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetX:-.5,key:helpers_1.itemKey({rowIndex:_x,columnIndex:columnIndex})}))}for(var _rowIndex=0;_rowIndex<Math.min(columnStopIndex,frozenRows);_rowIndex++)if(!(null==isHiddenRow?void 0:isHiddenRow(_rowIndex))){var _x4=helpers_1.getColumnOffset({index:Math.min(columnStopIndex+1,columnCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_y3=helpers_1.getRowOffset({index:Math.min(_rowIndex+1,rowCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_y4=_y3;gridLinesFrozenRow.push(gridLineRenderer({points:[0,_y3,_x4,_y4],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetY:-.5,key:helpers_1.itemKey({rowIndex:_rowIndex,columnIndex:_y3})})),gridLinesFrozenIntersection.push(gridLineRenderer({points:[0,_y3,_x4,_y4],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetY:-.5,key:helpers_1.itemKey({rowIndex:_rowIndex,columnIndex:_y3})}))}for(var _columnIndex=0;_columnIndex<Math.min(columnStopIndex,frozenColumns);_columnIndex++){var _x5=helpers_1.getColumnOffset({index:Math.min(_columnIndex+1,columnCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_x6=_x5,_y6=helpers_1.getRowOffset({index:Math.min(rowStopIndex+1,rowCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});gridLinesFrozenColumn.push(gridLineRenderer({points:[_x5,0,_x6,_y6],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetX:-.5,key:helpers_1.itemKey({rowIndex:_x5,columnIndex:_columnIndex})})),gridLinesFrozenIntersection.push(gridLineRenderer({points:[_x5,0,_x6,_y6],stroke:gridLineColor,strokeWidth:gridLineWidth,offsetX:-.5,key:helpers_1.itemKey({rowIndex:_x5,columnIndex:_columnIndex})}))}}var mergedCellRenderMap=new Set,cells=[],cellOverlays=[];if(columnCount>0&&rowCount)for(var _rowIndex2=rowStartIndex;_rowIndex2<=rowStopIndex;_rowIndex2++)if(!(_rowIndex2<frozenRows||(null==isHiddenRow?void 0:isHiddenRow(_rowIndex2)))){null==onBeforeRenderRow||onBeforeRenderRow(_rowIndex2);for(var _columnIndex2=columnStartIndex;_columnIndex2<=columnStopIndex;_columnIndex2++)if(!(_columnIndex2<frozenColumns)){var isMerged=isMergedCell({rowIndex:_rowIndex2,columnIndex:_columnIndex2}),bounds=getCellBounds({rowIndex:_rowIndex2,columnIndex:_columnIndex2}),actualRowIndex=isMerged?bounds.top:_rowIndex2,actualColumnIndex=isMerged?bounds.left:_columnIndex2,actualBottom=Math.max(_rowIndex2,bounds.bottom),actualRight=Math.max(_columnIndex2,bounds.right);if(isMerged||!(null==isHiddenCell?void 0:isHiddenCell(actualRowIndex,actualColumnIndex))){if(isMerged){var cellId=helpers_1.cellIdentifier(bounds.top,bounds.left);if(mergedCellRenderMap.has(cellId))continue;mergedCellRenderMap.add(cellId)}var y=helpers_1.getRowOffset({index:actualRowIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),height=helpers_1.getRowOffset({index:actualBottom,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-y+helpers_1.getRowHeight(actualBottom,instanceProps.current),x=helpers_1.getColumnOffset({index:actualColumnIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),width=helpers_1.getColumnOffset({index:actualRight,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-x+helpers_1.getColumnWidth(actualRight,instanceProps.current);cells.push(itemRenderer({x:x,y:y,width:width,height:height,rowIndex:actualRowIndex,columnIndex:actualColumnIndex,isMergedCell:isMerged,key:helpers_1.itemKey({rowIndex:actualRowIndex,columnIndex:actualColumnIndex})})),enableCellOverlay&&cellOverlays.push(overlayRenderer({x:x,y:y,width:width,height:height,rowIndex:actualRowIndex,columnIndex:actualColumnIndex,isMergedCell:isMerged,key:helpers_1.itemKey({rowIndex:actualRowIndex,columnIndex:actualColumnIndex})}))}}}var _step2,ranges=[],_iterator2=_createForOfIteratorHelper(cellAreas);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _ref10=_step2.value,_rowIndex3=_ref10.rowIndex,_columnIndex3=_ref10.columnIndex,toColumnIndex=_ref10.toColumnIndex;if(!(_rowIndex3<frozenRows||_columnIndex3<frozenColumns||isMergedCell({rowIndex:_rowIndex3,columnIndex:_columnIndex3})||(null==isHiddenCell?void 0:isHiddenCell(_rowIndex3,_columnIndex3)))){var _x7=helpers_1.getColumnOffset({index:_columnIndex3,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_y7=helpers_1.getRowOffset({index:_rowIndex3,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_height=helpers_1.getRowHeight(_rowIndex3,instanceProps.current),_getCellOffsetFromCoo2=getCellOffsetFromCoords({rowIndex:_rowIndex3,columnIndex:toColumnIndex+1}).x,offsetX=void 0===_getCellOffsetFromCoo2?0:_getCellOffsetFromCoo2;ranges.push(itemRenderer({x:_x7,y:_y7,width:offsetX-_x7,height:_height,rowIndex:_rowIndex3,columnIndex:_columnIndex3,key:"range:".concat(helpers_1.itemKey({rowIndex:_rowIndex3,columnIndex:_columnIndex3}))}))}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}for(var frozenRowCells=[],frozenRowCellOverlays=[],_rowIndex4=0;_rowIndex4<Math.min(rowStopIndex,frozenRows);_rowIndex4++)if(!(null==isHiddenRow?void 0:isHiddenRow(_rowIndex4))){null==onBeforeRenderRow||onBeforeRenderRow(_rowIndex4);for(var _columnIndex4=columnStartIndex;_columnIndex4<=columnStopIndex;_columnIndex4++)if(!(_columnIndex4<frozenColumns)){var _isMerged=isMergedCell({rowIndex:_rowIndex4,columnIndex:_columnIndex4}),_bounds=getCellBounds({rowIndex:_rowIndex4,columnIndex:_columnIndex4}),_actualRowIndex=_isMerged?_bounds.top:_rowIndex4,_actualColumnIndex=_isMerged?_bounds.left:_columnIndex4,_actualBottom=Math.max(_rowIndex4,_bounds.bottom),_actualRight=Math.max(_columnIndex4,_bounds.right);if(_isMerged||!(null==isHiddenCell?void 0:isHiddenCell(_actualRowIndex,_actualColumnIndex))){if(_isMerged){var _cellId=helpers_1.cellIdentifier(_bounds.top,_bounds.left);if(mergedCellRenderMap.has(_cellId))continue;mergedCellRenderMap.add(_cellId)}var _y8=helpers_1.getRowOffset({index:_actualRowIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_height2=helpers_1.getRowOffset({index:_actualBottom,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-_y8+helpers_1.getRowHeight(_actualBottom,instanceProps.current),_x8=helpers_1.getColumnOffset({index:_actualColumnIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_width=helpers_1.getColumnOffset({index:_actualRight,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-_x8+helpers_1.getColumnWidth(_actualRight,instanceProps.current);frozenRowCells.push(itemRenderer({x:_x8,y:_y8,width:_width,height:_height2,rowIndex:_actualRowIndex,columnIndex:_actualColumnIndex,isMergedCell:_isMerged,key:helpers_1.itemKey({rowIndex:_actualRowIndex,columnIndex:_actualColumnIndex})})),enableCellOverlay&&frozenRowCellOverlays.push(overlayRenderer({x:_x8,y:_y8,width:_width,height:_height2,rowIndex:_actualRowIndex,columnIndex:_actualColumnIndex,isMergedCell:_isMerged,key:helpers_1.itemKey({rowIndex:_actualRowIndex,columnIndex:_actualColumnIndex})}))}}}for(var frozenColumnCells=[],frozenColumnCellOverlays=[],_rowIndex5=rowStartIndex;_rowIndex5<=rowStopIndex;_rowIndex5++)if(!(_rowIndex5<frozenRows||(null==isHiddenRow?void 0:isHiddenRow(_rowIndex5)))){null==onBeforeRenderRow||onBeforeRenderRow(_rowIndex5);for(var _columnIndex5=0;_columnIndex5<Math.min(columnStopIndex,frozenColumns);_columnIndex5++){var _isMerged2=isMergedCell({rowIndex:_rowIndex5,columnIndex:_columnIndex5}),_bounds2=getCellBounds({rowIndex:_rowIndex5,columnIndex:_columnIndex5}),_actualRowIndex2=_isMerged2?_bounds2.top:_rowIndex5,_actualColumnIndex2=_isMerged2?_bounds2.left:_columnIndex5,_actualBottom2=Math.max(_rowIndex5,_bounds2.bottom),_actualRight2=Math.max(_columnIndex5,_bounds2.right);if(_isMerged2||!(null==isHiddenCell?void 0:isHiddenCell(_actualRowIndex2,_actualColumnIndex2))){if(_isMerged2){var _cellId2=helpers_1.cellIdentifier(_bounds2.top,_bounds2.left);if(mergedCellRenderMap.has(_cellId2))continue;mergedCellRenderMap.add(_cellId2)}var _y9=helpers_1.getRowOffset({index:_actualRowIndex2,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_height3=helpers_1.getRowOffset({index:_actualBottom2,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-_y9+helpers_1.getRowHeight(_actualBottom2,instanceProps.current),_x9=helpers_1.getColumnOffset({index:_actualColumnIndex2,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_width2=helpers_1.getColumnOffset({index:_actualRight2,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-_x9+helpers_1.getColumnWidth(_actualRight2,instanceProps.current);frozenColumnCells.push(itemRenderer({x:_x9,y:_y9,width:_width2,height:_height3,rowIndex:_actualRowIndex2,columnIndex:_actualColumnIndex2,isMergedCell:_isMerged2,key:helpers_1.itemKey({rowIndex:_actualRowIndex2,columnIndex:_actualColumnIndex2})})),enableCellOverlay&&frozenColumnCellOverlays.push(overlayRenderer({x:_x9,y:_y9,width:_width2,height:_height3,rowIndex:_actualRowIndex2,columnIndex:_actualColumnIndex2,isMergedCell:_isMerged2,key:helpers_1.itemKey({rowIndex:_actualRowIndex2,columnIndex:_actualColumnIndex2})}))}}}for(var frozenColumnShadow=react_1.useMemo((function(){var frozenColumnLineX=helpers_1.getColumnOffset({index:frozenColumns,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),frozenColumnLineY=helpers_1.getRowOffset({index:Math.min(rowStopIndex+1,rowCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});return react_1.default.createElement(ReactKonvaCore_1.Line,Object.assign({points:[frozenColumnLineX,0,frozenColumnLineX,frozenColumnLineY],offsetX:-.5,strokeWidth:1,shadowForStrokeEnabled:!1,strokeScaleEnabled:!1,hitStrokeWidth:0,listening:!1,perfectDrawEnabled:!1},shadowSettings))}),[shadowSettings,frozenColumns,rowStopIndex,rowCount,instanceProps.current.lastMeasuredColumnIndex,instanceProps.current.recalcColumnIndices]),frozenRowShadow=react_1.useMemo((function(){var frozenRowLineY=helpers_1.getRowOffset({index:frozenRows,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),frozenRowLineX=helpers_1.getColumnOffset({index:Math.min(columnStopIndex+1,columnCount),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});return react_1.default.createElement(ReactKonvaCore_1.Line,Object.assign({points:[0,frozenRowLineY,frozenRowLineX,frozenRowLineY],offsetY:-.5,strokeWidth:1,shadowForStrokeEnabled:!1,strokeScaleEnabled:!1,hitStrokeWidth:0,listening:!1,perfectDrawEnabled:!1},shadowSettings))}),[shadowSettings,frozenRows,columnStopIndex,columnCount,instanceProps.current.lastMeasuredRowIndex,instanceProps.current.recalcRowIndices]),frozenIntersectionCells=[],frozenIntersectionCellOverlays=[],_rowIndex6=0;_rowIndex6<Math.min(rowStopIndex,frozenRows);_rowIndex6++)if(!(null==isHiddenRow?void 0:isHiddenRow(_rowIndex6)))for(var _columnIndex6=0;_columnIndex6<Math.min(columnStopIndex,frozenColumns);_columnIndex6++){var _isMerged3=isMergedCell({rowIndex:_rowIndex6,columnIndex:_columnIndex6}),_bounds3=getCellBounds({rowIndex:_rowIndex6,columnIndex:_columnIndex6}),_actualRowIndex3=_isMerged3?_bounds3.top:_rowIndex6,_actualColumnIndex3=_isMerged3?_bounds3.left:_columnIndex6,_actualBottom3=Math.max(_rowIndex6,_bounds3.bottom),_actualRight3=Math.max(_columnIndex6,_bounds3.right);if(_isMerged3||!(null==isHiddenCell?void 0:isHiddenCell(_actualRowIndex3,_actualColumnIndex3))){if(_isMerged3){var _cellId3=helpers_1.cellIdentifier(_bounds3.top,_bounds3.left);if(mergedCellRenderMap.has(_cellId3))continue;mergedCellRenderMap.add(_cellId3)}var _y10=helpers_1.getRowOffset({index:_actualRowIndex3,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_height4=helpers_1.getRowOffset({index:_actualBottom3,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-_y10+helpers_1.getRowHeight(_actualBottom3,instanceProps.current),_x10=helpers_1.getColumnOffset({index:_actualColumnIndex3,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_width3=helpers_1.getColumnOffset({index:_actualRight3,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-_x10+helpers_1.getColumnWidth(_actualRight3,instanceProps.current);frozenIntersectionCells.push(itemRenderer({x:_x10,y:_y10,width:_width3,height:_height4,rowIndex:_actualRowIndex3,columnIndex:_actualColumnIndex3,isMergedCell:_isMerged3,key:helpers_1.itemKey({rowIndex:_actualRowIndex3,columnIndex:_actualColumnIndex3})})),enableCellOverlay&&frozenIntersectionCellOverlays.push(overlayRenderer({x:_x10,y:_y10,width:_width3,height:_height4,rowIndex:_actualRowIndex3,columnIndex:_actualColumnIndex3,isMergedCell:_isMerged3,key:helpers_1.itemKey({rowIndex:_actualRowIndex3,columnIndex:_actualColumnIndex3})}))}}var fillHandleDimension={},activeCellSelection=null,activeCellSelectionFrozenColumn=null,activeCellSelectionFrozenRow=null,activeCellSelectionFrozenIntersection=null;if(activeCell){var _bounds4=getCellBounds(activeCell),top=_bounds4.top,left=_bounds4.left,right=_bounds4.right,bottom=_bounds4.bottom,_actualBottom4=Math.min(rowStopIndex,bottom),_actualRight4=Math.min(columnStopIndex,right),isInFrozenColumn=left<frozenColumns,isInFrozenRow=top<frozenRows,isInFrozenIntersection=isInFrozenRow&&isInFrozenColumn,_y11=helpers_1.getRowOffset({index:top,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_height5=helpers_1.getRowOffset({index:_actualBottom4,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-_y11+helpers_1.getRowHeight(_actualBottom4,instanceProps.current),_x11=helpers_1.getColumnOffset({index:left,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_width4=helpers_1.getColumnOffset({index:_actualRight4,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-_x11+helpers_1.getColumnWidth(_actualRight4,instanceProps.current),cell=selectionRenderer({stroke:selectionBorderColor,strokeWidth:activeCellStrokeWidth,fill:"transparent",x:_x11,y:_y11,width:_width4,height:_height5,type:"activeCell"});isInFrozenIntersection?activeCellSelectionFrozenIntersection=cell:isInFrozenRow?activeCellSelectionFrozenRow=cell:isInFrozenColumn?activeCellSelectionFrozenColumn=cell:activeCellSelection=cell,fillHandleDimension={x:_x11+_width4,y:_y11+_height5}}for(var isSelectionInProgress=!1,selectionAreas=[],selectionAreasFrozenColumns=[],selectionAreasFrozenRows=[],selectionAreasIntersection=[],i=0;i<selections.length;i++){var _selections$i=selections[i],_bounds5=_selections$i.bounds,inProgress=_selections$i.inProgress,style=_selections$i.style,_top=_bounds5.top,_left=_bounds5.left,_right=_bounds5.right,_bottom=_bounds5.bottom,selectionBounds={x:0,y:0,width:0,height:0},_actualBottom5=Math.min(rowStopIndex,_bottom),_actualRight5=Math.min(columnStopIndex,_right),isLeftBoundFrozen=_left<frozenColumns,isTopBoundFrozen=_top<frozenRows,isIntersectionFrozen=_top<frozenRows&&_left<frozenColumns,isLast=i===selections.length-1,styles=Object.assign({stroke:inProgress?selectionBackgroundColor:selectionBorderColor,fill:selectionBackgroundColor},style);if(inProgress&&(isSelectionInProgress=!0),selectionBounds.y=helpers_1.getRowOffset({index:_top,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),selectionBounds.height=helpers_1.getRowOffset({index:_actualBottom5,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-selectionBounds.y+helpers_1.getRowHeight(_actualBottom5,instanceProps.current),selectionBounds.x=helpers_1.getColumnOffset({index:_left,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),selectionBounds.width=helpers_1.getColumnOffset({index:_actualRight5,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-selectionBounds.x+helpers_1.getColumnWidth(_actualRight5,instanceProps.current),isLeftBoundFrozen){var frozenColumnSelectionWidth=helpers_1.getColumnOffset({index:Math.min(_right+1,frozenColumns),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getColumnOffset({index:_left,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});selectionAreasFrozenColumns.push(selectionRenderer(Object.assign({},styles,{type:"selection",key:i,x:selectionBounds.x,y:selectionBounds.y,width:frozenColumnSelectionWidth,height:selectionBounds.height,strokeRightWidth:frozenColumnSelectionWidth===selectionBounds.width?selectionStrokeWidth:0})))}if(isTopBoundFrozen){var frozenRowSelectionHeight=helpers_1.getRowOffset({index:Math.min(_bottom+1,frozenRows),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getRowOffset({index:_top,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});selectionAreasFrozenRows.push(selectionRenderer(Object.assign({},styles,{type:"selection",key:i,x:selectionBounds.x,y:selectionBounds.y,width:selectionBounds.width,height:frozenRowSelectionHeight,strokeBottomWidth:frozenRowSelectionHeight===selectionBounds.height?selectionStrokeWidth:0})))}if(isIntersectionFrozen){var frozenIntersectionSelectionHeight=helpers_1.getRowOffset({index:Math.min(_bottom+1,frozenRows),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getRowOffset({index:_top,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),frozenIntersectionSelectionWidth=helpers_1.getColumnOffset({index:Math.min(_right+1,frozenColumns),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getColumnOffset({index:_left,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});selectionAreasIntersection.push(selectionRenderer(Object.assign({},styles,{type:"selection",key:i,x:selectionBounds.x,y:selectionBounds.y,width:frozenIntersectionSelectionWidth,height:frozenIntersectionSelectionHeight,strokeBottomWidth:frozenIntersectionSelectionHeight===selectionBounds.height?selectionStrokeWidth:0,strokeRightWidth:frozenIntersectionSelectionWidth===selectionBounds.width?selectionStrokeWidth:0})))}selectionAreas.push(selectionRenderer(Object.assign({},styles,{type:"selection",key:i,x:selectionBounds.x,y:selectionBounds.y,width:selectionBounds.width,height:selectionBounds.height}))),isLast&&(fillHandleDimension={x:selectionBounds.x+selectionBounds.width,y:selectionBounds.y+selectionBounds.height})}var fillSelections=null;if(fillSelection){var _bounds6=fillSelection.bounds,_top2=_bounds6.top,_left2=_bounds6.left,_right2=_bounds6.right,_bottom2=_bounds6.bottom,_actualBottom6=Math.min(rowStopIndex,_bottom2),_actualRight6=Math.min(columnStopIndex,_right2),_x12=helpers_1.getColumnOffset({index:_left2,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_y12=helpers_1.getRowOffset({index:_top2,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_height6=helpers_1.getRowOffset({index:_actualBottom6,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-_y12+helpers_1.getRowHeight(_actualBottom6,instanceProps.current);fillSelections=selectionRenderer({type:"fill",x:_x12,y:_y12,width:helpers_1.getColumnOffset({index:_actualRight6,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-_x12+helpers_1.getColumnWidth(_actualRight6,instanceProps.current),height:_height6,stroke:"gray",strokeStyle:"dashed"})}for(var borderStyleCells=[],borderStyleCellsFrozenColumns=[],borderStyleCellsFrozenRows=[],borderStyleCellsIntersection=[],_i2=0;_i2<borderStyles.length;_i2++){var _borderStyles$_i=borderStyles[_i2],_bounds7=_borderStyles$_i.bounds,_style=_borderStyles$_i.style,_top3=_bounds7.top,_right3=_bounds7.right,_bottom3=_bounds7.bottom,_left3=_bounds7.left,_isLeftBoundFrozen=_left3<frozenColumns,_isTopBoundFrozen=_top3<frozenRows,_isIntersectionFrozen=_top3<frozenRows&&_left3<frozenColumns,_x13=helpers_1.getColumnOffset({index:_left3,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_y13=helpers_1.getRowOffset({index:_top3,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_width6=helpers_1.getColumnOffset({index:Math.min(columnCount-1,_right3+1),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-_x13,_height7=helpers_1.getRowOffset({index:Math.min(rowCount-1,_bottom3+1),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-_y13;if(borderStyleCells.push(utils_1.createHTMLBox(Object.assign({x:_x13,y:_y13,key:_i2,width:_width6,height:_height7},_style))),_isLeftBoundFrozen){var _frozenColumnSelectionWidth=helpers_1.getColumnOffset({index:Math.min(_right3+1,frozenColumns),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getColumnOffset({index:_left3,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});borderStyleCellsFrozenColumns.push(utils_1.createHTMLBox(Object.assign({},_style,{x:_x13,y:_y13,key:_i2,width:_frozenColumnSelectionWidth,height:_height7,strokeRightWidth:_frozenColumnSelectionWidth===_width6?(null==_style?void 0:_style.strokeRightWidth)||(null==_style?void 0:_style.strokeWidth):0})))}if(_isTopBoundFrozen){var _frozenRowSelectionHeight=helpers_1.getRowOffset({index:Math.min(_bottom3+1,frozenRows),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getRowOffset({index:_top3,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});borderStyleCellsFrozenRows.push(utils_1.createHTMLBox(Object.assign({},_style,{x:_x13,y:_y13,key:_i2,width:_width6,height:_frozenRowSelectionHeight,strokeBottomWidth:_frozenRowSelectionHeight===_height7?(null==_style?void 0:_style.strokeBottomWidth)||(null==_style?void 0:_style.strokeWidth):0})))}if(_isIntersectionFrozen){var _frozenIntersectionSelectionHeight=helpers_1.getRowOffset({index:Math.min(_bottom3+1,frozenRows),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getRowOffset({index:_top3,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale}),_frozenIntersectionSelectionWidth=helpers_1.getColumnOffset({index:Math.min(_right3+1,frozenColumns),rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale})-helpers_1.getColumnOffset({index:_left3,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps.current,scale:scale});borderStyleCellsIntersection.push(utils_1.createHTMLBox(Object.assign({},_style,{x:_x13,y:_y13,key:_i2,width:_frozenIntersectionSelectionWidth,height:_frozenIntersectionSelectionHeight,strokeBottomWidth:_frozenIntersectionSelectionHeight===_height7?selectionStrokeWidth:0,strokeRightWidth:_frozenIntersectionSelectionWidth===_width6?selectionStrokeWidth:0})))}}var listenToEvents=!isScrolling,frozenRowShadowComponent=showFrozenShadow&&0!==frozenRows?frozenRowShadow:null,frozenColumnShadowComponent=showFrozenShadow&&0!==frozenColumns?frozenColumnShadow:null,stageChildren=react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(ReactKonvaCore_1.Layer,null,react_1.default.createElement(ReactKonvaCore_1.Group,{clipX:frozenColumnWidth,clipY:frozenRowHeight,clipWidth:containerWidth-frozenColumnWidth,clipHeight:containerHeight-frozenRowHeight},react_1.default.createElement(ReactKonvaCore_1.Group,{offsetY:scrollTop,offsetX:scrollLeft},gridLines,cells,cellOverlays,ranges)),react_1.default.createElement(ReactKonvaCore_1.Group,{clipX:frozenColumnWidth,clipY:0,clipWidth:containerWidth-frozenColumnWidth,clipHeight:frozenRowHeight+1},react_1.default.createElement(ReactKonvaCore_1.Group,{offsetY:0,offsetX:scrollLeft},gridLinesFrozenRow,frozenRowCells,frozenRowShadowComponent,frozenRowCellOverlays)),react_1.default.createElement(ReactKonvaCore_1.Group,{clipX:0,clipY:frozenRowHeight,clipWidth:frozenColumnWidth+1,clipHeight:containerHeight-frozenRowHeight},react_1.default.createElement(ReactKonvaCore_1.Group,{offsetY:scrollTop,offsetX:0},gridLinesFrozenColumn,frozenColumnCells,frozenColumnShadowComponent,frozenColumnCellOverlays)),react_1.default.createElement(ReactKonvaCore_1.Group,{offsetY:0,offsetX:0,clipX:0,clipY:0,clipWidth:frozenColumnWidth+1,clipHeight:frozenRowHeight+1},gridLinesFrozenIntersection,frozenIntersectionCells,frozenRowShadowComponent,frozenColumnShadowComponent,frozenIntersectionCellOverlays)),children&&"function"==typeof children?children({scrollLeft:scrollLeft,scrollTop:scrollTop}):null),fillhandleComponent=showFillHandle&&!isSelectionInProgress?react_1.default.createElement(FillHandle_1.default,Object.assign({},fillHandleDimension,{stroke:selectionBorderColor,size:8,borderColor:fillhandleBorderColor},fillHandleProps)):null,selectionChildren=react_1.default.createElement("div",{style:{pointerEvents:"none"}},react_1.default.createElement("div",{style:{position:"absolute",left:frozenColumnWidth,top:frozenRowHeight,right:0,bottom:0,overflow:"hidden"}},react_1.default.createElement("div",{style:{transform:"translate(-".concat(scrollLeft+frozenColumnWidth,"px, -").concat(scrollTop+frozenRowHeight,"px)")}},borderStyleCells,fillSelections,selectionAreas,activeCellSelection,fillhandleComponent)),frozenColumns?react_1.default.createElement("div",{style:{position:"absolute",width:frozenColumnWidth+8,top:frozenRowHeight,left:0,bottom:0,overflow:"hidden"}},react_1.default.createElement("div",{style:{transform:"translate(0, -".concat(scrollTop+frozenRowHeight,"px)")}},borderStyleCellsFrozenColumns,selectionAreasFrozenColumns,activeCellSelectionFrozenColumn,fillhandleComponent)):null,frozenRows?react_1.default.createElement("div",{style:{position:"absolute",height:frozenRowHeight+8,left:frozenColumnWidth,right:0,top:0,overflow:"hidden"}},react_1.default.createElement("div",{style:{transform:"translate(-".concat(scrollLeft+frozenColumnWidth,"px, 0)")}},borderStyleCellsFrozenRows,selectionAreasFrozenRows,activeCellSelectionFrozenRow,fillhandleComponent)):null,frozenRows&&frozenColumns?react_1.default.createElement("div",{style:{position:"absolute",height:frozenRowHeight+8,width:frozenColumnWidth+8,left:0,top:0,overflow:"hidden",pointerEvents:"none"}},borderStyleCellsIntersection,selectionAreasIntersection,activeCellSelectionFrozenIntersection,fillhandleComponent):null);return react_1.default.createElement("div",{style:{position:"relative",width:containerWidth,userSelect:"none"},className:"rowsncolumns-grid"},react_1.default.createElement("div",Object.assign({className:"rowsncolumns-grid-container",tabIndex:0,ref:containerRef},rest),react_1.default.createElement(ReactKonvaCore_1.Stage,Object.assign({width:containerWidth,height:containerHeight,ref:stageRef,listening:listenToEvents},stageProps),wrapper(stageChildren))),selectionChildren,showScrollbar?react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement("div",{className:"rowsncolumns-grid-scrollbar rowsncolumns-grid-scrollbar-y",tabIndex:-1,style:{height:containerHeight,overflow:"scroll",position:"absolute",right:0,top:0,width:scrollbarSize,willChange:"transform"},onScroll:handleScroll,ref:verticalScrollRef},react_1.default.createElement("div",{style:{position:"absolute",height:estimatedTotalHeight,width:1}})),react_1.default.createElement("div",{className:"rowsncolumns-grid-scrollbar rowsncolumns-grid-scrollbar-x",tabIndex:-1,style:{overflow:"scroll",position:"absolute",bottom:0,left:0,width:containerWidth,height:scrollbarSize,willChange:"transform"},onScroll:handleScrollLeft,ref:horizontalScrollRef},react_1.default.createElement("div",{style:{position:"absolute",width:estimatedTotalWidth,height:1}}))):null)})));exports.default=Grid},415:function(module,exports,__webpack_require__){"use strict";function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_require__(9),__webpack_require__(30),__webpack_require__(134),__webpack_require__(38),__webpack_require__(26),__webpack_require__(33),__webpack_require__(8),__webpack_require__(32);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Cell=exports.CellRenderer=void 0;var react_1=__importStar(__webpack_require__(1)),react_konva_1=__webpack_require__(14),helpers_1=__webpack_require__(90),Cell=react_1.memo((function(props){var _props$x=props.x,x=void 0===_props$x?0:_props$x,_props$y=props.y,y=void 0===_props$y?0:_props$y,width=props.width,height=props.height,value=props.value,_props$fill=props.fill,fill=void 0===_props$fill?"white":_props$fill,_props$strokeWidth=props.strokeWidth,strokeWidth=void 0===_props$strokeWidth?1:_props$strokeWidth,_props$stroke=props.stroke,stroke=void 0===_props$stroke?"#d9d9d9":_props$stroke,_props$align=props.align,align=void 0===_props$align?"left":_props$align,_props$verticalAlign=props.verticalAlign,verticalAlign=void 0===_props$verticalAlign?"middle":_props$verticalAlign,_props$textColor=props.textColor,textColor=void 0===_props$textColor?"#333":_props$textColor,_props$padding=props.padding,padding=void 0===_props$padding?5:_props$padding,_props$fontFamily=props.fontFamily,fontFamily=void 0===_props$fontFamily?"Arial":_props$fontFamily,_props$fontSize=props.fontSize,fontSize=void 0===_props$fontSize?12:_props$fontSize,children=props.children,_props$wrap=props.wrap,wrap=void 0===_props$wrap?"none":_props$wrap,_props$fontWeight=props.fontWeight,fontWeight=void 0===_props$fontWeight?"normal":_props$fontWeight,_props$fontStyle=props.fontStyle,fontStyle=void 0===_props$fontStyle?"normal":_props$fontStyle,textDecoration=props.textDecoration,_props$alpha=props.alpha,alpha=void 0===_props$alpha?1:_props$alpha,_props$strokeEnabled=props.strokeEnabled,strokeEnabled=void 0===_props$strokeEnabled||_props$strokeEnabled,isOverlay=(props.globalCompositeOperation,props.isOverlay),rest=_objectWithoutProperties(props,["x","y","width","height","value","fill","strokeWidth","stroke","align","verticalAlign","textColor","padding","fontFamily","fontSize","children","wrap","fontWeight","fontStyle","textDecoration","alpha","strokeEnabled","globalCompositeOperation","isOverlay"]);if(isOverlay)return null;var fillEnabled=!!fill,textStyle="".concat(fontWeight," ").concat(fontStyle);return react_1.default.createElement(react_konva_1.Group,Object.assign({},rest),react_1.default.createElement(react_konva_1.Rect,{x:x+.5,y:y+.5,height:height,width:width,fill:fill,stroke:stroke,strokeWidth:strokeWidth,shadowForStrokeEnabled:!1,strokeScaleEnabled:!1,hitStrokeWidth:0,alpha:alpha,fillEnabled:fillEnabled,strokeEnabled:strokeEnabled}),helpers_1.isNull(value)?null:react_1.default.createElement(react_konva_1.Text,{x:x,y:y,height:height,width:width,text:value,fill:textColor,verticalAlign:verticalAlign,align:align,fontFamily:fontFamily,fontStyle:textStyle,textDecoration:textDecoration,padding:padding,wrap:wrap,fontSize:fontSize,hitStrokeWidth:0}),children)}));exports.Cell=Cell;var CellRenderer=function CellRenderer(props){return react_1.default.createElement(Cell,Object.assign({},props))};exports.CellRenderer=CellRenderer,exports.default=CellRenderer},420:function(module,exports,__webpack_require__){"use strict";__webpack_require__(33),__webpack_require__(8);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.CellOverlay=exports.CellRenderer=exports.getOffsetFromWidth=void 0;var react_1=__importStar(__webpack_require__(1)),react_konva_1=__webpack_require__(14),EMPTY_ARRAY=[];exports.getOffsetFromWidth=function(width){return width/2-.5};var CellOverlay=react_1.memo((function(props){var x=props.x,y=props.y,width=props.width,height=props.height,strokeTopColor=props.strokeTopColor,strokeRightColor=props.strokeRightColor,strokeBottomColor=props.strokeBottomColor,strokeLeftColor=props.strokeLeftColor,_props$strokeTopDash=props.strokeTopDash,strokeTopDash=void 0===_props$strokeTopDash?EMPTY_ARRAY:_props$strokeTopDash,_props$strokeRightDas=props.strokeRightDash,strokeRightDash=void 0===_props$strokeRightDas?EMPTY_ARRAY:_props$strokeRightDas,_props$strokeBottomDa=props.strokeBottomDash,strokeBottomDash=void 0===_props$strokeBottomDa?EMPTY_ARRAY:_props$strokeBottomDa,_props$strokeLeftDash=props.strokeLeftDash,strokeLeftDash=void 0===_props$strokeLeftDash?EMPTY_ARRAY:_props$strokeLeftDash,strokeTopWidth=props.strokeTopWidth,strokeRightWidth=props.strokeRightWidth,strokeBottomWidth=props.strokeBottomWidth,strokeLeftWidth=props.strokeLeftWidth,lineCap=props.lineCap;return strokeTopColor||strokeRightColor||strokeBottomColor||strokeLeftColor?react_1.default.createElement(react_konva_1.Shape,{x:x,y:y,width:width,height:height,sceneFunc:function sceneFunc(context,shape){strokeTopColor&&(context.beginPath(),context.moveTo(strokeLeftColor?-exports.getOffsetFromWidth(strokeLeftWidth):0,.5),context.lineTo(shape.width()+(strokeRightColor?exports.getOffsetFromWidth(strokeRightWidth)+1:1),.5),context.setAttr("strokeStyle",strokeTopColor),context.setAttr("lineWidth",strokeTopWidth),context.setAttr("lineCap",lineCap),context.setLineDash(strokeTopDash),context.stroke()),strokeBottomColor&&(context.beginPath(),context.moveTo(strokeLeftColor?-exports.getOffsetFromWidth(strokeLeftWidth):0,shape.height()+.5),context.lineTo(shape.width()+(strokeRightColor?exports.getOffsetFromWidth(strokeRightWidth)+1:1),shape.height()+.5),context.setAttr("lineWidth",strokeBottomWidth),context.setAttr("strokeStyle",strokeBottomColor),context.setAttr("lineCap",lineCap),context.setLineDash(strokeBottomDash),context.stroke()),strokeLeftColor&&(context.beginPath(),context.moveTo(.5,strokeTopColor?-exports.getOffsetFromWidth(strokeTopWidth):0),context.lineTo(.5,shape.height()+(strokeBottomColor?exports.getOffsetFromWidth(strokeBottomWidth)+1:1)),context.setAttr("strokeStyle",strokeLeftColor),context.setAttr("lineWidth",strokeLeftWidth),context.setAttr("lineCap",lineCap),context.setLineDash(strokeLeftDash),context.stroke()),strokeRightColor&&(context.beginPath(),context.moveTo(shape.width()+.5,strokeTopColor?-exports.getOffsetFromWidth(strokeTopWidth):0),context.lineTo(shape.width()+.5,shape.height()+(strokeBottomColor?exports.getOffsetFromWidth(strokeBottomWidth)+1:1)),context.setAttr("strokeStyle",strokeRightColor),context.setAttr("lineWidth",strokeRightWidth),context.setAttr("lineCap",lineCap),context.setLineDash(strokeRightDash),context.stroke())}}):null}));exports.CellOverlay=CellOverlay;var CellRenderer=function CellRenderer(props){var x=props.x,y=props.y,width=props.width,height=props.height,stroke=props.stroke,_props$strokeTopColor=props.strokeTopColor,strokeTopColor=void 0===_props$strokeTopColor?stroke:_props$strokeTopColor,_props$strokeRightCol=props.strokeRightColor,strokeRightColor=void 0===_props$strokeRightCol?stroke:_props$strokeRightCol,_props$strokeBottomCo=props.strokeBottomColor,strokeBottomColor=void 0===_props$strokeBottomCo?stroke:_props$strokeBottomCo,_props$strokeLeftColo=props.strokeLeftColor,strokeLeftColor=void 0===_props$strokeLeftColo?stroke:_props$strokeLeftColo,_props$strokeDash=props.strokeDash,strokeDash=void 0===_props$strokeDash?EMPTY_ARRAY:_props$strokeDash,_props$strokeTopDash2=props.strokeTopDash,strokeTopDash=void 0===_props$strokeTopDash2?EMPTY_ARRAY:_props$strokeTopDash2,_props$strokeRightDas2=props.strokeRightDash,strokeRightDash=void 0===_props$strokeRightDas2?EMPTY_ARRAY:_props$strokeRightDas2,_props$strokeBottomDa2=props.strokeBottomDash,strokeBottomDash=void 0===_props$strokeBottomDa2?EMPTY_ARRAY:_props$strokeBottomDa2,_props$strokeLeftDash2=props.strokeLeftDash,strokeLeftDash=void 0===_props$strokeLeftDash2?EMPTY_ARRAY:_props$strokeLeftDash2,_props$strokeWidth=props.strokeWidth,strokeWidth=void 0===_props$strokeWidth?1:_props$strokeWidth,_props$strokeTopWidth=props.strokeTopWidth,strokeTopWidth=void 0===_props$strokeTopWidth?strokeWidth:_props$strokeTopWidth,_props$strokeRightWid=props.strokeRightWidth,strokeRightWidth=void 0===_props$strokeRightWid?strokeWidth:_props$strokeRightWid,_props$strokeBottomWi=props.strokeBottomWidth,strokeBottomWidth=void 0===_props$strokeBottomWi?strokeWidth:_props$strokeBottomWi,_props$strokeLeftWidt=props.strokeLeftWidth,strokeLeftWidth=void 0===_props$strokeLeftWidt?strokeWidth:_props$strokeLeftWidt,_props$lineCap=props.lineCap,lineCap=void 0===_props$lineCap?"butt":_props$lineCap,key=props.key;return strokeTopColor||strokeRightColor||strokeBottomColor||strokeLeftColor?react_1.default.createElement(CellOverlay,{key:key,x:x,y:y,width:width,height:height,strokeTopColor:strokeTopColor,strokeRightColor:strokeRightColor,strokeBottomColor:strokeBottomColor,strokeLeftColor:strokeLeftColor,strokeDash:strokeDash,strokeTopDash:strokeTopDash,strokeRightDash:strokeRightDash,strokeBottomDash:strokeBottomDash,strokeLeftDash:strokeLeftDash,strokeTopWidth:strokeTopWidth,strokeRightWidth:strokeRightWidth,strokeBottomWidth:strokeBottomWidth,strokeLeftWidth:strokeLeftWidth,lineCap:lineCap}):null};exports.CellRenderer=CellRenderer,exports.default=CellRenderer},421:function(module,exports,__webpack_require__){"use strict";__webpack_require__(26),__webpack_require__(8),Object.defineProperty(exports,"__esModule",{value:!0});var utils_1=__webpack_require__(422);exports.default=function Selection(props){return utils_1.createHTMLBox(Object.assign({strokeWidth:1,strokeBoxWidth:0},props))}},422:function(module,exports,__webpack_require__){"use strict";__webpack_require__(134),__webpack_require__(26),__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createHTMLBox=exports.createCanvasBox=void 0;var react_1=__importDefault(__webpack_require__(1)),react_konva_1=__webpack_require__(14);exports.createCanvasBox=function(_ref){var _ref$x=_ref.x,x=void 0===_ref$x?0:_ref$x,_ref$y=_ref.y,y=void 0===_ref$y?0:_ref$y,_ref$width=_ref.width,width=void 0===_ref$width?0:_ref$width,_ref$height=_ref.height,height=void 0===_ref$height?0:_ref$height,fill=_ref.fill,stroke=_ref.stroke,_ref$strokeLeftColor=_ref.strokeLeftColor,strokeLeftColor=void 0===_ref$strokeLeftColor?stroke:_ref$strokeLeftColor,_ref$strokeTopColor=_ref.strokeTopColor,strokeTopColor=void 0===_ref$strokeTopColor?stroke:_ref$strokeTopColor,_ref$strokeRightColor=_ref.strokeRightColor,strokeRightColor=void 0===_ref$strokeRightColor?stroke:_ref$strokeRightColor,_ref$strokeBottomColo=_ref.strokeBottomColor,strokeBottomColor=void 0===_ref$strokeBottomColo?stroke:_ref$strokeBottomColo,_ref$strokeWidth=_ref.strokeWidth,strokeWidth=void 0===_ref$strokeWidth?0:_ref$strokeWidth,_ref$strokeTopWidth=_ref.strokeTopWidth,strokeTopWidth=void 0===_ref$strokeTopWidth?strokeWidth:_ref$strokeTopWidth,_ref$strokeRightWidth=_ref.strokeRightWidth,strokeRightWidth=void 0===_ref$strokeRightWidth?strokeWidth:_ref$strokeRightWidth,_ref$strokeBottomWidt=_ref.strokeBottomWidth,strokeBottomWidth=void 0===_ref$strokeBottomWidt?strokeWidth:_ref$strokeBottomWidt,_ref$strokeLeftWidth=_ref.strokeLeftWidth,strokeLeftWidth=void 0===_ref$strokeLeftWidth?strokeWidth:_ref$strokeLeftWidth,dash=_ref.dash,dashEnabled=_ref.dashEnabled,_ref$lineCap=_ref.lineCap,lineCap=void 0===_ref$lineCap?"square":_ref$lineCap,key=_ref.key,commonProps={perfectDrawEnabled:!1,shadowForStrokeEnabled:!1,hitStrokeWidth:0,listening:!1},lines=[react_1.default.createElement(react_konva_1.Line,Object.assign({points:[x,y,x+width,y],stroke:strokeTopColor,strokeWidth:strokeTopWidth,dash:dash,dashEnabled:dashEnabled,lineCap:lineCap,key:"top",globalCompositeOperation:void 0},commonProps)),react_1.default.createElement(react_konva_1.Line,Object.assign({points:[x+width,y,x+width,y+height],stroke:strokeRightColor,strokeWidth:strokeRightWidth,dash:dash,dashEnabled:dashEnabled,lineCap:lineCap,key:"right",globalCompositeOperation:void 0},commonProps)),react_1.default.createElement(react_konva_1.Line,Object.assign({points:[x+width,y+height,x,y+height],stroke:strokeBottomColor,strokeWidth:strokeBottomWidth,dash:dash,dashEnabled:dashEnabled,lineCap:lineCap,key:"bottom",globalCompositeOperation:void 0},commonProps)),react_1.default.createElement(react_konva_1.Line,Object.assign({points:[x,y+height,x,y],stroke:strokeLeftColor,strokeWidth:strokeLeftWidth,dash:dash,dashEnabled:dashEnabled,lineCap:lineCap,key:"left",globalCompositeOperation:void 0},commonProps))];return react_1.default.createElement(react_1.default.Fragment,{key:key},fill&&react_1.default.createElement(react_konva_1.Rect,Object.assign({globalCompositeOperation:void 0,fill:fill,x:x,y:y,width:width,height:height},commonProps)),lines)},exports.createHTMLBox=function(_ref2){var _ref2$x=_ref2.x,x=void 0===_ref2$x?0:_ref2$x,_ref2$y=_ref2.y,y=void 0===_ref2$y?0:_ref2$y,_ref2$width=_ref2.width,width=void 0===_ref2$width?0:_ref2$width,_ref2$height=_ref2.height,height=void 0===_ref2$height?0:_ref2$height,fill=_ref2.fill,stroke=_ref2.stroke,_ref2$strokeLeftColor=_ref2.strokeLeftColor,strokeLeftColor=void 0===_ref2$strokeLeftColor?stroke:_ref2$strokeLeftColor,_ref2$strokeTopColor=_ref2.strokeTopColor,strokeTopColor=void 0===_ref2$strokeTopColor?stroke:_ref2$strokeTopColor,_ref2$strokeRightColo=_ref2.strokeRightColor,strokeRightColor=void 0===_ref2$strokeRightColo?stroke:_ref2$strokeRightColo,_ref2$strokeBottomCol=_ref2.strokeBottomColor,strokeBottomColor=void 0===_ref2$strokeBottomCol?stroke:_ref2$strokeBottomCol,_ref2$strokeWidth=_ref2.strokeWidth,strokeWidth=void 0===_ref2$strokeWidth?0:_ref2$strokeWidth,_ref2$strokeTopWidth=_ref2.strokeTopWidth,strokeTopWidth=void 0===_ref2$strokeTopWidth?strokeWidth:_ref2$strokeTopWidth,_ref2$strokeRightWidt=_ref2.strokeRightWidth,strokeRightWidth=void 0===_ref2$strokeRightWidt?strokeWidth:_ref2$strokeRightWidt,_ref2$strokeBottomWid=_ref2.strokeBottomWidth,strokeBottomWidth=void 0===_ref2$strokeBottomWid?strokeWidth:_ref2$strokeBottomWid,_ref2$strokeLeftWidth=_ref2.strokeLeftWidth,strokeLeftWidth=void 0===_ref2$strokeLeftWidth?strokeWidth:_ref2$strokeLeftWidth,key=_ref2.key,_ref2$strokeStyle=_ref2.strokeStyle,strokeStyle=void 0===_ref2$strokeStyle?"solid":_ref2$strokeStyle,_ref2$fillOpacity=_ref2.fillOpacity,fillOpacity=void 0===_ref2$fillOpacity?1:_ref2$fillOpacity,commonProps={};width-=Math.floor(strokeWidth/2),height-=Math.floor(strokeWidth/2);var lines=[react_1.default.createElement("div",Object.assign({style:{position:"absolute",left:x,top:y,width:width,height:strokeTopWidth,borderWidth:0,borderColor:strokeTopColor,borderTopWidth:strokeTopWidth,borderStyle:strokeStyle,pointerEvents:"none"},key:"top"},commonProps)),react_1.default.createElement("div",Object.assign({style:{position:"absolute",left:x+width,top:y,width:strokeRightWidth,height:height,borderWidth:0,borderColor:strokeRightColor,borderRightWidth:strokeRightWidth,borderStyle:strokeStyle,pointerEvents:"none"},key:"right"},commonProps)),,react_1.default.createElement("div",Object.assign({style:{position:"absolute",left:x,top:y+height,width:width+strokeTopWidth,height:strokeBottomWidth,borderWidth:0,borderColor:strokeBottomColor,borderBottomWidth:strokeBottomWidth,borderStyle:strokeStyle,pointerEvents:"none"},key:"bottom"},commonProps)),react_1.default.createElement("div",Object.assign({style:{position:"absolute",left:x,top:y,width:strokeLeftWidth,height:height,borderWidth:0,borderColor:strokeLeftColor,borderLeftWidth:strokeLeftWidth,borderStyle:strokeStyle,pointerEvents:"none"},key:"left"},commonProps))];return react_1.default.createElement(react_1.default.Fragment,{key:key},fill&&react_1.default.createElement("div",Object.assign({style:{position:"absolute",top:y,left:x,height:height,width:width,backgroundColor:fill,opacity:fillOpacity,userSelect:"none",pointerEvents:"none"}},commonProps)),lines)}},423:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(86),__webpack_require__(38),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(33),__webpack_require__(8),__webpack_require__(32),__webpack_require__(10),__webpack_require__(19),__webpack_require__(87),__webpack_require__(16),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),types_1=__webpack_require__(97),helpers_1=__webpack_require__(90),DefaultEditor=function DefaultEditor(props){var _onChange=props.onChange,onSubmit=props.onSubmit,onCancel=props.onCancel,position=props.position,cell=props.cell,nextFocusableCell=props.nextFocusableCell,_props$value=props.value,value=void 0===_props$value?"":_props$value,_props$autoFocus=(props.activeCell,props.autoFocus),autoFocus=void 0===_props$autoFocus||_props$autoFocus,_onKeyDown=props.onKeyDown,rest=_objectWithoutProperties(props,["onChange","onSubmit","onCancel","position","cell","nextFocusableCell","value","activeCell","autoFocus","onKeyDown"]),textSizer=react_1.useRef(helpers_1.autoSizerCanvas),inputRef=react_1.useRef(null),_position$x=position.x,x=void 0===_position$x?0:_position$x,_position$y=position.y,y=void 0===_position$y?0:_position$y,_position$width=position.width,width=void 0===_position$width?0:_position$width,_position$height=position.height,height=void 0===_position$height?0:_position$height,getWidth=react_1.useCallback((function(text){var _a,textWidth=(null===(_a=textSizer.current.measureText(text))||void 0===_a?void 0:_a.width)||0;return Math.max(textWidth+10,width+1)}),[width]);react_1.useEffect((function(){setInputWidth(getWidth(value))}),[value]);var _react_1$useState2=_slicedToArray(react_1.useState((function(){return getWidth(value)})),2),inputWidth=_react_1$useState2[0],setInputWidth=_react_1$useState2[1];react_1.useEffect((function(){var _a,_b;inputRef.current&&(autoFocus&&inputRef.current.focus(),inputRef.current.selectionStart=null!==(_b=null===(_a=helpers_1.castToString(value))||void 0===_a?void 0:_a.length)&&void 0!==_b?_b:0)}),[]);var inputHeight=height;return react_1.default.createElement("div",{style:{top:y-1,left:x,position:"absolute",width:inputWidth,height:inputHeight+2,padding:2,boxShadow:"0 2px 6px 2px rgba(60,64,67,.15)",border:"2px #1a73e8 solid",background:"white"}},react_1.default.createElement("textarea",Object.assign({rows:1,cols:1,ref:inputRef,value:value,style:{font:"12px Arial",lineHeight:1.2,width:"100%",height:"100%",padding:"0 1px",margin:0,boxSizing:"border-box",borderWidth:0,outline:"none",resize:"none",overflow:"hidden",verticalAlign:"top",background:"transparent"},onChange:function onChange(e){null==_onChange||_onChange(e.target.value,cell)},onKeyDown:function onKeyDown(e){if(inputRef.current){var isShiftKey=e.nativeEvent.shiftKey,value=inputRef.current.value;e.which===types_1.KeyCodes.Enter&&onSubmit&&onSubmit(value,cell,null==nextFocusableCell?void 0:nextFocusableCell(cell,isShiftKey?types_1.Direction.Up:types_1.Direction.Down)),e.which===types_1.KeyCodes.Escape&&onCancel&&onCancel(e),e.which===types_1.KeyCodes.Tab&&(e.preventDefault(),onSubmit&&onSubmit(value,cell,null==nextFocusableCell?void 0:nextFocusableCell(cell,isShiftKey?types_1.Direction.Left:types_1.Direction.Right))),null==_onKeyDown||_onKeyDown(e)}}},rest)))},getDefaultEditor=function getDefaultEditor(cell){return DefaultEditor},defaultCanEdit=function defaultCanEdit(cell){return!0},defaultIsHidden=function defaultIsHidden(i){return!1};exports.default=function useEditable(_ref){var _ref$getEditor=_ref.getEditor,getEditor=void 0===_ref$getEditor?getDefaultEditor:_ref$getEditor,gridRef=_ref.gridRef,getValue=_ref.getValue,onChange=_ref.onChange,onSubmit=_ref.onSubmit,onCancel=_ref.onCancel,onDelete=_ref.onDelete,_ref$selections=_ref.selections,selections=void 0===_ref$selections?[]:_ref$selections,activeCell=_ref.activeCell,_ref$canEdit=_ref.canEdit,canEdit=void 0===_ref$canEdit?defaultCanEdit:_ref$canEdit,_ref$frozenRows=_ref.frozenRows,frozenRows=void 0===_ref$frozenRows?0:_ref$frozenRows,_ref$frozenColumns=_ref.frozenColumns,frozenColumns=void 0===_ref$frozenColumns?0:_ref$frozenColumns,_ref$hideOnBlur=_ref.hideOnBlur,hideOnBlur=void 0===_ref$hideOnBlur||_ref$hideOnBlur,_ref$isHiddenRow=_ref.isHiddenRow,isHiddenRow=void 0===_ref$isHiddenRow?defaultIsHidden:_ref$isHiddenRow,_ref$isHiddenColumn=_ref.isHiddenColumn,isHiddenColumn=void 0===_ref$isHiddenColumn?defaultIsHidden:_ref$isHiddenColumn,rowCount=_ref.rowCount,columnCount=_ref.columnCount,_ref$selectionTopBoun=_ref.selectionTopBound,selectionTopBound=void 0===_ref$selectionTopBoun?0:_ref$selectionTopBoun,_ref$selectionBottomB=_ref.selectionBottomBound,selectionBottomBound=void 0===_ref$selectionBottomB?rowCount-1:_ref$selectionBottomB,_ref$selectionLeftBou=_ref.selectionLeftBound,selectionLeftBound=void 0===_ref$selectionLeftBou?0:_ref$selectionLeftBou,_ref$selectionRightBo=_ref.selectionRightBound,selectionRightBound=void 0===_ref$selectionRightBo?columnCount-1:_ref$selectionRightBo,editorProps=_ref.editorProps,onBeforeEdit=_ref.onBeforeEdit,onKeyDown=_ref.onKeyDown,_react_1$useState4=_slicedToArray(react_1.useState(!1),2),isEditorShown=_react_1$useState4[0],setShowEditor=_react_1$useState4[1],_react_1$useState6=_slicedToArray(react_1.useState(""),2),value=_react_1$useState6[0],setValue=_react_1$useState6[1],_react_1$useState8=_slicedToArray(react_1.useState({x:0,y:0,width:0,height:0}),2),position=_react_1$useState8[0],setPosition=_react_1$useState8[1],currentActiveCellRef=react_1.useRef(null),initialActiveCell=react_1.useRef(),_react_1$useState10=_slicedToArray(react_1.useState({scrollLeft:0,scrollTop:0}),2),scrollPosition=_react_1$useState10[0],setScrollPosition=_react_1$useState10[1],_react_1$useState12=_slicedToArray(react_1.useState(!0),2),autoFocus=_react_1$useState12[0],setAutoFocus=_react_1$useState12[1],isDirtyRef=react_1.useRef(!1),currentValueRef=react_1.useRef(value),getValueRef=react_1.useRef(getValue),showEditor=react_1.useCallback((function(){return setShowEditor(!0)}),[]),hideEditor=react_1.useCallback((function(){setShowEditor(!1),currentActiveCellRef.current=null}),[]),focusGrid=react_1.useCallback((function(){requestAnimationFrame((function(){return gridRef.current&&gridRef.current.focus()}))}),[]);react_1.useEffect((function(){currentValueRef.current=value})),react_1.useEffect((function(){getValueRef.current=getValue}),[getValue]);var makeEditable=react_1.useCallback((function(coords,initialValue){var _a,autoFocus=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(gridRef.current&&(coords=gridRef.current.getActualCellCoords(coords),!helpers_1.isEqualCells(coords,currentActiveCellRef.current)&&canEdit(coords))){null==onBeforeEdit||onBeforeEdit(coords),null===(_a=gridRef.current)||void 0===_a||_a.scrollToItem(coords),currentActiveCellRef.current=coords;var pos=gridRef.current.getCellOffsetFromCoords(coords),_scrollPosition=gridRef.current.getScrollPosition(),cellValue=getValueRef.current(coords),_value=initialValue||cellValue||"";isDirtyRef.current=!!initialValue,setValue(_value),null==onChange||onChange(_value,coords),setAutoFocus(autoFocus),setPosition(getCellPosition(pos,_scrollPosition)),showEditor()}}),[frozenRows,frozenColumns,onBeforeEdit]),getCellPosition=function getCellPosition(position,scrollPosition){var _a,_b;if(!currentActiveCellRef.current)return{x:0,y:0};var isFrozenRow=(null===(_a=currentActiveCellRef.current)||void 0===_a?void 0:_a.rowIndex)<frozenRows,isFrozenColumn=(null===(_b=currentActiveCellRef.current)||void 0===_b?void 0:_b.columnIndex)<frozenColumns;return Object.assign({},position,{x:position.x-(isFrozenColumn?0:scrollPosition.scrollLeft),y:position.y-(isFrozenRow?0:scrollPosition.scrollTop)})},handleDoubleClick=react_1.useCallback((function(e){if(gridRef.current){var coords=gridRef.current.getCellCoordsFromOffset(e.nativeEvent.clientX,e.nativeEvent.clientY);if(coords){var rowIndex=coords.rowIndex,columnIndex=coords.columnIndex;makeEditable({rowIndex:rowIndex,columnIndex:columnIndex})}}}),[getValue,frozenRows,frozenColumns]),isSelectionKey=react_1.useCallback((function(keyCode){return[types_1.KeyCodes.Right,types_1.KeyCodes.Left,types_1.KeyCodes.Up,types_1.KeyCodes.Down,types_1.KeyCodes.Meta,types_1.KeyCodes.Escape,types_1.KeyCodes.Tab,types_1.KeyCodes.Home,types_1.KeyCodes.End,types_1.KeyCodes.CapsLock,types_1.KeyCodes.PageDown,types_1.KeyCodes.PageUp,types_1.KeyCodes.ScrollLock,types_1.KeyCodes.NumLock,types_1.KeyCodes.Insert,types_1.KeyCodes.Pause].includes(keyCode)||keyCode>=types_1.KeyCodes.F1&&keyCode<=types_1.KeyCodes.F12}),[]),handleKeyDown=react_1.useCallback((function(e){var keyCode=e.nativeEvent.keyCode;if(keyCode!==types_1.KeyCodes.Tab||initialActiveCell.current||(initialActiveCell.current=activeCell),helpers_1.isArrowKey(keyCode)&&(initialActiveCell.current=void 0),!(isSelectionKey(keyCode)||e.nativeEvent.ctrlKey||e.nativeEvent.shiftKey&&("Shift"===e.nativeEvent.key||e.nativeEvent.which===types_1.KeyCodes.SPACE)||e.nativeEvent.metaKey||e.nativeEvent.which===types_1.KeyCodes.ALT)&&activeCell){var rowIndex=activeCell.rowIndex,columnIndex=activeCell.columnIndex;if(keyCode===types_1.KeyCodes.Delete||keyCode===types_1.KeyCodes.BackSpace)return onDelete&&onDelete(activeCell,selections),void e.preventDefault();var initialValue=keyCode===types_1.KeyCodes.Enter?void 0:e.nativeEvent.key;makeEditable({rowIndex:rowIndex,columnIndex:columnIndex},initialValue),e.preventDefault()}}),[getValue,selections,activeCell]),nextFocusableCell=react_1.useCallback((function(currentCell){var _a,_b,_c,_d,_e,nextActiveCell,direction=arguments.length>1&&void 0!==arguments[1]?arguments[1]:types_1.Direction.Right,bounds=null===(_a=gridRef.current)||void 0===_a?void 0:_a.getCellBounds(currentCell);if(!bounds)return null;switch(direction){case types_1.Direction.Right:var columnIndex=helpers_1.clampIndex(Math.min(bounds.right+1,selectionRightBound),isHiddenColumn,direction);nextActiveCell={rowIndex:bounds.top,columnIndex:columnIndex};break;case types_1.Direction.Up:var rowIndex=helpers_1.clampIndex(Math.max(bounds.top-1,selectionTopBound),isHiddenRow,direction);nextActiveCell={rowIndex:rowIndex,columnIndex:bounds.left};break;case types_1.Direction.Left:var _columnIndex=helpers_1.clampIndex(Math.max(bounds.left-1,selectionLeftBound),isHiddenColumn,direction);nextActiveCell={rowIndex:bounds.top,columnIndex:_columnIndex};break;default:var _rowIndex=helpers_1.clampIndex(Math.min((null!==(_c=null===(_b=initialActiveCell.current)||void 0===_b?void 0:_b.rowIndex)&&void 0!==_c?_c:bounds.bottom)+1,selectionBottomBound),isHiddenRow,direction);nextActiveCell={rowIndex:_rowIndex,columnIndex:null!==(_e=null===(_d=initialActiveCell.current)||void 0===_d?void 0:_d.columnIndex)&&void 0!==_e?_e:bounds.left}}if(direction!==types_1.Direction.Right||initialActiveCell.current||(initialActiveCell.current=currentCell),direction===types_1.Direction.Down&&(initialActiveCell.current=void 0),selections.length&&currentCell&&gridRef.current){var _bounds=selections[selections.length-1].bounds,activeCellBounds=gridRef.current.getCellBounds(currentCell),nextCell=helpers_1.findNextCellWithinBounds(activeCellBounds,_bounds,direction);nextCell&&(nextActiveCell=nextCell)}return nextActiveCell}),[selections,isHiddenRow,isHiddenColumn,selectionBottomBound,selectionTopBound]),handleSubmit=function handleSubmit(value,activeCell,nextActiveCell){hideEditor(),onSubmit&&onSubmit(value,activeCell,nextActiveCell),focusGrid()},handleMouseDown=react_1.useCallback((function(e){hideOnBlur&&(currentActiveCellRef.current&&(isDirtyRef.current?handleSubmit(currentValueRef.current,currentActiveCellRef.current):handleCancel()),initialActiveCell.current=void 0)}),[hideOnBlur]),handleChange=react_1.useCallback((function(newValue,activeCell){currentActiveCellRef.current&&(isDirtyRef.current=newValue!==value,setValue(newValue),null==onChange||onChange(newValue,activeCell))}),[value]),handleCancel=function handleCancel(e){hideEditor(),onCancel&&onCancel(e),focusGrid()},handleScroll=react_1.useCallback((function(scrollPos){currentActiveCellRef.current&&setScrollPosition(scrollPos)}),[]),editingCell=currentActiveCellRef.current,Editor=react_1.useMemo((function(){return editingCell?getEditor(editingCell)||getDefaultEditor():null}),[editingCell]),handleBlur=react_1.useCallback((function(e){currentActiveCellRef.current&&focusGrid()}),[]);return{editorComponent:isEditorShown&&Editor?react_1.default.createElement(Editor,Object.assign({},null==editorProps?void 0:editorProps(),{cell:editingCell,activeCell:activeCell,autoFocus:autoFocus,value:value,selections:selections,onChange:handleChange,onSubmit:handleSubmit,onCancel:handleCancel,position:position,scrollPosition:scrollPosition,nextFocusableCell:nextFocusableCell,onBlur:handleBlur,onKeyDown:onKeyDown})):null,onDoubleClick:handleDoubleClick,onKeyDown:handleKeyDown,nextFocusableCell:nextFocusableCell,isEditInProgress:!!editingCell,editingCell:editingCell,makeEditable:makeEditable,setValue:handleChange,hideEditor:hideEditor,showEditor:showEditor,submitEditor:handleSubmit,cancelEditor:handleCancel,onMouseDown:handleMouseDown,onScroll:handleScroll}}},424:function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(55),__webpack_require__(205),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(49),__webpack_require__(23),__webpack_require__(296),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21),Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(1),helpers_1=__webpack_require__(90),types_1=__webpack_require__(97),EMPTY_SELECTION=[],defaultIsHidden=function defaultIsHidden(i){return!1},defaultSelectionSpan=function defaultSelectionSpan(){return!0};exports.default=function useSelection(_ref){var gridRef=_ref.gridRef,_ref$initialActiveCel=_ref.initialActiveCell,initialActiveCell=void 0===_ref$initialActiveCel?null:_ref$initialActiveCel,_ref$initialSelection=_ref.initialSelections,initialSelections=void 0===_ref$initialSelection?EMPTY_SELECTION:_ref$initialSelection,_ref$columnCount=_ref.columnCount,columnCount=void 0===_ref$columnCount?0:_ref$columnCount,_ref$rowCount=_ref.rowCount,rowCount=void 0===_ref$rowCount?0:_ref$rowCount,_ref$selectionPolicy=_ref.selectionPolicy,selectionPolicy=void 0===_ref$selectionPolicy?"multiple":_ref$selectionPolicy,_ref$newSelectionMode=_ref.newSelectionMode,newSelectionMode=void 0===_ref$newSelectionMode?"clear":_ref$newSelectionMode,_ref$allowDeselectSel=_ref.allowDeselectSelection,allowDeselectSelection=void 0===_ref$allowDeselectSel||_ref$allowDeselectSel,onFill=_ref.onFill,_ref$isHiddenRow=_ref.isHiddenRow,isHiddenRow=void 0===_ref$isHiddenRow?defaultIsHidden:_ref$isHiddenRow,_ref$isHiddenColumn=_ref.isHiddenColumn,isHiddenColumn=void 0===_ref$isHiddenColumn?defaultIsHidden:_ref$isHiddenColumn,_ref$alwaysScrollToAc=_ref.alwaysScrollToActiveCell,alwaysScrollToActiveCell=void 0===_ref$alwaysScrollToAc||_ref$alwaysScrollToAc,_ref$selectionTopBoun=_ref.selectionTopBound,selectionTopBound=void 0===_ref$selectionTopBoun?0:_ref$selectionTopBoun,_ref$selectionBottomB=_ref.selectionBottomBound,selectionBottomBound=void 0===_ref$selectionBottomB?rowCount-1:_ref$selectionBottomB,_ref$selectionLeftBou=_ref.selectionLeftBound,selectionLeftBound=void 0===_ref$selectionLeftBou?0:_ref$selectionLeftBou,_ref$selectionRightBo=_ref.selectionRightBound,selectionRightBound=void 0===_ref$selectionRightBo?columnCount-1:_ref$selectionRightBo,mouseDownInterceptor=_ref.mouseDownInterceptor,mouseMoveInterceptor=_ref.mouseMoveInterceptor,_ref$mergedCells=_ref.mergedCells,mergedCells=void 0===_ref$mergedCells?[]:_ref$mergedCells,_ref$canSelectionSpan=_ref.canSelectionSpanMergedCells,canSelectionSpanMergedCells=void 0===_ref$canSelectionSpan?defaultSelectionSpan:_ref$canSelectionSpan,getValue=_ref.getValue,_react_1$useState2=_slicedToArray(react_1.useState(initialActiveCell),2),activeCell=_react_1$useState2[0],setActiveCell=_react_1$useState2[1],_react_1$useState4=_slicedToArray(react_1.useState(initialSelections),2),selections=_react_1$useState4[0],setSelections=_react_1$useState4[1],_react_1$useState6=_slicedToArray(react_1.useState(null),2),fillSelection=_react_1$useState6[0],setFillSelection=_react_1$useState6[1],selectionStart=react_1.useRef(null),selectionEnd=react_1.useRef(null),isSelecting=react_1.useRef(),isFilling=react_1.useRef(),firstActiveCell=react_1.useRef(null),activeCellRef=react_1.useRef(activeCell),activeSelectionsRef=react_1.useRef(selections),mergedCellsRef=react_1.useRef(mergedCells);react_1.useEffect((function(){activeCellRef.current=activeCell}),[activeCell]),react_1.useEffect((function(){activeSelectionsRef.current=selections}),[selections]),react_1.useEffect((function(){mergedCellsRef.current=mergedCells}),[mergedCells]);var isCellOutOfBounds=react_1.useCallback((function(cell){return cell.rowIndex<selectionTopBound||cell.columnIndex<selectionLeftBound}),[selectionTopBound,selectionLeftBound]),newSelection=function newSelection(start){var end=arguments.length>1&&void 0!==arguments[1]?arguments[1]:start;if(!isCellOutOfBounds(start)){selectionStart.current=start,selectionEnd.current=end;var bounds=selectionFromStartEnd(start,end);if(bounds){var coords={rowIndex:bounds.top,columnIndex:bounds.left};setActiveCell(coords),"clear"===newSelectionMode?(firstActiveCell.current=coords,clearSelections()):"modify"===newSelectionMode?modifySelection(coords):appendSelection(coords)}}},selectionFromStartEnd=function selectionFromStartEnd(start,end){if(!(null==gridRef?void 0:gridRef.current))return null;var spanMerges=null==canSelectionSpanMergedCells?void 0:canSelectionSpanMergedCells(start,end),boundsStart=gridRef.current.getCellBounds(start,spanMerges),boundsEnd=gridRef.current.getCellBounds(end,spanMerges),bounds={top:Math.min(boundsStart.top,boundsEnd.top),bottom:Math.max(boundsStart.bottom,boundsEnd.bottom),left:Math.min(boundsStart.left,boundsEnd.left),right:Math.max(boundsStart.right,boundsEnd.right)};return spanMerges?helpers_1.extendAreaToMergedCells(bounds,mergedCellsRef.current):bounds},modifySelection=function modifySelection(coords,setInProgress){if("single"!==selectionPolicy&&selectionStart.current&&!isCellOutOfBounds(coords)){selectionEnd.current=coords;var bounds=selectionFromStartEnd(selectionStart.current,coords);bounds&&setSelections((function(prevSelection){var len=prevSelection.length;return len?prevSelection.map((function(sel,i){return len-1===i?Object.assign({},sel,{bounds:bounds,inProgress:!!setInProgress}):sel})):[{bounds:bounds,inProgress:!!setInProgress}]}))}},appendSelection=function appendSelection(start){var end=arguments.length>1&&void 0!==arguments[1]?arguments[1]:start;if("multiple"===selectionPolicy&&start&&!isCellOutOfBounds(start)){selectionStart.current=start,selectionEnd.current=end;var bounds=selectionFromStartEnd(start,end);bounds&&(setActiveCell({rowIndex:bounds.top,columnIndex:bounds.left}),setSelections((function(prev){return[].concat(_toConsumableArray(prev),[{bounds:bounds}])})))}},removeSelectionByIndex=react_1.useCallback((function(index){var newSelection=selections.filter((function(_,idx){return idx!==index}));return setSelections(newSelection),newSelection}),[selections]),clearSelections=function clearSelections(){setSelections(EMPTY_SELECTION)},cellIndexInSelection=function cellIndexInSelection(cell,selections){var id=helpers_1.cellIdentifier(Math.max(selectionTopBound,cell.rowIndex),Math.max(selectionLeftBound,cell.columnIndex));return selections.findIndex((function(sel){return helpers_1.getBoundedCells(sel.bounds).has(id)}))},handleMouseDown=react_1.useCallback((function(e){var _a;if(gridRef&&gridRef.current){var coords=gridRef.current.getCellCoordsFromOffset(e.nativeEvent.clientX,e.nativeEvent.clientY);if(coords){var isContextMenuClick=e.nativeEvent.which===types_1.MouseButtonCodes.right;if(isContextMenuClick)if(-1!==cellIndexInSelection(coords,selections))return;var isShiftKey=e.nativeEvent.shiftKey,isMetaKey=e.nativeEvent.ctrlKey||e.nativeEvent.metaKey,allowMultiple=isMetaKey,allowDeselect=allowDeselectSelection,hasSelections=selections.length>0,isDeselecting=isMetaKey&&allowDeselect;if(isContextMenuClick||"single"===selectionPolicy||(document.addEventListener("mouseup",handleMouseUp),document.addEventListener("mousemove",handleMouseMove)),isSelecting.current=!0,!1!==(null==mouseDownInterceptor?void 0:mouseDownInterceptor(e,coords,selectionStart,selectionEnd)))if(isShiftKey)modifySelection(coords);else{var isSameAsActiveCell=helpers_1.isEqualCells(coords,activeCell);if(activeCell&&allowMultiple){if(isSameAsActiveCell&&(!isDeselecting||!hasSelections))return;if(isMetaKey&&!hasSelections&&appendSelection(activeCell),isMetaKey&&allowDeselect){var _cellIndex=cellIndexInSelection(coords,selections);if(-1!==_cellIndex){var _newSelection=removeSelectionByIndex(_cellIndex),nextActiveCell=function getPossibleActiveCellFromSelections(selections){if(!selections.length)return null;var bounds=selections[selections.length-1].bounds;return{rowIndex:bounds.top,columnIndex:bounds.left}}(_newSelection);return null!==nextActiveCell&&setActiveCell(nextActiveCell),void(1===_newSelection.length&&function cellEqualsSelection(cell,selections){return null!==cell&&selections.some((function(sel){return sel.bounds.left===cell.columnIndex&&sel.bounds.top===cell.rowIndex&&sel.bounds.right===cell.columnIndex&&sel.bounds.bottom===cell.rowIndex}))}(nextActiveCell,_newSelection)&&clearSelections())}}appendSelection(coords)}else alwaysScrollToActiveCell&&(null===(_a=gridRef.current)||void 0===_a||_a.scrollToItem(coords)),isSameAsActiveCell||newSelection(coords)}}}}),[activeCell,selections,selectionPolicy,allowDeselectSelection,alwaysScrollToActiveCell,rowCount,columnCount,newSelectionMode]),handleMouseMove=react_1.useCallback((function(e){var _a;if(isSelecting.current&&(null==gridRef?void 0:gridRef.current)){var coords=gridRef.current.getCellCoordsFromOffset(e.clientX,e.clientY);if(coords&&!1!==(null==mouseMoveInterceptor?void 0:mouseMoveInterceptor(e,coords,selectionStart,selectionEnd))){if(helpers_1.isEqualCells(firstActiveCell.current,coords))return clearSelections();modifySelection(coords,!0),null===(_a=gridRef.current)||void 0===_a||_a.scrollToItem(coords)}}}),[]),handleMouseUp=react_1.useCallback((function(){isSelecting.current=!1,document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp),setSelections((function(prevSelection){var len=prevSelection.length;return len?prevSelection.map((function(sel,i){return len-1===i?Object.assign({},sel,{inProgress:!1}):sel})):EMPTY_SELECTION}))}),[]),keyNavigate=react_1.useCallback((function(direction,modify,metaKeyPressed){if(selectionStart.current&&selectionEnd.current&&(null==gridRef?void 0:gridRef.current)&&activeCell){var currentCell=modify?selectionEnd.current:activeCell,rowIndex=currentCell.rowIndex,columnIndex=currentCell.columnIndex,isMergedCell=null==gridRef?void 0:gridRef.current.isMergedCell({rowIndex:rowIndex,columnIndex:columnIndex}),currentBounds=gridRef.current.getCellBounds({rowIndex:rowIndex,columnIndex:columnIndex});switch(direction){case types_1.Direction.Up:if(isMergedCell&&(rowIndex=currentBounds.top),rowIndex=helpers_1.clampIndex(Math.max(rowIndex-1,selectionTopBound),isHiddenRow,direction),metaKeyPressed){var startCell=Object.assign({},currentCell,{columnIndex:selectionStart.current.columnIndex});rowIndex=helpers_1.findNextCellInDataRegion(startCell,getValue,isHiddenRow,direction,selectionTopBound)}break;case types_1.Direction.Down:if(isMergedCell&&(rowIndex=currentBounds.bottom),rowIndex=helpers_1.clampIndex(Math.min(rowIndex+1,selectionBottomBound),isHiddenRow,direction),metaKeyPressed){var _startCell=Object.assign({},currentCell,{columnIndex:selectionStart.current.columnIndex});rowIndex=helpers_1.findNextCellInDataRegion(_startCell,getValue,isHiddenRow,direction,selectionBottomBound)}break;case types_1.Direction.Left:if(isMergedCell&&(columnIndex=currentBounds.left),columnIndex=helpers_1.clampIndex(Math.max(columnIndex-1,selectionLeftBound),isHiddenColumn,direction),metaKeyPressed){var _startCell2=Object.assign({},currentCell,{rowIndex:selectionStart.current.rowIndex});columnIndex=helpers_1.findNextCellInDataRegion(_startCell2,getValue,isHiddenColumn,direction,selectionLeftBound)}break;case types_1.Direction.Right:if(isMergedCell&&(columnIndex=currentBounds.right),columnIndex=helpers_1.clampIndex(Math.min(columnIndex+1,selectionRightBound),isHiddenColumn,direction),metaKeyPressed){var _startCell3=Object.assign({},currentCell,{rowIndex:selectionStart.current.rowIndex});columnIndex=helpers_1.findNextCellInDataRegion(_startCell3,getValue,isHiddenColumn,direction,selectionRightBound)}}var newBounds=gridRef.current.getCellBounds({rowIndex:rowIndex,columnIndex:columnIndex}),coords={rowIndex:newBounds.top,columnIndex:newBounds.left},scrollToCell=modify?selectionEnd.current.rowIndex===coords.rowIndex?{columnIndex:coords.columnIndex}:{rowIndex:coords.rowIndex}:{rowIndex:rowIndex,columnIndex:columnIndex},isUserNavigatingToActiveCell=helpers_1.isEqualCells(firstActiveCell.current,coords);modify&&!isUserNavigatingToActiveCell?modifySelection(coords):newSelection(coords),gridRef.current.scrollToItem(scrollToCell)}}),[activeCell,isHiddenRow,isHiddenColumn,selectionLeftBound,selectionTopBound,selectionPolicy,newSelectionMode]),selectAll=function selectAll(){selectionStart.current={rowIndex:selectionTopBound,columnIndex:selectionLeftBound},modifySelection({rowIndex:selectionBottomBound,columnIndex:selectionRightBound})},selectColumn=react_1.useCallback((function(){selectionEnd.current&&selectionStart.current&&(selectionStart.current={rowIndex:selectionTopBound,columnIndex:selectionStart.current.columnIndex},modifySelection({rowIndex:rowCount-1,columnIndex:selectionEnd.current.columnIndex}))}),[selectionTopBound]),selectRow=react_1.useCallback((function(){selectionEnd.current&&selectionStart.current&&(selectionStart.current={rowIndex:selectionStart.current.rowIndex,columnIndex:selectionLeftBound},modifySelection({rowIndex:selectionEnd.current.rowIndex,columnIndex:selectionRightBound}))}),[selectionLeftBound]),handleKeyDown=react_1.useCallback((function(e){if(null==gridRef?void 0:gridRef.current){var isShiftKey=e.nativeEvent.shiftKey,isAltKey=e.nativeEvent.altKey,isMetaKey=e.nativeEvent.ctrlKey||e.nativeEvent.metaKey;switch(e.nativeEvent.which){case types_1.KeyCodes.Right:keyNavigate(types_1.Direction.Right,isShiftKey,isMetaKey),e.preventDefault();break;case types_1.KeyCodes.Left:keyNavigate(types_1.Direction.Left,isShiftKey,isMetaKey),e.preventDefault();break;case types_1.KeyCodes.Up:keyNavigate(types_1.Direction.Up,isShiftKey,isMetaKey),e.preventDefault();break;case types_1.KeyCodes.Down:keyNavigate(types_1.Direction.Down,isShiftKey,isMetaKey),e.preventDefault();break;case types_1.KeyCodes.A:isMetaKey&&selectAll(),e.preventDefault();break;case types_1.KeyCodes.Home:isMetaKey?function selectFirstCellInColumn(){if(selectionStart.current&&(null==gridRef?void 0:gridRef.current)){var cell={rowIndex:selectionTopBound,columnIndex:selectionStart.current.columnIndex};newSelection(cell),null==gridRef||gridRef.current.scrollToItem(cell)}}():function selectFirstCellInRow(){if(selectionStart.current&&(null==gridRef?void 0:gridRef.current)){var cell={rowIndex:selectionStart.current.rowIndex,columnIndex:selectionLeftBound};newSelection(cell),null==gridRef||gridRef.current.scrollToItem(cell)}}();break;case types_1.KeyCodes.End:isMetaKey?function selectLastCellInColumn(){if(selectionStart.current&&(null==gridRef?void 0:gridRef.current)){var cell={rowIndex:rowCount-1,columnIndex:selectionStart.current.columnIndex};newSelection(cell),null==gridRef||gridRef.current.scrollToItem(cell)}}():function selectLastCellInRow(){if(selectionStart.current&&(null==gridRef?void 0:gridRef.current)){var cell={rowIndex:selectionStart.current.rowIndex,columnIndex:selectionRightBound};newSelection(cell),null==gridRef||gridRef.current.scrollToItem(cell)}}();break;case types_1.KeyCodes.BackSpace:isMetaKey&&function scrollToActiveCell(){activeCell&&(null==gridRef?void 0:gridRef.current)&&(null==gridRef||gridRef.current.scrollToItem(activeCell,helpers_1.Align.smart))}();break;case types_1.KeyCodes.SPACE:isMetaKey&&isShiftKey?selectAll():isMetaKey?selectColumn():isShiftKey&&selectRow();break;case types_1.KeyCodes.Tab:if(selections.length&&activeCell&&gridRef){var bounds=selections[selections.length-1].bounds,activeCellBounds=gridRef.current.getCellBounds(activeCell),direction=isShiftKey?types_1.Direction.Left:types_1.Direction.Right,nextCell=helpers_1.findNextCellWithinBounds(activeCellBounds,bounds,direction);nextCell&&(setActiveCell(nextCell),gridRef.current&&gridRef.current.scrollToItem(nextCell))}else keyNavigate(isShiftKey?types_1.Direction.Left:types_1.Direction.Right);e.preventDefault();break;case types_1.KeyCodes.PageDown:isAltKey?function pageRight(){if(activeCell&&(null==gridRef?void 0:gridRef.current)){var _gridRef$current$getV3=gridRef.current.getViewPort(),visibleColumnStartIndex=_gridRef$current$getV3.visibleColumnStartIndex,pageSize=_gridRef$current$getV3.visibleColumnStopIndex-visibleColumnStartIndex,columnIndex=Math.min(activeCell.columnIndex+pageSize,selectionRightBound),newActiveCell={columnIndex:columnIndex,rowIndex:activeCell.rowIndex};handleSetActiveCell(newActiveCell,!1),null==gridRef||gridRef.current.scrollToItem({columnIndex:columnIndex},helpers_1.Align.end)}}():function pageDown(){if(activeCell&&(null==gridRef?void 0:gridRef.current)){var _gridRef$current$getV=gridRef.current.getViewPort(),visibleRowStartIndex=_gridRef$current$getV.visibleRowStartIndex,pageSize=_gridRef$current$getV.visibleRowStopIndex-visibleRowStartIndex,rowIndex=Math.min(activeCell.rowIndex+pageSize,rowCount-1),newActiveCell={rowIndex:rowIndex,columnIndex:activeCell.columnIndex};handleSetActiveCell(newActiveCell,!1),null==gridRef||gridRef.current.scrollToItem({rowIndex:rowIndex},helpers_1.Align.end)}}();break;case types_1.KeyCodes.PageUp:isAltKey?function pageLeft(){if(activeCell&&(null==gridRef?void 0:gridRef.current)){var _gridRef$current$getV4=gridRef.current.getViewPort(),visibleColumnStartIndex=_gridRef$current$getV4.visibleColumnStartIndex,pageSize=_gridRef$current$getV4.visibleColumnStopIndex-visibleColumnStartIndex,columnIndex=Math.max(activeCell.columnIndex-pageSize,selectionLeftBound),newActiveCell={columnIndex:columnIndex,rowIndex:activeCell.rowIndex};handleSetActiveCell(newActiveCell,!1),null==gridRef||gridRef.current.scrollToItem({columnIndex:columnIndex},helpers_1.Align.end)}}():function pageUp(){if(activeCell&&(null==gridRef?void 0:gridRef.current)){var _gridRef$current$getV2=gridRef.current.getViewPort(),visibleRowStartIndex=_gridRef$current$getV2.visibleRowStartIndex,pageSize=_gridRef$current$getV2.visibleRowStopIndex-visibleRowStartIndex,rowIndex=Math.max(activeCell.rowIndex-pageSize,selectionTopBound),newActiveCell={rowIndex:rowIndex,columnIndex:activeCell.columnIndex};handleSetActiveCell(newActiveCell,!1),null==gridRef||gridRef.current.scrollToItem({rowIndex:rowIndex},helpers_1.Align.end)}}()}}}),[rowCount,columnCount,activeCell,selections,selectionPolicy,newSelectionMode]),handleSetActiveCell=react_1.useCallback((function(coords){var shouldScroll=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];selectionStart.current=coords,firstActiveCell.current=coords,selectionEnd.current=coords,setActiveCell(coords),shouldScroll&&coords&&(null==gridRef?void 0:gridRef.current)&&gridRef.current.scrollToItem(coords)}),[]),handleFillHandleMouseDown=react_1.useCallback((function(e){e.stopPropagation(),isFilling.current=!0,document.addEventListener("mousemove",handleFillHandleMouseMove),document.addEventListener("mouseup",handleFillHandleMouseUp)}),[selections]),handleFillHandleMouseMove=react_1.useCallback((function(e){if(isFilling.current&&(null==gridRef?void 0:gridRef.current)&&activeCellRef.current){var coords=gridRef.current.getCellCoordsFromOffset(e.clientX,e.clientY);if(coords){var selections=activeSelectionsRef.current,bounds=selectionFromStartEnd(activeCellRef.current,coords),hasSelections=selections.length>0,activeCellBounds=hasSelections?selections[selections.length-1].bounds:gridRef.current.getCellBounds(activeCellRef.current);if(bounds){var direction=bounds.top<activeCellBounds.top?types_1.Direction.Up:bounds.bottom>activeCellBounds.bottom?types_1.Direction.Down:bounds.right>activeCellBounds.right?types_1.Direction.Right:types_1.Direction.Left;direction===types_1.Direction.Right&&(bounds=Object.assign({},activeCellBounds,{right:Math.min(selectionRightBound,bounds.right)})),direction===types_1.Direction.Up&&(bounds=Object.assign({},activeCellBounds,{top:Math.max(selectionTopBound,bounds.top)})),direction===types_1.Direction.Left&&(bounds=Object.assign({},activeCellBounds,{left:Math.max(selectionLeftBound,bounds.left)})),direction===types_1.Direction.Down&&(bounds=Object.assign({},activeCellBounds,{bottom:Math.min(selectionBottomBound,bounds.bottom)})),hasSelections&&function boundsSubsetOfSelection(bounds,selection){return bounds.top>=selection.top&&bounds.bottom<=selection.bottom&&bounds.left>=selection.left&&bounds.right<=selection.right}(bounds,selections[0].bounds)?setFillSelection(null):(setFillSelection({bounds:bounds}),gridRef.current.scrollToItem(coords))}}}}),[]),handleFillHandleMouseUp=react_1.useCallback((function(e){var _a;if(isFilling.current=!1,document.removeEventListener("mousemove",handleFillHandleMouseMove),document.removeEventListener("mouseup",handleFillHandleMouseUp),gridRef&&activeCellRef.current){var fillSelection=null;setFillSelection((function(prev){return fillSelection=prev,null}));var selections=activeSelectionsRef.current,activeCell=activeCellRef.current;if(activeCell&&fillSelection){var newBounds=null===(_a=fillSelection)||void 0===_a?void 0:_a.bounds;newBounds&&(onFill&&onFill(activeCell,fillSelection,selections),setSelections((function(prevSelection){var len=prevSelection.length;return len?prevSelection.map((function(sel,i){return len-1===i?Object.assign({},sel,{bounds:newBounds}):sel})):[{bounds:newBounds}]})))}}}),[]),handleClearLastSelection=react_1.useCallback((function(){setSelections((function(prev){return prev.slice(0,-1)}))}),[]),fillHandleProps=react_1.useMemo((function(){return{onMouseDown:handleFillHandleMouseDown}}),[handleFillHandleMouseDown]);return{activeCell:activeCell,selections:selections,onMouseDown:handleMouseDown,onKeyDown:handleKeyDown,newSelection:newSelection,setSelections:setSelections,setActiveCell:handleSetActiveCell,setActiveCellState:setActiveCell,fillHandleProps:fillHandleProps,fillSelection:fillSelection,clearLastSelection:handleClearLastSelection,modifySelection:modifySelection,selectAll:selectAll,appendSelection:appendSelection,clearSelections:clearSelections}}},425:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(33),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),helpers_1=__webpack_require__(90),DefaultTooltipComponent=function DefaultTooltipComponent(_ref){var _ref$x=_ref.x,x=void 0===_ref$x?0:_ref$x,_ref$y=_ref.y,y=void 0===_ref$y?0:_ref$y,_ref$scrollLeft=_ref.scrollLeft,scrollLeft=void 0===_ref$scrollLeft?0:_ref$scrollLeft,_ref$scrollTop=_ref.scrollTop,scrollTop=void 0===_ref$scrollTop?0:_ref$scrollTop,_ref$width=_ref.width,width=void 0===_ref$width?0:_ref$width,posX=(_ref.height,x+width-scrollLeft),posY=y-scrollTop;return react_1.default.createElement("div",{style:{position:"absolute",left:0,top:0,transform:"translate(".concat(posX,"px, ").concat(posY,"px)"),maxWidth:200,minWidth:160,background:"white",boxShadow:"0 4px 8px 3px rgba(60,64,67,.15)",padding:12,borderRadius:4,fontSize:13}},x)},getDefaultTooltip=function getDefaultTooltip(){return DefaultTooltipComponent};exports.default=function useTooltip(_ref2){var gridRef=_ref2.gridRef,_ref2$getTooltip=_ref2.getTooltip,getTooltip=void 0===_ref2$getTooltip?getDefaultTooltip:_ref2$getTooltip,_react_1$useState2=_slicedToArray(react_1.useState(null),2),activeCell=_react_1$useState2[0],setActiveCell=_react_1$useState2[1],isTooltipActive=react_1.useRef(!1),activeCellRef=react_1.useRef(activeCell),_react_1$useState4=_slicedToArray(react_1.useState({}),2),tooltipPosition=_react_1$useState4[0],setTooltipPosition=_react_1$useState4[1],showTooltip=!!activeCell,TooltipComponent=react_1.useMemo((function(){return getTooltip(activeCell)}),[activeCell,getTooltip]),handleTooltipMouseEnter=react_1.useCallback((function(){isTooltipActive.current=!0}),[]),handleTooltipMouseLeave=react_1.useCallback((function(){isTooltipActive.current=!1,setActiveCell(null)}),[]),tooltipComponent=showTooltip&&TooltipComponent?react_1.default.createElement(TooltipComponent,Object.assign({},tooltipPosition,{onMouseEnter:handleTooltipMouseEnter,onMouseLeave:handleTooltipMouseLeave})):null,handleMouseMove=react_1.useCallback((function(e){if(gridRef.current){var coords=gridRef.current.getCellCoordsFromOffset(e.clientX,e.clientY);if(coords){var rowIndex=coords.rowIndex,columnIndex=coords.columnIndex;if(!activeCellRef.current||activeCellRef.current.rowIndex!==rowIndex||activeCellRef.current.columnIndex!==columnIndex){var pos=gridRef.current.getCellOffsetFromCoords(coords),scrollPosition=gridRef.current.getScrollPosition();setTooltipPosition(Object.assign({},pos,scrollPosition)),setActiveCell({rowIndex:rowIndex,columnIndex:columnIndex})}}}}),[]),handleMouseLeave=react_1.useCallback((function(){isTooltipActive.current||setActiveCell(null)}),[]),mouseMoveThrottler=react_1.useRef(),mouseLeaveThrottler=react_1.useRef();return react_1.useEffect((function(){mouseMoveThrottler.current=helpers_1.throttle(handleMouseMove,100),mouseLeaveThrottler.current=helpers_1.debounce(handleMouseLeave,2e3)}),[]),react_1.useEffect((function(){activeCellRef.current=activeCell}),[activeCell]),{tooltipComponent:tooltipComponent,onMouseMove:mouseMoveThrottler.current,onMouseLeave:mouseLeaveThrottler.current}}},429:function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21),Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(1),types_1=__webpack_require__(97),helpers_1=__webpack_require__(90);exports.default=function useUndo(){var props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},enableGlobalKeyHandlers=props.enableGlobalKeyHandlers,onRedo=props.onRedo,onUndo=props.onUndo,undoStack=(props.identifier,react_1.useRef([])),undoStackPointer=react_1.useRef(-1),_react_1$useReducer=react_1.useReducer((function(s){return s+1}),0),_react_1$useReducer2=_slicedToArray(_react_1$useReducer,2),forceRender=(_react_1$useReducer2[0],_react_1$useReducer2[1]);react_1.useEffect((function(){return enableGlobalKeyHandlers&&document.addEventListener("keydown",handleKeyDown),function(){return document.removeEventListener("keydown",handleKeyDown)}}),[enableGlobalKeyHandlers]);var handleKeyDown=react_1.useCallback((function(e){var _a;if(!document.activeElement||!helpers_1.focusableNodeNames.has(null===(_a=document.activeElement)||void 0===_a?void 0:_a.nodeName)){var isUndo=(e.metaKey||e.ctrlKey)&&e.which===types_1.KeyCodes.Z,isRedo=e.shiftKey&&isUndo||e.which===types_1.KeyCodes.KEY_Y;(isRedo||isUndo)&&(isRedo?handleRedo():handleUndo())}}),[]),handleUndo=react_1.useCallback((function(){if(!(undoStackPointer.current<0)){var patches=undoStack.current[undoStackPointer.current].inversePatches;undoStackPointer.current--,onUndo&&onUndo(patches),forceRender()}}),[]),handleRedo=react_1.useCallback((function(){if(undoStackPointer.current!==undoStack.current.length-1){undoStackPointer.current++;var patches=undoStack.current[undoStackPointer.current].patches;onRedo&&onRedo(patches),forceRender()}}),[]),addUndoable=react_1.useCallback((function(history){var patches=history.patches,inversePatches=history.inversePatches,pointer=++undoStackPointer.current;undoStack.current.length=pointer,undoStack.current[pointer]={patches:patches,inversePatches:inversePatches},forceRender()}),[]),replaceLastPatch=react_1.useCallback((function(patches,inversePatches){var _curPatches$patches;if(void 0!==patches){var _curPatches$inversePa,curPatches=undoStack.current[undoStackPointer.current];if(void 0!==(null==curPatches?void 0:curPatches.patches))if((_curPatches$patches=curPatches.patches).push.apply(_curPatches$patches,_toConsumableArray(patches)),inversePatches&&(null==curPatches?void 0:curPatches.inversePatches))(_curPatches$inversePa=curPatches.inversePatches).unshift.apply(_curPatches$inversePa,_toConsumableArray(inversePatches))}}),[]);return{undo:handleUndo,redo:handleRedo,add:addUndoable,replace:replaceLastPatch,onKeyDown:enableGlobalKeyHandlers?void 0:handleKeyDown,canUndo:!(undoStackPointer.current<0),canRedo:!(undoStackPointer.current===undoStack.current.length-1)}}},430:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(55),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(33),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19),__webpack_require__(130),__webpack_require__(16),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),helpers_1=__webpack_require__(90),getDefaultFilerComponent=function getDefaultFilerComponent(cell){return null};exports.default=function useFilter(_ref){var _ref$getFilterCompone=_ref.getFilterComponent,getFilterComponent=void 0===_ref$getFilterCompone?getDefaultFilerComponent:_ref$getFilterCompone,gridRef=_ref.gridRef,_ref$width=_ref.width,width=void 0===_ref$width?220:_ref$width,_ref$offset=_ref.offset,offset=void 0===_ref$offset?20:_ref$offset,getValue=_ref.getValue,_ref$frozenRows=_ref.frozenRows,frozenRows=void 0===_ref$frozenRows?0:_ref$frozenRows,_ref$frozenColumns=_ref.frozenColumns,frozenColumns=void 0===_ref$frozenColumns?0:_ref$frozenColumns,_react_1$useState2=_slicedToArray(react_1.useState(null),2),filterCell=_react_1$useState2[0],setFilterCell=_react_1$useState2[1],_react_1$useState4=_slicedToArray(react_1.useState(!1),2),isFilterVisible=_react_1$useState4[0],setIsFilterVisible=_react_1$useState4[1],_react_1$useState6=_slicedToArray(react_1.useState(null),2),currentFilter=_react_1$useState6[0],setCurrentFilter=_react_1$useState6[1],_react_1$useState8=_slicedToArray(react_1.useState({x:0,y:0}),2),position=_react_1$useState8[0],setPosition=_react_1$useState8[1],FilterComponent=react_1.useMemo((function(){return getFilterComponent(filterCell)}),[filterCell]),handleShowFilter=react_1.useCallback((function(coords,index,filterView,filter){if(gridRef.current){coords=gridRef.current.getActualCellCoords(coords);var scrollPosition=gridRef.current.getScrollPosition(),pos=gridRef.current.getCellOffsetFromCoords(coords),isFrozenColumn=coords.columnIndex<frozenColumns,isFrozenRow=coords.rowIndex<frozenRows;setPosition((function(prev){var left=pos.x,top=pos.y,cellWidth=pos.width;return{x:left+cellWidth-(isFrozenColumn?0:scrollPosition.scrollLeft)<width?left+cellWidth-offset-(isFrozenColumn?0:scrollPosition.scrollLeft):left+cellWidth-(isFrozenColumn?0:scrollPosition.scrollLeft)-width,y:top-(isFrozenRow?0:scrollPosition.scrollTop)+offset}})),setFilterCell(coords),setCurrentFilter({filter:filter,filterView:filterView,index:index}),showFilter()}}),[frozenRows,frozenColumns]),hideFilter=react_1.useCallback((function(){setIsFilterVisible(!1)}),[]),showFilter=react_1.useCallback((function(){setIsFilterVisible(!0)}),[]),values=react_1.useMemo((function(){if(!filterCell||!currentFilter)return[];for(var filterView=currentFilter.filterView,columnIndex=filterCell.columnIndex,bounds=filterView.bounds,filterValues=new Set,i=bounds.top+1;i<=bounds.bottom;i++){var text=getValue({rowIndex:i,columnIndex:columnIndex}),value=helpers_1.isNull(text)?"":text;filterValues.add(value)}return Array.from(filterValues)}),[filterCell,currentFilter]);return{filterComponent:isFilterVisible&&FilterComponent?react_1.default.createElement(FilterComponent,{position:position,width:width,values:values,index:null==currentFilter?void 0:currentFilter.index,filter:null==currentFilter?void 0:currentFilter.filter,columnIndex:null==filterCell?void 0:filterCell.columnIndex}):null,showFilter:handleShowFilter,hideFilter:hideFilter}}},431:function(module,exports,__webpack_require__){"use strict";function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_require__(9),__webpack_require__(38),__webpack_require__(26),__webpack_require__(33),__webpack_require__(8),__webpack_require__(32);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),react_konva_1=__webpack_require__(14),useImage_1=__importDefault(__webpack_require__(852)),ImageComponent=react_1.memo((function(props){var url=props.url,_props$width=props.width,width=void 0===_props$width?0:_props$width,_props$height=props.height,height=void 0===_props$height?0:_props$height,_props$x=props.x,x=void 0===_props$x?0:_props$x,_props$y=props.y,y=void 0===_props$y?0:_props$y,_props$spacing=props.spacing,spacing=void 0===_props$spacing?1:_props$spacing,rest=_objectWithoutProperties(props,["url","width","height","x","y","spacing"]),_useImage_1$default=useImage_1.default({url:url}),image=_useImage_1$default.image,imageWidth=_useImage_1$default.width,imageHeight=_useImage_1$default.height,status=_useImage_1$default.status,aspectRatio=react_1.useMemo((function(){return Math.min((width-spacing)/imageWidth,(height-spacing)/imageHeight)}),[imageWidth,imageHeight,width,height,spacing]);return x+=spacing,y+=spacing,width=Math.min(imageWidth,aspectRatio*imageWidth),height=Math.min(imageHeight,aspectRatio*imageHeight),"loaded"!==status?null:react_1.default.createElement(react_konva_1.Image,Object.assign({},rest,{x:x,y:y,height:height,width:width,image:image}))}));exports.default=ImageComponent},432:function(module,exports,__webpack_require__){"use strict";function _templateObject(){var data=function _taggedTemplateLiteral(strings,raw){raw||(raw=strings.slice(0));return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}(["\n            .rowsncolumns-spreadsheet {\n              font-family: ",";\n            }\n            .Toaster {\n              font-family: ",";\n              font-size: 0.875rem;\n            }\n            .Toaster button {\n              background: none;\n              border: none;\n              color: white;\n              cursor: pointer;\n            }\n            .rowsncolumns-spreadsheet *,\n            .rowsncolumns-spreadsheet *:before,\n            .rowsncolumns-spreadsheet *:after {\n              box-sizing: border-box;\n            }\n            .rowsncolumns-grid-container:focus {\n              outline: none;\n            }\n            .insert-range-indicator {\n              background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4IiBoZWlnaHQ9IjMiIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiNjY2MiPjxwYXRoIGQ9Ik0wLjUgMEwwLjUgM00wIDIuNUw4IDIuNU03LjUgM0w3LjUgMCIvPjwvc3ZnPg==)\n                bottom no-repeat;\n              background-size: contain;\n              width: 8px;\n              cursor: default;\n              display: inline-block;\n              line-height: 12px;\n            }\n          "]);return _templateObject=function _templateObject(){return data},data}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(134),__webpack_require__(117),__webpack_require__(205),__webpack_require__(25),__webpack_require__(86),__webpack_require__(38),__webpack_require__(20),__webpack_require__(13),__webpack_require__(96),__webpack_require__(23),__webpack_require__(296),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(33),__webpack_require__(68),__webpack_require__(8),__webpack_require__(128),__webpack_require__(32),__webpack_require__(10),__webpack_require__(70),__webpack_require__(45),__webpack_require__(19),__webpack_require__(87),__webpack_require__(16),__webpack_require__(115),__webpack_require__(118),__webpack_require__(297),__webpack_require__(21),__webpack_require__(204),__webpack_require__(80);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.initialState=exports.defaultSheets=void 0;var react_1=__importStar(__webpack_require__(1)),Toolbar_1=__importDefault(__webpack_require__(858)),Formulabar_1=__importDefault(__webpack_require__(984)),Workbook_1=__importDefault(__webpack_require__(991)),core_1=__webpack_require__(62),core_2=__webpack_require__(3),grid_1=__webpack_require__(7),constants_1=__webpack_require__(56),types_1=__webpack_require__(121),types_2=__webpack_require__(97),tiny_invariant_1=__importDefault(__webpack_require__(295)),Editor_1=__importDefault(__webpack_require__(461)),StatusBar_1=__importDefault(__webpack_require__(1010)),useFonts_1=__importDefault(__webpack_require__(1015)),state_1=__webpack_require__(464),ContextMenu_1=__importDefault(__webpack_require__(1019)),Tooltip_1=__importDefault(__webpack_require__(462)),validation_1=__importDefault(__webpack_require__(465)),useCalc_1=__importDefault(__webpack_require__(1021)),helpers_1=__webpack_require__(209),defaultActiveSheet=constants_1.uuid();exports.defaultSheets=[{id:defaultActiveSheet,name:"Sheet1",rowCount:1e3,columnCount:26,frozenColumns:0,frozenRows:0,activeCell:{rowIndex:1,columnIndex:1},mergedCells:[],selections:[],cells:{},scrollState:{scrollTop:0,scrollLeft:0},filterViews:[]}],exports.initialState={selectedSheet:0,sheets:exports.defaultSheets,currentActiveCell:null,currentSelections:null};var Spreadsheet=react_1.memo(react_1.forwardRef((function(props,forwardedRef){var _a,sheetsProp=props.sheets,_props$initialSheets=props.initialSheets,initialSheets=void 0===_props$initialSheets?exports.defaultSheets:_props$initialSheets,_props$showFormulabar=props.showFormulabar,showFormulabar=void 0===_props$showFormulabar||_props$showFormulabar,_props$minColumnWidth=props.minColumnWidth,minColumnWidth=void 0===_props$minColumnWidth?constants_1.DEFAULT_COLUMN_WIDTH:_props$minColumnWidth,_props$columnHeaderHe=props.columnHeaderHeight,columnHeaderHeight=void 0===_props$columnHeaderHe?constants_1.COLUMN_HEADER_HEIGHT:_props$columnHeaderHe,_props$rowHeaderWidth=props.rowHeaderWidth,rowHeaderWidth=void 0===_props$rowHeaderWidth?constants_1.ROW_HEADER_WIDTH:_props$rowHeaderWidth,_props$minRowHeight=props.minRowHeight,minRowHeight=void 0===_props$minRowHeight?constants_1.DEFAULT_ROW_HEIGHT:_props$minRowHeight,CellRenderer=props.CellRenderer,HeaderCellRenderer=props.HeaderCellRenderer,initialActiveSheet=props.initialActiveSheet,onChangeSelectedSheet=props.onChangeSelectedSheet,onChange=props.onChange,onChangeCell=props.onChangeCell,onChangeCells=props.onChangeCells,_props$showToolbar=props.showToolbar,showToolbar=void 0===_props$showToolbar||_props$showToolbar,_props$formatter=props.formatter,formatter=void 0===_props$formatter?constants_1.format:_props$formatter,_props$enableDarkMode=props.enableDarkMode,enableDarkMode=void 0===_props$enableDarkMode||_props$enableDarkMode,_props$fontFamily=props.fontFamily,fontFamily=void 0===_props$fontFamily?constants_1.SYSTEM_FONT:_props$fontFamily,_props$minHeight=props.minHeight,minHeight=void 0===_props$minHeight?400:_props$minHeight,_props$CellEditor=props.CellEditor,CellEditor=void 0===_props$CellEditor?Editor_1.default:_props$CellEditor,onActiveCellChange=props.onActiveCellChange,onActiveCellValueChange=props.onActiveCellValueChange,onSelectionChange=props.onSelectionChange,selectionMode=props.selectionMode,_props$showTabStrip=props.showTabStrip,showTabStrip=void 0===_props$showTabStrip||_props$showTabStrip,_props$isTabEditable=props.isTabEditable,isTabEditable=void 0===_props$isTabEditable||_props$isTabEditable,_props$allowNewSheet=props.allowNewSheet,allowNewSheet=void 0===_props$allowNewSheet||_props$allowNewSheet,_props$showStatusBar=props.showStatusBar,showStatusBar=void 0===_props$showStatusBar||_props$showStatusBar,_props$StatusBar=props.StatusBar,StatusBar=void 0===_props$StatusBar?StatusBar_1.default:_props$StatusBar,_props$ContextMenu=props.ContextMenu,ContextMenu=void 0===_props$ContextMenu?ContextMenu_1.default:_props$ContextMenu,_props$Tooltip=props.Tooltip,Tooltip=void 0===_props$Tooltip?Tooltip_1.default:_props$Tooltip,_props$initialScale=props.initialScale,initialScale=void 0===_props$initialScale?1:_props$initialScale,onScaleChange=props.onScaleChange,fontLoaderConfig=props.fontLoaderConfig,_props$fontList=props.fontList,fontList=void 0===_props$fontList?constants_1.FONT_FAMILIES:_props$fontList,selectionPolicy=props.selectionPolicy,_props$snap=props.snap,snap=void 0!==_props$snap&&_props$snap,stateReducer=props.stateReducer,_props$onValidate=props.onValidate,onValidate=void 0===_props$onValidate?validation_1.default:_props$onValidate,_props$enableGlobalKe=props.enableGlobalKeyHandlers,enableGlobalKeyHandlers=void 0!==_props$enableGlobalKe&&_props$enableGlobalKe,formulas=props.formulas,onFill=props.onFill,onAddNewSheet=props.onAddNewSheet,onSheetNameChange=props.onSheetNameChange,onDeleteSheet=props.onDeleteSheet,onDuplicateSheet=props.onDuplicateSheet,onResize=props.onResize,onInsertRow=props.onInsertRow,onInsertColumn=props.onInsertColumn,onDeleteRow=props.onDeleteRow,onDeleteColumn=props.onDeleteColumn,onShowSheet=props.onShowSheet,onHideSheet=props.onHideSheet,onProtectSheet=props.onProtectSheet,onUnProtectSheet=props.onUnProtectSheet,onSheetColorChange=props.onSheetColorChange,onFormattingChange=props.onFormattingChange,onDeleteCells=props.onDeleteCells,onFrozenRowsChange=props.onFrozenRowsChange,onFrozenColumnsChange=props.onFrozenColumnsChange,onClearFormatting=props.onClearFormatting,disableFormula=props.disableFormula,gridLineColor=props.gridLineColor,gridBackgroundColor=props.gridBackgroundColor,onCalculateSuccess=props.onCalculateSuccess,_props$autoFocus=props.autoFocus,autoFocus=void 0===_props$autoFocus||_props$autoFocus,_props$initialFormula=props.initialFormulaBarHeight,initialFormulaBarHeight=void 0===_props$initialFormula?constants_1.DEFAULT_FORMULABAR_HEIGHT:_props$initialFormula,onChangeFormulaBarHeight=props.onChangeFormulaBarHeight,rest=_objectWithoutProperties(props,["sheets","initialSheets","showFormulabar","minColumnWidth","columnHeaderHeight","rowHeaderWidth","minRowHeight","CellRenderer","HeaderCellRenderer","initialActiveSheet","onChangeSelectedSheet","onChange","onChangeCell","onChangeCells","showToolbar","formatter","enableDarkMode","fontFamily","minHeight","CellEditor","onActiveCellChange","onActiveCellValueChange","onSelectionChange","selectionMode","showTabStrip","isTabEditable","allowNewSheet","showStatusBar","StatusBar","ContextMenu","Tooltip","initialScale","onScaleChange","fontLoaderConfig","fontList","selectionPolicy","snap","stateReducer","onValidate","enableGlobalKeyHandlers","formulas","onFill","onAddNewSheet","onSheetNameChange","onDeleteSheet","onDuplicateSheet","onResize","onInsertRow","onInsertColumn","onDeleteRow","onDeleteColumn","onShowSheet","onHideSheet","onProtectSheet","onUnProtectSheet","onSheetColorChange","onFormattingChange","onDeleteCells","onFrozenRowsChange","onFrozenColumnsChange","onClearFormatting","disableFormula","gridLineColor","gridBackgroundColor","onCalculateSuccess","autoFocus","initialFormulaBarHeight","onChangeFormulaBarHeight"]),lastActiveCellRef=react_1.useRef(null),lastSelectionsRef=react_1.useRef([]),formulaBarInputRef=react_1.useRef(null),_react_1$useState2=_slicedToArray(react_1.useState(initialScale),2),scale=_react_1$useState2[0],setScale=_react_1$useState2[1],currentGrid=react_1.useRef(null),_react_1$useState4=_slicedToArray(react_1.useState(initialFormulaBarHeight),2),formulaBarHeight=_react_1$useState4[0],setFormulaBarHeight=_react_1$useState4[1],_react_1$useState6=_slicedToArray(react_1.useState(""),2),formulaInput=_react_1$useState6[0],setFormulaInput=_react_1$useState6[1],_react_1$useState8=_slicedToArray(react_1.useState(!1),2),isFormulaInputActive=_react_1$useState8[0],setIsFormulaInputActive=_react_1$useState8[1],isControlled=react_1.useRef(void 0!==sheetsProp).current,getCellConfigRef=react_1.useRef(),getCellConfigBySheetNameRef=react_1.useRef(),getSheetRef=react_1.useRef(),_react_1$useState10=_slicedToArray(react_1.useState(!1),2),isFormulaMode=_react_1$useState10[0],setFormulaMode=_react_1$useState10[1],_react_1$useState12=_slicedToArray(react_1.useState((function(){var _a;return{currentSelections:null,currentActiveCell:null,sheets:initialSheets,selectedSheet:isControlled?null==sheetsProp?void 0:sheetsProp[0].id:null!==(_a=null!=initialActiveSheet?initialActiveSheet:initialSheets[0].id)&&void 0!==_a?_a:null==sheetsProp?void 0:sheetsProp[0].id}})),2),valueState=_react_1$useState12[0],setValueState=_react_1$useState12[1],_react_1$useState14=_slicedToArray(react_1.useState((function(){return{newSelectionMode:"modify",showCellSuggestion:!1}})),2),formulaState=_react_1$useState14[0],setFormulaState=_react_1$useState14[1],isMounted=react_1.useRef(!1),currentStateRef=react_1.useRef(),state=react_1.useMemo((function(){return isControlled?Object.assign({},valueState,{sheets:sheetsProp}):valueState}),[isControlled,valueState,sheetsProp]),sheets=state.sheets,currentActiveCell=state.currentActiveCell,currentSelections=state.currentSelections,_react_1$useMemo2=_slicedToArray(react_1.useMemo((function(){return sheets.reduce((function(acc,sheet){return acc[0][sheet.id]=sheet,acc[1][sheet.name]=sheet,acc}),[{},{}])}),[sheets]),2),sheetsById=_react_1$useMemo2[0],sheetsByName=_react_1$useMemo2[1],selectedSheet=(null!==(_a=state.selectedSheet)&&void 0!==_a?_a:"")in sheetsById?state.selectedSheet:sheets[0].id,selectedSheetRef=react_1.useRef();tiny_invariant_1.default(null!=selectedSheet,"Exception, selectedSheet is empty, Please specify a selected sheet using `selectedSheet` prop"),react_1.useEffect((function(){return isMounted.current=!0,autoFocus&&focusGrid(),function(){isMounted.current=!1}}),[]),react_1.useEffect((function(){selectedSheetRef.current=selectedSheet}),[selectedSheet]),react_1.useEffect((function(){isControlled||null==onChange||onChange(state.sheets)}),[state,isControlled]),isControlled&&(currentStateRef.current=state);var currentStateReducer=react_1.useCallback((function(){return state_1.createStateReducer({addUndoPatch:addUndoPatch,replaceUndoPatch:replaceUndoPatch,getCellBounds:getCellBounds,stateReducer:stateReducer})}),[]),dispatch=react_1.useCallback((function(action){if(isMounted.current)if(isControlled){if(!currentStateRef.current)return;var newState=currentStateReducer()(currentStateRef.current,action);updateState(newState)}else setValueState((function(prevState){return currentStateReducer()(prevState,action)}))}),[isControlled]);react_1.useEffect((function(){var nextIsControlled=void 0!==sheetsProp,nextMode=nextIsControlled?"a controlled":"an uncontrolled",mode=isControlled?"a controlled":"an uncontrolled";isControlled!==nextIsControlled&&console.warn("Your component is changing from ".concat(mode," to ").concat(nextMode,".Components should not switch from controlled to uncontrolled (or vice versa).")+"Use initialSheets for uncontrolled and sheets and onChange for controlled SpreadSheet")}),[isControlled]);var updateState=react_1.useCallback((function(newState){var _a,_b,_c;newState.selectedSheet!==(null===(_a=currentStateRef.current)||void 0===_a?void 0:_a.selectedSheet)&&setValueState((function(prev){return Object.assign({},prev,{selectedSheet:newState.selectedSheet})})),newState.currentActiveCell===(null===(_b=currentStateRef.current)||void 0===_b?void 0:_b.currentActiveCell)&&newState.currentSelections===(null===(_c=currentStateRef.current)||void 0===_c?void 0:_c.currentSelections)||setValueState((function(prev){return Object.assign({},prev,{currentActiveCell:newState.currentActiveCell||prev.currentActiveCell,currentSelections:newState.currentSelections||prev.currentSelections})})),newState.selectedSheet!==state.selectedSheet&&(null==onChangeSelectedSheet||onChangeSelectedSheet(newState.selectedSheet)),currentStateRef.current=newState,null==onChange||onChange(newState.sheets)}),[isControlled]),currentSheet=sheetsById[selectedSheet],getCellConfig=react_1.useCallback((function(id,cell){var _a,_b,_c;if(cell)return null===(_c=null===(_b=null===(_a=null==sheetsById?void 0:sheetsById[id])||void 0===_a?void 0:_a.cells)||void 0===_b?void 0:_b[cell.rowIndex])||void 0===_c?void 0:_c[cell.columnIndex]}),[sheetsById]),getCellConfigBySheetName=react_1.useCallback((function(name,cell){var _a,_b,_c;if(cell)return null===(_c=null===(_b=null===(_a=null==sheetsByName?void 0:sheetsByName[name])||void 0===_a?void 0:_a.cells)||void 0===_b?void 0:_b[cell.rowIndex])||void 0===_c?void 0:_c[cell.columnIndex]}),[sheetsByName]),getSheet=react_1.useCallback((function(id){return null==sheetsById?void 0:sheetsById[id]}),[sheetsById]);getCellConfigRef.current=getCellConfig,getCellConfigBySheetNameRef.current=getCellConfigBySheetName,getSheetRef.current=getSheet;var getCellsBySheet=react_1.useCallback((function(){return sheets.reduce((function(acc,sheet){var _a,_b,_c;return acc[sheet.name]=null!==(_c=null===(_b=null===(_a=getSheetRef.current)||void 0===_a?void 0:_a.call(getSheetRef,sheet.id))||void 0===_b?void 0:_b.cells)&&void 0!==_c?_c:{},acc}),{})}),[sheets]),getSheetRange=react_1.useCallback((function(name){var _a,_b,sheet=sheetsByName[name];return{rowCount:null!==(_a=null==sheet?void 0:sheet.rowCount)&&void 0!==_a?_a:constants_1.DEFAULT_ROW_COUNT,columnCount:null!==(_b=null==sheet?void 0:sheet.columnCount)&&void 0!==_b?_b:constants_1.DEFAULT_COLUMN_COUNT}}),[sheetsByName]),_useCalc_1$default=useCalc_1.default({formulas:formulas,getCellConfig:getCellConfigBySheetNameRef.current,getSheetRange:getSheetRange}),initializeEngine=_useCalc_1$default.initializeEngine,onCalculateBatch=_useCalc_1$default.onCalculateBatch,supportedFormulas=_useCalc_1$default.supportedFormulas,beforeUndoRedo=react_1.useCallback((function(patches){var _a,_b;patches.some((function(item){return item.path.includes("filterViews")}))&&(null===(_b=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.resetAfterIndices)||void 0===_b||_b.call(_a,{rowIndex:0},!1))}),[]),patchHasCellChanges=react_1.useCallback((function(patches){return patches.some((function(patch){var _a;return"sheets"===patch.path[0]&&"cells"===(null===(_a=patch.path)||void 0===_a?void 0:_a[2])}))}),[]),_grid_1$useUndo=grid_1.useUndo({identifier:function identifier(patch){return JSON.stringify(patch.path)},enableGlobalKeyHandlers:enableGlobalKeyHandlers,onUndo:function onUndo(patches){beforeUndoRedo(patches),dispatch({type:state_1.ACTION_TYPE.APPLY_PATCHES,patches:patches,undoable:!1}),lastActiveCellRef.current&&setActiveCell(lastActiveCellRef.current),lastSelectionsRef.current&&setSelections(lastSelectionsRef.current),enableGlobalKeyHandlers&&focusGrid(),patchHasCellChanges(patches)&&void 0!==selectedSheetRef.current&&cellChangeCallback(selectedSheetRef.current,lastActiveCellRef.current,lastSelectionsRef.current,!0)},onRedo:function onRedo(patches){beforeUndoRedo(patches),dispatch({type:state_1.ACTION_TYPE.APPLY_PATCHES,patches:patches,undoable:!1});var activeCellPatch=patches.find((function(item){return item.path.includes("currentActiveCell")})),selectionsPatch=patches.find((function(item){return item.path.includes("currentSelections")}));activeCellPatch&&setActiveCell(activeCellPatch.value),selectionsPatch&&setSelections(selectionsPatch.value),enableGlobalKeyHandlers&&focusGrid(),patchHasCellChanges(patches)&&void 0!==selectedSheetRef.current&&cellChangeCallback(selectedSheetRef.current,null==activeCellPatch?void 0:activeCellPatch.value,null==selectionsPatch?void 0:selectionsPatch.value,!0)}}),addUndoPatch=_grid_1$useUndo.add,replaceUndoPatch=_grid_1$useUndo.replace,canRedo=_grid_1$useUndo.canRedo,canUndo=_grid_1$useUndo.canUndo,undo=_grid_1$useUndo.undo,redo=_grid_1$useUndo.redo,onUndoKeyDown=_grid_1$useUndo.onKeyDown,toast=core_1.useToast(),setActiveCell=react_1.useCallback((function(cell){var _a;cell&&(null===(_a=currentGrid.current)||void 0===_a||_a.setActiveCell(Object.assign({},cell)))}),[]),setSelections=react_1.useCallback((function(selections){var _a;selections&&(null===(_a=currentGrid.current)||void 0===_a||_a.setSelections(selections))}),[]),focusGrid=react_1.useCallback((function(){var _a;return null===(_a=currentGrid.current)||void 0===_a?void 0:_a.focus()}),[]),getCellBounds=react_1.useCallback((function(cell){var _a,_b;if(cell)return null===(_b=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.getCellBounds)||void 0===_b?void 0:_b.call(_a,cell)}),[]);react_1.useEffect((function(){lastActiveCellRef.current=null!=currentActiveCell?currentActiveCell:null,lastSelectionsRef.current=null!=currentSelections?currentSelections:null}),[currentActiveCell,currentSelections]);var setSelectedSheet=react_1.useCallback((function(id){id!==selectedSheetRef.current&&dispatch({type:state_1.ACTION_TYPE.SELECT_SHEET,id:id})}),[selectedSheet]),isFontActive=useFonts_1.default(fontLoaderConfig).isFontActive;react_1.useEffect((function(){var _a,_b;isFontActive&&(null===(_b=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.resetAfterIndices)||void 0===_b||_b.call(_a,{rowIndex:0,columnIndex:0}))}),[isFontActive]),react_1.useEffect((function(){null==onScaleChange||onScaleChange(scale)}),[scale]),react_1.useEffect((function(){null==onChangeFormulaBarHeight||onChangeFormulaBarHeight(formulaBarHeight)}),[formulaBarHeight]),react_1.useImperativeHandle(forwardedRef,(function(){return{grid:currentGrid.current,resize:handleResize,addUndoPatch:addUndoPatch,undo:undo,redo:redo,dispatch:dispatch,onCalculate:onCalculateBatch}}),[]);var handleNewSheet=react_1.useCallback((function(){var count=sheets.length,newSheet=constants_1.createNewSheet({count:count+1});dispatch({type:state_1.ACTION_TYPE.NEW_SHEET,sheet:newSheet}),focusGrid(),null==onAddNewSheet||onAddNewSheet(newSheet)}),[sheets,selectedSheet]),triggerBatchCalculation=react_1.useCallback(function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(sheet,id,cell,changes){var receivedResponse,loadingShown,values;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return receivedResponse=!1,loadingShown=!1,100,cell&&setTimeout((function(){receivedResponse||(dispatch({type:state_1.ACTION_TYPE.SET_LOADING,id:id,cell:cell,value:!0,undoable:!1}),loadingShown=!0)}),100),_context.next=6,null==onCalculateBatch?void 0:onCalculateBatch(changes);case 6:values=_context.sent,receivedResponse=!0,cell&&loadingShown&&dispatch({type:state_1.ACTION_TYPE.SET_LOADING,id:id,cell:cell,value:!1,undoable:!1}),void 0!==values&&(dispatch({type:state_1.ACTION_TYPE.UPDATE_CELLS,changes:values,replace:!0,undoable:!1}),null==onCalculateSuccess||onCalculateSuccess(values));case 10:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2,_x3,_x4){return _ref.apply(this,arguments)}}(),[]),triggerBatchInitialization=react_1.useCallback(function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(changes){var values;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,null==initializeEngine?void 0:initializeEngine(changes);case 2:void 0!==(values=_context2.sent)&&dispatch({type:state_1.ACTION_TYPE.UPDATE_CELLS,changes:values,undoable:!1});case 4:case"end":return _context2.stop()}}),_callee2)})));return function(_x5){return _ref2.apply(this,arguments)}}(),[]);react_1.useEffect((function(){triggerBatchInitialization(getCellsBySheet())}),[]);var _react_1$useMemo4=_slicedToArray(react_1.useMemo((function(){var sheet=getSheet(selectedSheet);return[getCellConfig(selectedSheet,sheet.activeCell),sheet.activeCell]}),[getSheet,selectedSheet,getCellConfig]),2),activeCellConfig=_react_1$useMemo4[0],activeCell=_react_1$useMemo4[1],handleChange=react_1.useCallback(function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(id,value,cell){var _a,config,datatype,isFormula,validationResponse,valid,message;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(config=null===(_a=getCellConfigRef.current)||void 0===_a?void 0:_a.call(getCellConfigRef,id,cell),datatype=constants_1.detectDataType(value),isFormula="formula"===datatype,disableFormula&&isFormula&&(datatype="string"),!isFormula){_context3.next=13;break}_context3.prev=5,helpers_1.formulaToRelativeReference(value,cell,cell),_context3.next=13;break;case 9:return _context3.prev=9,_context3.t0=_context3.catch(5),dispatch({type:state_1.ACTION_TYPE.SET_CELL_ERROR,id:id,cell:cell,value:value,datatype:datatype,error:_context3.t0.toString(),errorMessage:_context3.t0.message}),_context3.abrupt("return");case 13:return dispatch({type:state_1.ACTION_TYPE.CHANGE_SHEET_CELL,value:value,datatype:datatype,id:id,cell:cell}),null==onChangeCell||onChangeCell(id,value,cell),_context3.next=17,onValidate(value,id,cell,config);case 17:void 0!==(validationResponse=_context3.sent)&&(valid=validationResponse.valid,message=validationResponse.message,dispatch({type:state_1.ACTION_TYPE.VALIDATION_SUCCESS,cell:cell,id:id,valid:valid,prompt:message,undoable:!1,replace:!0})),cellChangeCallback(id,cell);case 20:case"end":return _context3.stop()}}),_callee3,null,[[5,9]])})));return function(_x6,_x7,_x8){return _ref3.apply(this,arguments)}}(),[disableFormula]),handleSheetAttributesChange=react_1.useCallback((function(id,_ref4){var activeCell=_ref4.activeCell,selections=_ref4.selections;dispatch({type:state_1.ACTION_TYPE.SHEET_SELECTION_CHANGE,id:id,activeCell:activeCell,selections:selections,undoable:!1})}),[]),handleChangeSheetName=react_1.useCallback((function(id,name){if(name in sheetsByName&&sheetsByName[name].id!==id)return toast({title:"There was a problem",description:"Sheet with the name ".concat(name," exists. Please enter another name"),status:"error",isClosable:!0,duration:9e4});dispatch({type:state_1.ACTION_TYPE.CHANGE_SHEET_NAME,id:id,name:name}),null==onSheetNameChange||onSheetNameChange(id,name)}),[sheetsByName]),handleDeleteSheet=react_1.useCallback((function(id){1!==sheets.length&&(dispatch({type:state_1.ACTION_TYPE.DELETE_SHEET,id:id}),null==onDeleteSheet||onDeleteSheet(id),focusGrid())}),[sheets,selectedSheet]),handleDuplicateSheet=react_1.useCallback((function(id){var newSheetId=constants_1.uuid(),index=sheets.findIndex((function(sheet){return sheet.id===id}));if(-1!==index){var newSheet=Object.assign({},sheets[index],{locked:!1,id:newSheetId,name:"Copy of ".concat(currentSheet.name)});dispatch({type:state_1.ACTION_TYPE.NEW_SHEET,sheet:newSheet,index:index}),null==onDuplicateSheet||onDuplicateSheet(newSheet,index)}}),[sheets,selectedSheet]),handleFormattingChangeAuto=react_1.useCallback((function(){var _a;dispatch({type:state_1.ACTION_TYPE.FORMATTING_CHANGE_AUTO,id:selectedSheet});var sheet=null===(_a=getSheetRef.current)||void 0===_a?void 0:_a.call(getSheetRef,selectedSheet);sheet&&cellChangeCallback(selectedSheet,sheet.activeCell,sheet.selections,!0)}),[selectedSheet]),handleFormattingChangePlain=react_1.useCallback((function(){var _a;dispatch({type:state_1.ACTION_TYPE.FORMATTING_CHANGE_PLAIN,id:selectedSheet});var sheet=null===(_a=getSheetRef.current)||void 0===_a?void 0:_a.call(getSheetRef,selectedSheet);sheet&&cellChangeCallback(selectedSheet,sheet.activeCell,sheet.selections,!0)}),[selectedSheet]),handleFormattingChange=react_1.useCallback((function(key,value){var _a;dispatch({type:state_1.ACTION_TYPE.FORMATTING_CHANGE,id:selectedSheet,key:key,value:value}),null==onFormattingChange||onFormattingChange(selectedSheet,key,value);var sheet=null===(_a=getSheetRef.current)||void 0===_a?void 0:_a.call(getSheetRef,selectedSheet);sheet&&cellChangeCallback(selectedSheet,sheet.activeCell,sheet.selections,!0)}),[selectedSheet]),handleActiveCellChange=react_1.useCallback((function(id,cell,value){cell&&(setFormulaInput(value||""),null==onActiveCellChange||onActiveCellChange(id,cell,value))}),[]),handleActiveCellValueChange=react_1.useCallback((function(id,activeCell,value){setFormulaInput(value),null==onActiveCellValueChange||onActiveCellValueChange(id,activeCell,value)}),[]),handleFormulabarFocus=react_1.useCallback((function(e){var _a,_b;!(null===(_a=currentGrid.current)||void 0===_a?void 0:_a.getEditingCell())&&activeCell&&(null===(_b=currentGrid.current)||void 0===_b||_b.makeEditable(activeCell,void 0,!1)),setIsFormulaInputActive(!0)}),[activeCell,isFormulaMode]),handleCellEditorFocus=react_1.useCallback((function(){setIsFormulaInputActive(!1)}),[]),handleFormulabarChange=react_1.useCallback((function(value){var _a,_b,currentlyEditingCell=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.getEditingCell();if(currentlyEditingCell){setFormulaInput(value);var isFormula=constants_1.isAFormula(value);null==setFormulaMode||setFormulaMode(!!isFormula),null===(_b=currentGrid.current)||void 0===_b||_b.setEditorValue(value,currentlyEditingCell)}}),[activeCell,selectedSheet]),handleFormulabarSubmit=react_1.useCallback((function(text,direction){var _a,_b,currentlyEditingCell=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.getEditingCell(),currentlyEditingSheetId=null===(_b=currentGrid.current)||void 0===_b?void 0:_b.getEditingSheetId();void 0!==currentlyEditingCell&&void 0!==currentlyEditingSheetId&&function submitEditor(value,activeCell){var _a,_b,direction=arguments.length>2&&void 0!==arguments[2]?arguments[2]:types_2.Direction.Down,nextActiveCell=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.getNextFocusableCell(activeCell,direction);null===(_b=currentGrid.current)||void 0===_b||_b.submitEditor(value,activeCell,nextActiveCell)}(text,currentlyEditingCell,direction)}),[]),handleFormulabarCancel=react_1.useCallback((function(){var _a,_b,_c,_d,_e,currentlyEditingCell=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.getEditingCell(),currentlyEditingSheetId=null===(_b=currentGrid.current)||void 0===_b?void 0:_b.getEditingSheetId();void 0!==currentlyEditingCell&&void 0!==currentlyEditingSheetId&&(null===(_c=currentGrid.current)||void 0===_c||_c.cancelEditor(),setFormulaInput((null===(_d=null==activeCellConfig?void 0:activeCellConfig.text)||void 0===_d?void 0:_d.toString())||""),setSelectedSheet(currentlyEditingSheetId),null===(_e=currentGrid.current)||void 0===_e||_e.setActiveCell(currentlyEditingCell))}),[]),handleFill=react_1.useCallback((function(id,activeCell,fillSelection,selections){fillSelection&&(dispatch({type:state_1.ACTION_TYPE.UPDATE_FILL,id:id,activeCell:activeCell,fillSelection:fillSelection,selections:selections}),null==onFill||onFill(id,activeCell,fillSelection,selections),focusGrid(),cellChangeCallback(id,activeCell,[fillSelection]))}),[sheets]),cellChangeCallback=react_1.useCallback((function(id,activeCell,selections){var _a,_b,skipFormula=arguments.length>3&&void 0!==arguments[3]&&arguments[3],sheetName=null===(_b=null===(_a=getSheetRef.current)||void 0===_a?void 0:_a.call(getSheetRef,id))||void 0===_b?void 0:_b.name,shouldRecalc=!disableFormula&&!skipFormula;if(sheetName&&(onChangeCells||shouldRecalc)){var sel=selections&&selections.length?selections:[{bounds:getCellBounds(activeCell)}],changes=_defineProperty({},sheetName,{}),cellChanges={};requestAnimationFrame((function(){for(var _a,_b,_c,_d,i=0;i<sel.length;i++)for(var bounds=sel[i].bounds,rowIndex=null==bounds?void 0:bounds.top;rowIndex<=(null==bounds?void 0:bounds.bottom);rowIndex++)for(var columnIndex=null==bounds?void 0:bounds.left;columnIndex<=(null==bounds?void 0:bounds.right);columnIndex++){var cellConfig=null!==(_b=null===(_a=getCellConfigRef.current)||void 0===_a?void 0:_a.call(getCellConfigRef,id,{rowIndex:rowIndex,columnIndex:columnIndex}))&&void 0!==_b?_b:{};cellChanges[rowIndex]=null!==(_c=cellChanges[rowIndex])&&void 0!==_c?_c:{},cellChanges[rowIndex][columnIndex]=cellConfig,shouldRecalc&&(changes[sheetName][rowIndex]=null!==(_d=changes[sheetName][rowIndex])&&void 0!==_d?_d:{},changes[sheetName][rowIndex][columnIndex]=cellConfig)}shouldRecalc&&triggerBatchCalculation(sheetName,id,activeCell,changes),null==onChangeCells||onChangeCells(id,cellChanges)}))}}),[disableFormula]),handleDelete=react_1.useCallback((function(id,activeCell,selections){dispatch({type:state_1.ACTION_TYPE.DELETE_CELLS,id:id,activeCell:activeCell,selections:selections}),setFormulaInput(""),null==onDeleteCells||onDeleteCells(id,activeCell,selections),cellChangeCallback(id,activeCell,selections)}),[]),handleClearFormatting=react_1.useCallback((function(){dispatch({type:state_1.ACTION_TYPE.CLEAR_FORMATTING,id:selectedSheet}),null==onClearFormatting||onClearFormatting(selectedSheet)}),[selectedSheet]),handleResize=react_1.useCallback((function(id,axis,index,dimension){var _a,_b,_c,_d;dispatch({type:state_1.ACTION_TYPE.RESIZE,id:id,index:index,dimension:dimension,axis:axis,undoable:!1}),"x"===axis?null===(_b=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.resizeColumns)||void 0===_b||_b.call(_a,[index]):null===(_d=null===(_c=currentGrid.current)||void 0===_c?void 0:_c.resizeRows)||void 0===_d||_d.call(_c,[index]),null==onResize||onResize(id,axis,index,dimension)}),[]),handleMergeCells=react_1.useCallback((function(){dispatch({type:state_1.ACTION_TYPE.MERGE_CELLS,id:selectedSheet})}),[selectedSheet]),handleFrozenRowChange=react_1.useCallback((function(count){dispatch({type:state_1.ACTION_TYPE.FROZEN_ROW_CHANGE,id:selectedSheet,count:count}),null==onFrozenRowsChange||onFrozenRowsChange(selectedSheet,count)}),[selectedSheet]),handleFrozenColumnChange=react_1.useCallback((function(count){dispatch({type:state_1.ACTION_TYPE.FROZEN_COLUMN_CHANGE,id:selectedSheet,count:count}),null==onFrozenColumnsChange||onFrozenColumnsChange(selectedSheet,count)}),[selectedSheet]),handleBorderChange=react_1.useCallback((function(color,borderStyle,variant){dispatch({type:state_1.ACTION_TYPE.SET_BORDER,id:selectedSheet,color:color,borderStyle:borderStyle,variant:variant})}),[selectedSheet]),handleScroll=react_1.useCallback((function(id,scrollState){dispatch({type:state_1.ACTION_TYPE.UPDATE_SCROLL,id:id,scrollState:scrollState,undoable:!1})}),[]),handlePaste=react_1.useCallback((function(id,rows,activeCell,selections,cutSelection){var _a,_b;if(activeCell){var rowIndex=activeCell.rowIndex,columnIndex=activeCell.columnIndex,endRowIndex=Math.max(rowIndex,rowIndex+rows.length-1),endColumnIndex=Math.max(columnIndex,columnIndex+(rows.length&&rows[0].length-1)),sel=selections.length?selections[selections.length-1].bounds:getCellBounds(activeCell),newSelection=[{bounds:{top:sel.top,left:sel.left,bottom:Math.max(sel.bottom,endRowIndex),right:Math.max(sel.right,endColumnIndex)}}],isSingleCellSelection=rowIndex===endRowIndex&&columnIndex===endColumnIndex;dispatch({type:state_1.ACTION_TYPE.PASTE,id:id,rows:rows,activeCell:activeCell,cutSelection:cutSelection,selections:isSingleCellSelection?void 0:newSelection}),isSingleCellSelection||setSelections(newSelection);var value=null===(_b=null===(_a=getCellConfigRef.current)||void 0===_a?void 0:_a.call(getCellConfigRef,id,activeCell))||void 0===_b?void 0:_b.text;handleActiveCellValueChange(id,activeCell,value),cellChangeCallback(id,activeCell,newSelection.concat(null!=cutSelection?cutSelection:[]))}}),[]),handleCopy=react_1.useCallback((function(id,selections){dispatch({type:state_1.ACTION_TYPE.COPY,id:id,undoable:!1})}),[]),handleCut=react_1.useCallback((function(id,selection){dispatch({type:state_1.ACTION_TYPE.REMOVE_CELLS,id:id,activeCell:null,selections:[selection]})}),[]),handleInsertRow=react_1.useCallback((function(id,activeCell){null!==activeCell&&(dispatch({type:state_1.ACTION_TYPE.INSERT_ROW,id:id,activeCell:activeCell}),null==onInsertRow||onInsertRow(id,activeCell),requestAnimationFrame((function(){return triggerBatchInitialization(getCellsBySheet())})))}),[]),handleInsertColumn=react_1.useCallback((function(id,activeCell){null!==activeCell&&(dispatch({type:state_1.ACTION_TYPE.INSERT_COLUMN,id:id,activeCell:activeCell}),null==onInsertColumn||onInsertColumn(id,activeCell),requestAnimationFrame((function(){return triggerBatchInitialization(getCellsBySheet())})))}),[]),handleDeleteRow=react_1.useCallback((function(id,activeCell){null!==activeCell&&(dispatch({type:state_1.ACTION_TYPE.DELETE_ROW,id:id,activeCell:activeCell}),null==onDeleteRow||onDeleteRow(id,activeCell),requestAnimationFrame((function(){return triggerBatchInitialization(getCellsBySheet())})))}),[]),handleDeleteColumn=react_1.useCallback((function(id,activeCell){null!==activeCell&&(dispatch({type:state_1.ACTION_TYPE.DELETE_COLUMN,id:id,activeCell:activeCell}),null==onDeleteColumn||onDeleteColumn(id,activeCell),requestAnimationFrame((function(){return triggerBatchInitialization(getCellsBySheet())})))}),[]),handleMoveToNextSheet=react_1.useCallback((function(){dispatch({type:state_1.ACTION_TYPE.SELECT_NEXT_SHEET}),focusGrid()}),[]),handleMoveToPrevSheet=react_1.useCallback((function(){dispatch({type:state_1.ACTION_TYPE.SELECT_PREV_SHEET}),focusGrid()}),[]),handleEditorKeyDown=react_1.useCallback((function(event){var keyCode=event.which,isAlt=event.altKey;switch(keyCode){case types_2.KeyCodes.Up:isAlt&&(handleMoveToPrevSheet(),null==event||event.preventDefault());break;case types_2.KeyCodes.Down:isAlt&&(handleMoveToNextSheet(),null==event||event.preventDefault())}}),[]),handleKeyDown=react_1.useCallback((function(id,event,activeCell){var _a,_b,_c,_d;if(activeCell){var isMeta=event.metaKey||event.ctrlKey,isShift=event.shiftKey,keyCode=event.which,isAlt=event.altKey;switch(keyCode){case types_2.KeyCodes.KEY_B:if(!isMeta)return;handleFormattingChange(types_1.FORMATTING_TYPE.BOLD,!(null===(_a=getCellConfig(id,activeCell))||void 0===_a?void 0:_a.bold));break;case types_2.KeyCodes.KEY_I:if(!isMeta)return;handleFormattingChange(types_1.FORMATTING_TYPE.ITALIC,!(null===(_b=getCellConfig(id,activeCell))||void 0===_b?void 0:_b.italic));break;case types_2.KeyCodes.KEY_U:if(!isMeta)return;handleFormattingChange(types_1.FORMATTING_TYPE.UNDERLINE,!(null===(_c=getCellConfig(id,activeCell))||void 0===_c?void 0:_c.underline));break;case types_2.KeyCodes.KEY_X:if(!isMeta||!isShift)return;handleFormattingChange(types_1.FORMATTING_TYPE.STRIKE,!(null===(_d=getCellConfig(id,activeCell))||void 0===_d?void 0:_d.strike));break;case types_2.KeyCodes.BACK_SLASH:if(!isMeta)return;handleClearFormatting(),null==event||event.preventDefault();break;case types_2.KeyCodes.KEY_L:case types_2.KeyCodes.KEY_E:case types_2.KeyCodes.KEY_R:if(!isMeta||!isShift)return;var align=keyCode===types_2.KeyCodes.KEY_L?"left":keyCode===types_2.KeyCodes.KEY_E?"center":"right";handleFormattingChange(types_1.FORMATTING_TYPE.HORIZONTAL_ALIGN,align),null==event||event.preventDefault();break;case types_2.KeyCodes.Up:isAlt&&(handleMoveToPrevSheet(),null==event||event.preventDefault());break;case types_2.KeyCodes.Down:isAlt&&(handleMoveToNextSheet(),null==event||event.preventDefault())}null==onUndoKeyDown||onUndoKeyDown(event)}}),[getCellConfig]),handleChangeFilter=react_1.useCallback((function(id,filterViewIndex,columnIndex,filter){var _a,_b;null===(_b=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.resetAfterIndices)||void 0===_b||_b.call(_a,{rowIndex:0},!1),dispatch({type:state_1.ACTION_TYPE.CHANGE_FILTER,id:id,filterViewIndex:filterViewIndex,columnIndex:columnIndex,filter:filter})}),[]),handleScaleChange=react_1.useCallback((function(value){var _a,_b;null===(_b=null===(_a=currentGrid.current)||void 0===_a?void 0:_a.resetAfterIndices)||void 0===_b||_b.call(_a,{rowIndex:0,columnIndex:0},!1),setScale(value)}),[selectedSheet]),handleShowSheet=react_1.useCallback((function(id){dispatch({type:state_1.ACTION_TYPE.SHOW_SHEET,id:id}),null==onShowSheet||onShowSheet(id)}),[]),handleHideSheet=react_1.useCallback((function(id){dispatch({type:state_1.ACTION_TYPE.HIDE_SHEET,id:id}),null==onHideSheet||onHideSheet(id)}),[]),handleProtectSheet=react_1.useCallback((function(id){dispatch({type:state_1.ACTION_TYPE.PROTECT_SHEET,id:id}),null==onProtectSheet||onProtectSheet(id)}),[]),handleUnProtectSheet=react_1.useCallback((function(id){dispatch({type:state_1.ACTION_TYPE.UNPROTECT_SHEET,id:id}),null==onUnProtectSheet||onUnProtectSheet(id)}),[]),handleChangeTabColor=react_1.useCallback((function(id,color){dispatch({type:state_1.ACTION_TYPE.CHANGE_TAB_COLOR,id:id,color:color}),null==onSheetColorChange||onSheetColorChange(id)}),[]),handleChangeFormulaState=react_1.useCallback((function(props){setFormulaState((function(prev){return Object.assign({},prev,props)}))}),[]),handleFormulaBarUpdateSelections=react_1.useCallback((function(name,sel,newSelectionMode){var _a,_b;formulaBarInputRef.current&&(null===(_b=(_a=formulaBarInputRef.current).updateSelection)||void 0===_b||_b.call(_a,name,sel,newSelectionMode))}),[]),handleFormulaBarFocus=react_1.useCallback((function(){var _a;null===(_a=formulaBarInputRef.current)||void 0===_a||_a.focus()}),[]);return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_2.Global,{styles:core_2.css(_templateObject(),fontFamily,fontFamily)}),react_1.default.createElement(core_1.Flex,{flexDirection:"column",flex:1,minWidth:0,minHeight:minHeight,className:"rowsncolumns-spreadsheet"},showToolbar?react_1.default.createElement(Toolbar_1.default,{wrap:null==activeCellConfig?void 0:activeCellConfig.wrap,datatype:null==activeCellConfig?void 0:activeCellConfig.datatype,plaintext:null==activeCellConfig?void 0:activeCellConfig.plaintext,format:null==activeCellConfig?void 0:activeCellConfig.format,fontSize:null==activeCellConfig?void 0:activeCellConfig.fontSize,fontFamily:null==activeCellConfig?void 0:activeCellConfig.fontFamily,fill:null==activeCellConfig?void 0:activeCellConfig.fill,bold:null==activeCellConfig?void 0:activeCellConfig.bold,italic:null==activeCellConfig?void 0:activeCellConfig.italic,strike:null==activeCellConfig?void 0:activeCellConfig.strike,underline:null==activeCellConfig?void 0:activeCellConfig.underline,color:null==activeCellConfig?void 0:activeCellConfig.color,percent:null==activeCellConfig?void 0:activeCellConfig.percent,currency:null==activeCellConfig?void 0:activeCellConfig.currency,verticalAlign:null==activeCellConfig?void 0:activeCellConfig.verticalAlign,horizontalAlign:null==activeCellConfig?void 0:activeCellConfig.horizontalAlign,onFormattingChange:handleFormattingChange,onFormattingChangeAuto:handleFormattingChangeAuto,onFormattingChangePlain:handleFormattingChangePlain,onClearFormatting:handleClearFormatting,onMergeCells:handleMergeCells,frozenRows:currentSheet.frozenRows,frozenColumns:currentSheet.frozenColumns,onFrozenRowChange:handleFrozenRowChange,onFrozenColumnChange:handleFrozenColumnChange,onBorderChange:handleBorderChange,onRedo:redo,onUndo:undo,canRedo:canRedo,canUndo:canUndo,enableDarkMode:enableDarkMode,scale:scale,onScaleChange:handleScaleChange,fontList:fontList}):null,showFormulabar?react_1.default.createElement(Formulabar_1.default,{ref:formulaBarInputRef,value:formulaInput,onChange:handleFormulabarChange,onSubmit:handleFormulabarSubmit,onCancel:handleFormulabarCancel,onFocus:handleFormulabarFocus,isFormulaMode:isFormulaMode,height:formulaBarHeight,onChangeHeight:setFormulaBarHeight,locked:null==activeCellConfig?void 0:activeCellConfig.locked,supportedFormulas:supportedFormulas,onFormulaChange:handleChangeFormulaState,disabled:!activeCell}):null,react_1.default.createElement(Workbook_1.default,Object.assign({},rest,{scale:scale,StatusBar:StatusBar,showTabStrip:showTabStrip,isTabEditable:isTabEditable,allowNewSheet:allowNewSheet,onResize:handleResize,formatter:formatter,ref:currentGrid,onDelete:handleDelete,onFill:handleFill,onActiveCellValueChange:handleActiveCellValueChange,onActiveCellChange:handleActiveCellChange,currentSheet:currentSheet,selectedSheet:selectedSheet,onChangeSelectedSheet:setSelectedSheet,onNewSheet:handleNewSheet,theme:core_1.theme,sheets:sheets,onChange:handleChange,onSheetChange:handleSheetAttributesChange,minColumnWidth:minColumnWidth,minRowHeight:minRowHeight,CellRenderer:CellRenderer,HeaderCellRenderer:HeaderCellRenderer,onChangeSheetName:handleChangeSheetName,onEditorKeyDown:handleEditorKeyDown,onDeleteSheet:handleDeleteSheet,onDuplicateSheet:handleDuplicateSheet,onScroll:handleScroll,onKeyDown:handleKeyDown,onPaste:handlePaste,onCut:handleCut,onCopy:handleCopy,onInsertRow:handleInsertRow,onInsertColumn:handleInsertColumn,onDeleteRow:handleDeleteRow,onDeleteColumn:handleDeleteColumn,CellEditor:CellEditor,onSelectionChange:onSelectionChange,selectionMode:selectionMode,onChangeFilter:handleChangeFilter,showStatusBar:showStatusBar,selectionPolicy:selectionPolicy,ContextMenu:ContextMenu,snap:snap,Tooltip:Tooltip,onHideSheet:handleHideSheet,onShowSheet:handleShowSheet,onProtectSheet:handleProtectSheet,onUnProtectSheet:handleUnProtectSheet,onChangeTabColor:handleChangeTabColor,rowHeaderWidth:rowHeaderWidth,columnHeaderHeight:columnHeaderHeight,gridLineColor:gridLineColor,gridBackgroundColor:gridBackgroundColor,isFormulaMode:isFormulaMode,setFormulaMode:setFormulaMode,isFormulaInputActive:isFormulaInputActive,supportedFormulas:supportedFormulas,formulaState:formulaState,onChangeFormulaState:handleChangeFormulaState,onCellEditorFocus:handleCellEditorFocus,onFormulaBarUpdateSelections:handleFormulaBarUpdateSelections,focusFormulaBar:handleFormulaBarFocus}))))}))),ThemeWrapper=react_1.forwardRef((function(props,forwardedRef){var _props$theme=props.theme,defaultTheme=void 0===_props$theme?core_1.theme:_props$theme,_props$initialColorMo=props.initialColorMode,initialColorMode=void 0===_props$initialColorMo?"light":_props$initialColorMo,rest=_objectWithoutProperties(props,["theme","initialColorMode"]);return react_1.default.createElement(core_1.ThemeProvider,{theme:defaultTheme},react_1.default.createElement(core_1.ColorModeProvider,{value:initialColorMode},react_1.default.createElement(Spreadsheet,Object.assign({},rest,{ref:forwardedRef}))))}));exports.default=ThemeWrapper},433:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _templateObject(){var data=function _taggedTemplateLiteral(strings,raw){raw||(raw=strings.slice(0));return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}(['\n          .circle-picker div[title="#efefef"],\n          .circle-picker div[title="#f3f3f3"],\n          .circle-picker div[title="#ffffff"] {\n            border: 1px solid #dadce0;\n            border-radius: 50%;\n          }\n        ']);return _templateObject=function _templateObject(){return data},data}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(134),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(49),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(89),__webpack_require__(33),__webpack_require__(68),__webpack_require__(8),__webpack_require__(128),__webpack_require__(10),__webpack_require__(164),__webpack_require__(19),__webpack_require__(16),__webpack_require__(118),__webpack_require__(297),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorPicker=void 0;var react_1=__importStar(__webpack_require__(1)),md_1=__webpack_require__(206),bs_1=__webpack_require__(860),io_1=__webpack_require__(861),core_1=__webpack_require__(62),styled_1=__webpack_require__(120),constants_1=__webpack_require__(56),types_1=__webpack_require__(121),translations_1=__webpack_require__(441),react_color_1=__webpack_require__(893),core_2=__webpack_require__(3),Select_1=__importDefault(__webpack_require__(983));exports.ColorPicker=function(_ref){var color=_ref.color,onChange=_ref.onChange,_ref$resetLabel=_ref.resetLabel,resetLabel=void 0===_ref$resetLabel?"Reset":_ref$resetLabel;return react_1.default.createElement(core_1.Box,{pb:2},react_1.default.createElement(core_2.Global,{styles:core_2.css(_templateObject())}),react_1.default.createElement(styled_1.Button,{variant:"ghost",isFullWidth:!0,justifyContent:"left",size:"sm",mb:2,onClick:function onClick(){return onChange(void 0)},background:"none"},react_1.default.createElement(core_1.Box,{mr:2},react_1.default.createElement(md_1.MdFormatColorReset,null)),resetLabel),react_1.default.createElement(react_color_1.CirclePicker,{color:color,onChangeComplete:function onChangeComplete(e){return onChange(e.hex)},circleSpacing:5,circleSize:20,width:"260px",colors:["#000000","#434343","#666666","#999999","#b7b7b7","#cccccc","#d9d9d9","#efefef","#f3f3f3","#ffffff","#980000","#ff0000","#ff9900","#ffff00","#00ff00","#00ffff","#4a86e8","#0000ff","#9900ff","#ff00ff","#e6b8af","#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#c9daf8","#cfe2f3","#d9d2e9","#ead1dc","#dd7e6b","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#a4c2f4","#9fc5e8","#b4a7d6","#d5a6bd","#cc4125","#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6d9eeb","#6fa8dc","#8e7cc3","#c27ba0","#a61c00","#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3c78d8","#3d85c6","#674ea7","#a64d79","#85200c","#990000","#b45f06","#bf9000","#38761d","#134f5c","#1155cc","#0b5394","#351c75","#741b47","#5b0f00","#660000","#783f04","#7f6000","#274e13","#0c343d","#1c4587","#073763","#20124d","#4c1130"]}))};var Toolbar=react_1.memo((function(props){var bold=props.bold,italic=props.italic,fill=props.fill,underline=props.underline,strike=props.strike,color=props.color,_props$verticalAlign=props.verticalAlign,verticalAlign=void 0===_props$verticalAlign?"bottom":_props$verticalAlign,horizontalAlign=props.horizontalAlign,onFormattingChange=props.onFormattingChange,onClearFormatting=props.onClearFormatting,onMergeCells=props.onMergeCells,onFrozenColumnChange=props.onFrozenColumnChange,onFrozenRowChange=props.onFrozenRowChange,_props$frozenRows=props.frozenRows,frozenRows=void 0===_props$frozenRows?0:_props$frozenRows,_props$frozenColumns=props.frozenColumns,frozenColumns=void 0===_props$frozenColumns?0:_props$frozenColumns,onBorderChange=props.onBorderChange,canUndo=props.canUndo,canRedo=props.canRedo,onRedo=props.onRedo,onUndo=props.onUndo,enableDarkMode=props.enableDarkMode,_props$fontSize=props.fontSize,fontSize=void 0===_props$fontSize?constants_1.DEFAULT_FONT_SIZE:_props$fontSize,_props$fontFamily=props.fontFamily,fontFamily=void 0===_props$fontFamily?constants_1.DEFAULT_FONT_FAMILY:_props$fontFamily,format=props.format,onFormattingChangeAuto=props.onFormattingChangeAuto,onFormattingChangePlain=props.onFormattingChangePlain,plaintext=props.plaintext,_props$scale=props.scale,scale=void 0===_props$scale?1:_props$scale,onScaleChange=props.onScaleChange,_props$fontList=props.fontList,fontList=void 0===_props$fontList?[]:_props$fontList,_props$wrap=props.wrap,wrap=void 0===_props$wrap?"clip":_props$wrap,_core_1$useColorMode=core_1.useColorMode(),colorMode=_core_1$useColorMode.colorMode,toggleColorMode=_core_1$useColorMode.toggleColorMode,theme=core_1.useTheme(),isLight="light"===colorMode,activeIconColor=theme.colors.teal[500],iconColor=isLight?theme.colors.gray[600]:theme.colors.gray[50],borderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600],backgroundColor=isLight?"white":constants_1.DARK_MODE_COLOR,foregroundColor=isLight?constants_1.DARK_MODE_COLOR:"white";return react_1.default.createElement(styled_1.StyledToolbar,{pr:2,pl:2,pt:1,pb:1,borderColor:borderColor,backgroundColor:backgroundColor,color:foregroundColor},react_1.default.createElement(core_1.Flex,{flex:1,alignItems:"center",flexWrap:"wrap",minWidth:1},react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.undo,label:translations_1.translations.undo,placement:"bottom-start"},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.undo,variant:"ghost",color:iconColor,icon:md_1.MdUndo,size:"sm",height:"28px",isDisabled:!canUndo,onClick:onUndo})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.redo,label:translations_1.translations.redo,placement:"bottom-start"},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.redo,variant:"ghost",color:iconColor,icon:md_1.MdRedo,size:"sm",height:"28px",isDisabled:!canRedo,onClick:onRedo})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.clear_formatting,label:translations_1.translations.clear_formatting},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.clear_formatting,variant:"ghost",color:iconColor,icon:md_1.MdFormatClear,size:"sm",height:"28px",onClick:function onClick(){return null==onClearFormatting?void 0:onClearFormatting()}})),react_1.default.createElement(styled_1.Separator,{borderColor:borderColor}),react_1.default.createElement(core_1.Menu,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.zoom,label:translations_1.translations.zoom},react_1.default.createElement(core_1.MenuButton,{color:foregroundColor,as:styled_1.Button,size:"sm",flexShrink:0,paddingLeft:1,paddingRight:1,background:"none",fontSize:12,height:"28px"},"".concat(100*scale,"%"),react_1.default.createElement(core_1.Icon,{name:"chevron-down",ml:1,fontSize:16}))),react_1.default.createElement(core_1.MenuList,{placement:"top-start",minWidth:100,borderColor:borderColor,borderStyle:"solid",fontSize:14},constants_1.SCALE_VALUES.map((function(_ref2){var label=_ref2.label,value=_ref2.value;return react_1.default.createElement(styled_1.MenuItem,{key:value,onClick:function onClick(){null==onScaleChange||onScaleChange(value)}},react_1.default.createElement(core_1.Box,{width:"24px"},value===scale&&react_1.default.createElement(core_1.Icon,{name:"check",mr:1})),label)})))),react_1.default.createElement(styled_1.Separator,{borderColor:borderColor}),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.format_as_currency,label:translations_1.translations.format_as_currency},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.format_as_currency,variant:format===constants_1.FORMAT_CURRENCY?"solid":"ghost",color:format===constants_1.FORMAT_CURRENCY?activeIconColor:iconColor,icon:md_1.MdAttachMoney,size:"sm",height:"28px",onClick:function onClick(){return null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,constants_1.FORMAT_CURRENCY)}})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.format_as_percent,label:translations_1.translations.format_as_percent},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.format_as_percent,variant:format===constants_1.FORMAT_PERCENT?"solid":"ghost",color:format===constants_1.FORMAT_PERCENT?activeIconColor:iconColor,fontSize:10,icon:styled_1.PercentIcon,size:"sm",height:"28px",onClick:function onClick(){return null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,constants_1.FORMAT_PERCENT)}})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.decrease_decimal,label:translations_1.translations.decrease_decimal},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.decrease_decimal,fontSize:20,color:iconColor,icon:styled_1.DecreaseDecimalIcon,size:"sm",height:"28px",onClick:function onClick(){return null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,constants_1.changeDecimals(format,-1))}})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.increase_decimal,label:translations_1.translations.increase_decimal},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.increase_decimal,fontSize:20,color:iconColor,icon:styled_1.IncreaseDecimalIcon,size:"sm",height:"28px",onClick:function onClick(){return null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,constants_1.changeDecimals(format))}})),react_1.default.createElement(core_1.Menu,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.more_formats,label:translations_1.translations.more_formats},react_1.default.createElement(core_1.MenuButton,{color:foregroundColor,as:styled_1.Button,size:"sm",flexShrink:0,paddingLeft:1,paddingRight:1,background:"none",height:"28px"},react_1.default.createElement(core_1.Box,{fontSize:12},"123"),react_1.default.createElement(core_1.Icon,{name:"chevron-down",fontSize:16}))),react_1.default.createElement(core_1.MenuList,{placement:"top-start",minWidth:280,borderColor:borderColor,borderStyle:"solid",fontSize:14},react_1.default.createElement(styled_1.MenuItem,{onClick:function onClick(){null==onFormattingChangeAuto||onFormattingChangeAuto(),null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,void 0)}},react_1.default.createElement(core_1.Box,{width:"24px"},void 0===format&&!plaintext&&react_1.default.createElement(core_1.Icon,{name:"check",mr:1})),"Automatic"),react_1.default.createElement(styled_1.MenuItem,{onClick:function onClick(){null==onFormattingChangePlain||onFormattingChangePlain()}},react_1.default.createElement(core_1.Box,{width:"24px"},plaintext&&react_1.default.createElement(core_1.Icon,{name:"check",mr:1})),"Plain"),react_1.default.createElement(core_1.MenuDivider,{borderColor:borderColor}),constants_1.AVAILABLE_FORMATS.map((function(item,idx){return react_1.default.createElement(styled_1.MenuItem,{display:"flex",onClick:function onClick(){null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,item.value)},key:idx},react_1.default.createElement(core_1.Box,{width:"24px"},format===item.value&&!plaintext&&react_1.default.createElement(core_1.Icon,{name:"check",mr:1})),react_1.default.createElement(core_1.Box,{flex:1},item.label),react_1.default.createElement(core_1.Box,{textAlign:"right",color:"gray.500"},item.sample))})),react_1.default.createElement(core_1.MenuDivider,{borderColor:borderColor}),constants_1.AVAILABLE_CURRENCY_FORMATS.map((function(item,idx){return react_1.default.createElement(styled_1.MenuItem,{display:"flex",onClick:function onClick(){null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,item.value)},key:idx},react_1.default.createElement(core_1.Box,{width:"24px"},format===item.value&&!plaintext&&react_1.default.createElement(core_1.Icon,{name:"check",mr:1})),react_1.default.createElement(core_1.Box,{flex:1},item.label),react_1.default.createElement(core_1.Box,{textAlign:"right",color:"gray.500"},item.sample))})),react_1.default.createElement(core_1.MenuDivider,{borderColor:borderColor}),constants_1.AVAILABLE_DATE_FORMATS.map((function(item,idx){return react_1.default.createElement(styled_1.MenuItem,{display:"flex",onClick:function onClick(){null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,item.value)},key:idx},react_1.default.createElement(core_1.Box,{width:"24px"},format===item.value&&!plaintext&&react_1.default.createElement(core_1.Icon,{name:"check",mr:1})),react_1.default.createElement(core_1.Box,{flex:1},item.label),react_1.default.createElement(core_1.Box,{textAlign:"right",color:"gray.500"},item.sample))})),react_1.default.createElement(core_1.MenuDivider,{borderColor:borderColor}),constants_1.AVAILABLE_CUSTOM_FORMATS.map((function(item,idx){return react_1.default.createElement(styled_1.MenuItem,{display:"flex",onClick:function onClick(){null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.CUSTOM_FORMAT,item.value)},key:idx},react_1.default.createElement(core_1.Box,{width:"24px"},format===item.value&&!plaintext&&react_1.default.createElement(core_1.Icon,{name:"check",mr:1})),react_1.default.createElement(core_1.Box,{flex:1},item.label),react_1.default.createElement(core_1.Box,{textAlign:"right",color:"gray.500"},item.sample))})))),react_1.default.createElement(styled_1.Separator,{borderColor:borderColor}),react_1.default.createElement(core_1.Menu,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.font,label:translations_1.translations.font},react_1.default.createElement(core_1.MenuButton,{paddingLeft:1,paddingRight:1,as:styled_1.Button,background:"none",fontSize:12,fontWeight:"normal",size:"sm",width:100,textAlign:"left",display:"flex",whiteSpace:"nowrap",minWidth:0,flexShrink:0,height:"28px",color:foregroundColor},react_1.default.createElement(core_1.Box,{whiteSpace:"nowrap",overflow:"hidden",flex:1,textOverflow:"ellipsis"},fontFamily),react_1.default.createElement(core_1.Icon,{name:"chevron-down",fontSize:16}))),react_1.default.createElement(core_1.MenuList,{placement:"top-start",borderColor:borderColor,borderStyle:"solid",fontSize:14},fontList.map((function(font,idx){return react_1.default.createElement(styled_1.MenuItem,{onClick:function onClick(){null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.FONT_FAMILY,font)},key:idx},react_1.default.createElement(core_1.Box,{width:"24px"},font===fontFamily&&react_1.default.createElement(core_1.Icon,{name:"check",mr:1})),font)})))),react_1.default.createElement(styled_1.Separator,{borderColor:borderColor}),react_1.default.createElement(Select_1.default,{id:"font-size",options:constants_1.FONT_SIZES.map((function(size){return{label:size,value:size}})),onChange:function onChange(item){null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.FONT_SIZE,null==item?void 0:item.value)},value:{value:fontSize,label:fontSize},format:function format(value){return parseInt(value)}}),react_1.default.createElement(styled_1.Separator,{borderColor:borderColor}),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.bold,label:translations_1.translations.bold},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.bold,variant:bold?"solid":"ghost",color:bold?activeIconColor:iconColor,icon:md_1.MdFormatBold,fontSize:20,size:"sm",height:"28px",onClick:function onClick(){return null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.BOLD,!bold)}})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.italic,label:translations_1.translations.italic},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.italic,variant:italic?"solid":"ghost",color:italic?activeIconColor:iconColor,icon:md_1.MdFormatItalic,fontSize:20,size:"sm",height:"28px",onClick:function onClick(){return null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.ITALIC,!italic)}})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.underline,label:translations_1.translations.underline},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.underline,variant:underline?"solid":"ghost",color:underline?activeIconColor:iconColor,icon:md_1.MdFormatUnderlined,fontSize:20,size:"sm",height:"28px",onClick:function onClick(){return null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.UNDERLINE,!underline)}})),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.strikethrough,label:translations_1.translations.strikethrough},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.strikethrough,variant:strike?"solid":"ghost",color:strike?activeIconColor:iconColor,icon:md_1.MdStrikethroughS,fontSize:20,size:"sm",height:"28px",onClick:function onClick(){return null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.STRIKE,!strike)}})),react_1.default.createElement(core_1.Popover,{usePortal:!0,placement:"top-start"},(function(_ref3){var onClose=_ref3.onClose;return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.text_color,label:translations_1.translations.text_color},react_1.default.createElement(styled_1.Button,{size:"sm",color:iconColor,variant:"ghost",p:0,w:8,flexDirection:"column","aria-label":translations_1.translations.text_color,background:"none",height:"28px"},react_1.default.createElement(md_1.MdTextFields,null),react_1.default.createElement(styled_1.Rect,{color:color}))))),react_1.default.createElement(styled_1.PopoverContent,{width:280,borderColor:borderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.PopoverBody,null,react_1.default.createElement(exports.ColorPicker,{color:color,onChange:function onChange(value){null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.COLOR,value),null==onClose||onClose()}}))))})),react_1.default.createElement(styled_1.Separator,{borderColor:borderColor}),react_1.default.createElement(core_1.Popover,{usePortal:!0,placement:"top-start"},(function(_ref4){var onClose=_ref4.onClose;return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.fill_color,label:translations_1.translations.fill_color},react_1.default.createElement(styled_1.Button,{size:"sm",color:iconColor,variant:"ghost",p:0,w:8,flexDirection:"column","aria-label":translations_1.translations.fill_color,background:"none",height:"28px"},react_1.default.createElement(io_1.IoMdColorFill,null),react_1.default.createElement(styled_1.Rect,{color:fill}))))),react_1.default.createElement(styled_1.PopoverContent,{width:280,borderColor:borderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.PopoverBody,null,react_1.default.createElement(exports.ColorPicker,{color:fill,onChange:function onChange(value){null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.FILL,value),null==onClose||onClose()}}))))})),react_1.default.createElement(BorderSelection,{onBorderChange:onBorderChange,iconColor:iconColor,activeIconColor:activeIconColor,isLight:isLight}),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.merge_cells,label:translations_1.translations.merge_cells},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.merge_cells,variant:"ghost",color:iconColor,icon:styled_1.MergeCellsIcon,fontSize:20,size:"sm",height:"28px",onClick:function onClick(){return null==onMergeCells?void 0:onMergeCells()}})),react_1.default.createElement(core_1.Popover,{usePortal:!0,placement:"top-start"},(function(){return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.freeze,label:translations_1.translations.freeze},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.freeze,variant:"ghost",color:iconColor,icon:bs_1.BsColumns,fontSize:20,size:"sm",height:"28px"})))),react_1.default.createElement(styled_1.PopoverContent,{width:220,borderColor:borderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.PopoverBody,{color:foregroundColor},react_1.default.createElement(core_1.FormControl,{mb:1},react_1.default.createElement(core_1.FormLabel,{fontSize:14},translations_1.translations.freeze_rows),react_1.default.createElement(core_1.Select,{size:"sm",value:frozenRows,onChange:function onChange(e){return null==onFrozenRowChange?void 0:onFrozenRowChange(Number(e.target.value))},borderColor:isLight?theme.colors.gray[300]:"rgba(255,255,255,0.04)"},Array.from({length:11}).map((function(_,idx){return react_1.default.createElement("option",{value:idx,key:idx},idx)})))),react_1.default.createElement(core_1.FormControl,{mb:1},react_1.default.createElement(core_1.FormLabel,{fontSize:14},translations_1.translations.freeze_columns),react_1.default.createElement(core_1.Select,{size:"sm",value:frozenColumns,onChange:function onChange(e){return null==onFrozenColumnChange?void 0:onFrozenColumnChange(Number(e.target.value))},borderColor:isLight?theme.colors.gray[300]:"rgba(255,255,255,0.04)"},Array.from({length:11}).map((function(_,idx){return react_1.default.createElement("option",{value:idx,key:idx},idx)})))))))})),react_1.default.createElement(styled_1.Separator,{borderColor:borderColor}),react_1.default.createElement(core_1.Popover,{usePortal:!0,placement:"top-start"},(function(){return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.horizontal_align,label:translations_1.translations.horizontal_align},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.horizontal_align,variant:"ghost",color:iconColor,icon:md_1.MdFormatAlignLeft,fontSize:20,size:"sm",height:"28px"})))),react_1.default.createElement(styled_1.PopoverContent,{width:"auto",borderColor:borderColor,borderStyle:"solid",placement:"bottom-start"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.Box,{display:"flex"},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.horizontal_align,variant:"left"===horizontalAlign?"solid":"ghost",color:"left"===horizontalAlign?activeIconColor:iconColor,onClick:function onClick(){return null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.HORIZONTAL_ALIGN,"left")},icon:md_1.MdFormatAlignLeft,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.horizontal_align,variant:"center"===horizontalAlign?"solid":"ghost",color:"center"===horizontalAlign?activeIconColor:iconColor,onClick:function onClick(){return null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.HORIZONTAL_ALIGN,"center")},icon:md_1.MdFormatAlignCenter,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.horizontal_align,variant:"right"===horizontalAlign?"solid":"ghost",color:"right"===horizontalAlign?activeIconColor:iconColor,onClick:function onClick(){return null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.HORIZONTAL_ALIGN,"right")},icon:md_1.MdFormatAlignRight,fontSize:20,size:"sm"}))))})),react_1.default.createElement(core_1.Popover,{usePortal:!0,placement:"top-start"},(function(){return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.vertical_align,label:translations_1.translations.vertical_align},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.vertical_align,variant:"ghost",color:iconColor,icon:md_1.MdVerticalAlignBottom,fontSize:20,size:"sm",height:"28px"})))),react_1.default.createElement(styled_1.PopoverContent,{width:"auto",borderColor:borderColor,borderStyle:"solid",placement:"bottom-start"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.Box,{display:"flex"},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.horizontal_align,variant:"top"===verticalAlign?"solid":"ghost",color:"top"===verticalAlign?activeIconColor:iconColor,icon:md_1.MdVerticalAlignTop,fontSize:20,size:"sm",onClick:function onClick(){return null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.VERTICAL_ALIGN,"top")}}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.horizontal_align,variant:"middle"===verticalAlign?"solid":"ghost",color:"middle"===verticalAlign?activeIconColor:iconColor,icon:md_1.MdVerticalAlignCenter,fontSize:20,size:"sm",onClick:function onClick(){return null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.VERTICAL_ALIGN,"middle")}}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.horizontal_align,variant:"bottom"===verticalAlign?"solid":"ghost",color:"bottom"===verticalAlign?activeIconColor:iconColor,icon:md_1.MdVerticalAlignBottom,fontSize:20,size:"sm",onClick:function onClick(){return null==onFormattingChange?void 0:onFormattingChange(types_1.FORMATTING_TYPE.VERTICAL_ALIGN,"bottom")}}))))})),react_1.default.createElement(core_1.Popover,{usePortal:!0,placement:"top-start"},(function(_ref5){var onClose=_ref5.onClose;return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.text_wrapping,label:translations_1.translations.text_wrapping},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.text_wrapping,variant:"ghost",color:iconColor,icon:"clip"===wrap?styled_1.WrapClipIcon:styled_1.WrapIcon,fontSize:20,size:"sm",height:"28px"})))),react_1.default.createElement(styled_1.PopoverContent,{width:"auto",borderColor:borderColor,borderStyle:"solid",placement:"bottom-start"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.Box,{display:"flex"},react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.text_clip,label:translations_1.translations.text_clip},react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.text_clip,variant:"clip"===wrap?"solid":"ghost",color:"clip"===wrap?activeIconColor:iconColor,icon:styled_1.WrapClipIcon,fontSize:20,size:"sm",onClick:function onClick(){null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.WRAP,"clip"),null==onClose||onClose()}}))),react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.text_wrap,label:translations_1.translations.text_wrap},react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.text_wrap,variant:"wrap"===wrap?"solid":"ghost",color:"wrap"===wrap?activeIconColor:iconColor,icon:styled_1.WrapIcon,fontSize:20,size:"sm",onClick:function onClick(){null==onFormattingChange||onFormattingChange(types_1.FORMATTING_TYPE.WRAP,"wrap"),null==onClose||onClose()}}))))))}))),react_1.default.createElement(core_1.Flex,{alignItems:"flex-end"},enableDarkMode&&react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":isLight?translations_1.translations.switch_dark_mode:translations_1.translations.switch_light_mode,label:isLight?translations_1.translations.switch_dark_mode:translations_1.translations.switch_light_mode},react_1.default.createElement(styled_1.IconButton,{"aria-label":isLight?translations_1.translations.switch_dark_mode:translations_1.translations.switch_light_mode,variant:"ghost",color:iconColor,icon:isLight?io_1.IoMdMoon:md_1.MdWbSunny,fontSize:20,size:"sm",onClick:toggleColorMode}))))})),BorderSelection=function BorderSelection(_ref6){var iconColor=_ref6.iconColor,activeIconColor=_ref6.activeIconColor,onBorderChange=_ref6.onBorderChange,isLight=_ref6.isLight,_react_1$useState2=_slicedToArray(react_1.useState("#000000"),2),borderColor=_react_1$useState2[0],setBorderColor=_react_1$useState2[1],_react_1$useState4=_slicedToArray(react_1.useState(),2),borderVariant=_react_1$useState4[0],setBorderVariant=_react_1$useState4[1],_react_1$useState6=_slicedToArray(react_1.useState("thin"),2),borderStyle=_react_1$useState6[0],setBorderStyle=_react_1$useState6[1],theme=core_1.useTheme(),handleChangeVariant=function handleChangeVariant(value){setBorderVariant(value),null==onBorderChange||onBorderChange(borderColor,borderStyle,value)},handleChangeBorderStyle=function handleChangeBorderStyle(value){setBorderStyle(value)},bgColor=isLight?theme.colors.gray[100]:theme.colors.gray[600],contentBorderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600];return react_1.default.createElement(core_1.Popover,{usePortal:!0,placement:"auto-start",onClose:function onClose(){setBorderVariant(void 0)}},react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.borders,label:translations_1.translations.borders,placement:"bottom-start"},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.borders,variant:"ghost",color:iconColor,icon:md_1.MdBorderAll,fontSize:20,size:"sm"})))),react_1.default.createElement(styled_1.PopoverContent,{width:230,borderColor:contentBorderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.Box,{display:"flex"},react_1.default.createElement(core_1.Box,{flex:1,display:"flex",p:2,flexWrap:"wrap",width:180},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_all,background:"all"===borderVariant?bgColor:"none",variant:"all"===borderVariant?"solid":"ghost",color:"all"===borderVariant?activeIconColor:iconColor,onClick:function onClick(){return handleChangeVariant("all")},icon:md_1.MdBorderAll,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_inner,background:"inner"===borderVariant?bgColor:"none",variant:"inner"===borderVariant?"solid":"ghost",color:"inner"===borderVariant?activeIconColor:iconColor,onClick:function onClick(){return handleChangeVariant("inner")},icon:md_1.MdBorderInner,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_horizontal,background:"horizontal"===borderVariant?bgColor:"none",variant:"horizontal"===borderVariant?"solid":"ghost",color:"horizontal"===borderVariant?activeIconColor:iconColor,onClick:function onClick(){return handleChangeVariant("horizontal")},icon:md_1.MdBorderHorizontal,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_vertical,background:"vertical"===borderVariant?bgColor:"none",variant:"vertical"===borderVariant?"solid":"ghost",color:"vertical"===borderVariant?activeIconColor:iconColor,onClick:function onClick(){return handleChangeVariant("vertical")},icon:md_1.MdBorderVertical,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_outer,background:"outer"===borderVariant?bgColor:"none",variant:"outer"===borderVariant?"solid":"ghost",color:"outer"===borderVariant?activeIconColor:iconColor,onClick:function onClick(){return handleChangeVariant("outer")},icon:md_1.MdBorderOuter,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_left,background:"left"===borderVariant?bgColor:"none",variant:"left"===borderVariant?"solid":"ghost",color:"left"===borderVariant?activeIconColor:iconColor,onClick:function onClick(){return handleChangeVariant("left")},icon:md_1.MdBorderLeft,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_right,background:"right"===borderVariant?bgColor:"none",variant:"right"===borderVariant?"solid":"ghost",color:"right"===borderVariant?activeIconColor:iconColor,onClick:function onClick(){return handleChangeVariant("right")},icon:md_1.MdBorderRight,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_top,background:"top"===borderVariant?bgColor:"none",variant:"top"===borderVariant?"solid":"ghost",color:"top"===borderVariant?activeIconColor:iconColor,onClick:function onClick(){return handleChangeVariant("top")},icon:md_1.MdBorderTop,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_bottom,background:"bottom"===borderVariant?bgColor:"none",variant:"bottom"===borderVariant?"solid":"ghost",color:"bottom"===borderVariant?activeIconColor:iconColor,onClick:function onClick(){return handleChangeVariant("bottom")},icon:md_1.MdBorderBottom,fontSize:20,size:"sm"}),react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_none,background:"none"===borderVariant?bgColor:"none",variant:"none"===borderVariant?"solid":"ghost",color:"none"===borderVariant?activeIconColor:iconColor,onClick:function onClick(){return handleChangeVariant("none")},icon:md_1.MdBorderClear,fontSize:20,size:"sm"})),react_1.default.createElement(core_1.Box,{p:2,borderLeft:bgColor,borderLeftWidth:1,borderLeftStyle:"solid",flexDirection:"column",display:"flex"},react_1.default.createElement(core_1.Popover,{placement:"top-start"},(function(_ref7){var onClose=_ref7.onClose;return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.border_color,label:translations_1.translations.border_color},react_1.default.createElement(styled_1.Button,{size:"sm",color:iconColor,variant:"ghost",pl:0,pr:0,flexDirection:"column","aria-label":translations_1.translations.border_color,background:"none"},react_1.default.createElement(md_1.MdEdit,null),react_1.default.createElement(styled_1.Rect,{color:borderColor}))))),react_1.default.createElement(styled_1.PopoverContent,{zIndex:1,width:280,borderColor:contentBorderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.PopoverBody,null,react_1.default.createElement(exports.ColorPicker,{color:borderColor,onChange:function onChange(value){!function handleChangeColor(value){setBorderColor(value)}(value),null==onClose||onClose()},resetLabel:"No borders"}))))})),react_1.default.createElement(core_1.Popover,{placement:"top-start"},(function(_ref8){var onClose=_ref8.onClose;return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.PopoverTrigger,null,react_1.default.createElement(core_1.Box,null,react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":translations_1.translations.border_style,label:translations_1.translations.border_style},react_1.default.createElement(styled_1.IconButton,{"aria-label":translations_1.translations.border_style,variant:"ghost",color:iconColor,icon:md_1.MdLineStyle,fontSize:20,size:"sm"})))),react_1.default.createElement(styled_1.PopoverContent,{width:100,borderColor:contentBorderColor,borderStyle:"solid"},react_1.default.createElement(core_1.PopoverArrow,null),react_1.default.createElement(core_1.PopoverBody,null,react_1.default.createElement(styled_1.Button,{background:"thin"===borderStyle?bgColor:"none",variant:"thin"===borderStyle?"solid":"ghost",color:"thin"===borderStyle?activeIconColor:iconColor,size:"sm",onClick:function onClick(){handleChangeBorderStyle("thin"),null==onClose||onClose()}},react_1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"1",style:{userSelect:"none"}},react_1.default.createElement("line",{x1:"0",y1:"0.5",x2:"50",y2:"0.5",strokeWidth:"1",stroke:"black",style:{userSelect:"none"}}))),react_1.default.createElement(styled_1.Button,{background:"medium"===borderStyle?bgColor:"none",variant:"medium"===borderStyle?"solid":"ghost",color:"medium"===borderStyle?activeIconColor:iconColor,size:"sm",onClick:function onClick(){handleChangeBorderStyle("medium"),null==onClose||onClose()}},react_1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"2",style:{userSelect:"none"}},react_1.default.createElement("line",{x1:"0",y1:"1.0",x2:"50",y2:"1.0",strokeWidth:"2",stroke:"black",style:{userSelect:"none"}}))),react_1.default.createElement(styled_1.Button,{background:"thick"===borderStyle?bgColor:"none",variant:"thick"===borderStyle?"solid":"ghost",color:"thick"===borderStyle?activeIconColor:iconColor,size:"sm",onClick:function onClick(){handleChangeBorderStyle("thick"),null==onClose||onClose()}},react_1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"3",style:{userSelect:"none"}},react_1.default.createElement("line",{x1:"0",y1:"1.5",x2:"50",y2:"1.5",strokeWidth:"3",stroke:"black",style:{userSelect:"none"}}))),react_1.default.createElement(styled_1.Button,{background:"dashed"===borderStyle?bgColor:"none",variant:"dashed"===borderStyle?"solid":"ghost",color:"dashed"===borderStyle?activeIconColor:iconColor,size:"sm",onClick:function onClick(){handleChangeBorderStyle("dashed"),null==onClose||onClose()}},react_1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"1",style:{userSelect:"none"}},react_1.default.createElement("line",{x1:"0",y1:"0.5",x2:"50",y2:"0.5",strokeWidth:"1",stroke:"black",strokeDasharray:"2",style:{userSelect:"none"}}))),react_1.default.createElement(styled_1.Button,{background:"dotted"===borderStyle?bgColor:"none",variant:"dotted"===borderStyle?"solid":"ghost",color:"dotted"===borderStyle?activeIconColor:iconColor,size:"sm",onClick:function onClick(){handleChangeBorderStyle("dotted"),null==onClose||onClose()}},react_1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"1",style:{userSelect:"none"}},react_1.default.createElement("line",{x1:"0",y1:"0.5",x2:"50",y2:"0.5",strokeWidth:"1",stroke:"black",strokeDasharray:"1",style:{userSelect:"none"}}))))))}))))))};exports.default=Toolbar},441:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8),Object.defineProperty(exports,"__esModule",{value:!0}),exports.translations=void 0,exports.translations={undo:"Undo",redo:"Redo",print:"Print",format_as_currency:"Format as currency",format_as_percent:"Format as percent",decrease_decimal:"Decrease decimal places",increase_decimal:"Increase decimal places",bold:"Bold",italic:"Italic",underline:"Underline",text_color:"Text color",fill_color:"Fill color",strikethrough:"Strikethrough",borders:"Borders",border_all:"All borders",border_inner:"Inner border",border_horizontal:"Horizontal border",border_vertical:"Vertical border",border_outer:"Outer border",border_left:"Left border",border_right:"Right border",border_bottom:"Bottom border",border_top:"Top border",border_none:"Clear borders",border_color:"Border color",border_style:"Border style",merge_cells:"Merge cells",freeze:"Freeze rows and columns",freeze_rows:"Freeze rows",freeze_columns:"Freeze columns",horizontal_align:"Horizontal align",vertical_align:"Vertical align",switch_light_mode:"Switch to light mode",switch_dark_mode:"Switch to dark mode",clear_formatting:"Clear formatting",add_sheet:"Add sheet",all_sheets:"All sheets",text_wrapping:"Text wrapping",text_wrap:"Wrap",text_clip:"Clip",more_formats:"More formats",zoom:"Zoom",font:"Font"}},455:function(module,exports,__webpack_require__){"use strict";__webpack_require__(49),__webpack_require__(18),__webpack_require__(33),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),styled_1=__webpack_require__(120),core_1=__webpack_require__(62),constants_1=__webpack_require__(56),types_1=__webpack_require__(97),useShiftDown_1=__importDefault(__webpack_require__(456)),Select=react_1.memo((function(props){var options=props.options,value=props.value,_onChange=props.onChange,format=props.format,_props$inputWidth=props.inputWidth,inputWidth=void 0===_props$inputWidth?44:_props$inputWidth,_props$enableInput=props.enableInput,enableInput=void 0===_props$enableInput||_props$enableInput,theme=(props.id,core_1.useTheme()),isLight="light"===core_1.useColorMode().colorMode,borderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600],inputBorderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600],inputBgColor=isLight?theme.colors.white:constants_1.DARK_MODE_COLOR,inputColor=isLight?constants_1.DARK_MODE_COLOR:theme.colors.white,dropdownBgColor=isLight?theme.colors.white:theme.colors.gray[700],_useShiftDown_1$defau=useShiftDown_1.default({limit:100,options:options,filter:function filter(){return!0},selectedItem:value,onChange:function onChange(sel){return null==_onChange?void 0:_onChange(sel)},itemToString:function itemToString(item){var _a;return(null===(_a=item)||void 0===_a?void 0:_a.value.toString())||""}}),menuRef=_useShiftDown_1$defau.menuRef,inputRef=_useShiftDown_1$defau.inputRef,inputValue=_useShiftDown_1$defau.inputValue,items=_useShiftDown_1$defau.items,setInputValue=_useShiftDown_1$defau.setInputValue,onShiftDownKeyDown=_useShiftDown_1$defau.onKeyDown,setSelectedItem=_useShiftDown_1$defau.setSelectedItem,isOpen=_useShiftDown_1$defau.isOpen,onFocus=_useShiftDown_1$defau.onFocus,onBlur=_useShiftDown_1$defau.onBlur,closeMenu=_useShiftDown_1$defau.closeMenu,toggleMenu=_useShiftDown_1$defau.toggleMenu,highlightedIndex=_useShiftDown_1$defau.highlightedIndex,selectedItem=_useShiftDown_1$defau.selectedItem,onMouseDown=_useShiftDown_1$defau.onMouseDown,_onMouseMove=_useShiftDown_1$defau.onMouseMove,_onClick=_useShiftDown_1$defau.onClick;return react_1.default.createElement(core_1.Box,{position:"relative",ref:menuRef},react_1.default.createElement(core_1.Box,{display:"flex",alignItems:"center"},enableInput?react_1.default.createElement("input",{value:inputValue,ref:inputRef,style:{width:inputWidth,height:24,paddingLeft:4,paddingRight:2,borderColor:inputBorderColor,background:inputBgColor,color:inputColor,borderStyle:"solid",borderWidth:1,fontSize:12},onChange:function onChange(e){setInputValue(e.target.value)},onKeyDown:function onKeyDown(e){if(onShiftDownKeyDown&&onShiftDownKeyDown(e),e.which===types_1.KeyCodes.Enter&&null===highlightedIndex){var _value=null==format?void 0:format(e.currentTarget.value);null==setSelectedItem||setSelectedItem({value:_value,label:_value}),closeMenu()}},onFocus:onFocus,onBlur:onBlur,"aria-label":"select-input"}):react_1.default.createElement(styled_1.Tooltip,{hasArrow:!0,"aria-label":inputValue||"",label:inputValue||"",placement:"bottom-start"},react_1.default.createElement(core_1.Box,{cursor:"pointer",pl:2,pr:2,title:inputValue,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontSize:12,width:inputWidth},inputValue)),react_1.default.createElement(styled_1.IconButton,{color:inputColor,height:5,minWidth:5,"aria-label":"Open",icon:"chevron-down",size:"sm",fontSize:16,onClick:toggleMenu})),react_1.default.createElement(core_1.Box,{background:dropdownBgColor,shadow:"md",position:"absolute",top:"100%",zIndex:1,borderRadius:5,pb:1,pt:1,borderColor:borderColor,borderStyle:"solid",borderWidth:1,display:isOpen?"block":"none","aria-label":"list"},isOpen&&items.map((function(item,index){var _a,_b,label=item.label;item.value;return react_1.default.createElement(core_1.Box,{fontSize:12,padding:2,pl:3,pr:3,key:index,whiteSpace:"nowrap",onMouseMove:function onMouseMove(){return null==_onMouseMove?void 0:_onMouseMove(index)},onMouseDown:onMouseDown,onClick:function onClick(){_onClick(item),closeMenu()},style:{cursor:"pointer",backgroundColor:highlightedIndex===index||(null===(_a=selectedItem)||void 0===_a?void 0:_a.value)===item.value?isLight?theme.colors.gray[100]:"rgba(255,255,255,0.06)":dropdownBgColor,fontWeight:(null===(_b=selectedItem)||void 0===_b?void 0:_b.value)===item.value?"bold":"normal"}},label)}))))}));exports.default=Select},456:function(module,exports,__webpack_require__){"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(55),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(8),__webpack_require__(10),__webpack_require__(208),__webpack_require__(45),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21),Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(1),grid_1=__webpack_require__(7),constants_1=__webpack_require__(56),defaultItemToString=function defaultItemToString(text){return text};exports.default=function useShiftDown(props){var _a,_props$initialInputVa=props.initialInputValue,initialInputValue=void 0===_props$initialInputVa?"":_props$initialInputVa,_props$initialIsOpen=props.initialIsOpen,initialIsOpen=void 0!==_props$initialIsOpen&&_props$initialIsOpen,initialSelectedItem=props.initialSelectedItem,_props$showAllIfEmpty=props.showAllIfEmpty,showAllIfEmpty=void 0===_props$showAllIfEmpty||_props$showAllIfEmpty,_props$options=props.options,options=void 0===_props$options?[]:_props$options,_props$filterOnInitia=props.filterOnInitialOpen,filterOnInitialOpen=void 0!==_props$filterOnInitia&&_props$filterOnInitia,_props$itemToString=props.itemToString,itemToString=void 0===_props$itemToString?defaultItemToString:_props$itemToString,onChange=props.onChange,filter=props.filter,_props$defaultHighlig=props.defaultHighlightedIndex,defaultHighlightedIndex=void 0===_props$defaultHighlig?null:_props$defaultHighlig,controlledSelecteditem=props.selectedItem,_props$limit=props.limit,limit=void 0===_props$limit?10:_props$limit,isControlled=react_1.useRef(void 0!==controlledSelecteditem).current,_react_1$useState2=_slicedToArray(react_1.useState(defaultHighlightedIndex),2),highlightedIndex=_react_1$useState2[0],setHighlightedIndex=_react_1$useState2[1],_react_1$useState4=_slicedToArray(react_1.useState(initialIsOpen),2),isOpen=_react_1$useState4[0],setIsOpen=_react_1$useState4[1],_react_1$useState6=_slicedToArray(react_1.useState(null!==(_a=grid_1.castToString(initialInputValue))&&void 0!==_a?_a:""),2),inputValue=_react_1$useState6[0],setInputValue=_react_1$useState6[1],_react_1$useState8=_slicedToArray(react_1.useState(initialSelectedItem),2),selectedItem=_react_1$useState8[0],setSelectedItem=_react_1$useState8[1],menuRef=react_1.useRef(null),inputRef=react_1.useRef(null),isDirty=react_1.useRef(!1),handleSetSelectedItem=function handleSetSelectedItem(item){null==onChange||onChange(item),setSelectedItem(item),handleSetInputValue(itemToString(null!=item?item:""))};react_1.useEffect((function(){isControlled&&controlledSelecteditem!==selectedItem&&handleSetInputValue(itemToString(null!=controlledSelecteditem?controlledSelecteditem:""))}),[isControlled,controlledSelecteditem,selectedItem]);var filteredItems=react_1.useMemo((function(){return inputValue||showAllIfEmpty?options.filter((function(item){if(!inputValue||!isDirty.current&&!filterOnInitialOpen)return!0;if(filter)return filter(item);var key="object"===_typeof(item)?item.value||item.label:item;return new RegExp("^"+constants_1.escapeRegExp(inputValue),"gi").test(key)})).slice(0,limit):[]}),[inputValue,options,filter,showAllIfEmpty]),handleKeyDown=react_1.useCallback((function(e){var _a,_b,keyCode=e.nativeEvent.which;if((keyCode===grid_1.KeyCodes.Up||keyCode===grid_1.KeyCodes.Down)&&!isOpen)return openMenu();keyCode===grid_1.KeyCodes.Up?(setHighlightedIndex((function(prev){var next=null===prev?filteredItems.length-1:prev-1;return next<0?filteredItems.length-1:next})),null===(_a=null==e?void 0:e.preventDefault)||void 0===_a||_a.call(e)):keyCode===grid_1.KeyCodes.Down&&(setHighlightedIndex((function(prev){var next=null===prev?0:prev+1;return next>filteredItems.length-1?0:next})),null===(_b=null==e?void 0:e.preventDefault)||void 0===_b||_b.call(e)),keyCode===grid_1.KeyCodes.Escape&&closeMenu(),keyCode!==grid_1.KeyCodes.Enter&&keyCode!==grid_1.KeyCodes.Tab||null!==highlightedIndex&&handleSetSelectedItem(filteredItems[highlightedIndex])}),[filteredItems,highlightedIndex,isOpen]);react_1.useEffect((function(){var listener=function listener(event){menuRef&&menuRef.current&&!menuRef.current.contains(event.target)&&closeMenu()};return document.addEventListener("mouseup",listener),function(){document.removeEventListener("mouseup",listener)}}),[menuRef]);var handleMouseMove=react_1.useCallback((function(index){index!==highlightedIndex&&setHighlightedIndex(index)}),[highlightedIndex]),handleMouseDown=react_1.useCallback((function(event){event.preventDefault()}),[]),handleSetInputValue=react_1.useCallback((function(value){setInputValue(value),setHighlightedIndex(defaultHighlightedIndex),isDirty.current=!0}),[defaultHighlightedIndex]),closeMenu=react_1.useCallback((function(){setIsOpen(!1)}),[]),openMenu=react_1.useCallback((function(){setIsOpen(!0)}),[]),toggleMenu=react_1.useCallback((function(){setIsOpen((function(prev){return!prev}))}),[]),handleFocus=react_1.useCallback((function(){openMenu()}),[]),handleBlur=react_1.useCallback((function(){closeMenu()}),[]);return react_1.useEffect((function(){var _a;isOpen&&(null===(_a=inputRef.current)||void 0===_a||_a.focus())}),[isOpen]),react_1.useEffect((function(){}),[inputValue]),{highlightedIndex:highlightedIndex,onKeyDown:handleKeyDown,inputValue:inputValue,setInputValue:handleSetInputValue,isOpen:isOpen,openMenu:openMenu,closeMenu:closeMenu,toggleMenu:toggleMenu,menuRef:menuRef,inputRef:inputRef,selectedItem:selectedItem,setSelectedItem:handleSetSelectedItem,items:filteredItems,onMouseMove:handleMouseMove,onMouseDown:handleMouseDown,onClick:handleSetSelectedItem,onFocus:handleFocus,onBlur:handleBlur}}},457:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(47),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(163),__webpack_require__(49),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(33),__webpack_require__(8),__webpack_require__(10),__webpack_require__(45),__webpack_require__(19),__webpack_require__(16),__webpack_require__(88),__webpack_require__(118),__webpack_require__(48),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),slate_1=__webpack_require__(6),slate_react_1=__webpack_require__(1053),slate_history_1=__webpack_require__(1055),grid_1=__webpack_require__(7),useShiftDown_1=__importDefault(__webpack_require__(456)),core_1=__webpack_require__(62),constants_1=__webpack_require__(56),helpers_1=__webpack_require__(209),types_1=__webpack_require__(121),Leaf=function Leaf(_ref){var attributes=_ref.attributes,children=_ref.children,leaf=_ref.leaf;return react_1.default.createElement("span",Object.assign({},attributes,{className:leaf.cursor?"insert-range-indicator":void 0,style:{color:leaf.color}}),children)},TextEditor=react_1.memo(react_1.forwardRef((function(props,forwardedRef){var _a,initialValue=props.value,onFocus=props.onFocus,onBlur=props.onBlur,onChange=props.onChange,onSubmit=props.onSubmit,onCancel=props.onCancel,fontFamily=props.fontFamily,fontSize=props.fontSize,bold=props.bold,_props$scale=props.scale,scale=void 0===_props$scale?1:_props$scale,color=props.color,_props$lineHeight=props.lineHeight,lineHeight=void 0===_props$lineHeight?"normal":_props$lineHeight,horizontalAlign=props.horizontalAlign,underline=props.underline,onKeyDown=props.onKeyDown,options=props.options,isFormulaMode=props.isFormulaMode,autoFocus=props.autoFocus,_props$supportedFormu=props.supportedFormulas,supportedFormulas=void 0===_props$supportedFormu?[]:_props$supportedFormu,onFormulaChange=props.onFormulaChange,_props$tearDown=props.tearDown,tearDown=void 0!==_props$tearDown&&_props$tearDown,disabled=props.disabled,serialize=react_1.useCallback((function(value){var _a;return(null!==(_a=grid_1.castToString(value))&&void 0!==_a?_a:"").split("\n").map((function(line){return{children:[{text:line}]}}))}),[isFormulaMode]),deserialize=react_1.useCallback((function(value){return value.map((function(element){return element.children.map((function(leaf){return leaf.text})).join("")})).join("\n")}),[]),_react_1$useState2=_slicedToArray(react_1.useState(),2),suggestionToken=_react_1$useState2[0],setSuggestionToken=_react_1$useState2[1],_react_1$useState4=_slicedToArray(react_1.useState(),2),cursorToken=_react_1$useState4[0],setCursorSuggestionToken=_react_1$useState4[1],value=react_1.useMemo((function(){return serialize(initialValue)}),[initialValue]),_react_1$useState6=_slicedToArray(react_1.useState(),2),target=_react_1$useState6[0],setTarget=_react_1$useState6[1],handleUpdateSelection=react_1.useCallback((function(sheetName,sel,mode){var cellAddress=helpers_1.selectionToAddress(sel);if(cellAddress){var address="".concat(sheetName?sheetName+"!":"").concat(cellAddress),start=helpers_1.getCurrentCursorOffset(editor);"modify"===mode&&target&&start&&slate_1.Transforms.delete(editor,{at:start,distance:target.image.length,reverse:!0}),"append"===mode&&helpers_1.isTokenACell(target)&&slate_1.Transforms.insertNodes(editor,[{text:","}]),address&&(slate_1.Transforms.insertNodes(editor,[{text:address}]),focusEditor())}}),[target,cursorToken]);react_1.useImperativeHandle(forwardedRef,(function(){return{focus:focusEditor,editor:editor,updateSelection:handleUpdateSelection}}),[target,cursorToken]);var editor=react_1.useMemo((function(){return slate_history_1.withHistory(slate_react_1.withReact(slate_1.createEditor()))}),[]),focusEditor=react_1.useCallback((function(){slate_react_1.ReactEditor.focus(editor)}),[editor]),moveToEnd=react_1.useCallback((function(){focusEditor();try{if(!grid_1.canUseDOM)return;if(document.activeElement){var range=document.createRange();range.selectNodeContents(document.activeElement),range.collapse(!1);var selection=window.getSelection();selection&&(selection.removeAllRanges(),selection.addRange(range))}}catch(err){console.log("Failed to collapse selection",err)}}),[]);react_1.useEffect((function(){autoFocus&&requestAnimationFrame(moveToEnd)}),[]);var _useShiftDown_1$defau=useShiftDown_1.default({showAllIfEmpty:!isFormulaMode,defaultHighlightedIndex:isFormulaMode?0:null,initialInputValue:isFormulaMode?"":initialValue,initialIsOpen:!isFormulaMode&&(null!==(_a=null==options?void 0:options.length)&&void 0!==_a?_a:0)>0,initialSelectedItem:initialValue,options:isFormulaMode?supportedFormulas:options,onChange:function onChange(item){var _a;if(isFormulaMode&&void 0!==item){var text=null==suggestionToken?void 0:suggestionToken.image,start=helpers_1.getCurrentCursorOffset(editor);if(!start)return;var startToken=Object.assign({},start,{offset:null!==(_a=null==suggestionToken?void 0:suggestionToken.startOffset)&&void 0!==_a?_a:0});start&&(slate_1.Transforms.delete(editor,{at:startToken,distance:null==text?void 0:text.length}),slate_1.Transforms.insertNodes(editor,[{text:"".concat(item,"(")}]))}else null==onSubmit||onSubmit(item)}}),highlightedIndex=_useShiftDown_1$defau.highlightedIndex,onShiftDownKeyDown=_useShiftDown_1$defau.onKeyDown,setInputValue=_useShiftDown_1$defau.setInputValue,menuRef=_useShiftDown_1$defau.menuRef,selectedItem=_useShiftDown_1$defau.selectedItem,items=_useShiftDown_1$defau.items,closeMenu=_useShiftDown_1$defau.closeMenu,_onMouseMove=_useShiftDown_1$defau.onMouseMove,onMouseDown=_useShiftDown_1$defau.onMouseDown,_onClick=_useShiftDown_1$defau.onClick,isOpen=_useShiftDown_1$defau.isOpen,openMenu=_useShiftDown_1$defau.openMenu;react_1.useEffect((function(){target&&items.length>0?openMenu():closeMenu()}),[items,target]);var decorate=react_1.useCallback((function(entry){if(!isFormulaMode)return[];var prevToken,ranges=[],_entry=_slicedToArray(entry,2),node=_entry[0],path=_entry[1],text=node.text,offset=0,tokens=helpers_1.normalizeTokens(text);return cursorToken&&tokens.length&&cursorToken.path[0]===path[0]&&ranges.push({anchor:{path:path,offset:cursorToken.offset},focus:{path:path,offset:cursorToken.offset},cursor:!0}),tokens.forEach((function(token){var _a,add=token.startOffset-(null!==(_a=null==prevToken?void 0:prevToken.endColumn)&&void 0!==_a?_a:0);ranges.push({anchor:{path:path,offset:offset+token.image.length+add},focus:{path:path,offset:offset},selection:!!token.sel,color:void 0!==(null==token?void 0:token.index)?helpers_1.getSelectionColorAtIndex(token.index):"String"===token.tokenType.name?"green":"Number"===token.tokenType.name?"#15c":void 0}),prevToken=token,offset=offset+token.image.length+add})),ranges}),[isFormulaMode,value,cursorToken]),theme=core_1.useTheme(),isLight="light"===core_1.useColorMode().colorMode,borderColor=isLight?theme.colors.gray[300]:theme.colors.gray[600],inputColor=isLight?constants_1.DARK_MODE_COLOR:theme.colors.white,dropdownBgColor=isLight?theme.colors.white:theme.colors.gray[700],handleChange=react_1.useCallback((function(value){var _a,text=deserialize(value);if(null==onChange||onChange(text),constants_1.isAFormula(text)){var start=helpers_1.getCurrentCursorOffset(editor);if(!start)return;var from=slate_1.Editor.before(editor,start,{unit:"line"}),end=slate_1.Editor.after(editor,start,{unit:"line"})||start;if(!from)return;var range=slate_1.Editor.range(editor,from,end),line=slate_1.Editor.string(editor,range),tokens=helpers_1.normalizeTokens(line),fnToken=helpers_1.functionSuggestion(tokens,editor),curToken=helpers_1.getCurrentToken(tokens,editor),showFnSuggestions=!!fnToken,showCellSuggestion=helpers_1.showCellSuggestions(editor,tokens),isCell=helpers_1.isCurrentPositionACell(editor,tokens),isTokenAtEdgeofCell=(null==curToken?void 0:curToken.endColumn)===start.offset;showFnSuggestions?(setSuggestionToken(fnToken),setInputValue(helpers_1.cleanFunctionToken(null!==(_a=null==fnToken?void 0:fnToken.image)&&void 0!==_a?_a:""))):(setSuggestionToken(void 0),setInputValue("")),setTarget(curToken),null==onFormulaChange||onFormulaChange({showCellSuggestion:!!showCellSuggestion||!!isCell&&isTokenAtEdgeofCell,newSelectionMode:showCellSuggestion?"append":"modify"}),setCursorSuggestionToken(showCellSuggestion?start:void 0)}}),[isFormulaMode]),prepareCloseEditor=react_1.useCallback((function(){tearDown&&slate_1.Transforms.deselect(editor)}),[editor,tearDown]),handleKeyDown=react_1.useCallback((function(e){var isShiftKey=e.nativeEvent.shiftKey,isMetaKey=e.nativeEvent.metaKey||e.nativeEvent.ctrlKey,isFromSelection=null!==highlightedIndex&&items.length>0,text=isFromSelection?items[highlightedIndex]:deserialize(value),isEnter=e.which===grid_1.KeyCodes.Enter,isTab=e.which===grid_1.KeyCodes.Tab;if(isEnter||isTab){if(e.preventDefault(),!isFormulaMode||!isFromSelection){if(e.preventDefault(),isMetaKey)return void editor.insertBreak();prepareCloseEditor();var dir=isEnter?isShiftKey?grid_1.Direction.Up:grid_1.Direction.Down:isShiftKey?grid_1.Direction.Left:grid_1.Direction.Right;return void(null==onSubmit||onSubmit(text,dir))}setInputValue("")}e.which===grid_1.KeyCodes.Escape&&(prepareCloseEditor(),onCancel&&onCancel(e)),null==onKeyDown||onKeyDown(e),onShiftDownKeyDown(e)}),[value,onKeyDown,onSubmit,onShiftDownKeyDown,items,isFormulaMode,highlightedIndex,isOpen]);return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement("div",{style:{fontFamily:isFormulaMode?constants_1.FORMULA_FONT:fontFamily,fontSize:(isFormulaMode?constants_1.FORMULA_FONT_SIZE:fontSize)*scale,fontWeight:bold&&!isFormulaMode?types_1.FONT_WEIGHT.BOLD:types_1.FONT_WEIGHT.NORMAL,width:"100%",height:"100%",padding:"0 1px",margin:0,boxSizing:"border-box",borderWidth:0,outline:"none",resize:"none",overflow:"auto",verticalAlign:"top",background:"transparent",color:color,whiteSpace:"pre-wrap",textAlign:isFormulaMode?"left":horizontalAlign,lineHeight:lineHeight,textDecoration:underline?"underline":"none",cursor:"text",flex:1,display:"flex"}},react_1.default.createElement(slate_react_1.Slate,{editor:editor,value:value,onChange:handleChange},react_1.default.createElement(slate_react_1.Editable,{readOnly:disabled,decorate:decorate,renderLeaf:function renderLeaf(props){return react_1.default.createElement(Leaf,Object.assign({},props))},onKeyDown:handleKeyDown,onFocus:onFocus,onBlur:onBlur,style:{flex:1}}))),isOpen&&items.length?react_1.default.createElement(core_1.Box,{ref:menuRef,width:isFormulaMode?320:"calc(100% + 4px)",left:"-2px",shadow:"md",background:dropdownBgColor,pb:1,pt:1,position:"absolute",top:"100%",mt:"2px",borderColor:borderColor,borderStyle:"solid",borderWidth:1,maxHeight:400,overflow:"auto",zIndex:1,borderRadius:4},items.map((function(item,index){return react_1.default.createElement(core_1.Box,{padding:1,pl:isFormulaMode?"10px":1,pr:1,whiteSpace:"nowrap",color:inputColor,cursor:"pointer",fontFamily:isFormulaMode?constants_1.FORMULA_FONT:fontFamily,fontSize:"".concat((isFormulaMode?constants_1.FORMULA_FONT_SIZE:12)*scale,"px"),onMouseMove:function onMouseMove(){return null==_onMouseMove?void 0:_onMouseMove(index)},onMouseDown:onMouseDown,onClick:function onClick(){return null==_onClick?void 0:_onClick(item)},key:item,style:{fontWeight:isFormulaMode||selectedItem!==item?"normal":"bold",backgroundColor:highlightedIndex===index?isLight?theme.colors.gray[100]:"rgba(255,255,255,0.06)":dropdownBgColor}},item)}))):null)})));exports.default=TextEditor},458:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(38),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(33),__webpack_require__(8),__webpack_require__(32),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),resize_observer_1=__webpack_require__(1049),react_use_measure_1=__importDefault(__webpack_require__(992)),Grid_1=__importDefault(__webpack_require__(994)),core_1=__webpack_require__(62),styled_1=__webpack_require__(120),Tabs_1=__importDefault(__webpack_require__(1006)),grid_1=__webpack_require__(7),constants_1=__webpack_require__(56),Workbook=react_1.memo(react_1.forwardRef((function(props,forwardedRef){var selectedSheet=props.selectedSheet,onChangeSelectedSheet=props.onChangeSelectedSheet,sheets=props.sheets,onChange=props.onChange,minColumnWidth=props.minColumnWidth,minRowHeight=props.minRowHeight,CellRenderer=props.CellRenderer,HeaderCellRenderer=props.HeaderCellRenderer,onNewSheet=props.onNewSheet,onSheetChange=props.onSheetChange,theme=props.theme,onChangeSheetName=props.onChangeSheetName,onDeleteSheet=props.onDeleteSheet,onDuplicateSheet=props.onDuplicateSheet,currentSheet=props.currentSheet,onActiveCellChange=props.onActiveCellChange,onActiveCellValueChange=props.onActiveCellValueChange,onFill=props.onFill,onDelete=props.onDelete,formatter=props.formatter,onResize=props.onResize,onScroll=props.onScroll,onKeyDown=props.onKeyDown,onPaste=props.onPaste,onCut=props.onCut,onInsertRow=props.onInsertRow,onInsertColumn=props.onInsertColumn,onDeleteColumn=props.onDeleteColumn,onDeleteRow=props.onDeleteRow,CellEditor=props.CellEditor,selectionPolicy=props.selectionPolicy,onSelectionChange=props.onSelectionChange,selectionMode=props.selectionMode,onChangeFilter=props.onChangeFilter,showTabStrip=props.showTabStrip,isTabEditable=props.isTabEditable,allowNewSheet=props.allowNewSheet,StatusBar=props.StatusBar,showStatusBar=props.showStatusBar,_props$scale=props.scale,scale=void 0===_props$scale?1:_props$scale,ContextMenu=props.ContextMenu,Tooltip=props.Tooltip,snap=props.snap,onHideSheet=props.onHideSheet,onShowSheet=props.onShowSheet,onProtectSheet=props.onProtectSheet,onUnProtectSheet=props.onUnProtectSheet,onChangeTabColor=props.onChangeTabColor,rowHeaderWidth=props.rowHeaderWidth,columnHeaderHeight=props.columnHeaderHeight,gridLineColor=props.gridLineColor,gridBackgroundColor=props.gridBackgroundColor,onCopy=props.onCopy,isFormulaMode=props.isFormulaMode,setFormulaMode=props.setFormulaMode,isFormulaInputActive=props.isFormulaInputActive,supportedFormulas=props.supportedFormulas,onEditorKeyDown=props.onEditorKeyDown,formulaState=props.formulaState,onChangeFormulaState=props.onChangeFormulaState,onCellEditorFocus=props.onCellEditorFocus,onFormulaBarUpdateSelections=props.onFormulaBarUpdateSelections,focusFormulaBar=props.focusFormulaBar,rest=_objectWithoutProperties(props,["selectedSheet","onChangeSelectedSheet","sheets","onChange","minColumnWidth","minRowHeight","CellRenderer","HeaderCellRenderer","onNewSheet","onSheetChange","theme","onChangeSheetName","onDeleteSheet","onDuplicateSheet","currentSheet","onActiveCellChange","onActiveCellValueChange","onFill","onDelete","formatter","onResize","onScroll","onKeyDown","onPaste","onCut","onInsertRow","onInsertColumn","onDeleteColumn","onDeleteRow","CellEditor","selectionPolicy","onSelectionChange","selectionMode","onChangeFilter","showTabStrip","isTabEditable","allowNewSheet","StatusBar","showStatusBar","scale","ContextMenu","Tooltip","snap","onHideSheet","onShowSheet","onProtectSheet","onUnProtectSheet","onChangeTabColor","rowHeaderWidth","columnHeaderHeight","gridLineColor","gridBackgroundColor","onCopy","isFormulaMode","setFormulaMode","isFormulaInputActive","supportedFormulas","onEditorKeyDown","formulaState","onChangeFormulaState","onCellEditorFocus","onFormulaBarUpdateSelections","focusFormulaBar"]),isLight="light"===core_1.useColorMode().colorMode,_react_use_measure_1$2=_slicedToArray(react_use_measure_1.default({polyfill:resize_observer_1.ResizeObserver}),2),containerRef=_react_use_measure_1$2[0],_react_use_measure_1$3=_react_use_measure_1$2[1],width=_react_use_measure_1$3.width,height=_react_use_measure_1$3.height,cells=currentSheet.cells,activeCell=currentSheet.activeCell,selections=currentSheet.selections,scrollState=currentSheet.scrollState,_currentSheet$columnS=currentSheet.columnSizes,columnSizes=void 0===_currentSheet$columnS?{}:_currentSheet$columnS,_currentSheet$rowSize=currentSheet.rowSizes,rowSizes=void 0===_currentSheet$rowSize?{}:_currentSheet$rowSize,mergedCells=currentSheet.mergedCells,frozenRows=currentSheet.frozenRows,frozenColumns=currentSheet.frozenColumns,_currentSheet$hiddenC=currentSheet.hiddenColumns,hiddenColumns=void 0===_currentSheet$hiddenC?constants_1.EMPTY_ARRAY:_currentSheet$hiddenC,_currentSheet$hiddenR=currentSheet.hiddenRows,hiddenRows=void 0===_currentSheet$hiddenR?constants_1.EMPTY_ARRAY:_currentSheet$hiddenR,_currentSheet$showGri=currentSheet.showGridLines,showGridLines=void 0===_currentSheet$showGri||_currentSheet$showGri,filterViews=currentSheet.filterViews,_currentSheet$rowCoun=currentSheet.rowCount,rowCount=void 0===_currentSheet$rowCoun?constants_1.DEFAULT_ROW_COUNT:_currentSheet$rowCoun,_currentSheet$columnC=currentSheet.columnCount,columnCount=void 0===_currentSheet$columnC?constants_1.DEFAULT_COLUMN_COUNT:_currentSheet$columnC,locked=currentSheet.locked,sheetName=currentSheet.name,selectedSheetRef=react_1.useRef(selectedSheet);react_1.useEffect((function(){selectedSheetRef.current=selectedSheet}));var handleFill=react_1.useCallback((function(cell,currentSelection,selections){null==onFill||onFill(selectedSheetRef.current,cell,currentSelection,selections)}),[]),handleSheetChange=react_1.useCallback((function(args){grid_1.isNull(selectedSheetRef.current)||null==onSheetChange||onSheetChange(selectedSheetRef.current,args)}),[]),handleScroll=react_1.useCallback((function(scrollState){grid_1.isNull(selectedSheetRef.current)||null==onScroll||onScroll(selectedSheetRef.current,scrollState)}),[]),handleDelete=react_1.useCallback((function(activeCell,selections){grid_1.isNull(selectedSheetRef.current)||null==onDelete||onDelete(selectedSheetRef.current,activeCell,selections)}),[]),handleResize=react_1.useCallback((function(axis,index,dimension){grid_1.isNull(selectedSheetRef.current)||null==onResize||onResize(selectedSheetRef.current,axis,index,dimension)}),[]),handlePaste=react_1.useCallback((function(rows,activeCell,selections,cutSelections){null==onPaste||onPaste(selectedSheetRef.current,rows,activeCell,selections,cutSelections)}),[]),handleCopy=react_1.useCallback((function(selections){null==onCopy||onCopy(selectedSheetRef.current,selections)}),[]),handleCut=react_1.useCallback((function(selection){null==onCut||onCut(selectedSheetRef.current,selection)}),[]),handleInsertRow=react_1.useCallback((function(cell,selections){null==onInsertRow||onInsertRow(selectedSheetRef.current,cell,selections)}),[]),handleInsertColumn=react_1.useCallback((function(cell,selections){null==onInsertColumn||onInsertColumn(selectedSheetRef.current,cell,selections)}),[]),handleDeleteRow=react_1.useCallback((function(cell,selections){null==onDeleteRow||onDeleteRow(selectedSheetRef.current,cell,selections)}),[]),handleDeleteColumn=react_1.useCallback((function(cell,selections){null==onDeleteColumn||onDeleteColumn(selectedSheetRef.current,cell,selections)}),[]),handleActiveCellChange=react_1.useCallback((function(cell,value){grid_1.isNull(selectedSheetRef.current)||null==onActiveCellChange||onActiveCellChange(selectedSheetRef.current,cell,value)}),[]),handleActiveCellValueChange=react_1.useCallback((function(value,cell){grid_1.isNull(selectedSheetRef.current)||null==onActiveCellValueChange||onActiveCellValueChange(selectedSheetRef.current,cell,value)}),[]),handleSelectionChange=react_1.useCallback((function(cell,selections){grid_1.isNull(selectedSheetRef.current)||null==onSelectionChange||onSelectionChange(selectedSheetRef.current,cell,selections)}),[]),handleChangeFilter=react_1.useCallback((function(filterIndex,columnIndex,filter){grid_1.isNull(selectedSheetRef.current)||null==onChangeFilter||onChangeFilter(selectedSheetRef.current,filterIndex,columnIndex,filter)}),[]),handleKeyDown=react_1.useCallback((function(e,activeCell,selections){grid_1.isNull(selectedSheetRef.current)||null==onKeyDown||onKeyDown(selectedSheetRef.current,e,activeCell,selections)}),[currentSheet]),finalGridBackground=gridBackgroundColor||(isLight?"white":constants_1.DARK_MODE_COLOR_LIGHT);return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.Flex,{minHeight:0,flex:1,ref:containerRef,background:finalGridBackground},react_1.default.createElement(Grid_1.default,Object.assign({},rest,{scale:scale,isLightMode:isLight,ref:forwardedRef,onResize:handleResize,onDelete:handleDelete,onActiveCellValueChange:handleActiveCellValueChange,onActiveCellChange:handleActiveCellChange,onSelectionChange:handleSelectionChange,selectedSheet:selectedSheet,activeCell:activeCell,selections:selections,scrollState:scrollState,width:width,height:height,cells:cells,onChange:onChange,onFill:handleFill,minColumnWidth:minColumnWidth,minRowHeight:minRowHeight,CellRenderer:CellRenderer,HeaderCellRenderer:HeaderCellRenderer,onSheetChange:handleSheetChange,onScroll:handleScroll,formatter:formatter,columnSizes:columnSizes,rowSizes:rowSizes,mergedCells:mergedCells,frozenRows:frozenRows,frozenColumns:frozenColumns,onKeyDown:handleKeyDown,hiddenRows:hiddenRows,hiddenColumns:hiddenColumns,onPaste:handlePaste,onCut:handleCut,onCopy:handleCopy,onInsertRow:handleInsertRow,onInsertColumn:handleInsertColumn,onDeleteRow:handleDeleteRow,onDeleteColumn:handleDeleteColumn,theme:theme,rowCount:rowCount,columnCount:columnCount,showGridLines:showGridLines,CellEditor:CellEditor,selectionPolicy:selectionPolicy,selectionMode:selectionMode,filterViews:filterViews,onChangeFilter:handleChangeFilter,ContextMenu:ContextMenu,Tooltip:Tooltip,snap:snap,locked:locked,rowHeaderWidth:rowHeaderWidth,columnHeaderHeight:columnHeaderHeight,gridLineColor:gridLineColor,gridBackgroundColor:gridBackgroundColor,sheetName:sheetName,onChangeSelectedSheet:onChangeSelectedSheet,isFormulaMode:isFormulaMode,setFormulaMode:setFormulaMode,isFormulaInputActive:isFormulaInputActive,supportedFormulas:supportedFormulas,onEditorKeyDown:onEditorKeyDown,formulaState:formulaState,onChangeFormulaState:onChangeFormulaState,onCellEditorFocus:onCellEditorFocus,onFormulaBarUpdateSelections:onFormulaBarUpdateSelections,focusFormulaBar:focusFormulaBar}))),showTabStrip||showStatusBar?react_1.default.createElement(core_1.Flex,null,react_1.default.createElement(styled_1.BottomPanel,{background:isLight?"#f1f3f4":theme.colors.gray[800],borderTopColor:isLight?"#e8eaed":null==theme?void 0:theme.colors.gray[600],borderTopWidth:1,borderTopStyle:"solid"},showTabStrip&&react_1.default.createElement(Tabs_1.default,{sheets:sheets,selectedSheet:selectedSheet,onNewSheet:onNewSheet,onSelect:onChangeSelectedSheet,onChangeSheetName:onChangeSheetName,onDeleteSheet:onDeleteSheet,onHideSheet:onHideSheet,onShowSheet:onShowSheet,onProtectSheet:onProtectSheet,onUnProtectSheet:onUnProtectSheet,onDuplicateSheet:onDuplicateSheet,onChangeTabColor:onChangeTabColor,isTabEditable:isTabEditable,allowNewSheet:allowNewSheet,leftSpacing:rowHeaderWidth}),showStatusBar&&react_1.default.createElement(StatusBar,{selections:selections,cells:cells}))):null)})));exports.default=Workbook},459:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(33),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ARROW_ICON_PATH=exports.LIST_ICON_DIM=void 0;var react_1=__importStar(__webpack_require__(1)),react_konva_1=__webpack_require__(14);exports.LIST_ICON_DIM=16,exports.ARROW_ICON_PATH="M7 10l5 5 5-5z";exports.default=function FilterIcon(_ref){var _ref$x=_ref.x,x=void 0===_ref$x?0:_ref$x,_ref$y=_ref.y,y=void 0===_ref$y?0:_ref$y,_ref$width=_ref.width,width=void 0===_ref$width?0:_ref$width,_ref$height=_ref.height,height=void 0===_ref$height?0:_ref$height,rowIndex=_ref.rowIndex,columnIndex=_ref.columnIndex,onClick=_ref.onClick,_react_1$useState2=_slicedToArray(react_1.useState(!1),2),isHovered=_react_1$useState2[0],setIsHovered=_react_1$useState2[1],padding=(height-exports.LIST_ICON_DIM)/2,posX=x+width-exports.LIST_ICON_DIM-2,posY=y+padding+.5,handleMouseEnter=react_1.useCallback((function(){setIsHovered(!0)}),[]),handleMouseLeave=react_1.useCallback((function(){setIsHovered(!1)}),[]);return react_1.default.createElement(react_konva_1.Group,{onClick:function handleClick(e){null==onClick||onClick({rowIndex:rowIndex,columnIndex:columnIndex})},onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave},react_1.default.createElement(react_konva_1.Rect,{x:posX,y:posY,width:exports.LIST_ICON_DIM,height:exports.LIST_ICON_DIM,fill:isHovered?"#808080":"transparent",cornerRadius:2}),react_1.default.createElement(react_konva_1.Path,{data:exports.ARROW_ICON_PATH,x:posX-1,y:posY-1,fill:isHovered?"white":"#808080",scaleY:.8,scaleX:.8,listening:!1}))}},460:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var Editor_1=__importDefault(__webpack_require__(461));exports.default=Editor_1.default},461:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(33),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(118),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),grid_1=__webpack_require__(7),TextEditor_1=__importDefault(__webpack_require__(457)),core_1=__webpack_require__(62),constants_1=__webpack_require__(56),types_1=__webpack_require__(121),Editor=react_1.forwardRef((function(props,forwardedRef){var onChange=props.onChange,onSubmit=props.onSubmit,onCancel=props.onCancel,position=props.position,cell=props.cell,nextFocusableCell=props.nextFocusableCell,_props$value=props.value,value=void 0===_props$value?"":_props$value,_props$autoFocus=(props.activeCell,props.autoFocus),autoFocus=void 0===_props$autoFocus||_props$autoFocus,background=props.background,color=props.color,_props$fontSize=props.fontSize,fontSizePt=void 0===_props$fontSize?constants_1.DEFAULT_FONT_SIZE:_props$fontSize,_props$fontFamily=props.fontFamily,fontFamily=void 0===_props$fontFamily?constants_1.DEFAULT_FONT_FAMILY:_props$fontFamily,bold=props.bold,_props$wrap=props.wrap,cellWrap=void 0===_props$wrap?"nowrap":_props$wrap,scrollPosition=(props.selections,props.scrollPosition),horizontalAlign=props.horizontalAlign,underline=props.underline,_props$scale=props.scale,scale=void 0===_props$scale?1:_props$scale,_props$editorType=props.editorType,editorType=void 0===_props$editorType?"text":_props$editorType,options=props.options,sheetName=props.sheetName,address=props.address,selectedSheetName=props.selectedSheetName,onKeyDown=props.onKeyDown,isFormulaMode=props.isFormulaMode,supportedFormulas=props.supportedFormulas,onFormulaChange=props.onFormulaChange,onFocus=props.onFocus,fontSize=react_1.useMemo((function(){return constants_1.pointToPixel(fontSizePt)}),[fontSizePt]),wrapping="wrap"===cellWrap?"wrap":"nowrap",isLight="light"===core_1.useColorMode().colorMode,backgroundColor=void 0!==background?background:isLight?"white":constants_1.DARK_MODE_COLOR_LIGHT,textColor=void 0!==color?color:isLight?"black":"white",hasScrollPositionChanged=react_1.useRef(!1),hasSheetChanged=react_1.useRef(!1),isMounted=react_1.useRef(!1),textSizer=react_1.useRef(grid_1.autoSizerCanvas),_position$x=position.x,x=void 0===_position$x?0:_position$x,_position$y=position.y,y=void 0===_position$y?0:_position$y,_position$width=position.width,width=void 0===_position$width?0:_position$width,_position$height=position.height,height=void 0===_position$height?0:_position$height,getInputDims=react_1.useCallback((function(text){textSizer.current.setFont({fontSize:isFormulaMode?constants_1.FORMULA_FONT_SIZE:fontSize,fontFamily:isFormulaMode?constants_1.FORMULA_FONT:fontFamily,fontWeight:bold?types_1.FONT_WEIGHT.BOLD:"",scale:scale});var _textSizer$current$me=textSizer.current.measureText(text),measuredWidth=_textSizer$current$me.width,measuredHeight=_textSizer$current$me.height;return[Math.max(measuredWidth+(isFormulaMode?18:10),width+1),Math.max(measuredHeight+constants_1.DEFAULT_CELL_PADDING+(isFormulaMode?0:2),height)]}),[width,height,fontSize,fontFamily,bold,wrapping,scale,isFormulaMode]),_react_1$useState2=_slicedToArray(react_1.useState((function(){return getInputDims(value)})),2),inputDims=_react_1$useState2[0],setInputDims=_react_1$useState2[1],_inputDims=_slicedToArray(inputDims,2),inputWidth=_inputDims[0],inputHeight=_inputDims[1];react_1.useEffect((function(){setInputDims(getInputDims(value))}),[value]),react_1.useEffect((function(){isMounted.current&&(hasScrollPositionChanged.current=!0)}),[scrollPosition]),react_1.useEffect((function(){hasSheetChanged.current||selectedSheetName!==sheetName&&(hasSheetChanged.current=!0)}),[selectedSheetName]),react_1.useEffect((function(){isMounted.current=!0}),[]);var showAddress=hasScrollPositionChanged.current||hasSheetChanged.current,handleChange=react_1.useCallback((function(value){null==onChange||onChange(value,cell)}),[cell]),dropdownOptions=react_1.useMemo((function(){return"list"===editorType?options:[]}),[editorType,options]);return react_1.default.createElement("div",{style:{top:y,left:x,position:"absolute",width:inputWidth,height:inputHeight+1,padding:1,boxShadow:"0 2px 6px 2px rgba(60,64,67,.15)",border:"2px #1a73e8 solid",background:backgroundColor,display:"flex",flexDirection:"column"}},showAddress?react_1.default.createElement("div",{style:{position:"absolute",left:-2,marginBottom:4,fontSize:12,lineHeight:"14px",padding:6,paddingTop:4,paddingBottom:4,boxShadow:"0px 1px 2px rgba(0,0,0,0.5)",bottom:"100%",background:"#4589eb",color:"white",whiteSpace:"nowrap"}},hasSheetChanged.current?constants_1.sanitizeSheetName(sheetName)+"!":"",address):null,react_1.default.createElement(TextEditor_1.default,{ref:forwardedRef,value:value,fontFamily:fontFamily,fontSize:fontSize,bold:bold,scale:scale,color:textColor,wrapping:wrapping,horizontalAlign:horizontalAlign,underline:underline,onChange:handleChange,onSubmit:function handleSubmit(value,direction){var nextCell=direction?null==nextFocusableCell?void 0:nextFocusableCell(cell,direction):cell;null==onSubmit||onSubmit(value,cell,nextCell)},onCancel:function handleCancel(e){null==onCancel||onCancel(e)},onKeyDown:onKeyDown,options:dropdownOptions,isFormulaMode:isFormulaMode,autoFocus:autoFocus,onFocus:onFocus,supportedFormulas:supportedFormulas,onFormulaChange:onFormulaChange}))}));exports.default=Editor},462:function(module,exports,__webpack_require__){"use strict";__webpack_require__(33),__webpack_require__(8);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var Tooltip_1=__importDefault(__webpack_require__(463));exports.default=Tooltip_1.default,__exportStar(__webpack_require__(463),exports)},463:function(module,exports,__webpack_require__){"use strict";__webpack_require__(30),__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importDefault(__webpack_require__(1)),grid_1=__webpack_require__(7),constants_1=__webpack_require__(56),core_1=__webpack_require__(62),HyperLink=function HyperLink(_ref2){var title=_ref2.title,url=_ref2.url;return react_1.default.createElement(react_1.default.Fragment,null,react_1.default.createElement(core_1.Box,{mb:1,fontWeight:"bold",wordBreak:"break-word"},react_1.default.createElement(core_1.Link,{color:constants_1.HYPERLINK_COLOR,_hover:{color:constants_1.HYPERLINK_COLOR},href:url,target:"_blank"},title)),react_1.default.createElement(core_1.Box,{wordBreak:"break-word",color:"#666"},url))},Alert=function Alert(_ref3){var title=_ref3.title,content=_ref3.content,variantColor=_ref3.variantColor;return react_1.default.createElement(react_1.default.Fragment,null,title&&react_1.default.createElement(core_1.Box,{pb:2,color:variantColor},react_1.default.createElement("strong",null,title)),content)};exports.default=function Tooltip(_ref){var _ref$x=_ref.x,x=void 0===_ref$x?0:_ref$x,_ref$y=_ref.y,y=void 0===_ref$y?0:_ref$y,_ref$width=_ref.width,width=void 0===_ref$width?0:_ref$width,_ref$position=_ref.position,position=void 0===_ref$position?"right":_ref$position,_ref$scrollLeft=_ref.scrollLeft,scrollLeft=void 0===_ref$scrollLeft?0:_ref$scrollLeft,_ref$scrollTop=_ref.scrollTop,scrollTop=void 0===_ref$scrollTop?0:_ref$scrollTop,_ref$height=_ref.height,height=void 0===_ref$height?0:_ref$height,_ref$variant=(_ref.valid,_ref.variant),variant=void 0===_ref$variant?"info":_ref$variant,content=_ref.content,datatype=_ref.datatype,resultType=_ref.resultType,result=_ref.result,hyperlink=_ref.hyperlink,text=_ref.text,onMouseEnter=_ref.onMouseEnter,onMouseLeave=_ref.onMouseLeave,title="invalid"===variant?"Invalid:":"error"===variant?"Error:":"",variantColor="invalid"===variant?constants_1.INVALID_COLOR:"error"===variant?constants_1.ERROR_COLOR:constants_1.INFO_COLOR,posX="right"===position?x+width-scrollLeft:x-scrollLeft,posY="bottom"===position?y+height-scrollTop:y-scrollTop;return react_1.default.createElement("div",{style:{position:"absolute",left:0,top:0,transform:"translate(".concat(posX,"px, ").concat(posY,"px)"),maxWidth:200,minWidth:160,background:"white",boxShadow:"0 4px 8px 3px rgba(60,64,67,.15)",padding:12,borderRadius:4,fontSize:13,borderLeft:"4px ".concat(variantColor," solid"),backfaceVisibility:"hidden",userSelect:"none",wordBreak:"break-word"},onMouseLeave:onMouseLeave,onMouseEnter:onMouseEnter},"hyperlink"===datatype||"hyperlink"===resultType?react_1.default.createElement(HyperLink,{title:result?grid_1.castToString(result):text,url:hyperlink,variantColor:variantColor}):react_1.default.createElement(Alert,{title:title,content:content,variantColor:variantColor}))}},464:function(module,exports,__webpack_require__){"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(55),__webpack_require__(117),__webpack_require__(205),__webpack_require__(47),__webpack_require__(25),__webpack_require__(86),__webpack_require__(20),__webpack_require__(13),__webpack_require__(49),__webpack_require__(23),__webpack_require__(1017),__webpack_require__(18),__webpack_require__(24),__webpack_require__(89),__webpack_require__(26),__webpack_require__(8),__webpack_require__(32),__webpack_require__(10),__webpack_require__(116),__webpack_require__(45),__webpack_require__(19),__webpack_require__(87),__webpack_require__(16),__webpack_require__(115),__webpack_require__(48),__webpack_require__(21),Object.defineProperty(exports,"__esModule",{value:!0}),exports.createStateReducer=exports.produceState=exports.ACTION_TYPE=exports.defaultSheets=exports.clearCellKeepFormatting=void 0;var ACTION_TYPE,immer_1=__webpack_require__(1018),constants_1=__webpack_require__(56),grid_1=__webpack_require__(7),types_1=__webpack_require__(121),helpers_1=__webpack_require__(209);immer_1.enablePatches(),exports.clearCellKeepFormatting=function(config){for(var key in config)key in constants_1.formattingTypeKeys||delete config[key]},exports.defaultSheets=[{id:constants_1.uuid(),name:"Sheet1",frozenColumns:0,frozenRows:0,activeCell:{rowIndex:1,columnIndex:1},mergedCells:[],selections:[],cells:{},scrollState:{scrollTop:0,scrollLeft:0},filterViews:[]}],function(ACTION_TYPE){ACTION_TYPE.SELECT_SHEET="SELECT_SHEET",ACTION_TYPE.SELECT_NEXT_SHEET="SELECT_NEXT_SHEET",ACTION_TYPE.SELECT_PREV_SHEET="SELECT_PREV_SHEET",ACTION_TYPE.APPLY_PATCHES="APPLY_PATCHES",ACTION_TYPE.CHANGE_SHEET_NAME="CHANGE_SHEET_NAME",ACTION_TYPE.NEW_SHEET="NEW_SHEET",ACTION_TYPE.CHANGE_SHEET_CELL="CHANGE_SHEET_CELL",ACTION_TYPE.SET_CELL_ERROR="SET_CELL_ERROR",ACTION_TYPE.UPDATE_FILL="UPDATE_FILL",ACTION_TYPE.DELETE_SHEET="DELETE_SHEET",ACTION_TYPE.SHEET_SELECTION_CHANGE="SHEET_SELECTION_CHANGE",ACTION_TYPE.FORMATTING_CHANGE_AUTO="FORMATTING_CHANGE_AUTO",ACTION_TYPE.FORMATTING_CHANGE_PLAIN="FORMATTING_CHANGE_PLAIN",ACTION_TYPE.FORMATTING_CHANGE="FORMATTING_CHANGE",ACTION_TYPE.DELETE_CELLS="DELETE_CELLS",ACTION_TYPE.CLEAR_FORMATTING="CLEAR_FORMATTING",ACTION_TYPE.RESIZE="RESIZE",ACTION_TYPE.MERGE_CELLS="MERGE_CELLS",ACTION_TYPE.FROZEN_ROW_CHANGE="FROZEN_ROW_CHANGE",ACTION_TYPE.FROZEN_COLUMN_CHANGE="FROZEN_COLUMN_CHANGE",ACTION_TYPE.SET_BORDER="SET_BORDER",ACTION_TYPE.UPDATE_SCROLL="UPDATE_SCROLL",ACTION_TYPE.CHANGE_FILTER="CHANGE_FILTER",ACTION_TYPE.DELETE_COLUMN="DELETE_COLUMN",ACTION_TYPE.DELETE_ROW="DELETE_ROW",ACTION_TYPE.INSERT_COLUMN="INSERT_COLUMN",ACTION_TYPE.INSERT_ROW="INSERT_ROW",ACTION_TYPE.REMOVE_CELLS="REMOVE_CELLS",ACTION_TYPE.PASTE="PASTE",ACTION_TYPE.COPY="COPY",ACTION_TYPE.VALIDATION_SUCCESS="VALIDATION_SUCCESS",ACTION_TYPE.SHOW_SHEET="SHOW_SHEET",ACTION_TYPE.HIDE_SHEET="HIDE_SHEET",ACTION_TYPE.PROTECT_SHEET="PROTECT_SHEET",ACTION_TYPE.UNPROTECT_SHEET="UNPROTECT_SHEET",ACTION_TYPE.UPDATE_CELLS="UPDATE_CELLS",ACTION_TYPE.CHANGE_TAB_COLOR="CHANGE_TAB_COLOR",ACTION_TYPE.SET_LOADING="SET_LOADING"}(ACTION_TYPE=exports.ACTION_TYPE||(exports.ACTION_TYPE={}));var defaultStateReducer=function defaultStateReducer(state){return state};exports.produceState=function(sheets,cb,gridRef){var _immer_1$produceWithP2=_slicedToArray(immer_1.produceWithPatches({sheets:sheets},(function(draft){return cb(draft.sheets)})),3),nextState=_immer_1$produceWithP2[0],patches=_immer_1$produceWithP2[1],inversePatches=_immer_1$produceWithP2[2];return requestAnimationFrame((function(){var _a;null===(_a=gridRef.current)||void 0===_a||_a.addUndoPatch({patches:patches,inversePatches:inversePatches})})),nextState.sheets},exports.createStateReducer=function(_ref){var addUndoPatch=_ref.addUndoPatch,replaceUndoPatch=_ref.replaceUndoPatch,getCellBounds=_ref.getCellBounds,_ref$stateReducer=_ref.stateReducer,stateReducer=void 0===_ref$stateReducer?defaultStateReducer:_ref$stateReducer;return function(state,action){var _immer_1$produceWithP3=immer_1.produceWithPatches(state,(function(draft){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,_y,_z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19,_20,_21,_22,_23,_24,_25,_26,_27,_28,_29,_30,_31,_32,_33,_34,_35,_36,_37,_38,_39,_40,_41,_42,_43,_44,_45,_46,_47,_48,_49,_50,_51,_52,_53,_54,_55,_56,_57,_58,_59,_60,_61,_62,_63,_64,_65,_66,_67,_68,_69,_70,_71;switch(action.type){case ACTION_TYPE.SELECT_SHEET:draft.selectedSheet=action.id;break;case ACTION_TYPE.SELECT_NEXT_SHEET:var index=draft.sheets.findIndex((function(sheet){return sheet.id===draft.selectedSheet}))+1,newIndex=index>=draft.sheets.length?0:index;draft.selectedSheet=draft.sheets[newIndex].id;break;case ACTION_TYPE.SELECT_PREV_SHEET:var _index=draft.sheets.findIndex((function(sheet){return sheet.id===draft.selectedSheet}))-1,_len=draft.sheets.length,_newIndex=_index<0?_len-1:_index;draft.selectedSheet=draft.sheets[_newIndex].id;break;case ACTION_TYPE.CHANGE_SHEET_NAME:var sheet=draft.sheets.find((function(sheet){return sheet.id===action.id}));sheet&&!sheet.locked&&(sheet.name=action.name);break;case ACTION_TYPE.NEW_SHEET:var _sheet=action.sheet,_index2=action.index;void 0===_index2?draft.sheets.push(action.sheet):draft.sheets.splice(_index2+1,0,_sheet),draft.selectedSheet=action.sheet.id;break;case ACTION_TYPE.CHANGE_SHEET_CELL:var _sheet2=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet2&&!_sheet2.locked){var activeCell=_sheet2.activeCell,selections=_sheet2.selections,cell=action.cell,value=action.value,datatype=action.datatype;_sheet2.cells[cell.rowIndex]=null!==(_a=_sheet2.cells[cell.rowIndex])&&void 0!==_a?_a:{},_sheet2.cells[cell.rowIndex][cell.columnIndex]=null!==(_b=_sheet2.cells[cell.rowIndex][cell.columnIndex])&&void 0!==_b?_b:{};var currentCell=null!==(_c=_sheet2.cells[cell.rowIndex][cell.columnIndex])&&void 0!==_c?_c:{};if(currentCell.locked)return;var hasFormulaChanged=currentCell.text!==value;currentCell.text=value,currentCell.datatype=datatype,delete currentCell.parentCell,delete currentCell.resultType,delete currentCell.result,delete currentCell.error,delete currentCell.valid;var formulaRange=currentCell.formulaRange;if(hasFormulaChanged&&formulaRange)for(var _formulaRange=_slicedToArray(formulaRange,2),right=_formulaRange[0],bottom=_formulaRange[1],a=0;a<bottom;a++)for(var b=0;b<right;b++)0===a&&0===b||null===(_e=null===(_d=_sheet2.cells)||void 0===_d?void 0:_d[cell.rowIndex+a])||void 0===_e||delete _e[cell.columnIndex+b];delete currentCell.formulaRange,draft.currentActiveCell=activeCell,draft.currentSelections=selections}break;case ACTION_TYPE.SET_CELL_ERROR:var _sheet3=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet3&&!_sheet3.locked){var error=action.error,errorMessage=action.errorMessage,_cell=action.cell,_value=action.value,_datatype=action.datatype;_sheet3.cells[_cell.rowIndex]=null!==(_f=_sheet3.cells[_cell.rowIndex])&&void 0!==_f?_f:{},_sheet3.cells[_cell.rowIndex][_cell.columnIndex]=null!==(_g=_sheet3.cells[_cell.rowIndex][_cell.columnIndex])&&void 0!==_g?_g:{},_sheet3.cells[_cell.rowIndex][_cell.columnIndex].text=_value,_sheet3.cells[_cell.rowIndex][_cell.columnIndex].datatype=_datatype,_sheet3.cells[_cell.rowIndex][_cell.columnIndex].error=error,_sheet3.cells[_cell.rowIndex][_cell.columnIndex].errorMessage=errorMessage}break;case ACTION_TYPE.UPDATE_CELLS:var changes=action.changes,_loop=function _loop(name){var sheet=draft.sheets.find((function(sheet){return sheet.name==name}));if(sheet&&!sheet.locked)for(var rowIndex in changes[name])for(var columnIndex in sheet.cells[rowIndex]=null!==(_h=sheet.cells[rowIndex])&&void 0!==_h?_h:{},changes[name][rowIndex]){sheet.cells[rowIndex][columnIndex]=null!==(_j=sheet.cells[rowIndex][columnIndex])&&void 0!==_j?_j:{};var _cell2=sheet.cells[rowIndex][columnIndex];if(_cell2.formulaRange)for(var _cell2$formulaRange=_slicedToArray(_cell2.formulaRange,2),_right=_cell2$formulaRange[0],_bottom=_cell2$formulaRange[1],start=Number(rowIndex),end=Number(columnIndex),_a2=0;_a2<_bottom;_a2++)for(var _b2=0;_b2<_right;_b2++)0===_a2&&0===_b2||exports.clearCellKeepFormatting(null===(_l=null===(_k=sheet.cells)||void 0===_k?void 0:_k[start+_a2])||void 0===_l?void 0:_l[end+_b2]);var values=changes[name][rowIndex][columnIndex];for(var key in values){var _value2=values[key];if(void 0===_value2)null===(_m=sheet.cells[rowIndex][columnIndex])||void 0===_m||delete _m[key];else{if(Object.values(types_1.FORMATTING_TYPE).includes(key)&&void 0!==(null===(_o=sheet.cells[rowIndex][columnIndex])||void 0===_o?void 0:_o[key]))continue;sheet.cells[rowIndex][columnIndex][key]=_value2}}}};for(var name in changes)_loop(name);break;case ACTION_TYPE.VALIDATION_SUCCESS:var _sheet4=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet4&&!_sheet4.locked){var valid=action.valid,_cell3=action.cell,prompt=action.prompt;if(_sheet4.cells[_cell3.rowIndex]=null!==(_p=_sheet4.cells[_cell3.rowIndex])&&void 0!==_p?_p:{},_sheet4.cells[_cell3.rowIndex][_cell3.columnIndex]=null!==(_q=_sheet4.cells[_cell3.rowIndex][_cell3.columnIndex])&&void 0!==_q?_q:{},_sheet4.cells[_cell3.rowIndex][_cell3.columnIndex].locked)return;var _currentCell=_sheet4.cells[_cell3.rowIndex][_cell3.columnIndex];void 0!==valid&&(_currentCell.valid=valid),void 0!==prompt&&(_currentCell.dataValidation=null!==(_r=_currentCell.dataValidation)&&void 0!==_r?_r:constants_1.createCustomValidation(),_currentCell.dataValidation.prompt=prompt)}break;case ACTION_TYPE.UPDATE_FILL:var _sheet5=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet5&&!_sheet5.locked){var _activeCell=action.activeCell,fillSelection=action.fillSelection,_selections=action.selections,sel=_selections.length?_selections[_selections.length-1]:{bounds:getCellBounds(_activeCell)},fillBounds=fillSelection.bounds,direction=fillBounds.bottom>(null===(_s=sel.bounds)||void 0===_s?void 0:_s.bottom)?grid_1.Direction.Down:fillBounds.top<sel.bounds.top?grid_1.Direction.Up:fillBounds.left<sel.bounds.left?grid_1.Direction.Left:grid_1.Direction.Right;if(direction===grid_1.Direction.Down)for(var start=sel.bounds.bottom+1,end=fillBounds.bottom,counter=0,i=start;i<=end;i++){var curSelRowIndex=sel.bounds.top+counter;curSelRowIndex>sel.bounds.bottom&&(counter=0,curSelRowIndex=sel.bounds.top),_sheet5.cells[i]=null!==(_t=_sheet5.cells[i])&&void 0!==_t?_t:{};for(var j=sel.bounds.left;j<=sel.bounds.right;j++){var cellConfig=Object.assign({},null===(_v=null===(_u=_sheet5.cells)||void 0===_u?void 0:_u[curSelRowIndex])||void 0===_v?void 0:_v[j]);(null===(_w=_sheet5.cells[i][j])||void 0===_w?void 0:_w.locked)||(_sheet5.cells[i][j]=cellConfig,"formula"===(null==cellConfig?void 0:cellConfig.datatype)&&(null===(_x=_sheet5.cells[i][j])||void 0===_x||delete _x.result,null===(_y=_sheet5.cells[i][j])||void 0===_y||delete _y.parentCell,_sheet5.cells[i][j].text=helpers_1.formulaToRelativeReference(cellConfig.text,{rowIndex:curSelRowIndex,columnIndex:j},{rowIndex:i,columnIndex:j})))}counter++}if(direction===grid_1.Direction.Up)for(var _start=sel.bounds.top-1,_end=fillBounds.top,_counter=0,_i2=_start;_i2>=_end;_i2--){var _curSelRowIndex=sel.bounds.bottom+_counter;_curSelRowIndex<sel.bounds.top&&(_counter=0,_curSelRowIndex=sel.bounds.bottom),_sheet5.cells[_i2]=null!==(_z=_sheet5.cells[_i2])&&void 0!==_z?_z:{};for(var _j2=sel.bounds.left;_j2<=sel.bounds.right;_j2++){var _cellConfig=Object.assign({},null===(_1=null===(_0=_sheet5.cells)||void 0===_0?void 0:_0[_curSelRowIndex])||void 0===_1?void 0:_1[_j2]);(null===(_2=_sheet5.cells[_i2][_j2])||void 0===_2?void 0:_2.locked)||(_sheet5.cells[_i2][_j2]=_cellConfig,"formula"===(null==_cellConfig?void 0:_cellConfig.datatype)&&(null===(_3=_sheet5.cells[_i2][_j2])||void 0===_3||delete _3.result,null===(_4=_sheet5.cells[_i2][_j2])||void 0===_4||delete _4.parentCell,_sheet5.cells[_i2][_j2].text=helpers_1.formulaToRelativeReference(_cellConfig.text,{rowIndex:_curSelRowIndex,columnIndex:_j2},{rowIndex:_i2,columnIndex:_j2})))}_counter--}if(direction===grid_1.Direction.Left)for(var _i3=sel.bounds.top;_i3<=sel.bounds.bottom;_i3++){_sheet5.cells[_i3]=null!==(_5=_sheet5.cells[_i3])&&void 0!==_5?_5:{};for(var _start2=sel.bounds.left-1,_end2=fillBounds.left,_counter2=0,_j3=_start2;_j3>=_end2;_j3--){var curSelColumnIndex=sel.bounds.right+_counter2;curSelColumnIndex<sel.bounds.left&&(_counter2=0,curSelColumnIndex=sel.bounds.right);var _cellConfig2=Object.assign({},null===(_7=null===(_6=_sheet5.cells)||void 0===_6?void 0:_6[_i3])||void 0===_7?void 0:_7[curSelColumnIndex]);(null===(_8=_sheet5.cells[_i3][_j3])||void 0===_8?void 0:_8.locked)||(_sheet5.cells[_i3][_j3]=_cellConfig2,"formula"===(null==_cellConfig2?void 0:_cellConfig2.datatype)&&(null===(_9=_sheet5.cells[_i3][_j3])||void 0===_9||delete _9.result,null===(_10=_sheet5.cells[_i3][_j3])||void 0===_10||delete _10.parentCell,_sheet5.cells[_i3][_j3].text=helpers_1.formulaToRelativeReference(_cellConfig2.text,{rowIndex:_i3,columnIndex:curSelColumnIndex},{rowIndex:_i3,columnIndex:_j3})),_counter2--)}}if(direction===grid_1.Direction.Right)for(var _i4=sel.bounds.top;_i4<=sel.bounds.bottom;_i4++){_sheet5.cells[_i4]=null!==(_11=_sheet5.cells[_i4])&&void 0!==_11?_11:{};for(var _start3=sel.bounds.right+1,_end3=fillBounds.right,_counter3=0,_j4=_start3;_j4<=_end3;_j4++){var _curSelColumnIndex=sel.bounds.left+_counter3;_curSelColumnIndex>sel.bounds.right&&(_counter3=0,_curSelColumnIndex=sel.bounds.left);var _cellConfig3=Object.assign({},null===(_13=null===(_12=_sheet5.cells)||void 0===_12?void 0:_12[_i4])||void 0===_13?void 0:_13[_curSelColumnIndex]);(null===(_14=_sheet5.cells[_i4][_j4])||void 0===_14?void 0:_14.locked)||(_sheet5.cells[_i4][_j4]=_cellConfig3,"formula"===(null==_cellConfig3?void 0:_cellConfig3.datatype)&&(null===(_15=_sheet5.cells[_i4][_j4])||void 0===_15||delete _15.result,null===(_16=_sheet5.cells[_i4][_j4])||void 0===_16||delete _16.parentCell,_sheet5.cells[_i4][_j4].text=helpers_1.formulaToRelativeReference(_cellConfig3.text,{rowIndex:_i4,columnIndex:_curSelColumnIndex},{rowIndex:_i4,columnIndex:_j4})),_counter3++)}}draft.currentActiveCell=_activeCell,draft.currentSelections=[fillSelection]}break;case ACTION_TYPE.DELETE_SHEET:var id=action.id,_index3=draft.sheets.findIndex((function(sheet){return sheet.id===id}));if(draft.sheets[_index3].locked)return;var newSheets=draft.sheets.filter((function(sheet){return sheet.id!==id})),newSelectedSheet=draft.selectedSheet===draft.sheets[_index3].id?newSheets[Math.max(0,_index3-1)].id:draft.selectedSheet;draft.selectedSheet=newSelectedSheet,draft.sheets.splice(_index3,1);break;case ACTION_TYPE.SHEET_SELECTION_CHANGE:var _sheet6=draft.sheets.find((function(sheet){return sheet.id===action.id}));_sheet6&&(_sheet6.activeCell=action.activeCell,_sheet6.selections=action.selections);break;case ACTION_TYPE.FORMATTING_CHANGE_AUTO:var _sheet7=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet7&&!_sheet7.locked)for(var _activeCell2=_sheet7.activeCell,_selections2=_sheet7.selections,_sel=_selections2.length?_selections2:_activeCell2?[{bounds:null==getCellBounds?void 0:getCellBounds(_activeCell2)}]:[],_i5=0;_i5<_sel.length;_i5++){var bounds=_sel[_i5].bounds;if(bounds)for(var _j5=bounds.top;_j5<=bounds.bottom;_j5++)for(var k=bounds.left;k<=bounds.right;k++)(null===(_18=null===(_17=_sheet7.cells[_j5])||void 0===_17?void 0:_17[k])||void 0===_18?void 0:_18.locked)||null===(_20=null===(_19=_sheet7.cells[_j5])||void 0===_19?void 0:_19[k])||void 0===_20||delete _20.plaintext}break;case ACTION_TYPE.FORMATTING_CHANGE_PLAIN:var _sheet8=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet8&&!_sheet8.locked)for(var _activeCell3=_sheet8.activeCell,_selections3=_sheet8.selections,_sel2=_selections3.length?_selections3:_activeCell3?[{bounds:null==getCellBounds?void 0:getCellBounds(_activeCell3)}]:[],_i6=0;_i6<_sel2.length;_i6++){var _bounds=_sel2[_i6].bounds;if(_bounds)for(var _j6=_bounds.top;_j6<=_bounds.bottom;_j6++){_sheet8.cells[_j6]=null!==(_21=_sheet8.cells[_j6])&&void 0!==_21?_21:{};for(var _k2=_bounds.left;_k2<=_bounds.right;_k2++)_sheet8.cells[_j6][_k2]=null!==(_22=_sheet8.cells[_j6][_k2])&&void 0!==_22?_22:{},_sheet8.cells[_j6][_k2].locked||(_sheet8.cells[_j6][_k2].plaintext=!0)}}break;case ACTION_TYPE.FORMATTING_CHANGE:var _sheet9=draft.sheets.find((function(sheet){return sheet.id===action.id})),key=action.key,_value3=action.value;if(_sheet9&&!_sheet9.locked){for(var _selections4=_sheet9.selections,_activeCell4=_sheet9.activeCell,_sel3=_selections4&&_selections4.length?_selections4:[{bounds:getCellBounds(_activeCell4)}],_i7=0;_i7<_sel3.length;_i7++){var _bounds2=_sel3[_i7].bounds;if(_bounds2)for(var _j7=_bounds2.top;_j7<=_bounds2.bottom;_j7++){_sheet9.cells[_j7]=null!==(_23=_sheet9.cells[_j7])&&void 0!==_23?_23:{};for(var _k3=_bounds2.left;_k3<=_bounds2.right;_k3++){if(_sheet9.cells[_j7][_k3]=null!==(_24=_sheet9.cells[_j7][_k3])&&void 0!==_24?_24:{},_sheet9.cells[_j7][_k3].locked)return;_sheet9.cells[_j7][_k3][key]=_value3,key===types_1.FORMATTING_TYPE.CUSTOM_FORMAT&&(null===(_26=null===(_25=_sheet9.cells[_j7])||void 0===_25?void 0:_25[_k3])||void 0===_26||delete _26.plaintext)}}}draft.currentActiveCell=_activeCell4,draft.currentSelections=_selections4}break;case ACTION_TYPE.DELETE_CELLS:var _sheet10=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet10&&!_sheet10.locked)for(var _activeCell5=action.activeCell,_selections5=action.selections,_sel4=_selections5.length?_selections5:[{bounds:getCellBounds(_activeCell5)}],_i8=0;_i8<_sel4.length;_i8++){var _bounds3=_sel4[_i8].bounds;if(_bounds3){for(var _constants_1$getMinMa2=_slicedToArray(constants_1.getMinMax(_sheet10.cells),2),minRows=_constants_1$getMinMa2[0],maxRows=_constants_1$getMinMa2[1],_j8=Math.max(_bounds3.top,minRows);_j8<=Math.min(_bounds3.bottom,maxRows);_j8++)if(void 0!==_sheet10.cells[_j8])for(var _k4=_bounds3.left;_k4<=_bounds3.right;_k4++)if(void 0!==_sheet10.cells[_j8][_k4]&&!(null===(_27=_sheet10.cells[_j8][_k4])||void 0===_27?void 0:_27.locked)){var _formulaRange2=null===(_30=null===(_29=null===(_28=_sheet10.cells)||void 0===_28?void 0:_28[_j8])||void 0===_29?void 0:_29[_k4])||void 0===_30?void 0:_30.formulaRange;if(exports.clearCellKeepFormatting(_sheet10.cells[_j8][_k4]),_formulaRange2)for(var _formulaRange3=_slicedToArray(_formulaRange2,2),_right2=_formulaRange3[0],_bottom2=_formulaRange3[1],_a3=0;_a3<_bottom2;_a3++)for(var _b3=0;_b3<_right2;_b3++)exports.clearCellKeepFormatting(null===(_32=null===(_31=_sheet10.cells)||void 0===_31?void 0:_31[_j8+_a3])||void 0===_32?void 0:_32[_k4+_b3])}draft.currentActiveCell=_activeCell5,draft.currentSelections=_selections5}}break;case ACTION_TYPE.REMOVE_CELLS:var _sheet11=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet11&&!_sheet11.locked)for(var _activeCell6=action.activeCell,_selections6=action.selections,_sel5=_selections6.length?_selections6:[{bounds:getCellBounds(_activeCell6)}],_i9=0;_i9<_sel5.length;_i9++){var _bounds4=_sel5[_i9].bounds;if(_bounds4)for(var _j9=_bounds4.top;_j9<=_bounds4.bottom;_j9++)for(var _k5=_bounds4.left;_k5<=_bounds4.right;_k5++)(null===(_35=null===(_34=null===(_33=_sheet11.cells)||void 0===_33?void 0:_33[_j9])||void 0===_34?void 0:_34[_k5])||void 0===_35?void 0:_35.locked)||null===(_37=null===(_36=_sheet11.cells)||void 0===_36?void 0:_36[_j9])||void 0===_37||delete _37[_k5]}break;case ACTION_TYPE.CLEAR_FORMATTING:if("break"===function(){var sheet=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(sheet&&!sheet.locked)for(var _activeCell7=sheet.activeCell,_selections7=sheet.selections,_sel6=_selections7.length?_selections7:[{bounds:_activeCell7&&getCellBounds(_activeCell7)}],_i10=0;_i10<_sel6.length;_i10++){var _bounds5=_sel6[_i10].bounds;if(_bounds5)for(var _loop2=function _loop2(_j10){if(void 0===sheet.cells[_j10])return"continue";for(var _loop3=function _loop3(_k6){if(void 0===sheet.cells[_j10][_k6]||(null===(_38=sheet.cells[_j10][_k6])||void 0===_38?void 0:_38.locked))return"continue";Object.values(types_1.FORMATTING_TYPE).forEach((function(key){var _a,_b;null===(_b=null===(_a=sheet.cells[_j10])||void 0===_a?void 0:_a[_k6])||void 0===_b||delete _b[key]})),Object.values(types_1.STROKE_FORMATTING).forEach((function(key){var _a,_b;null===(_b=null===(_a=sheet.cells[_j10])||void 0===_a?void 0:_a[_k6])||void 0===_b||delete _b[key]}))},_k6=_bounds5.left;_k6<=_bounds5.right;_k6++)_loop3(_k6)},_j10=_bounds5.top;_j10<=_bounds5.bottom;_j10++)_loop2(_j10)}return"break"}())break;case ACTION_TYPE.RESIZE:var _sheet12=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet12&&!_sheet12.locked){var axis=action.axis,_index4=action.index,dimension=action.dimension;"x"===axis?(_sheet12.columnSizes=null!==(_39=_sheet12.columnSizes)&&void 0!==_39?_39:{},_sheet12.columnSizes[_index4]=dimension):(_sheet12.rowSizes=null!==(_40=_sheet12.rowSizes)&&void 0!==_40?_40:{},_sheet12.rowSizes[_index4]=dimension)}break;case ACTION_TYPE.MERGE_CELLS:var _sheet13=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet13&&!_sheet13.locked){var _selections8=_sheet13.selections,_activeCell8=_sheet13.activeCell,_bounds6=(_selections8.length?_selections8[_selections8.length-1]:{bounds:_activeCell8&&getCellBounds(_activeCell8)}).bounds;if(!_bounds6)return;if(_bounds6.top===_bounds6.bottom&&_bounds6.left===_bounds6.right||0===_bounds6.top||0===_bounds6.left)return;_sheet13.mergedCells=null!==(_41=_sheet13.mergedCells)&&void 0!==_41?_41:[];var _index5=_sheet13.mergedCells.findIndex((function(area){return area.left===_bounds6.left&&area.right===_bounds6.right&&area.top===_bounds6.top&&area.bottom===_bounds6.bottom}));if(-1!==_index5)return void _sheet13.mergedCells.splice(_index5,1);_sheet13.mergedCells.push(_bounds6)}break;case ACTION_TYPE.FROZEN_ROW_CHANGE:var _sheet14=draft.sheets.find((function(sheet){return sheet.id===action.id}));_sheet14&&!_sheet14.locked&&(_sheet14.frozenRows=action.count);break;case ACTION_TYPE.FROZEN_COLUMN_CHANGE:var _sheet15=draft.sheets.find((function(sheet){return sheet.id===action.id}));_sheet15&&!_sheet15.locked&&(_sheet15.frozenColumns=action.count);break;case ACTION_TYPE.SET_BORDER:if("break"===function(){var sheet=draft.sheets.find((function(sheet){return sheet.id===action.id}));return sheet&&!sheet.locked&&function(){var color=action.color,variant=action.variant,borderStyle=action.borderStyle,selections=sheet.selections,cells=sheet.cells,activeCell=sheet.activeCell,sel=selections.length?selections:grid_1.selectionFromActiveCell(activeCell),boundedCells=constants_1.cellsInSelectionVariant(sel,variant,borderStyle,color,getCellBounds),_loop4=function _loop4(row){var _loop5=function _loop5(col){if("none"===variant)Object.values(types_1.STROKE_FORMATTING).forEach((function(key){var _a,_b;null===(_b=null===(_a=sheet.cells[row])||void 0===_a?void 0:_a[col])||void 0===_b||delete _b[key]}));else{var styles=boundedCells[row][col];Object.keys(styles).forEach((function(key){var _a,_b;sheet.cells[row]=null!==(_a=cells[row])&&void 0!==_a?_a:{},sheet.cells[row][col]=null!==(_b=cells[row][col])&&void 0!==_b?_b:{},sheet.cells[row][col][key]=styles[key]}))}};for(var col in boundedCells[row])_loop5(col)};for(var row in boundedCells)_loop4(row)}(),"break"}())break;case ACTION_TYPE.UPDATE_SCROLL:var _sheet16=draft.sheets.find((function(sheet){return sheet.id===action.id}));_sheet16&&(_sheet16.scrollState=action.scrollState);break;case ACTION_TYPE.CHANGE_FILTER:var _sheet17=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet17&&!_sheet17.locked){var columnIndex=action.columnIndex,filterViewIndex=action.filterViewIndex,filter=action.filter;void 0===filter?null===(_44=null===(_43=null===(_42=null==_sheet17?void 0:_sheet17.filterViews)||void 0===_42?void 0:_42[filterViewIndex])||void 0===_43?void 0:_43.filters)||void 0===_44||delete _44[columnIndex]:(_sheet17.filterViews=null!==(_45=_sheet17.filterViews)&&void 0!==_45?_45:[],(null===(_46=_sheet17.filterViews[filterViewIndex])||void 0===_46?void 0:_46.filters)?_sheet17.filterViews[filterViewIndex].filters[columnIndex]=filter:(_sheet17.filterViews[filterViewIndex]=null!==(_47=_sheet17.filterViews[filterViewIndex])&&void 0!==_47?_47:{},_sheet17.filterViews[filterViewIndex].filters=function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},columnIndex,filter)))}break;case ACTION_TYPE.DELETE_COLUMN:var _sheet18=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet18&&!_sheet18.locked){var _columnIndex=action.activeCell.columnIndex,cells=_sheet18.cells,_changes={};for(var row in cells){var maxCol=Math.max.apply(Math,_toConsumableArray(Object.keys(null!==(_48=cells[row])&&void 0!==_48?_48:{}).map(Number)));_changes[row]=null!==(_49=_changes[row])&&void 0!==_49?_49:{};for(var _i11=0;_i11<=maxCol;_i11++){var _cellConfig4=cells[row][_i11];if("formula"===(null==_cellConfig4?void 0:_cellConfig4.datatype))try{var newFormula=helpers_1.formulaToRelativeReference(_cellConfig4.text,{rowIndex:Number(row),columnIndex:_columnIndex},{rowIndex:Number(row),columnIndex:_columnIndex-1},"column",_columnIndex);_cellConfig4.text=newFormula}catch(err){_cellConfig4.error=err.toString(),_cellConfig4.errorMessage=err.message}_i11<_columnIndex||(_changes[row][_i11]=null!==(_51=null===(_50=cells[row])||void 0===_50?void 0:_50[_i11+1])&&void 0!==_51?_51:{})}}for(var _row in _changes)for(var col in _changes[_row])cells[_row][col]=_changes[_row][col];_sheet18.mergedCells=helpers_1.moveMergedCells(_sheet18.mergedCells,"column-remove",_columnIndex)}break;case ACTION_TYPE.DELETE_ROW:var _sheet19=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet19&&!_sheet19.locked){for(var rowIndex=action.activeCell.rowIndex,_cells=_sheet19.cells,maxRow=Math.max.apply(Math,_toConsumableArray(Object.keys(_cells).map(Number))),_changes2={},_i12=0;_i12<=maxRow;_i12++){for(var _maxCol=Math.max.apply(Math,_toConsumableArray(Object.keys(null!==(_52=_cells[_i12])&&void 0!==_52?_52:{}).map(Number))),_j11=0;_j11<=_maxCol;_j11++){var _cellConfig5=_cells[_i12][_j11];if("formula"===(null==_cellConfig5?void 0:_cellConfig5.datatype))try{var _newFormula=helpers_1.formulaToRelativeReference(_cellConfig5.text,{rowIndex:Number(_i12),columnIndex:_j11},{rowIndex:Number(_i12)-1,columnIndex:_j11},"row",rowIndex);_cellConfig5.text=_newFormula}catch(err){_cellConfig5.error=err.toString(),_cellConfig5.errorMessage=err.message}}_i12<rowIndex||(_changes2[_i12]=_cells[_i12+1])}for(var _index6 in _changes2)_cells[_index6]=_changes2[_index6];_sheet19.mergedCells=helpers_1.moveMergedCells(_sheet19.mergedCells,"row-remove",rowIndex)}break;case ACTION_TYPE.INSERT_COLUMN:var _sheet20=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet20&&!_sheet20.locked){var _columnIndex2=action.activeCell.columnIndex,_cells2=_sheet20.cells,_changes3={};for(var _row2 in _cells2){var _maxCol2=Math.max.apply(Math,_toConsumableArray(Object.keys(null!==(_53=_cells2[_row2])&&void 0!==_53?_53:{}).map(Number)));_changes3[_row2]=null!==(_54=_changes3[_row2])&&void 0!==_54?_54:{},_changes3[_row2][_columnIndex2]=constants_1.cloneCellConfig(null!==(_55=_cells2[_row2][_columnIndex2])&&void 0!==_55?_55:{});for(var _i13=0;_i13<=_maxCol2;_i13++){var _cellConfig6=_cells2[_row2][_i13];if("formula"===(null==_cellConfig6?void 0:_cellConfig6.datatype))try{var _newFormula2=helpers_1.formulaToRelativeReference(_cellConfig6.text,{rowIndex:Number(_row2),columnIndex:_i13},{rowIndex:Number(_row2),columnIndex:_i13+1},"column",_columnIndex2);_cellConfig6.text=_newFormula2}catch(err){_cellConfig6.error=err.toString(),_cellConfig6.errorMessage=err.message}_i13<_columnIndex2||(_changes3[_row2][_i13+1]=null!==(_56=_cells2[_row2][_i13])&&void 0!==_56?_56:{})}}for(var _row3 in _changes3)for(var _col in _cells2[_row3]=null!==(_57=_cells2[_row3])&&void 0!==_57?_57:{},_changes3[_row3])_cells2[_row3][_col]=null!==(_58=_changes3[_row3][_col])&&void 0!==_58?_58:{};_sheet20.mergedCells=helpers_1.moveMergedCells(_sheet20.mergedCells,"column-insert",_columnIndex2)}break;case ACTION_TYPE.INSERT_ROW:var _sheet21=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet21&&!_sheet21.locked){var _rowIndex=action.activeCell.rowIndex,_cells3=_sheet21.cells,_maxRow=Math.max.apply(Math,_toConsumableArray(Object.keys(_cells3).map(Number))),_changes4={};_changes4[_rowIndex]=constants_1.cloneRow(Object.assign({},_cells3[_rowIndex]));for(var _i14=0;_i14<=_maxRow;_i14++){for(var _maxCol3=Math.max.apply(Math,_toConsumableArray(Object.keys(null!==(_59=_cells3[_i14])&&void 0!==_59?_59:{}).map(Number))),_j12=0;_j12<=_maxCol3;_j12++){var _cellConfig7=_cells3[_i14][_j12];if("formula"===(null==_cellConfig7?void 0:_cellConfig7.datatype)){var referenceRowIndex=Number(_i14);try{_cellConfig7.text=helpers_1.formulaToRelativeReference(_cellConfig7.text,{rowIndex:referenceRowIndex,columnIndex:_j12},{rowIndex:referenceRowIndex+1,columnIndex:_j12},"row",_rowIndex)}catch(err){_cellConfig7.error=err.toString(),_cellConfig7.errorMessage=err.message}}}_i14<_rowIndex||(_changes4[_i14+1]=null!==(_60=_cells3[_i14])&&void 0!==_60?_60:{})}for(var _index7 in _changes4)_cells3[_index7]=_changes4[_index7];_sheet21.mergedCells=helpers_1.moveMergedCells(_sheet21.mergedCells,"row-insert",_rowIndex)}break;case ACTION_TYPE.PASTE:var _sheet22=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet22&&!_sheet22.locked){for(var rows=action.rows,_activeCell13=action.activeCell,_selections9=action.selections,cutSelection=action.cutSelection,userSelections=_sheet22.selections,_sel7=userSelections.length?userSelections[userSelections.length-1]:grid_1.selectionFromActiveCell(_activeCell13)[0],_cells4=_sheet22.cells,_sel7$bounds=_sel7.bounds,startTop=_sel7$bounds.top,startLeft=_sel7$bounds.left,_ref3=[rows.length,rows[0].length],rowSpan=_ref3[0],colSpan=_ref3[1],_bottom3=Math.max(_sel7.bounds.bottom+1,startTop+rowSpan),_right3=Math.max(_sel7.bounds.right+1,startLeft+colSpan),rowCounter=0,_i15=startTop;_i15<_bottom3;_i15++){rowCounter>=rowSpan&&(rowCounter=0);var colCounter=0;_cells4[_i15]=null!==(_61=_cells4[_i15])&&void 0!==_61?_61:{};for(var _j13=startLeft;_j13<_right3;_j13++)if(colCounter>=colSpan&&(colCounter=0),_cells4[_i15][_j13]=null!==(_62=_cells4[_i15][_j13])&&void 0!==_62?_62:{},!(null===(_63=_cells4[_i15][_j13])||void 0===_63?void 0:_63.locked)){var _cell4=rows[rowCounter][colCounter];if("object"===_typeof(_cell4)){if(grid_1.isNull(_cell4))continue;var _cellConfig8=Object.assign({},_cell4),sourceCell=null==_cellConfig8?void 0:_cellConfig8.sourceCell;if(null==_cellConfig8||delete _cellConfig8.formulaRange,null==_cellConfig8||delete _cellConfig8.result,null==_cellConfig8||delete _cellConfig8.parentCell,null==_cellConfig8||delete _cellConfig8.resultType,null==_cellConfig8||delete _cellConfig8.sourceCell,_cells4[_i15][_j13]=_cellConfig8,"formula"===_cellConfig8.datatype){var destinationCell={rowIndex:_i15,columnIndex:_j13};try{var relativeFormula=helpers_1.formulaToRelativeReference(_cellConfig8.text,sourceCell,destinationCell);_cells4[_i15][_j13].text=relativeFormula}catch(err){_cells4[_i15][_j13].text=err.details,_cells4[_i15][_j13].error=err.toString(),_cells4[_i15][_j13].errorMessage=err.message}}}else _cells4[_i15][_j13].text=null===_cell4||grid_1.isNull(_cell4)?"":_cell4,_cells4[_i15][_j13].datatype=constants_1.detectDataType(_cells4[_i15][_j13].text);colCounter++}rowCounter++}if(cutSelection)for(var _bounds7=cutSelection.bounds,_i16=_bounds7.top;_i16<=_bounds7.bottom;_i16++)for(var _j14=_bounds7.left;_j14<=_bounds7.right;_j14++)(null===(_66=null===(_65=null===(_64=_sheet22.cells)||void 0===_64?void 0:_64[_i16])||void 0===_65?void 0:_65[_j14])||void 0===_66?void 0:_66.locked)||null===(_68=null===(_67=_sheet22.cells)||void 0===_67?void 0:_67[_i16])||void 0===_68||delete _68[_j14];void 0!==_selections9&&(_sheet22.selections=_selections9),draft.currentActiveCell=_activeCell13,draft.currentSelections=_selections9}break;case ACTION_TYPE.COPY:var _sheet23=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet23){var _activeCell14=_sheet23.activeCell,_selections10=_sheet23.selections;draft.currentActiveCell=_activeCell14,draft.currentSelections=_selections10}break;case ACTION_TYPE.SET_LOADING:var _sheet24=draft.sheets.find((function(sheet){return sheet.id===action.id}));if(_sheet24&&!_sheet24.locked){var _value4=action.value,_cell5=action.cell;_sheet24.cells[_cell5.rowIndex]=null!==(_69=_sheet24.cells[_cell5.rowIndex])&&void 0!==_69?_69:{},_sheet24.cells[_cell5.rowIndex][_cell5.columnIndex]=null!==(_70=_sheet24.cells[_cell5.rowIndex][_cell5.columnIndex])&&void 0!==_70?_70:{},_sheet24.cells[_cell5.rowIndex][_cell5.columnIndex].loading=_value4}break;case ACTION_TYPE.HIDE_SHEET:var visibleSheets=draft.sheets.filter((function(sheet){return!sheet.hidden})),_index8=visibleSheets.findIndex((function(sheet){return sheet.id===action.id}));if(-1!==_index8){var _newSelectedSheet=null===(_71=visibleSheets[0===_index8?1:Math.max(0,_index8-1)])||void 0===_71?void 0:_71.id;void 0!==_newSelectedSheet&&(draft.selectedSheet=_newSelectedSheet,visibleSheets[_index8].hidden=!0)}break;case ACTION_TYPE.SHOW_SHEET:var _sheet25=draft.sheets.find((function(sheet){return sheet.id===action.id}));_sheet25&&(_sheet25.hidden=!1);break;case ACTION_TYPE.PROTECT_SHEET:var _sheet26=draft.sheets.find((function(sheet){return sheet.id===action.id}));_sheet26&&(_sheet26.locked=!0);break;case ACTION_TYPE.UNPROTECT_SHEET:var _sheet27=draft.sheets.find((function(sheet){return sheet.id===action.id}));_sheet27&&(_sheet27.locked=!1);break;case ACTION_TYPE.CHANGE_TAB_COLOR:var _sheet28=draft.sheets.find((function(sheet){return sheet.id===action.id}));_sheet28&&!_sheet28.locked&&(_sheet28.tabColor=action.color);break;case ACTION_TYPE.APPLY_PATCHES:return immer_1.applyPatches(state,action.patches)}})),_immer_1$produceWithP4=_slicedToArray(_immer_1$produceWithP3,3),newState=_immer_1$produceWithP4[0],patches=_immer_1$produceWithP4[1],inversePatches=_immer_1$produceWithP4[2],_action$undoable=action.undoable,undoable=void 0===_action$undoable||_action$undoable,_action$replace=action.replace,replace=void 0!==_action$replace&&_action$replace;if(undoable&&requestAnimationFrame((function(){addUndoPatch({patches:patches,inversePatches:inversePatches})})),replace&&replaceUndoPatch){var isFromFormulaUpdate=action.type===ACTION_TYPE.UPDATE_CELLS;requestAnimationFrame((function(){replaceUndoPatch(patches,isFromFormulaUpdate?constants_1.removeStaleFormulas(inversePatches):void 0)}))}return stateReducer(newState,action)}}},465:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(86),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(8),__webpack_require__(10),__webpack_require__(299),__webpack_require__(70),__webpack_require__(19),__webpack_require__(87),__webpack_require__(16),__webpack_require__(21),__webpack_require__(80),Object.defineProperty(exports,"__esModule",{value:!0}),exports.validate=void 0;var constants_1=__webpack_require__(56);exports.validate=function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(value,id,cell,cellConfig){var _a,_b,_c,valid,validList,_validList,_cellConfig$dataValid,operator,formulae,_valid,num,_formulae,from,to,isBetween;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:_context.t0=null===(_a=null==cellConfig?void 0:cellConfig.dataValidation)||void 0===_a?void 0:_a.type,_context.next="list"===_context.t0?3:"boolean"===_context.t0?9:"decimal"===_context.t0?15:41;break;case 3:if(validList=null===(_b=null==cellConfig?void 0:cellConfig.dataValidation)||void 0===_b?void 0:_b.formulae){_context.next=7;break}return valid=!1,_context.abrupt("return",{valid:valid});case 7:return valid=null==validList?void 0:validList.includes(value),_context.abrupt("return",{valid:valid});case 9:if(_validList=null===(_c=null==cellConfig?void 0:cellConfig.dataValidation)||void 0===_c?void 0:_c.formulae){_context.next=13;break}return valid=!1,_context.abrupt("return",{valid:valid});case 13:return valid=null==_validList?void 0:_validList.includes(value),_context.abrupt("return",{valid:valid});case 15:if(_cellConfig$dataValid=cellConfig.dataValidation,operator=_cellConfig$dataValid.operator,formulae=_cellConfig$dataValid.formulae,"number"===constants_1.detectDataType(value)){_context.next=19;break}return _context.abrupt("return",{valid:!1});case 19:_valid=!0,num=parseFloat(value),_context.t1=operator,_context.next="notBetween"===_context.t1||"between"===_context.t1?24:"equal"===_context.t1?28:"notEqual"===_context.t1?30:"greaterThan"===_context.t1?32:"lessThan"===_context.t1?34:"greaterThanOrEqual"===_context.t1?36:"lessThanOrEqual"===_context.t1?38:40;break;case 24:return _formulae=_slicedToArray(formulae,2),from=_formulae[0],to=_formulae[1],isBetween=num>=from&&num<=to,_valid="between"===operator?isBetween:!isBetween,_context.abrupt("break",40);case 28:return _valid=num===(null==formulae?void 0:formulae[0]),_context.abrupt("break",40);case 30:return _valid=num!==(null==formulae?void 0:formulae[0]),_context.abrupt("break",40);case 32:return _valid=num>(null==formulae?void 0:formulae[0]),_context.abrupt("break",40);case 34:return _valid=num<(null==formulae?void 0:formulae[0]),_context.abrupt("break",40);case 36:return _valid=num>=(null==formulae?void 0:formulae[0]),_context.abrupt("break",40);case 38:return _valid=num<=(null==formulae?void 0:formulae[0]),_context.abrupt("break",40);case 40:return _context.abrupt("return",{valid:_valid});case 41:return _context.abrupt("return",void 0);case 42:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2,_x3,_x4){return _ref.apply(this,arguments)}}(),exports.default=exports.validate},466:function(module,exports,__webpack_require__){"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(20),__webpack_require__(13),__webpack_require__(294),__webpack_require__(18),__webpack_require__(89),__webpack_require__(8),__webpack_require__(10),__webpack_require__(70),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21),__webpack_require__(80);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.FastFormulaParser=exports.FormulaParser=exports.getDefaultErrorMessage=exports.removeUndefined=exports.DEFAULT_HYPERLINK_COLOR=void 0;var fast_formula_parser_1=__importDefault(__webpack_require__(1023));exports.FastFormulaParser=fast_formula_parser_1.default;var hooks_1=__webpack_require__(473),error_1=__importDefault(__webpack_require__(51)),helpers_1=__webpack_require__(306),lodash_merge_1=__importDefault(__webpack_require__(474));exports.DEFAULT_HYPERLINK_COLOR="#1155CC";var basePosition={row:1,col:1,sheet:"Sheet1"};function extractIfJSON(str){try{return JSON.parse(str)}catch(e){return str}}function extractBoolean(str){return!0===str||!1===str?str.toString().toUpperCase():str}exports.removeUndefined=function(o){for(var key in o)void 0===o[key]&&delete o[key];return o},exports.getDefaultErrorMessage=function(err){if(err===error_1.default.REF)return helpers_1.ERROR_REFERENCE};var FormulaParser=function(){function FormulaParser(options){var _a,_this=this;!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FormulaParser),this.cacheValues=function(changes){_this.currentValues=lodash_merge_1.default(_this.currentValues,changes)},this.clearCachedValues=function(){_this.currentValues=void 0},this.getCellConfig=function(position){var _a,_b,_c,_d,_e,_f,_g,_h,_j,sheet=position.sheet,cell={rowIndex:position.row,columnIndex:position.col},config=null!==(_f=null!==(_d=null===(_c=null===(_b=null===(_a=_this.currentValues)||void 0===_a?void 0:_a[position.sheet])||void 0===_b?void 0:_b[position.row])||void 0===_c?void 0:_c[position.col])&&void 0!==_d?_d:null===(_e=_this.getValue)||void 0===_e?void 0:_e.call(_this,sheet,cell))&&void 0!==_f?_f:null;return null===config?config:"formula"!==(null==config?void 0:config.datatype)&&helpers_1.isNull(null==config?void 0:config.resultType)?config&&"number"===config.datatype?Number(null!==(_h=helpers_1.castToString(config.text))&&void 0!==_h?_h:"0"):null!==(_j=config.text)&&void 0!==_j?_j:null:"number"===(null==config?void 0:config.resultType)?Number(null!==(_g=helpers_1.castToString(null==config?void 0:config.result))&&void 0!==_g?_g:"0"):null==config?void 0:config.result},this.getCellValue=function(pos){return _this.getCellConfig(pos)},this.getRangeValue=function(ref){for(var arr=[],_this$sheetRange=_this.sheetRange(ref.sheet),rowCount=_this$sheetRange.rowCount,columnCount=_this$sheetRange.columnCount,row=Math.min(ref.from.row,rowCount);row<=Math.min(ref.to.row,rowCount);row++){for(var innerArr=[],col=Math.min(ref.from.col,columnCount);col<=Math.min(ref.to.col,columnCount);col++)innerArr.push(_this.getCellValue({sheet:ref.sheet,row:row,col:col}));arr.push(innerArr)}return arr},this.parse=function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(text){var position,getValue,result,error,errorMessage,hyperlink,underline,color,horizontalAlign,resultType,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return position=_args.length>1&&void 0!==_args[1]?_args[1]:basePosition,void 0!==(getValue=_args.length>2?_args[2]:void 0)&&(_this.getValue=getValue),_context.prev=3,_context.next=6,_this.formulaParser.parseAsync(text,position,!0).catch((function(err){result=void 0,error=err.error||err.message,errorMessage=err.message}));case 6:result=extractBoolean(result=extractIfJSON(result=_context.sent)),Array.isArray(result)||"object"!==_typeof(result)?resultType=helpers_1.detectDataType(result):"hyperlink"===(null==result?void 0:result.datatype)&&(resultType=result.datatype,hyperlink=result.hyperlink,result=result.title||result.hyperlink,color=exports.DEFAULT_HYPERLINK_COLOR,underline=!0),"boolean"===resultType&&(horizontalAlign="center"),result instanceof error_1.default&&(error=result.error,errorMessage=result.message||exports.getDefaultErrorMessage(result),result=void 0),_context.next=18;break;case 14:_context.prev=14,_context.t0=_context.catch(3),error=_context.t0.toString(),resultType="error";case 18:return _context.abrupt("return",exports.removeUndefined({result:result,timestamp:Date.now(),resultType:resultType,hyperlink:hyperlink,color:color,underline:underline,error:error,errorMessage:errorMessage,horizontalAlign:horizontalAlign}));case 19:case"end":return _context.stop()}}),_callee,null,[[3,14]])})));return function(_x){return _ref.apply(this,arguments)}}(),this.getDependencies=function(text){var position=arguments.length>1&&void 0!==arguments[1]?arguments[1]:basePosition;return _this.dependencyParser.parse(text,position)},options.getValue&&(this.getValue=options.getValue),options.getSheetRange&&(this.getSheetRange=options.getSheetRange),this.formulaParser=new fast_formula_parser_1.default({functionsNeedContext:null!==(_a=null==options?void 0:options.functions)&&void 0!==_a?_a:{},onCell:this.getCellValue,onRange:this.getRangeValue}),this.dependencyParser=new hooks_1.DepParser}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(FormulaParser,[{key:"sheetRange",value:function sheetRange(name){return this.getSheetRange(name)}}]),FormulaParser}();exports.FormulaParser=FormulaParser},475:function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(49),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(89),__webpack_require__(8),__webpack_require__(10),__webpack_require__(70),__webpack_require__(45),__webpack_require__(19),__webpack_require__(1039),__webpack_require__(16),__webpack_require__(88),__webpack_require__(21);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.FormulaError=exports.formulas=exports.hyperLink=exports.max=exports.min=exports.importData=void 0;var error_1=__importDefault(__webpack_require__(210));function importData(parser,arg){if(!arg||!arg.value)throw new error_1.default("#N/A","Wrong number of arguments provided.");var value=arg.value;return fetch(value.toString()).then((function(response){if(!response.ok)throw new Error(response.statusText);return response})).then((function(response){return response.text()})).then((function(response){var _step,separator=value.toString().endsWith("tsv")?"\t":",",data=[],_iterator=function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(response.split("\n"));try{for(_iterator.s();!(_step=_iterator.n()).done;){var cols=_step.value.split(separator);data.push(cols)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return data})).catch((function(err){throw new error_1.default("#NA",err.toString())}))}function min(parser){for(var _len=arguments.length,arg=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)arg[_key-1]=arguments[_key];return Math.min.apply(Math,_toConsumableArray(arg.map((function(item){return Number(item.value)}))))}function max(parser){for(var _len2=arguments.length,arg=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)arg[_key2-1]=arguments[_key2];return Math.max.apply(Math,_toConsumableArray(arg.map((function(item){return Number(item.value)}))))}function hyperLink(parser,urlArg,titleArg){if((null==titleArg?void 0:titleArg.value)instanceof error_1.default)throw new error_1.default("#VALUE","Invalid title");if((null==urlArg?void 0:urlArg.value)instanceof error_1.default)throw new error_1.default("#VALUE","Invalid url");return JSON.stringify({title:null==titleArg?void 0:titleArg.value,hyperlink:null==urlArg?void 0:urlArg.value,datatype:"hyperlink"})}exports.FormulaError=error_1.default,exports.importData=importData,exports.min=min,exports.max=max,exports.hyperLink=hyperLink,exports.formulas={IMPORTDATA:importData,MIN:min,MAX:max,HYPERLINK:hyperLink}},476:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8),Object.defineProperty(exports,"__esModule",{value:!0});var grid_1=__webpack_require__(7);exports.default=grid_1.Image},488:function(module,exports,__webpack_require__){__webpack_require__(489),__webpack_require__(638),__webpack_require__(639),__webpack_require__(795),module.exports=__webpack_require__(797)},52:function(module,exports,__webpack_require__){"use strict";__webpack_require__(33),__webpack_require__(8);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.validate=exports.defaultSheets=exports.Image=exports.DefaultCell=exports.DefaultEditor=void 0;var Spreadsheet_1=__importStar(__webpack_require__(432));Object.defineProperty(exports,"defaultSheets",{enumerable:!0,get:function get(){return Spreadsheet_1.defaultSheets}});var Editor_1=__importDefault(__webpack_require__(460));exports.DefaultEditor=Editor_1.default;var Cell_1=__importDefault(__webpack_require__(303));exports.DefaultCell=Cell_1.default;var validation_1=__importDefault(__webpack_require__(465));exports.validate=validation_1.default;var Image_1=__importDefault(__webpack_require__(476));exports.Image=Image_1.default,__exportStar(__webpack_require__(432),exports),exports.default=Spreadsheet_1.default,__exportStar(__webpack_require__(56),exports),__exportStar(__webpack_require__(121),exports),__exportStar(__webpack_require__(464),exports),__exportStar(__webpack_require__(303),exports),__exportStar(__webpack_require__(476),exports),__exportStar(__webpack_require__(475),exports)},555:function(module,exports){},56:function(module,exports,__webpack_require__){"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(55),__webpack_require__(47),__webpack_require__(25),__webpack_require__(38),__webpack_require__(20),__webpack_require__(13),__webpack_require__(163),__webpack_require__(49),__webpack_require__(96),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(89),__webpack_require__(26),__webpack_require__(8),__webpack_require__(32),__webpack_require__(10),__webpack_require__(116),__webpack_require__(299),__webpack_require__(164),__webpack_require__(208),__webpack_require__(45),__webpack_require__(19),__webpack_require__(16),__webpack_require__(115),__webpack_require__(88),__webpack_require__(382),__webpack_require__(48),__webpack_require__(21);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.removeStaleFormulas=exports.escapeRegExp=exports.isAFormula=exports.desanitizeSheetName=exports.sanitizeSheetName=exports.formattingTypeKeys=exports.cloneRow=exports.cloneCellConfig=exports.createCustomValidation=exports.getMinMax=exports.DEFAULT_CHECKBOX_VALUES=exports.getEditorType=exports.changeDecimals=exports.splitDecimals=exports.cellsInSelectionVariant=exports.dashArray=exports.dotArray=exports.pointToPixel=exports.luminance=exports.DEFAULT_FONT_FAMILY=exports.DEFAULT_FONT_SIZE=exports.DEFAULT_DATE_FORMAT=exports.SCALE_VALUES=exports.AVAILABLE_CUSTOM_FORMATS=exports.AVAILABLE_DATE_FORMATS=exports.AVAILABLE_CURRENCY_FORMATS=exports.AVAILABLE_FORMATS=exports.FONT_FAMILIES=exports.FONT_SIZES=exports.detectDataType=exports.isNumeric=exports.format=exports.uuid=exports.createNewSheet=exports.cellToAddress=exports.addressToCell=exports.alpha2number=exports.number2Alpha=exports.DEFAULT_FORMULABAR_HEIGHT=exports.ERROR_REFERENCE=exports.ERROR_CIRCULAR_DEPENDENCY=exports.CELL_BORDER_WIDTH=exports.DEFAULT_CELL_PADDING=exports.LINE_HEIGHT_RATIO=exports.DEFAULT_FONT_COLOR=exports.HYPERLINK_COLOR=exports.INFO_COLOR=exports.ERROR_COLOR=exports.INVALID_COLOR=exports.FORMULA_FONT_SIZE=exports.FORMULA_FONT=exports.SYSTEM_FONT=exports.FORMAT_DEFAULT_DECIMAL=exports.FORMAT_CURRENCY=exports.FORMAT_PERCENT=exports.CELL_BORDER_COLOR=exports.HEADER_BORDER_COLOR=exports.EMPTY_ARRAY=exports.DARK_MODE_COLOR_LIGHT=exports.DARK_MODE_COLOR=exports.DEFAULT_COLUMN_WIDTH=exports.DEFAULT_ROW_HEIGHT=exports.ROW_HEADER_WIDTH=exports.FORMULABAR_LEFT_CORNER_WIDTH=exports.COLUMN_HEADER_HEIGHT=exports.DEFAULT_COLUMN_COUNT=exports.DEFAULT_ROW_COUNT=void 0;var types_1=__webpack_require__(121),grid_1=__webpack_require__(7),ssf_1=__importDefault(__webpack_require__(892));exports.DEFAULT_ROW_COUNT=1e3,exports.DEFAULT_COLUMN_COUNT=1e3,exports.COLUMN_HEADER_HEIGHT=24,exports.FORMULABAR_LEFT_CORNER_WIDTH=47,exports.ROW_HEADER_WIDTH=46,exports.DEFAULT_ROW_HEIGHT=21,exports.DEFAULT_COLUMN_WIDTH=100,exports.DARK_MODE_COLOR="rgb(26, 32, 44)",exports.DARK_MODE_COLOR_LIGHT="#252E3E",exports.EMPTY_ARRAY=[],exports.HEADER_BORDER_COLOR="#C0C0C0",exports.CELL_BORDER_COLOR="#E3E2E2",exports.FORMAT_PERCENT="0.00%",exports.FORMAT_CURRENCY="$0.00",exports.FORMAT_DEFAULT_DECIMAL="0.0",exports.SYSTEM_FONT="-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji",exports.FORMULA_FONT="Inconsolata,monospace,arial,sans,sans-serif",exports.FORMULA_FONT_SIZE=14,exports.INVALID_COLOR="#FF5621",exports.ERROR_COLOR="#C63929",exports.INFO_COLOR="#1D72E8",exports.HYPERLINK_COLOR="#1155CC",exports.DEFAULT_FONT_COLOR="#000",exports.LINE_HEIGHT_RATIO=1,exports.DEFAULT_CELL_PADDING=2,exports.CELL_BORDER_WIDTH=1,exports.ERROR_CIRCULAR_DEPENDENCY="Circular dependency detected.",exports.ERROR_REFERENCE="Reference does not exist.",exports.DEFAULT_FORMULABAR_HEIGHT=24,exports.number2Alpha=function(i){return((i>=26?exports.number2Alpha((i/26>>0)-1):"")+"abcdefghijklmnopqrstuvwxyz"[i%26>>0]).toUpperCase()},exports.alpha2number=function(letters){return letters.split("").reduce((function(r,a){return 26*r+parseInt(a,36)-9}),0)},exports.addressToCell=function(address){for(var m,regex=/\$?([A-Z]+)\$?(\d+)/gim,matches=[];null!==(m=regex.exec(address));)m.index===regex.lastIndex&&regex.lastIndex++,m.forEach((function(match,groupIndex){groupIndex>0&&matches.push(match)}));if(!matches.length)return null;var columnAlpha=matches[0],rowIndex=matches[1];return{rowIndex:parseInt(rowIndex),columnIndex:exports.alpha2number(columnAlpha)}},exports.cellToAddress=function(cell){var isAbsoluteColumn=arguments.length>1&&void 0!==arguments[1]&&arguments[1],isAbsoluteRow=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return cell?0===cell.columnIndex?null:"".concat(isAbsoluteColumn?"$":"").concat(exports.number2Alpha(cell.columnIndex-1)).concat(isAbsoluteRow?"$":"").concat(Math.max(0,cell.rowIndex)):null},exports.createNewSheet=function(_ref){var count=_ref.count;return{id:exports.uuid(),name:"Sheet".concat(count),cells:{},activeCell:{rowIndex:1,columnIndex:1},selections:[],scrollState:{scrollTop:0,scrollLeft:0},columnSizes:{},rowSizes:{}}},exports.uuid=function(){return"_"+Math.random().toString(36).substr(2,9)},exports.format=function(value,datatype,cellConfig){if(void 0===value||grid_1.isNull(value)||grid_1.isNull(datatype))return grid_1.castToString(value);if(!cellConfig)return grid_1.castToString(value);if("date"===datatype)return ssf_1.default.format(cellConfig.format||exports.DEFAULT_DATE_FORMAT,"string"==typeof value?new Date(value):value);var num="number"===datatype?parseFloat("string"!=typeof value?""+value:value):value;try{cellConfig.format&&(value=ssf_1.default.format(cellConfig.format,num))}catch(err){console.error("Error while formatting ",num,err)}return""+value},exports.isNumeric=function(cell){return cell&&("number"===cell.datatype||"number"===cell.resultType)},exports.detectDataType=function(value){var _a;if(!grid_1.isNull(value))return isNaN(Number(value))?"TRUE"===value||"FALSE"===value?"boolean":(null===(_a=grid_1.castToString(value))||void 0===_a?void 0:_a.startsWith("="))?"formula":void 0:"number"},exports.FONT_SIZES=[6,7,8,9,10,11,12,14,18,24,36],exports.FONT_FAMILIES=["Arial","Helvetica","Source Sans Pro","Comic Sans MS","Courier New","Verdana","Times New Roman"],exports.AVAILABLE_FORMATS=[{label:"Number",value:"0.00",sample:"1,000.12"},{label:"Percent",value:exports.FORMAT_PERCENT,sample:"10.12%"},{label:"Scientific",value:"0.00E+00",sample:"1.01E+03"}],exports.AVAILABLE_CURRENCY_FORMATS=[{label:"Accounting",value:"$(0.00)",sample:"$(1,000.12)"},{label:"Financial",value:"(0.00)",sample:"(1,000.12)"},{label:"Currency",value:exports.FORMAT_CURRENCY,sample:"$1,000.00"},{label:"Currency (rounded)",value:"$#",sample:"$1,000"}],exports.AVAILABLE_DATE_FORMATS=[{label:"Date",value:"M/d/yyyy",sample:"9/26/2008"},{label:"Time",value:"h:mm:ss am/pm",sample:"3:59:00 PM"},{label:"Date time",value:"M/d/yyyy H:mm:ss",sample:"9/26/2008 15:59:00"},{label:"Duration",value:"[h]:mm:ss",sample:"24:01:00"}],exports.AVAILABLE_CUSTOM_FORMATS=[{label:"Euro",value:"[$€]#,##0.00",sample:"€1,000.12"},{label:"Indian Rupee",value:"[$₹]#,##0.00",sample:"₹1,000.12"}],exports.SCALE_VALUES=[{label:"50%",value:.5},{label:"75%",value:.75},{label:"100%",value:1},{label:"125%",value:1.25},{label:"150%",value:1.5},{label:"200%",value:2}],exports.DEFAULT_DATE_FORMAT="d-mmm-yy",exports.DEFAULT_FONT_SIZE=10,exports.DEFAULT_FONT_FAMILY="Arial",exports.luminance=function(color,amount){return color&&color.startsWith("#")?"#"+color.replace(/^#/,"").replace(/../g,(function(color){return("0"+Math.min(255,Math.max(0,parseInt(color,16)+amount)).toString(16)).substr(-2)})):color},exports.pointToPixel=function(pt){return void 0===pt?void 0:Math.round(1.3*pt)};var dpr=grid_1.canUseDOM?window.devicePixelRatio:1,dashDotWidth=Math.max(Math.floor(dpr/2),.5);exports.dotArray=1===dpr?[dashDotWidth,dashDotWidth+dpr]:[dashDotWidth,dashDotWidth],exports.dashArray=[2,2],exports.cellsInSelectionVariant=function(selections,variant){for(var _a,borderStyle=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"thin",color=arguments.length>3?arguments[3]:void 0,boundGetter=arguments.length>4?arguments[4]:void 0,thickness="medium"===borderStyle?2:"thick"===borderStyle?3:1,dash="dashed"===borderStyle?exports.dashArray:"dotted"===borderStyle?exports.dotArray:[],lineCap="butt",cells={},i=0;i<selections.length;i++)for(var bounds=selections[i].bounds,j=bounds.top;j<=bounds.bottom;j++){cells[j]=null!==(_a=cells[j])&&void 0!==_a?_a:{};for(var k=bounds.left;k<=bounds.right;k++){cells[j][k]=cells[j][k]||{};var actualBounds=null==boundGetter?void 0:boundGetter({rowIndex:j,columnIndex:k}),_ref2=actualBounds?{rowIndex:actualBounds.top,columnIndex:actualBounds.left}:{rowIndex:j,columnIndex:k},rowIndex=_ref2.rowIndex,columnIndex=_ref2.columnIndex;switch(variant){case"outer":j===bounds.top&&(cells[rowIndex][columnIndex]=Object.assign({},cells[rowIndex][columnIndex],{strokeTopColor:color,strokeTopWidth:thickness,strokeTopDash:dash,lineCap:lineCap})),k===bounds.right&&(cells[rowIndex][columnIndex]=Object.assign({},cells[rowIndex][columnIndex],{strokeRightColor:color,strokeRightWidth:thickness,strokeRightDash:dash,lineCap:lineCap})),j===bounds.bottom&&(cells[rowIndex][columnIndex]=Object.assign({},cells[rowIndex][columnIndex],{strokeBottomColor:color,strokeBottomWidth:thickness,strokeBottomDash:dash,lineCap:lineCap})),k===bounds.left&&(cells[rowIndex][columnIndex]=Object.assign({},cells[rowIndex][columnIndex],{strokeLeftColor:color,strokeLeftWidth:thickness,strokeLeftDash:dash,lineCap:lineCap}));break;case"all":cells[rowIndex][columnIndex]={strokeTopColor:color,strokeTopWidth:thickness,strokeTopDash:dash,strokeLeftColor:color,strokeLeftWidth:thickness,strokeLeftDash:dash,strokeRightColor:color,strokeRightDash:dash,strokeRightWidth:thickness,strokeBottomColor:color,strokeBottomDash:dash,strokeBottomWidth:thickness,lineCap:lineCap};break;case"inner":k!==bounds.left&&k!==bounds.right&&(cells[rowIndex][columnIndex]=Object.assign({},cells[rowIndex][columnIndex],{strokeLeftColor:color,strokeLeftWidth:thickness,strokeLeftDash:dash,strokeRightColor:color,strokeRightDash:dash,strokeRightWidth:thickness})),j!==bounds.top&&j!==bounds.bottom&&(cells[rowIndex][columnIndex]=Object.assign({},cells[rowIndex][columnIndex],{strokeTopColor:color,strokeTopWidth:thickness,strokeTopDash:dash,strokeBottomColor:color,strokeBottomDash:dash,strokeBottomWidth:thickness})),bounds.top!==bounds.bottom&&(j===bounds.top&&(cells[rowIndex][columnIndex]=Object.assign({},cells[rowIndex][columnIndex],{strokeBottomColor:color,strokeBottomDash:dash,strokeBottomWidth:thickness})),j===bounds.bottom&&(cells[rowIndex][columnIndex]=Object.assign({},cells[rowIndex][columnIndex],{strokeTopColor:color,strokeTopDash:dash,strokeTopWidth:thickness}))),bounds.left!==bounds.right&&(k===bounds.left&&(cells[rowIndex][columnIndex]=Object.assign({},cells[rowIndex][columnIndex],{strokeRightColor:color,strokeRightDash:dash,strokeRightWidth:thickness})),k===bounds.right&&(cells[rowIndex][columnIndex]=Object.assign({},cells[rowIndex][columnIndex],{strokeLeftColor:color,strokeLeftDash:dash,strokeLeftWidth:thickness})));break;case"horizontal":cells[rowIndex][columnIndex]={strokeBottomColor:color,strokeBottomDash:dash,strokeBottomWidth:thickness,lineCap:lineCap},j===bounds.bottom&&(cells[rowIndex][columnIndex]={});break;case"vertical":cells[rowIndex][columnIndex]={strokeRightColor:color,strokeRightDash:dash,strokeRightWidth:thickness,lineCap:lineCap},k===bounds.right&&(cells[rowIndex][columnIndex]={});break;case"left":k===bounds.left&&(cells[rowIndex][columnIndex]=Object.assign({},cells[rowIndex][columnIndex],{strokeLeftColor:color,strokeLeftDash:dash,strokeLeftWidth:thickness,lineCap:lineCap}));break;case"right":k===bounds.right&&(cells[rowIndex][columnIndex]=Object.assign({},cells[rowIndex][columnIndex],{strokeRightColor:color,strokeRightDash:dash,strokeRightWidth:thickness,lineCap:lineCap}));break;case"top":j===bounds.top&&(cells[rowIndex][columnIndex]=Object.assign({},cells[rowIndex][columnIndex],{strokeTopColor:color,strokeTopDash:dash,strokeTopWidth:thickness,lineCap:lineCap}));break;case"bottom":j===bounds.bottom&&(cells[rowIndex][columnIndex]=Object.assign({},cells[rowIndex][columnIndex],{strokeBottomColor:color,strokeBottomDash:dash,strokeBottomWidth:thickness,lineCap:lineCap}))}}}return cells},exports.splitDecimals=function(str){for(var m,regex=/(\d+)(.*)/gm,matches=[];null!==(m=regex.exec(str));)m.index===regex.lastIndex&&regex.lastIndex++,m.forEach((function(match,groupIndex){groupIndex>0&&matches.push(match)}));return matches},exports.changeDecimals=function(format){var step=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(step<0&&!format)return format;if(!format)return exports.FORMAT_DEFAULT_DECIMAL;var DEFAULT_FORMAT="".concat(format,".0"),decimalIndex=format.indexOf(".");if(-1===decimalIndex)return step<0?format:DEFAULT_FORMAT;var decimalPortion=format.substr(decimalIndex+1),_exports$splitDecimal=exports.splitDecimals(decimalPortion),_exports$splitDecimal2=_slicedToArray(_exports$splitDecimal,2),num=_exports$splitDecimal2[0],suffix=_exports$splitDecimal2[1];if(""===num)return DEFAULT_FORMAT;var len=num.length+step;return len<=0?format.substr(0,decimalIndex):format.substr(0,decimalIndex)+"."+Array.from({length:len}).map((function(_){return"0"})).join("")+suffix},exports.getEditorType=function(type){switch(type){case"list":return"list";default:return"text"}},exports.DEFAULT_CHECKBOX_VALUES=["TRUE","FALSE"],exports.getMinMax=function(o){var keys=Object.keys(null!=o?o:{}).map(Number);return 0===keys.length?[0,0]:[Math.min.apply(Math,_toConsumableArray(keys)),Math.max.apply(Math,_toConsumableArray(keys))]},exports.createCustomValidation=function(){return{type:"custom"}},exports.cloneCellConfig=function(config){config.text,config.result,config.datatype,config.resultType;return _objectWithoutProperties(config,["text","result","datatype","resultType"])},exports.cloneRow=function(cells){for(var columnIndex in cells)cells[columnIndex]=exports.cloneCellConfig(cells[columnIndex]);return cells},exports.formattingTypeKeys=[].concat(Object.values(types_1.FORMATTING_TYPE),Object.values(types_1.STROKE_FORMATTING)).reduce((function(acc,key){return acc[key]=!0,acc}),{}),exports.sanitizeSheetName=function(name){if(void 0!==name)return"number"==typeof name?name:name.split(/\s/gi).length>1?"'".concat(name,"'"):name},exports.desanitizeSheetName=function(name){if(void 0!==name)return"number"==typeof name?name:name.replace(new RegExp(/\'/,"gi"),"")},exports.isAFormula=function(value){var _a;return null===(_a=grid_1.castToString(value))||void 0===_a?void 0:_a.startsWith("=")};var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reHasRegExpChar=RegExp(reRegExpChar.source);exports.escapeRegExp=function(string){return string&&reHasRegExpChar.test(string)?string.replace(reRegExpChar,"\\$&"):string||""},exports.removeStaleFormulas=function(patches){return null==patches?void 0:patches.filter((function(patch){var _a,_b;if(patch.value&&"object"===_typeof(patch.value)&&Object.keys(patch.value).length){var value=Object.assign({},patch.value);for(var key in patch.value)"formula"===(null===(_a=value[key])||void 0===_a?void 0:_a.datatype)&&void 0===(null===(_b=value[key])||void 0===_b?void 0:_b.timestamp)&&delete value[key];patch.value=value}return!0}))}},639:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(247)},7:function(module,exports,__webpack_require__){"use strict";__webpack_require__(33),__webpack_require__(8);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Selection=exports.Image=exports.CellOverlayRenderer=exports.useFilter=exports.useTouch=exports.useUndo=exports.usePagination=exports.useCopyPaste=exports.useSizer=exports.useTooltip=exports.useSelection=exports.useEditable=exports.CellOverlay=exports.Cell=exports.CellRenderer=exports.Grid=void 0;var Grid_1=__importDefault(__webpack_require__(407));exports.Grid=Grid_1.default;var Cell_1=__webpack_require__(415);Object.defineProperty(exports,"CellRenderer",{enumerable:!0,get:function get(){return Cell_1.CellRenderer}}),Object.defineProperty(exports,"Cell",{enumerable:!0,get:function get(){return Cell_1.Cell}});var CellOverlay_1=__webpack_require__(420);Object.defineProperty(exports,"CellOverlay",{enumerable:!0,get:function get(){return CellOverlay_1.CellOverlay}}),Object.defineProperty(exports,"CellOverlayRenderer",{enumerable:!0,get:function get(){return CellOverlay_1.CellRenderer}});var useEditable_1=__importDefault(__webpack_require__(423));exports.useEditable=useEditable_1.default;var useSelection_1=__importDefault(__webpack_require__(424));exports.useSelection=useSelection_1.default;var useTooltip_1=__importDefault(__webpack_require__(425));exports.useTooltip=useTooltip_1.default;var useSizer_1=__importDefault(__webpack_require__(846));exports.useSizer=useSizer_1.default;var useTouch_1=__importDefault(__webpack_require__(847));exports.useTouch=useTouch_1.default;var useCopyPaste_1=__importDefault(__webpack_require__(850));exports.useCopyPaste=useCopyPaste_1.default;var useUndo_1=__importDefault(__webpack_require__(429));exports.useUndo=useUndo_1.default;var usePagination_1=__importDefault(__webpack_require__(851));exports.usePagination=usePagination_1.default;var useFilter_1=__importDefault(__webpack_require__(430));exports.useFilter=useFilter_1.default;var Image_1=__importDefault(__webpack_require__(431));exports.Image=Image_1.default;var Selection_1=__importDefault(__webpack_require__(421));exports.Selection=Selection_1.default,exports.default=Grid_1.default,__exportStar(__webpack_require__(407),exports),__exportStar(__webpack_require__(90),exports),__exportStar(__webpack_require__(430),exports),__exportStar(__webpack_require__(429),exports),__exportStar(__webpack_require__(425),exports),__exportStar(__webpack_require__(423),exports),__exportStar(__webpack_require__(424),exports),__exportStar(__webpack_require__(97),exports),__exportStar(__webpack_require__(431),exports)},795:function(module,exports,__webpack_require__){"use strict";__webpack_require__(9),__webpack_require__(55),__webpack_require__(47),__webpack_require__(68),__webpack_require__(8),__webpack_require__(132),__webpack_require__(133),__webpack_require__(32),__webpack_require__(48);var _clientApi=__webpack_require__(177),_clientLogger=__webpack_require__(114),_configFilename=__webpack_require__(796);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}(_configFilename.args||_configFilename.argTypes)&&_clientLogger.logger.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify({args:_configFilename.args,argTypes:_configFilename.argTypes})),_configFilename.decorators&&_configFilename.decorators.forEach((function(decorator){return(0,_clientApi.addDecorator)(decorator,!1)})),(_configFilename.parameters||_configFilename.globals||_configFilename.globalTypes)&&(0,_clientApi.addParameters)(_objectSpread(_objectSpread({},_configFilename.parameters),{},{globals:_configFilename.globals,globalTypes:_configFilename.globalTypes}),!1),_configFilename.argTypesEnhancers&&_configFilename.argTypesEnhancers.forEach((function(enhancer){return(0,_clientApi.addArgTypesEnhancer)(enhancer)}))},796:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(247)},797:function(module,exports,__webpack_require__){"use strict";(function(module){(0,__webpack_require__(247).configure)([__webpack_require__(798)],module,!1)}).call(this,__webpack_require__(113)(module))},798:function(module,exports,__webpack_require__){var map={"./Grid.stories.tsx":799,"./collaborative.stories.tsx":853,"./copypaste.stories.tsx":854,"./overlay.stories.tsx":855,"./pagination.stories.tsx":856,"./spreadsheet.stories.tsx":857,"./styling.stories.tsx":1043,"./theme.stories.tsx":1044,"./ticking.stories.tsx":1045,"./touch.stories.tsx":1046,"./treetable.stories.tsx":1047,"./undo.stories.tsx":1048};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=798},799:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"BaseGrid",(function(){return BaseGrid})),__webpack_require__.d(__webpack_exports__,"BaseGridSnap",(function(){return BaseGridSnap})),__webpack_require__.d(__webpack_exports__,"FullWidthGrid",(function(){return FullWidthGrid})),__webpack_require__.d(__webpack_exports__,"AutoSizer",(function(){return AutoSizer})),__webpack_require__.d(__webpack_exports__,"MergedCells",(function(){return MergedCells})),__webpack_require__.d(__webpack_exports__,"BaseGridWithSelection",(function(){return BaseGridWithSelection})),__webpack_require__.d(__webpack_exports__,"VariableSizeGrid",(function(){return VariableSizeGrid})),__webpack_require__.d(__webpack_exports__,"LargeGrid",(function(){return LargeGrid})),__webpack_require__.d(__webpack_exports__,"DataGrid",(function(){return DataGrid})),__webpack_require__.d(__webpack_exports__,"DataGridResize",(function(){return DataGridResize})),__webpack_require__.d(__webpack_exports__,"GridWithFrozenRow",(function(){return GridWithFrozenRow})),__webpack_require__.d(__webpack_exports__,"GridWithFrozenColumns",(function(){return GridWithFrozenColumns})),__webpack_require__.d(__webpack_exports__,"GridWithFrozenEdges",(function(){return GridWithFrozenEdges})),__webpack_require__.d(__webpack_exports__,"EditableGrid",(function(){return EditableGrid})),__webpack_require__.d(__webpack_exports__,"WithTooltip",(function(){return WithTooltip})),__webpack_require__.d(__webpack_exports__,"GridWithContextMenu",(function(){return GridWithContextMenu}));__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(55),__webpack_require__(47),__webpack_require__(25),__webpack_require__(38),__webpack_require__(20),__webpack_require__(13),__webpack_require__(96),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(68),__webpack_require__(8),__webpack_require__(132),__webpack_require__(133),__webpack_require__(32),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(48),__webpack_require__(21);var react__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_25___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_25__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(7),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__),react_use__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(1056),react_konva__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(14);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}__webpack_exports__.default={title:"Grid",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a};var BaseGrid=function BaseGrid(){var App=function App(){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,{width:900,height:600,columnCount:200,rowCount:200,columnWidth:function columnWidth(index){return 100},itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__.Cell,_extends({},props,{value:"".concat(props.rowIndex,":").concat(props.columnIndex)}))},rowHeight:function rowHeight(index){return 20}})};return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(App,null)},BaseGridSnap=function BaseGridSnap(){var Cell=function Cell(_ref){var rowIndex=_ref.rowIndex,columnIndex=_ref.columnIndex,x=_ref.x,y=_ref.y,width=_ref.width,height=_ref.height,text="".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_25___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))},App=function App(){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,{width:900,height:600,columnCount:200,rowCount:200,columnWidth:function columnWidth(index){return 100},snap:!0,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(Cell,props)},rowHeight:function rowHeight(index){return 20}})};return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(App,null)};BaseGridSnap.story={name:"Autosnap"};var FullWidthGrid=function FullWidthGrid(){var itemRenderer=function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__.Cell,_extends({value:"".concat(props.rowIndex,":").concat(props.columnIndex)},props))},App=function App(){var _useMeasure2=_slicedToArray(Object(react_use__WEBPACK_IMPORTED_MODULE_27__.a)(),2),containerRef=_useMeasure2[0],_useMeasure2$=_useMeasure2[1],width=_useMeasure2$.width,height=_useMeasure2$.height;return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement("div",{style:{flex:1,width:"100%",height:600},ref:containerRef},react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,{width:width,height:height,columnCount:200,rowCount:200,columnWidth:function columnWidth(index){return 100},itemRenderer:itemRenderer,rowHeight:function rowHeight(index){return 20}}))};return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(App,null)},AutoSizer=function AutoSizer(){var Cell=function Cell(_ref2){var rowIndex=_ref2.rowIndex,columnIndex=_ref2.columnIndex,x=_ref2.x,y=_ref2.y,width=_ref2.width,height=_ref2.height,text=_ref2.value||"".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_25___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"left",offsetX:-5}))},App=function App(){var _useState3,_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_25__.useState)((_defineProperty(_useState3={},[1,2],"Hello, good morning"),_defineProperty(_useState3,[30,4],"lorem asd asd as das dasd asd as da sdasdasda"),_defineProperty(_useState3,[2,15],"lorem asd asd as das dasd asd as da sdasdasda"),_useState3)),2),data=_useState2[0],gridRef=(_useState2[1],Object(react__WEBPACK_IMPORTED_MODULE_25__.useRef)(null)),getCellValue=Object(react__WEBPACK_IMPORTED_MODULE_25__.useCallback)((function(_ref3){var rowIndex=_ref3.rowIndex,columnIndex=_ref3.columnIndex;return data[[rowIndex,columnIndex]]}),[data]),autoSizerProps=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__.useSizer)({gridRef:gridRef,getValue:getCellValue});return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,_extends({ref:gridRef,width:900,height:600,columnCount:200,rowCount:200,columnWidth:function columnWidth(index){return 100},itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(Cell,_extends({value:data[[props.rowIndex,props.columnIndex]]},props))},rowHeight:function rowHeight(index){return 20}},autoSizerProps))};return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(App,null)},MergedCells=function MergedCells(){var Cell=function Cell(_ref4){var rowIndex=_ref4.rowIndex,columnIndex=_ref4.columnIndex,x=_ref4.x,y=_ref4.y,width=_ref4.width,height=_ref4.height,text="".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_25___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))},App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_25__.useRef)(),_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__.useSelection)({gridRef:gridRef,rowCount:200,columnCount:200}),selection=_useSelection.selection,selectionProps=_objectWithoutProperties(_useSelection,["selection"]);return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,_extends({width:900,height:600,columnCount:200,rowCount:200,ref:gridRef,mergedCells:[{top:5,left:5,right:6,bottom:5},{top:1,left:2,right:4,bottom:5},{top:5,left:0,right:1,bottom:5}],columnWidth:function columnWidth(index){return 100},itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(Cell,props)},rowHeight:function rowHeight(index){return 20},selection:selection},selectionProps))};return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(App,null)},BaseGridWithSelection=function BaseGridWithSelection(){var initialSelections=[{bounds:{top:2,right:3,left:2,bottom:20},style:{borderStyle:"dashed"}}],Cell=function Cell(_ref5){var rowIndex=_ref5.rowIndex,columnIndex=_ref5.columnIndex,x=_ref5.x,y=_ref5.y,width=_ref5.width,height=_ref5.height,text="".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_25___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))},App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_25__.useRef)(),_useSelection2=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__.useSelection)({initialSelections:initialSelections,gridRef:gridRef,rowCount:200,columnCount:200}),selections=_useSelection2.selections,activeCell=_useSelection2.activeCell,selectionProps=_objectWithoutProperties(_useSelection2,["selections","activeCell"]);return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,_extends({width:900,height:600,selections:selections,activeCell:activeCell,columnCount:2e3,rowCount:2e3,showGridLines:!0,gridLineColor:"gray",showFillHandle:!1,frozenColumns:1,frozenRows:1,snap:!0,ref:gridRef},selectionProps,{columnWidth:function columnWidth(index){return 100},rowHeight:function rowHeight(index){return 20},itemRenderer:Cell}))};return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(App,null)},VariableSizeGrid=function VariableSizeGrid(){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,{width:900,height:600,columnCount:200,rowCount:200,columnWidth:function columnWidth(index){return index%3==0?200:100},rowHeight:function rowHeight(index){return index%2==0?40:20},itemRenderer:function Cell(_ref6){var rowIndex=_ref6.rowIndex,columnIndex=_ref6.columnIndex,x=_ref6.x,y=_ref6.y,width=_ref6.width,height=_ref6.height,text="".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_25___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))}})},LargeGrid=function LargeGrid(){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,{width:900,height:600,columnCount:1e6,rowCount:1e6,columnWidth:function columnWidth(index){return index%3==0?200:100},rowHeight:function rowHeight(index){return index%2==0?40:20},itemRenderer:function Cell(_ref7){var rowIndex=_ref7.rowIndex,columnIndex=_ref7.columnIndex,x=_ref7.x,y=_ref7.y,width=_ref7.width,height=_ref7.height,text="".concat(rowIndex,"x").concat(columnIndex),fill=columnIndex%2==0?rowIndex%2==0?"#f8f8f0":"white":rowIndex%2?"#f8f8f0":"white";return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_25___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Rect,{x:x,y:y,height:height,width:width,fill:fill,stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))}})};LargeGrid.story={name:"1,000,000 rows and cols"};var DataGrid=function DataGrid(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_25__.useRef)(),Cell=function Cell(_ref8){var rowIndex=_ref8.rowIndex,columnIndex=_ref8.columnIndex,x=_ref8.x,y=_ref8.y,width=_ref8.width,height=_ref8.height,header=_ref8.header,text=header?columnIndex<1?"S/No":"Header ".concat(columnIndex):"".concat(rowIndex,"x").concat(columnIndex),fill=header?"#eee":"white";return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_25___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Rect,{x:x,y:y,height:height,width:width,fill:fill,stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Text,{x:x,y:y,height:height,width:width,text:text,fontStyle:header?"bold":"normal",verticalAlign:"middle",align:"center"}))};return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,{columnCount:1e5,height:40,rowCount:1,frozenColumns:1,ref:gridRef,width:900,columnWidth:function columnWidth(index){return 0===index?80:index%3==0?200:100},rowHeight:function rowHeight(index){return index%2==0?40:20},showScrollbar:!1,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(Cell,_extends({},props,{header:!0}))}}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,{columnCount:1e5,rowCount:1e5,frozenColumns:1,height:600,width:900,columnWidth:function columnWidth(index){return 0===index?80:index%3==0?200:100},rowHeight:function rowHeight(index){return index%2==0?40:20},onScroll:function onScroll(_ref9){var scrollLeft=_ref9.scrollLeft;gridRef.current.scrollTo({scrollLeft:scrollLeft})},itemRenderer:Cell}))},DataGridResize=function DataGridResize(){var DraggableRect=function DraggableRect(props){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Rect,_extends({fill:"blue",draggable:!0,hitStrokeWidth:20,onMouseEnter:function onMouseEnter(){return document.body.style.cursor="ew-resize"},onMouseLeave:function onMouseLeave(){return document.body.style.cursor="default"},dragBoundFunc:function dragBoundFunc(pos){return _objectSpread(_objectSpread({},pos),{},{y:0})}},props))},HeaderComponent=function HeaderComponent(_ref10){_ref10.rowIndex;var columnIndex=_ref10.columnIndex,x=_ref10.x,y=_ref10.y,width=_ref10.width,height=_ref10.height,frozenColumns=_ref10.frozenColumns,onResize=_ref10.onResize,text=columnIndex<frozenColumns?"S/No":"Header ".concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Group,null,react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Rect,{x:x,y:y,height:height,width:width,fill:"#eee",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Text,{x:x,y:y,height:height,width:width,text:text,fontStyle:"bold",verticalAlign:"middle",align:"center"}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(DraggableRect,{x:x+width-5,y:y,width:5,height:height,onDragMove:function onDragMove(e){var newWidth=e.target.x()-x+5;onResize(columnIndex,newWidth)}}))},Cell=function Cell(_ref11){var rowIndex=_ref11.rowIndex,columnIndex=_ref11.columnIndex,x=_ref11.x,y=_ref11.y,width=_ref11.width,height=_ref11.height,key=_ref11.key,text="".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_25___default.a.Fragment,{key:key},react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Text,{x:x,y:y,height:height,width:width,text:text,fontStyle:"normal",verticalAlign:"middle",align:"center"}))},App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_25__.useRef)(),mainGridRef=Object(react__WEBPACK_IMPORTED_MODULE_25__.useRef)(),_useState5=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_25__.useState)({}),2),columnWidthMap=_useState5[0],setColumnWidthMap=_useState5[1],handleResize=function handleResize(columnIndex,newWidth){setColumnWidthMap((function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},columnIndex,newWidth))})),gridRef.current.resizeColumns([columnIndex]),mainGridRef.current.resizeColumns([columnIndex])};return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,{columnCount:1e5,height:40,rowCount:1,frozenColumns:1,ref:gridRef,width:900,columnWidth:function columnWidth(index){return index in columnWidthMap?columnWidthMap[index]:0===index?80:index%3==0?200:100},rowHeight:function rowHeight(index){return index%2==0?40:20},showScrollbar:!1,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(HeaderComponent,_extends({onResize:handleResize,frozenColumns:1},props))}}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,{columnCount:1e5,rowCount:1e5,frozenColumns:1,height:600,width:900,ref:mainGridRef,columnWidth:function columnWidth(index){return index in columnWidthMap?columnWidthMap[index]:0===index?80:index%3==0?200:100},rowHeight:function rowHeight(index){return index%2==0?40:20},onScroll:function onScroll(_ref12){var scrollLeft=_ref12.scrollLeft;gridRef.current.scrollTo({scrollLeft:scrollLeft})},itemRenderer:Cell}))};return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(App,null)};DataGridResize.story={name:"Grid with resizable headers"};var GridWithFrozenRow=function GridWithFrozenRow(){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,{width:900,height:600,columnCount:200,rowCount:200,frozenRows:1,columnWidth:function columnWidth(index){return 100},rowHeight:function rowHeight(index){return 20},itemRenderer:function Cell(_ref13){var rowIndex=_ref13.rowIndex,columnIndex=_ref13.columnIndex,x=_ref13.x,y=_ref13.y,width=_ref13.width,height=_ref13.height,text="".concat(rowIndex,"x").concat(columnIndex),isFrozen=rowIndex<1;return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_25___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Rect,{x:x,y:y,height:height,width:width,fill:isFrozen?"lightblue":"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))}})};GridWithFrozenRow.story={name:"Frozen rows"};var GridWithFrozenColumns=function GridWithFrozenColumns(){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,{width:900,height:600,columnCount:200,rowCount:200,frozenColumns:1,columnWidth:function columnWidth(index){return 100},rowHeight:function rowHeight(index){return 20},itemRenderer:function Cell(_ref14){var rowIndex=_ref14.rowIndex,columnIndex=_ref14.columnIndex,x=_ref14.x,y=_ref14.y,width=_ref14.width,height=_ref14.height,text="".concat(rowIndex,"x").concat(columnIndex),isFrozen=columnIndex<1;return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_25___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Rect,{x:x,y:y,height:height,width:width,fill:isFrozen?"lightblue":"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))}})};GridWithFrozenColumns.story={name:"Frozen columns"};var GridWithFrozenEdges=function GridWithFrozenEdges(){var Cell=function Cell(_ref15){var rowIndex=_ref15.rowIndex,columnIndex=_ref15.columnIndex,x=_ref15.x,y=_ref15.y,width=_ref15.width,height=_ref15.height,text="".concat(rowIndex,"x").concat(columnIndex),isFrozen=rowIndex<2||columnIndex<2;return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_25___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Rect,{x:x,y:y,height:height,width:width,fill:isFrozen?"lightblue":"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))},App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_25__.useRef)(),_useSelection3=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__.useSelection)({gridRef:gridRef,rowCount:200,columnCount:200}),selection=_useSelection3.selection,selectionProps=_objectWithoutProperties(_useSelection3,["selection"]);return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,_extends({ref:gridRef,selection:selection,width:900,height:600,columnCount:1e5,rowCount:1e5,frozenColumns:2,frozenRows:2,columnWidth:function columnWidth(index){return 100},rowHeight:function rowHeight(index){return 20},itemRenderer:Cell},selectionProps))};return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(App,null)};GridWithFrozenEdges.story={name:"Frozen columns and rows"};var EditableGrid=function EditableGrid(){var SelectEditor=function SelectEditor(props){var _React$createElement,position=props.position,onSubmit=props.onSubmit,value=props.value,cell=props.cell,nextFocusableCell=props.nextFocusableCell,onBlur=props.onBlur;return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement("div",{style:{position:"absolute",left:position.x,top:position.y,width:position.width,height:position.height}},react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement("select",(_defineProperty(_React$createElement={style:{width:"100%"},autoFocus:!0,value:value,onBlur:onBlur},"value",value),_defineProperty(_React$createElement,"onChange",(function onChange(e){onSubmit(e.target.value,cell,nextFocusableCell(cell,_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__.Direction.Down))})),_React$createElement),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement("option",null,"Yay Select"),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement("option",null,"This can be any React Component")))},App=function App(){var _useState8,_useState7=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_25__.useState)((_defineProperty(_useState8={},[1,2],"Hello lorem ipsum lorem"),_defineProperty(_useState8,[1,1],"Select editor"),_defineProperty(_useState8,[2,3],"Cannot be edited"),_defineProperty(_useState8,[30,4],"lorem asd asd as das dasd asd as da sdasdasda"),_defineProperty(_useState8,[2,15],"lorem asd asd as das dasd asd as da sdasdasda"),_defineProperty(_useState8,[100,80],"asdhasd asd asd asd as dasdas"),_useState8)),2),data=_useState7[0],setData=_useState7[1],gridRef=Object(react__WEBPACK_IMPORTED_MODULE_25__.useRef)(null),getCellValue=Object(react__WEBPACK_IMPORTED_MODULE_25__.useCallback)((function(_ref16){var rowIndex=_ref16.rowIndex,columnIndex=_ref16.columnIndex;return data[[rowIndex,columnIndex]]}),[data]),_useSelection4=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__.useSelection)({gridRef:gridRef,rowCount:200,columnCount:200,onFill:function onFill(activeCell,fillSelection){if(fillSelection){for(var bounds=fillSelection.bounds,changes={},value=getCellValue(activeCell),i=bounds.top;i<=bounds.bottom;i++)for(var j=bounds.left;j<=bounds.right;j++)changes[[i,j]]=value;setData((function(prev){return _objectSpread(_objectSpread({},prev),changes)}))}}}),activeCell=_useSelection4.activeCell,selections=_useSelection4.selections,setActiveCell=_useSelection4.setActiveCell,selectionProps=_objectWithoutProperties(_useSelection4,["activeCell","selections","setActiveCell"]),_useAutoSizer=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__.useSizer)({gridRef:gridRef,getValue:getCellValue,resizeStrategy:"lazy",rowCount:200,autoResize:!1}),autoSizerProps=(_useAutoSizer.getTextMetrics,_objectWithoutProperties(_useAutoSizer,["getTextMetrics"])),_useEditable=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__.useEditable)({rowCount:200,columnCount:200,gridRef:gridRef,getValue:getCellValue,selections:selections,getEditor:function getEditor(_ref17){var rowIndex=_ref17.rowIndex,columnIndex=_ref17.columnIndex;if(1==rowIndex&&1===columnIndex)return SelectEditor},activeCell:activeCell,onDelete:function onDelete(activeCell,selections){if(selections.length){var newValues=selections.reduce((function(acc,_ref18){for(var sel=_ref18.bounds,i=sel.top;i<=sel.bottom;i++)for(var j=sel.left;j<=sel.right;j++)acc[[i,j]]="";return acc}),{});setData((function(prev){return _objectSpread(_objectSpread({},prev),newValues)}));var selectionBounds=selections[0].bounds;gridRef.current.resetAfterIndices({columnIndex:selectionBounds.left,rowIndex:selectionBounds.top},!0)}else activeCell&&(setData((function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},[activeCell.rowIndex,activeCell.columnIndex],""))})),gridRef.current.resetAfterIndices(activeCell))},canEdit:function canEdit(_ref19){var rowIndex=_ref19.rowIndex,columnIndex=_ref19.columnIndex;return 2!==rowIndex||3!==columnIndex},onSubmit:function onSubmit(value,_ref20,nextActiveCell){var rowIndex=_ref20.rowIndex,columnIndex=_ref20.columnIndex;setData((function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},[rowIndex,columnIndex],value))})),gridRef.current.resizeColumns([columnIndex]),nextActiveCell&&setActiveCell(nextActiveCell)}}),editorComponent=_useEditable.editorComponent,isEditInProgress=_useEditable.isEditInProgress,editableProps=_objectWithoutProperties(_useEditable,["editorComponent","isEditInProgress"]);return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement("div",{style:{position:"relative"}},react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,_extends({width:900,height:600,columnCount:1e5,rowCount:1e5,ref:gridRef,activeCell:activeCell,selections:selections,columnWidth:function columnWidth(index){return 100},showFillHandle:!isEditInProgress,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__.Cell,_extends({value:data[[props.rowIndex,props.columnIndex]],align:"left"},props))},rowHeight:function rowHeight(index){return 20}},selectionProps,editableProps,autoSizerProps,{onKeyDown:function onKeyDown(){selectionProps.onKeyDown.apply(selectionProps,arguments),editableProps.onKeyDown.apply(editableProps,arguments)},onMouseDown:function onMouseDown(){selectionProps.onMouseDown.apply(selectionProps,arguments),editableProps.onMouseDown.apply(editableProps,arguments)}})),editorComponent)};return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(App,null)},WithTooltip=function WithTooltip(){var Cell=function Cell(_ref21){var rowIndex=_ref21.rowIndex,columnIndex=_ref21.columnIndex,x=_ref21.x,y=_ref21.y,width=_ref21.width,height=_ref21.height,text="".concat(rowIndex,"x").concat(columnIndex);return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_25___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Rect,{x:x,y:y,height:height,width:width,fill:"white",stroke:"grey",strokeWidth:.5}),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_28__.Text,{x:x,y:y,height:height,width:width,text:text,verticalAlign:"middle",align:"center"}))},App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_25__.useRef)(),_useTooltip=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__.useTooltip)({gridRef:gridRef,getValue:function getValue(_ref22){var rowIndex=_ref22.rowIndex,columnIndex=_ref22.columnIndex;return"You are at: ".concat(rowIndex,", ").concat(columnIndex)}}),tooltipComponent=_useTooltip.tooltipComponent,tooltipProps=_objectWithoutProperties(_useTooltip,["tooltipComponent"]);return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement("div",{style:{position:"relative"}},react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,_extends({ref:gridRef,width:900,height:600,columnCount:200,rowCount:200,columnWidth:function columnWidth(index){return 100},itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(Cell,props)},rowHeight:function rowHeight(index){return 20}},tooltipProps)),tooltipComponent)};return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(App,null)},GridWithContextMenu=function GridWithContextMenu(){var ContextMenu=function ContextMenu(_ref23){var left=_ref23.left,top=_ref23.top,rowIndex=_ref23.rowIndex,columnIndex=_ref23.columnIndex;return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement("div",{style:{left:left,top:top,position:"absolute",padding:8,background:"white",boxShadow:"0 1px 2px 3px rgba(0,0,0,0.2)"}},react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement("div",null,"You selected ",rowIndex,": ",columnIndex),react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement("a",{href:"#",style:{display:"block",padding:8}},"Hide column"))},App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_25__.useRef)(),_useState10=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_25__.useState)(null),2),contextMenuPostion=_useState10[0],setContextMenuPosition=_useState10[1];return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement("div",{style:{position:"relative"}},react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26___default.a,{ref:gridRef,onContextMenu:function onContextMenu(e){var _gridRef$current$getC=gridRef.current.getCellCoordsFromOffset(e.clientX,e.clientY),rowIndex=_gridRef$current$getC.rowIndex,columnIndex=_gridRef$current$getC.columnIndex;setContextMenuPosition({left:e.clientX+10,top:e.clientY+10,rowIndex:rowIndex,columnIndex:columnIndex}),e.preventDefault()},onMouseDown:function onMouseDown(){return setContextMenuPosition(null)},width:900,height:600,columnCount:200,rowCount:200,columnWidth:function columnWidth(index){return 100},itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_26__.Cell,_extends({},props,{value:"".concat(props.rowIndex,":").concat(props.columnIndex)}))},rowHeight:function rowHeight(index){return 20}}),contextMenuPostion&&react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(ContextMenu,contextMenuPostion))};return react__WEBPACK_IMPORTED_MODULE_25___default.a.createElement(App,null)}},844:function(module,exports,__webpack_require__){"use strict";function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_require__(9),__webpack_require__(30),__webpack_require__(38),__webpack_require__(26),__webpack_require__(8),__webpack_require__(32);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importDefault(__webpack_require__(1));exports.default=function FillHandle(_ref){var _ref$x=_ref.x,x=void 0===_ref$x?0:_ref$x,_ref$y=_ref.y,y=void 0===_ref$y?0:_ref$y,stroke=_ref.stroke,_ref$strokeWidth=_ref.strokeWidth,strokeWidth=void 0===_ref$strokeWidth?1:_ref$strokeWidth,_ref$size=_ref.size,size=void 0===_ref$size?8:_ref$size,borderColor=_ref.borderColor,props=_objectWithoutProperties(_ref,["x","y","stroke","strokeWidth","size","borderColor"]);return 0===x||0===y?null:react_1.default.createElement("div",Object.assign({style:{position:"absolute",left:x-size/2,top:y-size/2,width:size,height:size,border:"".concat(strokeWidth,"px ").concat(borderColor," solid"),background:stroke,cursor:"crosshair",pointerEvents:"all"}},props))}},845:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importDefault(__webpack_require__(1)),react_konva_1=__webpack_require__(14);exports.default=function GridLine(props){var points=props.points,stroke=props.stroke,strokeWidth=props.strokeWidth,offsetY=props.offsetY,offsetX=props.offsetX;return react_1.default.createElement(react_konva_1.Line,{points:points,stroke:stroke,strokeWidth:strokeWidth,offsetY:offsetY,offsetX:offsetX,shadowForStrokeEnabled:!1,strokeScaleEnabled:!1,hitStrokeWidth:0,listening:!1,perfectDrawEnabled:!1})}},846:function(module,exports,__webpack_require__){"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(118),__webpack_require__(21);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(1),helpers_1=__webpack_require__(90),tiny_invariant_1=__importDefault(__webpack_require__(295)),defaultGetText=function defaultGetText(text){return text};exports.default=function useAutoSizer(_ref){var gridRef=_ref.gridRef,getValue=_ref.getValue,_ref$initialVisibleRo=_ref.initialVisibleRows,initialVisibleRows=void 0===_ref$initialVisibleRo?20:_ref$initialVisibleRo,_ref$cellSpacing=_ref.cellSpacing,cellSpacing=void 0===_ref$cellSpacing?10:_ref$cellSpacing,_ref$minColumnWidth=_ref.minColumnWidth,minColumnWidth=void 0===_ref$minColumnWidth?60:_ref$minColumnWidth,_ref$timeout=_ref.timeout,timeout=void 0===_ref$timeout?300:_ref$timeout,_ref$resizeStrategy=_ref.resizeStrategy,resizeStrategy=void 0===_ref$resizeStrategy?"lazy":_ref$resizeStrategy,rowCount=_ref.rowCount,_ref$resizeOnScroll=_ref.resizeOnScroll,resizeOnScroll=void 0===_ref$resizeOnScroll||_ref$resizeOnScroll,_ref$fontFamily=_ref.fontFamily,fontFamily=void 0===_ref$fontFamily?"Arial":_ref$fontFamily,_ref$fontSize=_ref.fontSize,fontSize=void 0===_ref$fontSize?12:_ref$fontSize,_ref$fontWeight=_ref.fontWeight,fontWeight=void 0===_ref$fontWeight?"":_ref$fontWeight,_ref$fontStyle=_ref.fontStyle,fontStyle=void 0===_ref$fontStyle?"":_ref$fontStyle,_ref$autoResize=_ref.autoResize,autoResize=void 0===_ref$autoResize||_ref$autoResize,_ref$frozenRows=(_ref.columnSizes,_ref.frozenRows),frozenRows=void 0===_ref$frozenRows?0:_ref$frozenRows,_ref$scale=_ref.scale,scale=void 0===_ref$scale?1:_ref$scale,isHiddenRow=_ref.isHiddenRow,_ref$getText=(_ref.isHiddenColumn,_ref.getText),getText=void 0===_ref$getText?defaultGetText:_ref$getText;tiny_invariant_1.default(!("full"===resizeStrategy&&void 0===rowCount),"Row count should be specified if resize stragtegy is full");var autoSizer=react_1.useRef(helpers_1.autoSizerCanvas),_react_1$useState2=_slicedToArray(react_1.useState({rowStartIndex:0,rowStopIndex:0,columnStartIndex:0,columnStopIndex:0,visibleRowStartIndex:0,visibleRowStopIndex:0,visibleColumnStartIndex:0,visibleColumnStopIndex:0}),2),viewport=_react_1$useState2[0],setViewport=_react_1$useState2[1],isMounted=react_1.useRef(!1),getValueRef=react_1.useRef(),viewPortRef=react_1.useRef(),hiddenRowRef=react_1.useRef(isHiddenRow),handleResize=react_1.useCallback((function(_ref2){var rowIndex=_ref2.rowIndex,columnIndex=_ref2.columnIndex;gridRef.current&&gridRef.current.resetAfterIndices({rowIndex:rowIndex,columnIndex:columnIndex})}),[]),debounceResizer=react_1.useRef(null);react_1.useEffect((function(){getValueRef.current=getValue,viewPortRef.current=viewport,hiddenRowRef.current=isHiddenRow})),react_1.useEffect((function(){isMounted.current=!0,debounceResizer.current=helpers_1.debounce(handleResize,timeout)}),[]),react_1.useEffect((function(){autoSizer.current.setFont({fontFamily:fontFamily,fontSize:fontSize,fontWeight:fontWeight,fontStyle:fontStyle})}),[fontFamily,fontSize,fontWeight,fontStyle]);var getTextMetrics=react_1.useCallback((function(text){return autoSizer.current.measureText(helpers_1.castToString(text))}),[]),getCellWidth=react_1.useCallback((function(rowIndex,columnIndex){var _a,_b,_c,cellValue=null!==(_b=null===(_a=getValueRef.current)||void 0===_a?void 0:_a.call(getValueRef,{rowIndex:rowIndex,columnIndex:columnIndex}))&&void 0!==_b?_b:null,width=null!==(_c=null==cellValue?void 0:cellValue.spacing)&&void 0!==_c?_c:0;if(null!==cellValue){var isCellConfig="object"===_typeof(cellValue),text=getText(cellValue);if(void 0!==helpers_1.cellIdentifier&&!helpers_1.isNull(text)&&void 0!==text){if(autoSizer.current.reset(),isCellConfig){var isBold=cellValue.bold;autoSizer.current.setFont({fontWeight:isBold?"bold":"",fontSize:(cellValue.fontSize||fontSize)*scale,fontFamily:cellValue.fontFamily,fontStyle:cellValue.italic?"italic":""})}var metrics=autoSizer.current.measureText(text);metrics&&(width+=Math.ceil(metrics.width)+cellSpacing)}}return width}),[scale]),getColumnWidth=react_1.useCallback((function(columnIndex){for(var _a,_b,_c,_ref3=null!==(_a=viewPortRef.current)&&void 0!==_a?_a:{},_ref3$rowStartIndex=_ref3.rowStartIndex,rowStartIndex=void 0===_ref3$rowStartIndex?0:_ref3$rowStartIndex,_ref3$rowStopIndex=_ref3.rowStopIndex,visibleRows="full"===resizeStrategy?rowCount:(void 0===_ref3$rowStopIndex?0:_ref3$rowStopIndex)||initialVisibleRows,start="full"===resizeStrategy?0:rowStartIndex,maxWidth=minColumnWidth,i=0;i<frozenRows;i++)if(!(null===(_b=hiddenRowRef.current)||void 0===_b?void 0:_b.call(hiddenRowRef,i))){var width=getCellWidth(i,columnIndex);width>maxWidth&&(maxWidth=width)}for(;start<visibleRows;)if(null===(_c=hiddenRowRef.current)||void 0===_c?void 0:_c.call(hiddenRowRef,start))start++;else{var _width=getCellWidth(start,columnIndex);_width>maxWidth&&(maxWidth=_width),start++}return maxWidth/scale}),[viewport,initialVisibleRows,frozenRows,scale]),handleViewChange=react_1.useCallback((function(cells){if(setViewport(cells),"full"!==resizeStrategy&&resizeOnScroll&&(cells.rowStartIndex!==viewport.rowStartIndex||cells.columnStartIndex!==viewport.columnStartIndex)&&gridRef.current){if(!isMounted.current)return;debounceResizer.current({rowIndex:cells.rowStartIndex,columnIndex:cells.columnStartIndex})}}),[resizeOnScroll,viewport,resizeStrategy]);return Object.assign({},autoResize?{columnWidth:getColumnWidth}:void 0,{getColumnWidth:getColumnWidth,onViewChange:handleViewChange,getTextMetrics:getTextMetrics})}},847:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8),Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(1),scroller_1=__webpack_require__(848),helpers_1=__webpack_require__(90);exports.default=function useTouch(_ref){var gridRef=_ref.gridRef,scrollerRef=react_1.useRef(null),isTouchDevice=react_1.useRef(!1);react_1.useEffect((function(){var _a,_b,_c,_d,_e,_f,_g;if(isTouchDevice.current=helpers_1.canUseDOM&&"ontouchstart"in window,isTouchDevice.current){null===(_b=null===(_a=gridRef.current)||void 0===_a?void 0:_a.container)||void 0===_b||_b.addEventListener("touchstart",handleTouchStart),null===(_d=null===(_c=gridRef.current)||void 0===_c?void 0:_c.container)||void 0===_d||_d.addEventListener("touchend",handleTouchEnd),null===(_f=null===(_e=gridRef.current)||void 0===_e?void 0:_e.container)||void 0===_f||_f.addEventListener("touchmove",handleTouchMove),scrollerRef.current=new scroller_1.Scroller(handleTouchScroll,{scrollingX:!0,scrollingY:!0,decelerationRate:.95,penetrationAcceleration:.08});var dims=null===(_g=gridRef.current)||void 0===_g?void 0:_g.getDimensions();updateScrollDimensions(dims)}}),[]);var scrollTo=react_1.useCallback((function(_ref2){var scrollLeft=_ref2.scrollLeft,scrollTop=_ref2.scrollTop;scrollerRef.current&&scrollerRef.current.scrollTo(scrollLeft,scrollTop)}),[]),scrollToTop=react_1.useCallback((function(){scrollerRef.current&&scrollerRef.current.scrollTo(0,0)}),[]),updateScrollDimensions=react_1.useCallback((function(_ref3){var containerWidth=_ref3.containerWidth,containerHeight=_ref3.containerHeight,estimatedTotalWidth=_ref3.estimatedTotalWidth,estimatedTotalHeight=_ref3.estimatedTotalHeight;scrollerRef.current.setDimensions(containerWidth,containerHeight,estimatedTotalWidth,estimatedTotalHeight)}),[]),handleTouchScroll=react_1.useCallback((function(scrollLeft,scrollTop){var _a;null===(_a=gridRef.current)||void 0===_a||_a.scrollTo({scrollTop:scrollTop,scrollLeft:scrollLeft})}),[]),handleTouchStart=react_1.useCallback((function(e){scrollerRef.current.doTouchStart(e.touches,e.timeStamp)}),[]),handleTouchMove=react_1.useCallback((function(e){e.preventDefault(),scrollerRef.current.doTouchMove(e.touches,e.timeStamp)}),[]),handleTouchEnd=react_1.useCallback((function(e){scrollerRef.current.doTouchEnd(e.timeStamp)}),[]);return{isTouchDevice:isTouchDevice.current,scrollTo:scrollTo,scrollToTop:scrollToTop}}},850:function(module,exports,__webpack_require__){"use strict";function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(8),__webpack_require__(10),__webpack_require__(70),__webpack_require__(45),__webpack_require__(19),__webpack_require__(16),__webpack_require__(115),__webpack_require__(88),__webpack_require__(21),__webpack_require__(80),Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(1),helpers_1=__webpack_require__(90),types_1=__webpack_require__(97),defaultGetText=function defaultGetText(text){return text};exports.default=function useCopyPaste(_ref){var _ref$selections=_ref.selections,selections=void 0===_ref$selections?[]:_ref$selections,_ref$activeCell=_ref.activeCell,activeCell=void 0===_ref$activeCell?null:_ref$activeCell,getValue=_ref.getValue,gridRef=_ref.gridRef,onPaste=_ref.onPaste,onCopy=(_ref.onCut,_ref.onCopy),_ref$getText=_ref.getText,getText=void 0===_ref$getText?defaultGetText:_ref$getText,selectionRef=react_1.useRef({selections:selections,activeCell:activeCell,getValue:getValue}),cutSelections=react_1.useRef();react_1.useEffect((function(){selectionRef.current={selections:selections,activeCell:activeCell,getValue:getValue}}),[selections,activeCell,getValue]);var currentSelections=function currentSelections(){var sel=selectionRef.current.selections.length?selectionRef.current.selections:helpers_1.selectionFromActiveCell(selectionRef.current.activeCell);return sel[sel.length-1]};react_1.useEffect((function(){if(gridRef.current)return document.addEventListener("copy",handleCopy),document.addEventListener("paste",handlePaste),document.addEventListener("cut",handleCut),function(){document.removeEventListener("copy",handleCopy),document.removeEventListener("paste",handlePaste),document.removeEventListener("cut",handleCut)}}),[]);var handleCut=react_1.useCallback((function(){var _a;document.activeElement===(null===(_a=gridRef.current)||void 0===_a?void 0:_a.container)&&(cutSelections.current=currentSelections(),handleProgramaticCopy())}),[]),handleCopy=react_1.useCallback((function(e){var _a,_b,_c,_d,_e;if(document.activeElement===(null===(_a=gridRef.current)||void 0===_a?void 0:_a.container)){for(var selection=currentSelections(),bounds=selection.bounds,top=bounds.top,left=bounds.left,right=bounds.right,bottom=bounds.bottom,rows=[],cells=[],i=top;i<=bottom;i++){for(var row=[],cell=[],j=left;j<=right;j++){var coords={rowIndex:i,columnIndex:j},config=Object.assign({},selectionRef.current.getValue(coords),{sourceCell:coords}),value=getText(config);cell.push(config),row.push(value)}rows.push(row),cells.push(cell)}var _helpers_1$prepareCli2=_slicedToArray(helpers_1.prepareClipboardData(rows),2),html=_helpers_1$prepareCli2[0],csv=_helpers_1$prepareCli2[1];null===(_b=e.clipboardData)||void 0===_b||_b.setData(types_1.MimeType.html,html),null===(_c=e.clipboardData)||void 0===_c||_c.setData(types_1.MimeType.plain,csv),null===(_d=e.clipboardData)||void 0===_d||_d.setData(types_1.MimeType.csv,csv),null===(_e=e.clipboardData)||void 0===_e||_e.setData(types_1.MimeType.json,JSON.stringify(cells)),e.preventDefault(),null==onCopy||onCopy([selection])}}),[currentSelections]),handlePaste=function handlePaste(e){var _a,_b,_c,_d;if(document.activeElement===(null===(_a=gridRef.current)||void 0===_a?void 0:_a.container)&&(null===(_b=e.clipboardData)||void 0===_b?void 0:_b.items)){for(var type,value,mimeTypes=[types_1.MimeType.json,types_1.MimeType.html,types_1.MimeType.csv,types_1.MimeType.plain],plainTextValue=null===(_c=e.clipboardData)||void 0===_c?void 0:_c.getData(types_1.MimeType.plain),_i2=0,_mimeTypes=mimeTypes;_i2<_mimeTypes.length&&(type=_mimeTypes[_i2],!(value=null===(_d=e.clipboardData)||void 0===_d?void 0:_d.getData(type)));_i2++);if(type&&value){var rows=[];if(/^text\/html/.test(type)){var nodes=(new DOMParser).parseFromString(value,type).querySelectorAll("table, p, h1, h2, h3, h4, h5, h6");0===nodes.length&&rows.push([plainTextValue]);for(var i=0;i<nodes.length;i++){var node=nodes[i];if("TABLE"===node.nodeName)for(var tableRows=node.querySelectorAll("tr"),_i3=0;_i3<tableRows.length;_i3++){for(var row=[],cells=tableRows[_i3].querySelectorAll("td"),j=0;j<cells.length;j++){var cell=cells[j];row.push(cell.textContent)}rows.push(row)}else rows.push([node.textContent])}}else if(type===types_1.MimeType.json)rows=JSON.parse(value);else if(type===types_1.MimeType.plain)rows=[[value]];else{var _step,_iterator=_createForOfIteratorHelper(value.split("\n"));try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step2,val=_step.value,_row=[],_iterator2=_createForOfIteratorHelper(val.split(","));try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _cell=_step2.value;_row.push(_cell.replace(/^\"|\"$/gi,""))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}rows.push(_row)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}onPaste&&onPaste(rows,selectionRef.current.activeCell,selectionRef.current.selections,cutSelections.current),cutSelections.current=void 0}else console.warn("No clipboard data to paste")}},handleProgramaticCopy=react_1.useCallback((function(){gridRef.current&&(gridRef.current.focus(),document.execCommand("copy"))}),[]),handleProgramaticPaste=react_1.useCallback(_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var text,clipboardData,event;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(gridRef.current){_context.next=2;break}return _context.abrupt("return");case 2:return gridRef.current.focus(),_context.next=5,navigator.clipboard.readText();case 5:text=_context.sent,(clipboardData=new DataTransfer).setData(types_1.MimeType.plain,text),event=new ClipboardEvent("paste",{clipboardData:clipboardData}),handlePaste(event);case 10:case"end":return _context.stop()}}),_callee)}))),[]);return{copy:handleProgramaticCopy,paste:handleProgramaticPaste,cut:handleCut}}},851:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(33),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),PaginationComponent=function PaginationComponent(_ref){for(var currentPage=_ref.currentPage,goToFirst=_ref.goToFirst,goToLast=_ref.goToLast,goToPage=_ref.goToPage,totalPages=_ref.totalPages,nextPage=_ref.nextPage,prevPage=_ref.prevPage,pages=[],_loop=function _loop(i){var isActive=currentPage===i;pages.push(react_1.default.createElement("button",{onClick:function onClick(){return goToPage(i)}},isActive?react_1.default.createElement("strong",null,i):i))},i=1;i<=totalPages;i++)_loop(i);return react_1.default.createElement("div",null,react_1.default.createElement("button",{onClick:goToFirst,disabled:1===currentPage},"First page"),react_1.default.createElement("button",{onClick:prevPage,disabled:1===currentPage},"Prev page"),pages,react_1.default.createElement("button",{onClick:nextPage,disabled:currentPage===totalPages},"Next page"),react_1.default.createElement("button",{onClick:goToLast,disabled:currentPage===totalPages},"Last page"))};exports.default=function usePagination(props){var _props$initialCurrent=props.initialCurrentPage,initialCurrentPage=void 0===_props$initialCurrent?1:_props$initialCurrent,_props$pageSize=props.pageSize,pageSize=void 0===_props$pageSize?10:_props$pageSize,_props$total=props.total,total=void 0===_props$total?0:_props$total,onChange=props.onChange,_props$component=props.component,component=void 0===_props$component?PaginationComponent:_props$component,_react_1$useState2=_slicedToArray(react_1.useState(initialCurrentPage),2),currentPage=_react_1$useState2[0],setCurrentPage=_react_1$useState2[1],totalPages=Math.ceil(total/pageSize);react_1.useEffect((function(){onChange&&onChange(currentPage)}),[currentPage]);var pageProps={currentPage:currentPage,totalPages:totalPages,nextPage:function nextPage(){return setCurrentPage((function(prev){return Math.min(prev+1,totalPages)}))},prevPage:function prevPage(){return setCurrentPage((function(prev){return Math.max(prev-1,1)}))},goToFirst:function goToFirst(){return setCurrentPage(1)},goToLast:function goToLast(){return setCurrentPage(totalPages)},goToPage:function goToPage(page){return setCurrentPage(page)},pageSize:pageSize},paginationComponent=react_1.default.createElement(component,pageProps);return Object.assign({paginationComponent:paginationComponent},pageProps)}},852:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(8),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21),Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(1);exports.default=function useImage(_ref){var url=_ref.url,crossOrigin=_ref.crossOrigin,_react_1$useState2=_slicedToArray(react_1.useState((function(){return{image:void 0,status:"loading",width:0,height:0}})),2),state=_react_1$useState2[0],setState=_react_1$useState2[1];return react_1.useEffect((function(){if(url){var img=new Image;return img.addEventListener("load",onload),img.addEventListener("error",onerror),crossOrigin&&(img.crossOrigin=crossOrigin),img.src=url,function(){img.removeEventListener("load",onload),img.removeEventListener("error",onerror)}}function onload(){setState({image:img,height:img.height,width:img.width,status:"loaded"})}function onerror(){setState((function(prev){return Object.assign({},prev,{image:void 0,status:"failed"})}))}}),[url,crossOrigin]),state}},853:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"SharedActiveCells",(function(){return SharedActiveCells}));__webpack_require__(9),__webpack_require__(30),__webpack_require__(117),__webpack_require__(38),__webpack_require__(49),__webpack_require__(26),__webpack_require__(32);var react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_7__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(7),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_8__);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_exports__.default={title:"Collaboration",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_8___default.a};var SharedActiveCells=function SharedActiveCells(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_7__.useRef)(),_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_8__.useSelection)({gridRef:gridRef,rowCount:200,columnCount:200,getValue:function getValue(){return""}}),selections=_useSelection.selections,selectionProps=_objectWithoutProperties(_useSelection,["selections"]),touchProps=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_8__.useTouch)({gridRef:gridRef}),sharedActiveCells=[{label:"User A",isEditing:!1,cell:{rowIndex:1,columnIndex:2},style:{fill:"rgba(0,0,0,0.2)",stroke:"green",strokeWidth:2}},{label:"User B",isEditing:!1,cell:{rowIndex:4,columnIndex:6},style:{stroke:"green",strokeWidth:2}}],_useTooltip=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_8__.useTooltip)({gridRef:gridRef,getTooltip:function getTooltip(cell){return function(props){var _props$x=props.x,x=void 0===_props$x?0:_props$x,_props$y=props.y,y=void 0===_props$y?0:_props$y,_props$scrollLeft=props.scrollLeft,scrollLeft=void 0===_props$scrollLeft?0:_props$scrollLeft,_props$scrollTop=props.scrollTop,scrollTop=void 0===_props$scrollTop?0:_props$scrollTop,_props$width=props.width,width=void 0===_props$width?0:_props$width,isSharedActiveCell=(props.height,sharedActiveCells.find((function(item){return item.cell.rowIndex===cell.rowIndex&&item.cell.columnIndex===cell.columnIndex})));if(!isSharedActiveCell)return null;var posX=x+width-scrollLeft,posY=y-scrollTop;return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement("div",{style:{position:"absolute",left:0,top:0,transform:"translate(".concat(posX,"px, ").concat(posY,"px)"),background:"green",boxShadow:"0 4px 8px 3px rgba(60,64,67,.15)",padding:2,borderTopRightRadius:2,borderBottomRightRadius:2,fontSize:12,fontFamily:"Arial",color:"white"}},isSharedActiveCell.label)}}}),tooltipComponent=_useTooltip.tooltipComponent,tooltipProps=_objectWithoutProperties(_useTooltip,["tooltipComponent"]),borderStyles=sharedActiveCells.map((function(_ref){var cell=_ref.cell,style=_ref.style;return{bounds:{top:cell.rowIndex,bottom:cell.rowIndex,left:cell.columnIndex,right:cell.columnIndex},style:style}}));return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement("div",{style:{position:"relative"}},react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_8___default.a,_extends({ref:gridRef,itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_8__.Cell,_extends({},props,{value:"".concat(props.rowIndex,":").concat(props.columnIndex)}))},showFillHandle:!0,rowCount:200,columnCount:200,selections:selections,borderStyles:borderStyles},selectionProps,touchProps,tooltipProps)),tooltipComponent)};SharedActiveCells.story={name:"Default"}},854:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Default",(function(){return Default}));__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(55),__webpack_require__(47),__webpack_require__(25),__webpack_require__(38),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(68),__webpack_require__(8),__webpack_require__(132),__webpack_require__(133),__webpack_require__(32),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(48),__webpack_require__(21);var react__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_23___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_23__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(7),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_24___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_24__);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_exports__.default={title:"Copy Paste",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_24___default.a};var Default=function Default(){var App=function App(){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_23__.useState)(_defineProperty({},[1,2],"Hello world")),2),data=_useState2[0],setData=_useState2[1],gridRef=Object(react__WEBPACK_IMPORTED_MODULE_23__.useRef)(),getValue=Object(react__WEBPACK_IMPORTED_MODULE_23__.useCallback)((function(_ref){var rowIndex=_ref.rowIndex,columnIndex=_ref.columnIndex;return data[[rowIndex,columnIndex]]}),[data]),_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_24__.useSelection)({gridRef:gridRef,columnCount:100,rowCount:100}),activeCell=_useSelection.activeCell,selections=_useSelection.selections,setSelections=_useSelection.setSelections,selectionProps=_objectWithoutProperties(_useSelection,["activeCell","selections","setSelections"]),_useCopyPaste=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_24__.useCopyPaste)({gridRef:gridRef,selections:selections,activeCell:activeCell,getValue:getValue,onPaste:function onPaste(rows,activeCell){var _step,rowIndex=activeCell.rowIndex,columnIndex=activeCell.columnIndex,endRowIndex=Math.max(rowIndex,rowIndex+rows.length-1),endColumnIndex=Math.max(columnIndex,columnIndex+(rows.length&&rows[0].length-1)),changes={},_iterator=_createForOfIteratorHelper(rows.entries());try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step2,_step$value=_slicedToArray(_step.value,2),i=_step$value[0],_iterator2=_createForOfIteratorHelper(_step$value[1].entries());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _step2$value=_slicedToArray(_step2.value,2),j=_step2$value[0],cell=_step2$value[1];changes[[rowIndex+i,columnIndex+j]]=cell}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}setData((function(prev){return _objectSpread(_objectSpread({},prev),changes)})),rowIndex===endRowIndex&&columnIndex===endColumnIndex||setSelections([{bounds:{top:rowIndex,left:columnIndex,bottom:endRowIndex,right:endColumnIndex}}])},onCut:function onCut(selection){for(var bounds=selection.bounds,changes={},i=bounds.top;i<=bounds.bottom;i++)for(var j=bounds.left;j<=bounds.right;j++)changes[[i,j]]=void 0;setData((function(prev){return _objectSpread(_objectSpread({},prev),changes)}))}}),copy=_useCopyPaste.copy,paste=_useCopyPaste.paste;return react__WEBPACK_IMPORTED_MODULE_23___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_23___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_23___default.a.createElement("button",{onClick:function onClick(){return copy()}},"Copy"),react__WEBPACK_IMPORTED_MODULE_23___default.a.createElement("button",{onClick:function onClick(){return paste()}},"Paste"),react__WEBPACK_IMPORTED_MODULE_23___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_24___default.a,_extends({activeCell:activeCell,selections:selections,ref:gridRef,rowCount:100,columnCount:100,columnWidth:function columnWidth(){return 100},itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_23___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_24__.Cell,_extends({},props,{value:data[[props.rowIndex,props.columnIndex]]}))}},selectionProps)))};return react__WEBPACK_IMPORTED_MODULE_23___default.a.createElement(App,null)};Default.story={name:"Copy cells"}},855:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"CanvasOverlay",(function(){return CanvasOverlay})),__webpack_require__.d(__webpack_exports__,"ChartJs",(function(){return ChartJs}));__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(55),__webpack_require__(47),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(68),__webpack_require__(8),__webpack_require__(132),__webpack_require__(133),__webpack_require__(32),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(48),__webpack_require__(21);var react__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_21___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_21__),react_konva__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(14),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(7),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_23___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_23__);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_exports__.default={title:"Overlays",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_23___default.a};var Resizable=function Resizable(_ref){var scrollTop=_ref.scrollTop,scrollLeft=_ref.scrollLeft,isSelected=_ref.isSelected,onSelect=_ref.onSelect,trRef=Object(react__WEBPACK_IMPORTED_MODULE_21__.useRef)(null),shapeRef=Object(react__WEBPACK_IMPORTED_MODULE_21__.useRef)();Object(react__WEBPACK_IMPORTED_MODULE_21__.useEffect)((function(){isSelected&&(trRef.current.attachTo(shapeRef.current),trRef.current.getLayer().batchDraw())}),[isSelected]);var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_21__.useState)({x:100,y:100,width:100,height:100}),2),dimensions=_useState2[0],setDimensions=_useState2[1],x=dimensions.x-scrollLeft,y=dimensions.y-scrollTop;return react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_21___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_22__.Rect,{onMouseDown:onSelect,ref:shapeRef,draggable:!0,onDragEnd:function onDragEnd(e){setDimensions((function(prev){return _objectSpread(_objectSpread({},prev),{},{x:e.target.x()+scrollLeft,y:e.target.y()+scrollTop})}))},onTransformEnd:function onTransformEnd(e){var node=shapeRef.current,scaleX=node.scaleX(),scaleY=node.scaleY();node.scaleX(1),node.scaleY(1),setDimensions({x:node.x(),y:node.y(),width:Math.max(5,node.width()*scaleX),height:Math.max(node.height()*scaleY)})},fill:"lightblue",stroke:"#aaa",strokeWidth:1,x:x,y:y,width:dimensions.width,height:dimensions.height}),isSelected&&react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_22__.Transformer,{ref:trRef,rotateEnabled:!1,boundBoxFunc:function boundBoxFunc(oldBox,newBox){return newBox.width<5||newBox.height<5?oldBox:newBox}}))},CanvasOverlay=function CanvasOverlay(){var App=function App(){var _useState4=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_21__.useState)(!1),2),isSelected=_useState4[0],setIsSelected=_useState4[1];return react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_23___default.a,{rowCount:100,columnCount:100,stageProps:{onMouseDown:function handleMouseDown(e){!0!==e.target.attrs.draggable&&setIsSelected(!1)}}},(function(_ref2){var scrollTop=_ref2.scrollTop,scrollLeft=_ref2.scrollLeft;return react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_22__.Layer,null,react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(Resizable,{scrollTop:scrollTop,scrollLeft:scrollLeft,isSelected:isSelected,onSelect:function onSelect(){setIsSelected(!0)}}))}))};return react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(App,null)},ChartJSLayer=function ChartJSLayer(){var canvasRef=Object(react__WEBPACK_IMPORTED_MODULE_21__.useRef)(null),_useReducer2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_21__.useReducer)((function(s){return s+1}),0),2),forceRender=(_useReducer2[0],_useReducer2[1]);return Object(react__WEBPACK_IMPORTED_MODULE_21__.useEffect)((function(){canvasRef.current=document.createElement("canvas"),canvasRef.current.width=600,canvasRef.current.height=400,document.body.appendChild(canvasRef.current);var ctx=canvasRef.current.getContext("2d");new Chart(ctx,{type:"bar",data:{labels:["January","February","March","April","May","June","July"],datasets:[{label:"My First dataset",backgroundColor:"rgb(255, 99, 132)",borderColor:"rgb(255, 99, 132)",data:[0,10,5,2,20,30,45]}]},options:{animation:!1}});document.body.removeChild(canvasRef.current),forceRender()}),[]),canvasRef.current?react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_22__.Image,{image:canvasRef.current,draggable:!0,fill:"white",stroke:"#aaa",x:100,y:100,width:600,height:400}):null},ChartJs=function ChartJs(){return react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_23___default.a,{rowCount:100,columnCount:100},(function(_ref3){_ref3.scrollTop,_ref3.scrollLeft;return react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(react_konva__WEBPACK_IMPORTED_MODULE_22__.Layer,null,react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(ChartJSLayer,null))}))}},856:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Pagination",(function(){return Pagination}));__webpack_require__(9),__webpack_require__(30),__webpack_require__(38),__webpack_require__(26),__webpack_require__(32);var react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_5__),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(7),_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6__);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_exports__.default={title:"Pagination",component:_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6___default.a};var Pagination=function Pagination(){var App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_5__.useRef)(),_useSelection=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6__.useSelection)({gridRef:gridRef}),selections=_useSelection.selections,selectionProps=_objectWithoutProperties(_useSelection,["selections"]),_usePagination=Object(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6__.usePagination)({pageSize:8,total:100,onChange:function onChange(page){}}),currentPage=_usePagination.currentPage,paginationComponent=_usePagination.paginationComponent;return react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6___default.a,_extends({ref:gridRef,rowCount:8,columnCount:100,selections:selections,rowHeight:function rowHeight(){return 60},itemRenderer:function itemRenderer(props){return react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement(_rowsncolumns_grid__WEBPACK_IMPORTED_MODULE_6__.Cell,_extends({},props,{padding:0,value:"Page: ".concat(currentPage," Row: ").concat(props.rowIndex+8*(currentPage-1))}))}},selectionProps)),paginationComponent)};return react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement(App,null)};Pagination.story={name:"Pagination"}},857:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Default",(function(){return Default})),__webpack_require__.d(__webpack_exports__,"Import",(function(){return Import})),__webpack_require__.d(__webpack_exports__,"ExportToExcel",(function(){return ExportToExcel})),__webpack_require__.d(__webpack_exports__,"FilterViews",(function(){return FilterViews})),__webpack_require__.d(__webpack_exports__,"DataValidation",(function(){return DataValidation})),__webpack_require__.d(__webpack_exports__,"UsingStateReducer",(function(){return UsingStateReducer})),__webpack_require__.d(__webpack_exports__,"CustomDataType",(function(){return CustomDataType})),__webpack_require__.d(__webpack_exports__,"ProtectedSheet",(function(){return ProtectedSheet})),__webpack_require__.d(__webpack_exports__,"TabColors",(function(){return TabColors})),__webpack_require__.d(__webpack_exports__,"Formula",(function(){return Formula})),__webpack_require__.d(__webpack_exports__,"TickingFormula",(function(){return TickingFormula})),__webpack_require__.d(__webpack_exports__,"autoResize",(function(){return autoResize}));__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(117),__webpack_require__(25),__webpack_require__(20),__webpack_require__(13),__webpack_require__(49),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(8),__webpack_require__(10),__webpack_require__(70),__webpack_require__(45),__webpack_require__(19),__webpack_require__(16),__webpack_require__(88),__webpack_require__(21),__webpack_require__(204);var react__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_20___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_20__),_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(52),_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21___default=__webpack_require__.n(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21__),_rowsncolumns_export__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(169),_rowsncolumns_calc__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(309),_rowsncolumns_calc__WEBPACK_IMPORTED_MODULE_23___default=__webpack_require__.n(_rowsncolumns_calc__WEBPACK_IMPORTED_MODULE_23__);function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_exports__.default={title:"Spreadsheet",component:_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21___default.a};var Default=function Default(){var App=function App(){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_20__.useState)(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21__.defaultSheets),2),sheets=_useState2[0],setSheets=_useState2[1];return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement("div",{style:{margin:10,display:"flex",flexDirection:"column",minHeight:800}},react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21___default.a,{sheets:sheets,onChangeCells:console.log,onChange:setSheets}))};return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(App,null)},Import=function Import(){var App=function App(){var _useState4=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_20__.useState)(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21__.defaultSheets),2),sheets=_useState4[0],setSheets=_useState4[1],handleChangeFile=Object(react__WEBPACK_IMPORTED_MODULE_20__.useCallback)((function(e){(function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(file){var newSheets;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(_rowsncolumns_export__WEBPACK_IMPORTED_MODULE_22__.parse)({file:file});case 2:newSheets=_context.sent,setSheets(newSheets.sheets);case 4:case"end":return _context.stop()}}),_callee)})));return function getSheets(_x){return _ref.apply(this,arguments)}})()(e.target.files[0])}),[]);return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement("div",{style:{margin:10,display:"flex",flexDirection:"column",minHeight:800}},react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement("form",{id:"testForm"},react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement("input",{type:"file",name:"test",id:"testFile",onChange:handleChangeFile})),react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement("button",{onClick:function onClick(){return Object(_rowsncolumns_export__WEBPACK_IMPORTED_MODULE_22__.download)({sheets:sheets,filename:"Hello"})}},"Download Excel"),react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement("button",{onClick:function onClick(){return Object(_rowsncolumns_export__WEBPACK_IMPORTED_MODULE_22__.download)({sheets:sheets,filename:"Hello",type:"csv"})}},"Download CSV")),react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21___default.a,{sheets:sheets,onChange:setSheets}))};return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(App,null)};Import.story={name:"Import excel file"};var ExportToExcel=function ExportToExcel(){var App=function App(){var _useState6=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_20__.useState)(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21__.defaultSheets),2),sheets=_useState6[0],setSheets=_useState6[1],handleExport=Object(react__WEBPACK_IMPORTED_MODULE_20__.useCallback)((function(_ref2){var sheets=_ref2.sheets;Object(_rowsncolumns_export__WEBPACK_IMPORTED_MODULE_22__.download)({sheets:sheets,filename:"Report"})}),[]);return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_20___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement("br",null),react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement("button",{onClick:function onClick(){return handleExport({sheets:sheets})}},"Export to excel"),react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement("div",{style:{margin:10,display:"flex",flexDirection:"column",minHeight:600}},react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21___default.a,{sheets:sheets,onChange:setSheets})))};return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(App,null)};ExportToExcel.story={name:"Export excel file"};var FilterViews=function FilterViews(){var App=function App(){return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21___default.a,{initialSheets:[{name:"Sheet 1",id:0,frozenRows:1,frozenColumns:1,hiddenRows:[],activeCell:null,selections:[],cells:{1:{1:{text:"First Name"},2:{text:"Last Name"},3:{text:"Gender"}},2:{1:{text:"Dulce"},2:{text:"Abril"},3:{text:"Female"}},3:{1:{text:"Mara"},2:{text:"Hashimoto"},3:{text:"Male"}},4:{1:{text:"EMara"},2:{text:"Hashimoto"},3:{text:"Male"}},5:{5:{text:"First name"},6:{text:"Last name"},7:{text:"Gender"}},6:{5:{text:"EMara"},6:{text:"Hashimoto"},7:{text:"Male"}}},filterViews:[{bounds:{top:1,bottom:5,left:1,right:3}},{bounds:{top:5,bottom:8,left:5,right:7}}]}]})};return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(App,null)},initialValidationSheet=[{name:"Sheet 1",id:0,activeCell:{rowIndex:1,columnIndex:1},selections:[],cells:{2:{2:{text:"",valid:!1,dataValidation:{prompt:"Enter a country",type:"list",formulae:["Singapore","Japan","China"]}}},3:{2:{text:"",valid:!1,dataValidation:{prompt:"Something went wrong",allowBlank:!0,formulae:[10,100],operator:"between",type:"decimal"}}},4:{2:{text:"TRUE",datatype:"boolean",dataValidation:{allowBlank:!0,type:"boolean",prompt:"Invalid entry",formulae:["TRUE","FALSE"]}}},5:{2:{datatype:"hyperlink",text:"Hello world",color:"#1155CC",underline:!0,hyperlink:"http://google.com"}},6:{2:{datatype:"formula",text:"=SUM(A1,A2)",result:"4",error:"#VALUE!"}},7:{2:{text:"tooltip",tooltip:"hello world"},3:{text:"12",dataValidation:{type:"decimal",operator:"between",formulae:[0,10],prompt:"Please enter a valid number between 0 and 10"}}}}},{name:"Sheet 2",id:2,activeCell:{rowIndex:1,columnIndex:1},selections:[],cells:{}}],DataValidation=function DataValidation(){var App=function App(){var _useState8=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_20__.useState)(initialValidationSheet),2),sheets=_useState8[0],setSheets=_useState8[1];return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_20___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement("div",{style:{margin:10,display:"flex",flexDirection:"column",minHeight:800}},react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21___default.a,{sheets:sheets,onChange:setSheets})))};return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(App,null)},UsingStateReducer=function UsingStateReducer(){var App=function App(){var _useState10=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_20__.useState)(),2),sheets=_useState10[0],stateReducer=(_useState10[1],Object(react__WEBPACK_IMPORTED_MODULE_20__.useCallback)((function(state,action){return console.log(state,action),state}),[]));return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_20___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement("div",{style:{margin:10,display:"flex",flexDirection:"column",minHeight:800}},react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21___default.a,{sheets:sheets,stateReducer:stateReducer})))};return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(App,null)},CustomDataType=function CustomDataType(){var App=function App(){return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21___default.a,{sheets:[{name:"Sheet 1",id:1,activeCell:null,selections:[],cells:{1:{2:{datatype:"boolean",type:"hello"}}}}]})};return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(App,null)},ProtectedSheet=function ProtectedSheet(){var App=function App(){return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21___default.a,{minHeight:600,initialSheets:[{name:"Protected sheet",id:1,activeCell:null,selections:[],locked:!0,cells:{1:{2:{datatype:"boolean",type:"hello"}}}},{name:"Hidden sheet",id:2,activeCell:null,selections:[],hidden:!0,cells:{1:{2:{datatype:"boolean",type:"hello"}}}}]})};return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(App,null)},TabColors=function TabColors(){var App=function App(){return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21___default.a,{minHeight:600,sheets:[{name:"Sheet 1",id:1,activeCell:null,selections:[],tabColor:"red",cells:{1:{2:{datatype:"boolean",type:"hello"}}}}]})};return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(App,null)},Formula=function Formula(){new _rowsncolumns_calc__WEBPACK_IMPORTED_MODULE_23___default.a({functions:{FETCH_CSV:(_FETCH_CSV=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(arg){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return",fetch(arg.value).then((function(r){return r.text()})).then((function(response){var _step,data=[],_iterator=_createForOfIteratorHelper(response.split("\n"));try{for(_iterator.s();!(_step=_iterator.n()).done;){var cols=_step.value.split(",");data.push(cols)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return data})));case 1:case"end":return _context2.stop()}}),_callee2)}))),function FETCH_CSV(_x2){return _FETCH_CSV.apply(this,arguments)})}});var _FETCH_CSV,App=function App(){var _FETCH_CSV2,_useState12=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_20__.useState)([{name:"Sheet1",id:"1",activeCell:null,selections:[],tabColor:"red",cells:{1:{1:{text:"20",datatype:"number",locked:!0},2:{datatype:"formula",text:"=SUM()"}},2:{1:{locked:!0}},7:{3:{datatype:"formula",text:"=C6"}},8:{2:{text:"=VLOOKUP(A9,$A$2:$B$5, 2, FALSE)",datatype:"formula"}}}}]),2),sheets=_useState12[0],setSheets=_useState12[1];return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21___default.a,{minHeight:600,sheets:sheets,onChange:setSheets,onChangeCells:console.log,formulas:{FETCH_CSV:(_FETCH_CSV2=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(parser,arg){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.abrupt("return",fetch(arg.value).then((function(r){return r.text()})).then((function(response){var _step2,data=[],_iterator2=_createForOfIteratorHelper(response.split("\n"));try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var cols=_step2.value.split(",");data.push(cols)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return data})));case 1:case"end":return _context3.stop()}}),_callee3)}))),function FETCH_CSV(_x3,_x4){return _FETCH_CSV2.apply(this,arguments)})}})};return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(App,null)},TickingFormula=function TickingFormula(){var App=function App(){var _TICK,gridRef=react__WEBPACK_IMPORTED_MODULE_20___default.a.useRef(null),_useState14=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_20__.useState)(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21__.defaultSheets),2),sheets=_useState14[0],setSheets=_useState14[1],_useState16=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_20__.useState)(null),2),ticker=_useState16[0],setTicker=_useState16[1];return Object(react__WEBPACK_IMPORTED_MODULE_20__.useEffect)((function(){var interval;return ticker&&(interval=setTimeout((function(){for(var _gridRef$current$onCa,_gridRef$current,newData=function generateRandomData(){return Array.from({length:5}).map((function(_,i){return Array.from({length:5}).map((function(_,j){return Math.floor(99*Math.random())+1}))}))}(),parentRow=ticker.row,parentCol=ticker.col,sheet=ticker.sheet,changes=function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},sheet,{}),i=0;i<newData.length;i++){var _changes$sheet;changes[sheet][i+parentRow]=null!==(_changes$sheet=changes[sheet][i+parentRow])&&void 0!==_changes$sheet?_changes$sheet:{};for(var j=0;j<newData[i].length;j++){var _changes$sheet2;0===i&&0===j||(changes[sheet][i+parentRow][j+parentCol]=null!==(_changes$sheet2=changes[sheet][i+parentRow][j+parentCol])&&void 0!==_changes$sheet2?_changes$sheet2:{})}}setSheets((function(sheets){return Object(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21__.produceState)(sheets,(function(draft){var sheet=draft.find((function(sheet){return sheet.name===ticker.sheet}));if(sheet)for(var _i2=0;_i2<newData.length;_i2++){var _sheet$cells$row,row=parentRow+_i2;sheet.cells[row]=null!==(_sheet$cells$row=sheet.cells[row])&&void 0!==_sheet$cells$row?_sheet$cells$row:{};for(var _j=0;_j<newData[_i2].length;_j++){var _sheet$cells$row$col,col=parentCol+_j;if(sheet.cells[row][col]=null!==(_sheet$cells$row$col=sheet.cells[row][col])&&void 0!==_sheet$cells$row$col?_sheet$cells$row$col:{},row===parentRow&&col===parentCol){if(void 0===sheet.cells[row][col].text)return clearInterval(interval);sheet.cells[row][col].result=newData[_i2][_j],sheet.cells[row][col].resultType="number",sheet.cells[row][col].formulaRange=[newData[0].length,newData.length]}else sheet.cells[row][col].text=newData[_i2][_j],sheet.cells[row][col].datatype="number"}}}),gridRef)})),null===(_gridRef$current$onCa=(_gridRef$current=gridRef.current).onCalculate)||void 0===_gridRef$current$onCa||_gridRef$current$onCa.call(_gridRef$current,changes).then((function(results){gridRef.current.dispatch({type:"UPDATE_CELLS",changes:results,undoable:!1,replace:!0})}))}),1e3)),function(){interval&&clearInterval(interval)}}),[ticker]),react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21___default.a,{minHeight:600,sheets:sheets,ref:gridRef,onChange:setSheets,formulas:{TICK:(_TICK=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(context){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return setTicker(context.position),_context4.abrupt("return","Connecting...");case 2:case"end":return _context4.stop()}}),_callee4)}))),function TICK(_x5){return _TICK.apply(this,arguments)})}})};return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(App,null)},autoResize=function autoResize(){var App=function App(){var gridRef=Object(react__WEBPACK_IMPORTED_MODULE_20__.useRef)(),_useState18=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_20__.useState)([{id:1,name:"Sheet 1",activeCell:{rowIndex:1,columnIndex:1},selections:[],cells:{1:{2:{image:"https://placeimg.com/640/480/any"}}}}]),2),sheets=_useState18[0],sheetSheets=_useState18[1];return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement("div",{className:"App"},react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(_rowsncolumns_spreadsheet__WEBPACK_IMPORTED_MODULE_21___default.a,{ref:gridRef,sheets:sheets,onChange:sheetSheets,onChangeCells:function onChangeCells(sheetId,cells){for(var rowIndex in cells)for(var columnIndex in cells[rowIndex]){cells[rowIndex][columnIndex].image&&gridRef.current.resize(sheetId,"y",rowIndex,100)}}}))};return react__WEBPACK_IMPORTED_MODULE_20___default.a.createElement(App,null)}},858:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var Toolbar_1=__importDefault(__webpack_require__(433));exports.default=Toolbar_1.default},90:function(module,exports,__webpack_require__){"use strict";function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(47),__webpack_require__(25),__webpack_require__(86),__webpack_require__(20),__webpack_require__(13),__webpack_require__(163),__webpack_require__(23),__webpack_require__(294),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(8),__webpack_require__(10),__webpack_require__(45),__webpack_require__(19),__webpack_require__(130),__webpack_require__(87),__webpack_require__(16),__webpack_require__(115),__webpack_require__(88),__webpack_require__(48),__webpack_require__(21),__webpack_require__(204),Object.defineProperty(exports,"__esModule",{value:!0}),exports.isArrowKey=exports.castToString=exports.focusableNodeNames=exports.findNextCellInDataRegion=exports.findLastContentfulCell=exports.findNextContentfulCell=exports.clampIndex=exports.isEqualCells=exports.isNull=exports.autoSizerCanvas=exports.AutoSizerCanvas=exports.canUseDOM=exports.extendAreaToMergedCells=exports.areaIntersects=exports.findNextCellWithinBounds=exports.prepareClipboardData=exports.numberToAlphabet=exports.selectionFromActiveCell=exports.requestTimeout=exports.cancelTimeout=exports.getOffsetForRowAndAlignment=exports.getOffsetForColumnAndAlignment=exports.getOffsetForIndexAndAlignment=exports.rafThrottle=exports.debounce=exports.throttle=exports.cellIdentifier=exports.getEstimatedTotalWidth=exports.getEstimatedTotalHeight=exports.getItemMetadata=exports.getColumnWidth=exports.getRowHeight=exports.getColumnOffset=exports.getRowOffset=exports.itemKey=exports.getBoundedCells=exports.getColumnStopIndexForStartIndex=exports.getColumnStartIndexForOffset=exports.getRowStopIndexForStartIndex=exports.getRowStartIndexForOffset=exports.ItemType=exports.Align=void 0;var Align,ItemType,types_1=__webpack_require__(97);!function(Align){Align.start="start",Align.end="end",Align.center="center",Align.auto="auto",Align.smart="smart"}(Align=exports.Align||(exports.Align={})),function(ItemType){ItemType.row="row",ItemType.column="column"}(ItemType=exports.ItemType||(exports.ItemType={})),exports.getRowStartIndexForOffset=function(_ref){var rowHeight=_ref.rowHeight,columnWidth=_ref.columnWidth,rowCount=_ref.rowCount,columnCount=_ref.columnCount,instanceProps=_ref.instanceProps,offset=_ref.offset,scale=_ref.scale;return findNearestItem({itemType:ItemType.row,rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps,offset:offset,scale:scale})},exports.getRowStopIndexForStartIndex=function(_ref2){for(var startIndex=_ref2.startIndex,rowCount=_ref2.rowCount,rowHeight=_ref2.rowHeight,columnWidth=_ref2.columnWidth,scrollTop=_ref2.scrollTop,containerHeight=_ref2.containerHeight,instanceProps=_ref2.instanceProps,scale=_ref2.scale,itemMetadata=exports.getItemMetadata({itemType:ItemType.row,rowHeight:rowHeight,columnWidth:columnWidth,index:startIndex,instanceProps:instanceProps,scale:scale}),maxOffset=scrollTop+containerHeight,offset=itemMetadata.offset+itemMetadata.size,stopIndex=startIndex;stopIndex<rowCount-1&&offset<maxOffset;)stopIndex++,offset+=exports.getItemMetadata({itemType:ItemType.row,rowHeight:rowHeight,columnWidth:columnWidth,index:stopIndex,instanceProps:instanceProps,scale:scale}).size;return stopIndex},exports.getColumnStartIndexForOffset=function(_ref3){var rowHeight=_ref3.rowHeight,columnWidth=_ref3.columnWidth,rowCount=_ref3.rowCount,columnCount=_ref3.columnCount,instanceProps=_ref3.instanceProps,offset=_ref3.offset,scale=_ref3.scale;return findNearestItem({itemType:ItemType.column,rowHeight:rowHeight,columnWidth:columnWidth,rowCount:rowCount,columnCount:columnCount,instanceProps:instanceProps,offset:offset,scale:scale})},exports.getColumnStopIndexForStartIndex=function(_ref4){for(var startIndex=_ref4.startIndex,rowHeight=_ref4.rowHeight,columnWidth=_ref4.columnWidth,instanceProps=_ref4.instanceProps,containerWidth=_ref4.containerWidth,scrollLeft=_ref4.scrollLeft,columnCount=_ref4.columnCount,scale=_ref4.scale,itemMetadata=exports.getItemMetadata({itemType:ItemType.column,index:startIndex,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,scale:scale}),maxOffset=scrollLeft+containerWidth,offset=itemMetadata.offset+itemMetadata.size,stopIndex=startIndex;stopIndex<columnCount-1&&offset<maxOffset;)stopIndex++,offset+=exports.getItemMetadata({itemType:ItemType.column,rowHeight:rowHeight,columnWidth:columnWidth,index:stopIndex,instanceProps:instanceProps,scale:scale}).size;return stopIndex},exports.getBoundedCells=function(area){var cells=new Set;if(!area)return cells;for(var top=area.top,bottom=area.bottom,left=area.left,right=area.right,i=top;i<=bottom;i++)for(var j=left;j<=right;j++)cells.add(exports.cellIdentifier(i,j));return cells},exports.itemKey=function(_ref5){var rowIndex=_ref5.rowIndex,columnIndex=_ref5.columnIndex;return"".concat(rowIndex,":").concat(columnIndex)},exports.getRowOffset=function(_ref6){var index=_ref6.index,rowHeight=_ref6.rowHeight,columnWidth=_ref6.columnWidth,instanceProps=_ref6.instanceProps,scale=_ref6.scale;return exports.getItemMetadata({itemType:ItemType.row,index:index,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,scale:scale}).offset},exports.getColumnOffset=function(_ref7){var index=_ref7.index,rowHeight=_ref7.rowHeight,columnWidth=_ref7.columnWidth,instanceProps=_ref7.instanceProps,scale=_ref7.scale;return exports.getItemMetadata({itemType:ItemType.column,index:index,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,scale:scale}).offset},exports.getRowHeight=function(index,instanceProps){return instanceProps.rowMetadataMap[index].size},exports.getColumnWidth=function(index,instanceProps){return instanceProps.columnMetadataMap[index].size},exports.getItemMetadata=function(_ref8){var _a,itemMetadataMap,itemSize,lastMeasuredIndex,recalcIndices,itemType=_ref8.itemType,index=_ref8.index,rowHeight=_ref8.rowHeight,columnWidth=_ref8.columnWidth,instanceProps=_ref8.instanceProps,_ref8$scale=_ref8.scale,scale=void 0===_ref8$scale?2:_ref8$scale;"column"===itemType?(itemMetadataMap=instanceProps.columnMetadataMap,itemSize=columnWidth,lastMeasuredIndex=instanceProps.lastMeasuredColumnIndex,recalcIndices=instanceProps.recalcColumnIndices):(itemMetadataMap=instanceProps.rowMetadataMap,itemSize=rowHeight,lastMeasuredIndex=instanceProps.lastMeasuredRowIndex,recalcIndices=instanceProps.recalcRowIndices);var recalcWithinBoundsOnly=recalcIndices.length>0;if(index>lastMeasuredIndex){var offset=0;if(lastMeasuredIndex>=0){var itemMetadata=itemMetadataMap[lastMeasuredIndex];offset=itemMetadata.offset+itemMetadata.size}for(var i=lastMeasuredIndex+1;i<=index;i++){var size=recalcWithinBoundsOnly?recalcIndices.includes(i)?itemSize(i)*scale:(null===(_a=itemMetadataMap[i])||void 0===_a?void 0:_a.size)||itemSize(i)*scale:itemSize(i)*scale;itemMetadataMap[i]={offset:offset,size:size},offset+=size}"column"===itemType?instanceProps.lastMeasuredColumnIndex=index:instanceProps.lastMeasuredRowIndex=index}return itemMetadataMap[index]};var findNearestItem=function findNearestItem(_ref9){var itemMetadataMap,lastMeasuredIndex,itemType=_ref9.itemType,rowHeight=_ref9.rowHeight,columnWidth=_ref9.columnWidth,rowCount=_ref9.rowCount,columnCount=_ref9.columnCount,instanceProps=_ref9.instanceProps,offset=_ref9.offset,scale=_ref9.scale;return"column"===itemType?(itemMetadataMap=instanceProps.columnMetadataMap,lastMeasuredIndex=instanceProps.lastMeasuredColumnIndex):(itemMetadataMap=instanceProps.rowMetadataMap,lastMeasuredIndex=instanceProps.lastMeasuredRowIndex),(lastMeasuredIndex>0?itemMetadataMap[lastMeasuredIndex].offset:0)>=offset?findNearestItemBinarySearch({itemType:itemType,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,high:lastMeasuredIndex,low:0,offset:offset,scale:scale}):findNearestItemExponentialSearch({itemType:itemType,rowHeight:rowHeight,rowCount:rowCount,columnCount:columnCount,columnWidth:columnWidth,instanceProps:instanceProps,index:Math.max(0,lastMeasuredIndex),offset:offset,scale:scale})},findNearestItemBinarySearch=function findNearestItemBinarySearch(_ref10){for(var itemType=_ref10.itemType,rowHeight=_ref10.rowHeight,columnWidth=_ref10.columnWidth,instanceProps=_ref10.instanceProps,high=_ref10.high,low=_ref10.low,offset=_ref10.offset,scale=_ref10.scale;low<=high;){var middle=low+Math.floor((high-low)/2),currentOffset=exports.getItemMetadata({itemType:itemType,rowHeight:rowHeight,columnWidth:columnWidth,index:middle,instanceProps:instanceProps,scale:scale}).offset;if(currentOffset===offset)return middle;currentOffset<offset?low=middle+1:currentOffset>offset&&(high=middle-1)}return low>0?low-1:0},findNearestItemExponentialSearch=function findNearestItemExponentialSearch(_ref11){for(var itemType=_ref11.itemType,rowHeight=_ref11.rowHeight,columnWidth=_ref11.columnWidth,rowCount=_ref11.rowCount,columnCount=_ref11.columnCount,instanceProps=_ref11.instanceProps,index=_ref11.index,offset=_ref11.offset,scale=_ref11.scale,itemCount="column"===itemType?columnCount:rowCount,interval=1;index<itemCount&&exports.getItemMetadata({itemType:itemType,rowHeight:rowHeight,columnWidth:columnWidth,index:index,instanceProps:instanceProps,scale:scale}).offset<offset;)index+=interval,interval*=2;return findNearestItemBinarySearch({itemType:itemType,rowHeight:rowHeight,columnWidth:columnWidth,instanceProps:instanceProps,high:Math.min(index,itemCount-1),low:Math.floor(index/2),offset:offset,scale:scale})};exports.getEstimatedTotalHeight=function(rowCount,instanceProps){var estimatedRowHeight=instanceProps.estimatedRowHeight,totalSizeOfMeasuredRows=0,lastMeasuredRowIndex=instanceProps.lastMeasuredRowIndex,rowMetadataMap=instanceProps.rowMetadataMap;if(lastMeasuredRowIndex>=rowCount&&(lastMeasuredRowIndex=rowCount-1),lastMeasuredRowIndex>=0){var itemMetadata=rowMetadataMap[lastMeasuredRowIndex];totalSizeOfMeasuredRows=itemMetadata.offset+itemMetadata.size}return totalSizeOfMeasuredRows+(rowCount-lastMeasuredRowIndex-1)*estimatedRowHeight},exports.getEstimatedTotalWidth=function(columnCount,instanceProps){var estimatedColumnWidth=instanceProps.estimatedColumnWidth,totalSizeOfMeasuredRows=0,lastMeasuredColumnIndex=instanceProps.lastMeasuredColumnIndex,columnMetadataMap=instanceProps.columnMetadataMap;if(lastMeasuredColumnIndex>=columnCount&&(lastMeasuredColumnIndex=columnCount-1),lastMeasuredColumnIndex>=0){var itemMetadata=columnMetadataMap[lastMeasuredColumnIndex];totalSizeOfMeasuredRows=itemMetadata.offset+itemMetadata.size}return totalSizeOfMeasuredRows+(columnCount-lastMeasuredColumnIndex-1)*estimatedColumnWidth},exports.cellIdentifier=function(rowIndex,columnIndex){return"".concat(rowIndex,",").concat(columnIndex)},exports.throttle=function throttle(func,limit){var lastEventTimestamp=null;return function callable(){var now=Date.now();(!lastEventTimestamp||now-lastEventTimestamp>=limit)&&(lastEventTimestamp=now,func.apply(void 0,arguments))}},exports.debounce=function debounce(cb){var wait=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,h=0,callable=function callable(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];clearTimeout(h),h=window.setTimeout((function(){return cb.apply(void 0,args)}),wait)};return callable},exports.rafThrottle=function rafThrottle(callback){var evt,active=!1,handler=function handler(){active=!1,callback(evt)};return function handleEvent(e){(evt=e)&&evt.persist&&evt.persist(),active||(active=!0,requestAnimationFrame(handler))}},exports.getOffsetForIndexAndAlignment=function(_ref12){var itemType=_ref12.itemType,containerHeight=_ref12.containerHeight,containerWidth=_ref12.containerWidth,rowHeight=_ref12.rowHeight,columnWidth=_ref12.columnWidth,columnCount=_ref12.columnCount,rowCount=_ref12.rowCount,index=_ref12.index,_ref12$align=_ref12.align,align=void 0===_ref12$align?Align.smart:_ref12$align,scrollOffset=_ref12.scrollOffset,instanceProps=_ref12.instanceProps,scrollbarSize=_ref12.scrollbarSize,_ref12$frozenOffset=_ref12.frozenOffset,frozenOffset=void 0===_ref12$frozenOffset?0:_ref12$frozenOffset,scale=_ref12.scale,size="column"===itemType?containerWidth:containerHeight,itemMetadata=exports.getItemMetadata({itemType:itemType,rowHeight:rowHeight,columnWidth:columnWidth,index:index,instanceProps:instanceProps,scale:scale}),estimatedTotalSize="column"===itemType?exports.getEstimatedTotalWidth(columnCount,instanceProps):exports.getEstimatedTotalHeight(rowCount,instanceProps),maxOffset=Math.max(0,Math.min(estimatedTotalSize-size,itemMetadata.offset-frozenOffset)),minOffset=Math.max(0,itemMetadata.offset-size+scrollbarSize+itemMetadata.size);switch(align===Align.smart&&(align=scrollOffset>=minOffset-size&&scrollOffset<=maxOffset+size?Align.auto:Align.center),align){case Align.start:return maxOffset;case Align.end:return minOffset;case Align.center:return Math.round(minOffset+(maxOffset-minOffset)/2);case Align.auto:default:return scrollOffset>=minOffset&&scrollOffset<=maxOffset?scrollOffset:minOffset>maxOffset||scrollOffset<minOffset?minOffset:maxOffset}},exports.getOffsetForColumnAndAlignment=function(props){return exports.getOffsetForIndexAndAlignment(Object.assign({itemType:ItemType.column},props))},exports.getOffsetForRowAndAlignment=function(props){return exports.getOffsetForIndexAndAlignment(Object.assign({itemType:ItemType.row},props))};var now="object"===("undefined"==typeof performance?"undefined":_typeof(performance))&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};exports.cancelTimeout=function cancelTimeout(timeoutID){cancelAnimationFrame(timeoutID.id)},exports.requestTimeout=function requestTimeout(callback,delay){var start=now(),timeoutID={id:requestAnimationFrame((function tick(){now()-start>=delay?callback.call(null):timeoutID.id=requestAnimationFrame(tick)}))};return timeoutID},exports.selectionFromActiveCell=function(activeCell){return activeCell?[{bounds:{top:activeCell.rowIndex,left:activeCell.columnIndex,bottom:activeCell.rowIndex,right:activeCell.columnIndex}}]:[]},exports.numberToAlphabet=function(i){return((i>=26?exports.numberToAlphabet((i/26>>0)-1):"")+"abcdefghijklmnopqrstuvwxyz"[i%26>>0]).toUpperCase()},exports.prepareClipboardData=function(rows){var html=["<table>"],csv=[];return rows.forEach((function(row){html.push("<tr>");var csvRow=[];row.forEach((function(cell){var _a;html.push("<td>".concat(cell,"</td>")),csvRow.push("".concat(null===(_a=exports.castToString(cell))||void 0===_a?void 0:_a.replace(/"/g,'""')))})),csv.push(csvRow.join(",")),html.push("</tr>")})),html.push("</table>"),[html.join(""),csv.join("\n")]},exports.findNextCellWithinBounds=function(activeCellBounds,selectionBounds){var rowIndex,columnIndex,direction=arguments.length>2&&void 0!==arguments[2]?arguments[2]:types_1.Direction.Right,intersects=exports.areaIntersects(activeCellBounds,selectionBounds);if(!intersects)return null;var nextActiveCell=null;return direction===types_1.Direction.Right&&(rowIndex=activeCellBounds.top,(columnIndex=activeCellBounds.left+1)>selectionBounds.right&&(rowIndex+=1,columnIndex=selectionBounds.left,rowIndex>selectionBounds.bottom&&(rowIndex=selectionBounds.top)),nextActiveCell={rowIndex:rowIndex,columnIndex:columnIndex}),direction===types_1.Direction.Left&&(rowIndex=activeCellBounds.bottom,(columnIndex=activeCellBounds.left-1)<selectionBounds.left&&(rowIndex-=1,columnIndex=selectionBounds.right,rowIndex<selectionBounds.top&&(rowIndex=selectionBounds.bottom)),nextActiveCell={rowIndex:rowIndex,columnIndex:columnIndex}),direction===types_1.Direction.Down&&(rowIndex=activeCellBounds.bottom+1,columnIndex=activeCellBounds.left,rowIndex>selectionBounds.bottom&&(columnIndex=activeCellBounds.left+1,rowIndex=selectionBounds.top,columnIndex>selectionBounds.right&&(columnIndex=selectionBounds.left)),nextActiveCell={rowIndex:rowIndex,columnIndex:columnIndex}),direction===types_1.Direction.Up&&(rowIndex=activeCellBounds.top-1,columnIndex=activeCellBounds.left,rowIndex<selectionBounds.top&&(columnIndex=activeCellBounds.left-1,rowIndex=selectionBounds.bottom,columnIndex<selectionBounds.left&&(columnIndex=selectionBounds.right)),nextActiveCell={rowIndex:rowIndex,columnIndex:columnIndex}),nextActiveCell},exports.areaIntersects=function(area1,area2){return!(area1.left>area2.right||area2.left>area1.right)&&!(area1.top>area2.bottom||area2.top>area1.bottom)},exports.extendAreaToMergedCells=function(_area,mergedCells){var _step,area=Object.assign({},_area),_iterator=_createForOfIteratorHelper(mergedCells);try{for(_iterator.s();!(_step=_iterator.n()).done;){var bounds=_step.value;exports.areaIntersects(area,bounds)&&(area.top=Math.min(area.top,bounds.top),area.bottom=Math.max(area.bottom,bounds.bottom),area.right=Math.max(area.right,bounds.right),area.left=Math.min(area.left,bounds.left))}}catch(err){_iterator.e(err)}finally{_iterator.f()}return area},exports.canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement),exports.AutoSizerCanvas=function(){var defaults=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_defaults$fontFamily=defaults.fontFamily,fontFamily=void 0===_defaults$fontFamily?"Arial":_defaults$fontFamily,_defaults$fontSize=defaults.fontSize,fontSize=void 0===_defaults$fontSize?12:_defaults$fontSize,_defaults$fontWeight=defaults.fontWeight,fontWeight=void 0===_defaults$fontWeight?"":_defaults$fontWeight,_defaults$fontStyle=defaults.fontStyle,fontStyle=void 0===_defaults$fontStyle?"":_defaults$fontStyle,_defaults$lineHeight=defaults.lineHeight,lineHeight=void 0===_defaults$lineHeight?16:_defaults$lineHeight,_defaults$scale=defaults.scale,scale=void 0===_defaults$scale?1:_defaults$scale,o={fontFamily:fontFamily,fontSize:fontSize,fontWeight:fontWeight,fontStyle:fontStyle,lineHeight:lineHeight,scale:scale},canvas=exports.canUseDOM&&document.createElement("canvas"),context=canvas?canvas.getContext("2d"):null,setFont=function setFont(){var _a,options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var key in options)o[key]=null!==(_a=options[key])&&void 0!==_a?_a:o[key];context&&(context.font="".concat(o.fontStyle," ").concat(o.fontWeight," ").concat(o.fontSize*o.scale,"px ").concat(o.fontFamily))},getWidthOfLongestText=function getWidthOfLongestText(text){var _a,width=0,height=0;if(void 0===text)return{width:width,height:height};for(var lines=text.split("\n"),i=0;i<lines.length;i++){var line=lines[i],lineWidth=null!==(_a=null==context?void 0:context.measureText(line).width)&&void 0!==_a?_a:0;width=Math.max(width,lineWidth),height+=1.2*o.fontSize*o.scale}return{width:Math.ceil(width),height:Math.ceil(height)}},measureText=function measureText(text){return getWidthOfLongestText(exports.castToString(text))},reset=function reset(){return setFont(defaults)};return setFont(o),{context:context,measureText:measureText,setFont:setFont,reset:reset}},exports.autoSizerCanvas=exports.AutoSizerCanvas(),exports.isNull=function(value){return null==value||""===value},exports.isEqualCells=function(a,b){return!exports.isNull(a)&&!exports.isNull(b)&&null!==a&&null!==b&&(a.rowIndex===b.rowIndex&&a.columnIndex===b.columnIndex)},exports.clampIndex=function(index,isHidden,direction){switch(direction){case types_1.Direction.Right:case types_1.Direction.Down:for(var hidden=null==isHidden?void 0:isHidden(index);!0===hidden;)hidden=null==isHidden?void 0:isHidden(++index);break;case types_1.Direction.Left:case types_1.Direction.Up:for(var _hidden=null==isHidden?void 0:isHidden(index);!0===_hidden;)_hidden=null==isHidden?void 0:isHidden(--index)}return index},exports.findNextContentfulCell=function(activeCell,getValue,isHidden,direction,limit){var rowIndex=activeCell.rowIndex,columnIndex=activeCell.columnIndex;switch(direction){case types_1.Direction.Down:for(var value=getValue({rowIndex:rowIndex=exports.clampIndex(Math.min(rowIndex+1,limit),isHidden,direction),columnIndex:columnIndex});exports.isNull(value)&&rowIndex<limit;)value=getValue({rowIndex:rowIndex=exports.clampIndex(Math.min(++rowIndex,limit),isHidden,direction),columnIndex:columnIndex});return{rowIndex:rowIndex,columnIndex:columnIndex};case types_1.Direction.Up:for(var _value=getValue({rowIndex:rowIndex=exports.clampIndex(Math.max(rowIndex-1,limit),isHidden,direction),columnIndex:columnIndex});exports.isNull(_value)&&rowIndex>limit;)_value=getValue({rowIndex:rowIndex=exports.clampIndex(Math.max(--rowIndex,limit),isHidden,direction),columnIndex:columnIndex});return{rowIndex:rowIndex,columnIndex:columnIndex};case types_1.Direction.Right:for(var _value2=getValue({rowIndex:rowIndex,columnIndex:columnIndex=exports.clampIndex(Math.min(columnIndex+1,limit),isHidden,direction)});exports.isNull(_value2)&&columnIndex<limit;)_value2=getValue({rowIndex:rowIndex,columnIndex:columnIndex=exports.clampIndex(Math.min(++columnIndex,limit),isHidden,direction)});return{rowIndex:rowIndex,columnIndex:columnIndex};case types_1.Direction.Left:for(var _value3=getValue({rowIndex:rowIndex,columnIndex:columnIndex=exports.clampIndex(Math.max(columnIndex-1,limit),isHidden,direction)});exports.isNull(_value3)&&columnIndex>limit;)_value3=getValue({rowIndex:rowIndex,columnIndex:columnIndex=exports.clampIndex(Math.max(--columnIndex,limit),isHidden,direction)});return{rowIndex:rowIndex,columnIndex:columnIndex};default:return activeCell}},exports.findLastContentfulCell=function(activeCell,getValue,isHidden,direction,limit){var rowIndex=activeCell.rowIndex,columnIndex=activeCell.columnIndex;switch(direction){case types_1.Direction.Down:for(var value=getValue({rowIndex:rowIndex=exports.clampIndex(Math.min(rowIndex+1,limit),isHidden,direction),columnIndex:columnIndex});!exports.isNull(value)&&rowIndex<limit;)value=getValue({rowIndex:rowIndex=exports.clampIndex(Math.min(++rowIndex,limit),isHidden,direction),columnIndex:columnIndex});return{columnIndex:columnIndex,rowIndex:exports.isNull(getValue({columnIndex:columnIndex,rowIndex:rowIndex}))?rowIndex-1:rowIndex};case types_1.Direction.Up:for(var _value4=getValue({rowIndex:rowIndex=exports.clampIndex(Math.max(rowIndex-1,limit),isHidden,direction),columnIndex:columnIndex});!exports.isNull(_value4)&&rowIndex>limit;)_value4=getValue({rowIndex:rowIndex=exports.clampIndex(Math.max(--rowIndex,limit),isHidden,direction),columnIndex:columnIndex});return{columnIndex:columnIndex,rowIndex:exports.isNull(getValue({columnIndex:columnIndex,rowIndex:rowIndex}))?rowIndex+1:rowIndex};case types_1.Direction.Right:for(var _value5=getValue({rowIndex:rowIndex,columnIndex:columnIndex=exports.clampIndex(Math.min(columnIndex+1,limit),isHidden,direction)});!exports.isNull(_value5)&&columnIndex<limit;)_value5=getValue({rowIndex:rowIndex,columnIndex:columnIndex=exports.clampIndex(Math.min(++columnIndex,limit),isHidden,direction)});return{rowIndex:rowIndex,columnIndex:exports.isNull(getValue({columnIndex:columnIndex,rowIndex:rowIndex}))?columnIndex-1:columnIndex};case types_1.Direction.Left:for(var _value6=getValue({rowIndex:rowIndex,columnIndex:columnIndex=exports.clampIndex(Math.max(columnIndex-1,limit),isHidden,direction)});!exports.isNull(_value6)&&columnIndex>limit;)_value6=getValue({rowIndex:rowIndex,columnIndex:columnIndex=exports.clampIndex(Math.max(--columnIndex,limit),isHidden,direction)});return{rowIndex:rowIndex,columnIndex:exports.isNull(getValue({columnIndex:columnIndex,rowIndex:rowIndex}))?columnIndex+1:columnIndex};default:return activeCell}},exports.findNextCellInDataRegion=function(activeCell,getValue,isHidden,direction,limit){var rowIndex=activeCell.rowIndex,columnIndex=activeCell.columnIndex,isCurrentCellEmpty=exports.isNull(getValue(activeCell)),didWeReachTheEdge=function didWeReachTheEdge(cur,next){return cur&&next||cur&&!next||!cur&&next};switch(direction){case types_1.Direction.Down:var nextCellValue=getValue({rowIndex:rowIndex+1,columnIndex:columnIndex}),nextCell=didWeReachTheEdge(isCurrentCellEmpty,exports.isNull(nextCellValue))?exports.findNextContentfulCell(activeCell,getValue,isHidden,direction,limit):exports.findLastContentfulCell(activeCell,getValue,isHidden,direction,limit);return null==nextCell?void 0:nextCell.rowIndex;case types_1.Direction.Up:var _nextCellValue=getValue({rowIndex:rowIndex-1,columnIndex:columnIndex}),_nextCell=didWeReachTheEdge(isCurrentCellEmpty,exports.isNull(_nextCellValue))?exports.findNextContentfulCell(activeCell,getValue,isHidden,direction,limit):exports.findLastContentfulCell(activeCell,getValue,isHidden,direction,limit);return null==_nextCell?void 0:_nextCell.rowIndex;case types_1.Direction.Right:var _nextCellValue2=getValue({rowIndex:rowIndex,columnIndex:columnIndex+1}),_nextCell2=didWeReachTheEdge(isCurrentCellEmpty,exports.isNull(_nextCellValue2))?exports.findNextContentfulCell(activeCell,getValue,isHidden,direction,limit):exports.findLastContentfulCell(activeCell,getValue,isHidden,direction,limit);return null==_nextCell2?void 0:_nextCell2.columnIndex;case types_1.Direction.Left:var _nextCellValue3=getValue({rowIndex:rowIndex,columnIndex:columnIndex-1}),_nextCell3=didWeReachTheEdge(isCurrentCellEmpty,exports.isNull(_nextCellValue3))?exports.findNextContentfulCell(activeCell,getValue,isHidden,direction,limit):exports.findLastContentfulCell(activeCell,getValue,isHidden,direction,limit);return null==_nextCell3?void 0:_nextCell3.columnIndex}},exports.focusableNodeNames=new Set(["INPUT","TEXTAREA","SELECT"]),exports.castToString=function(value){if(null!=value)return"string"!=typeof value?""+value:value},exports.isArrowKey=function(keyCode){return[types_1.KeyCodes.Up,types_1.KeyCodes.Down,types_1.KeyCodes.Left,types_1.KeyCodes.Right].includes(keyCode)}},97:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8),Object.defineProperty(exports,"__esModule",{value:!0}),exports.MouseButtonCodes=exports.MimeType=exports.Direction=exports.KeyCodes=void 0,function(KeyCodes){KeyCodes[KeyCodes.Right=39]="Right",KeyCodes[KeyCodes.Left=37]="Left",KeyCodes[KeyCodes.Up=38]="Up",KeyCodes[KeyCodes.Down=40]="Down",KeyCodes[KeyCodes.Escape=27]="Escape",KeyCodes[KeyCodes.Tab=9]="Tab",KeyCodes[KeyCodes.Meta=91]="Meta",KeyCodes[KeyCodes.Delete=46]="Delete",KeyCodes[KeyCodes.BackSpace=8]="BackSpace",KeyCodes[KeyCodes.Enter=13]="Enter",KeyCodes[KeyCodes.A=65]="A",KeyCodes[KeyCodes.SPACE=32]="SPACE",KeyCodes[KeyCodes.ALT=18]="ALT",KeyCodes[KeyCodes.C=67]="C",KeyCodes[KeyCodes.Home=36]="Home",KeyCodes[KeyCodes.End=35]="End",KeyCodes[KeyCodes.PageDown=34]="PageDown",KeyCodes[KeyCodes.PageUp=33]="PageUp",KeyCodes[KeyCodes.Z=90]="Z",KeyCodes[KeyCodes.CapsLock=20]="CapsLock",KeyCodes[KeyCodes.KEY_B=66]="KEY_B",KeyCodes[KeyCodes.KEY_I=73]="KEY_I",KeyCodes[KeyCodes.KEY_U=85]="KEY_U",KeyCodes[KeyCodes.KEY_X=88]="KEY_X",KeyCodes[KeyCodes.KEY_L=76]="KEY_L",KeyCodes[KeyCodes.KEY_E=69]="KEY_E",KeyCodes[KeyCodes.KEY_R=82]="KEY_R",KeyCodes[KeyCodes.BACK_SLASH=220]="BACK_SLASH",KeyCodes[KeyCodes.KEY_Y=89]="KEY_Y",KeyCodes[KeyCodes.ScrollLock=145]="ScrollLock",KeyCodes[KeyCodes.NumLock=144]="NumLock",KeyCodes[KeyCodes.Pause=19]="Pause",KeyCodes[KeyCodes.Insert=45]="Insert",KeyCodes[KeyCodes.F1=112]="F1",KeyCodes[KeyCodes.F2=113]="F2",KeyCodes[KeyCodes.F3=114]="F3",KeyCodes[KeyCodes.F4=115]="F4",KeyCodes[KeyCodes.F5=116]="F5",KeyCodes[KeyCodes.F6=117]="F6",KeyCodes[KeyCodes.F7=118]="F7",KeyCodes[KeyCodes.F8=119]="F8",KeyCodes[KeyCodes.F9=120]="F9",KeyCodes[KeyCodes.F10=121]="F10",KeyCodes[KeyCodes.F11=122]="F11",KeyCodes[KeyCodes.F12=123]="F12"}(exports.KeyCodes||(exports.KeyCodes={})),function(Direction){Direction.Up="UP",Direction.Down="DOWN",Direction.Left="LEFT",Direction.Right="RIGHT"}(exports.Direction||(exports.Direction={})),function(MimeType){MimeType.html="text/html",MimeType.csv="text/csv",MimeType.plain="text/plain",MimeType.json="application/json"}(exports.MimeType||(exports.MimeType={})),function(MouseButtonCodes){MouseButtonCodes[MouseButtonCodes.left=1]="left",MouseButtonCodes[MouseButtonCodes.middle=2]="middle",MouseButtonCodes[MouseButtonCodes.right=3]="right"}(exports.MouseButtonCodes||(exports.MouseButtonCodes={}))},983:function(module,exports,__webpack_require__){"use strict";__webpack_require__(33),__webpack_require__(8);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var Select_1=__importDefault(__webpack_require__(455));exports.default=Select_1.default,__exportStar(__webpack_require__(455),exports)},984:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var Formulabar_1=__importDefault(__webpack_require__(985));exports.default=Formulabar_1.default},985:function(module,exports,__webpack_require__){"use strict";__webpack_require__(33),__webpack_require__(8);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),core_1=__webpack_require__(62),constants_1=__webpack_require__(56),Resizer_1=__importDefault(__webpack_require__(986)),TextEditor_1=__importDefault(__webpack_require__(457)),Formulabar=react_1.memo(react_1.forwardRef((function(props,forwardedRef){var _props$value=props.value,value=void 0===_props$value?"":_props$value,onChange=props.onChange,onFocus=(props.onKeyDown,props.onFocus),onBlur=props.onBlur,_props$isFormulaMode=props.isFormulaMode,isFormulaMode=void 0!==_props$isFormulaMode&&_props$isFormulaMode,locked=props.locked,_props$height=props.height,height=void 0===_props$height?constants_1.DEFAULT_FORMULABAR_HEIGHT:_props$height,onChangeHeight=props.onChangeHeight,supportedFormulas=props.supportedFormulas,onFormulaChange=props.onFormulaChange,onSubmit=props.onSubmit,onCancel=props.onCancel,disabled=props.disabled,isFormula=(react_1.useRef(null),constants_1.isAFormula(value)||isFormulaMode),colorMode=core_1.useColorMode().colorMode,theme=core_1.useTheme(),isLightMode="light"===colorMode,backgroundColor=isLightMode?"white":constants_1.DARK_MODE_COLOR,color=isLightMode?constants_1.DARK_MODE_COLOR:"white",borderColor=isLightMode?theme.colors.gray[300]:theme.colors.gray[600];return react_1.default.createElement(core_1.Box,{position:"relative"},react_1.default.createElement(core_1.InputGroup,{size:"sm",borderTopWidth:1,borderTopStyle:"solid",borderTopColor:borderColor,height:"".concat(height,"px")},react_1.default.createElement(core_1.InputLeftAddon,{width:constants_1.FORMULABAR_LEFT_CORNER_WIDTH,justifyContent:"center",bg:backgroundColor,color:color,fontSize:12,fontStyle:"italic",borderTopWidth:0,borderBottomWidth:0,borderRightWidth:1,size:"sm",borderRadius:0,children:"fx",height:"auto",userSelect:"none",borderLeftColor:borderColor,borderRightColor:borderColor}),react_1.default.createElement("div",{style:{display:"flex",flex:1,position:"relative",marginTop:4,marginLeft:6,paddingLeft:1}},react_1.default.createElement(TextEditor_1.default,{ref:forwardedRef,isFormulaMode:isFormula,value:value,fontFamily:isFormula?constants_1.FORMULA_FONT:constants_1.SYSTEM_FONT,fontSize:constants_1.pointToPixel(constants_1.DEFAULT_FONT_SIZE),onChange:onChange,onFocus:onFocus,onBlur:onBlur,autoFocus:!1,onSubmit:onSubmit,onCancel:onCancel,tearDown:!0,scale:1,color:constants_1.DEFAULT_FONT_COLOR,wrapping:!0,horizontalAlign:"left",disabled:locked||disabled,supportedFormulas:supportedFormulas,lineHeight:"13px",onFormulaChange:onFormulaChange}))),react_1.default.createElement(Resizer_1.default,{minTop:constants_1.DEFAULT_FORMULABAR_HEIGHT,top:constants_1.DEFAULT_FORMULABAR_HEIGHT,onDrag:onChangeHeight}))})));exports.default=Formulabar},986:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var Resizer_1=__importDefault(__webpack_require__(987));exports.default=Resizer_1.default},987:function(module,exports,__webpack_require__){"use strict";__webpack_require__(33),__webpack_require__(8),__webpack_require__(164);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1));exports.default=function Resizer(_ref){var onDrag=_ref.onDrag,top=_ref.top,_ref$minTop=_ref.minTop,minTop=void 0===_ref$minTop?0:_ref$minTop,dragging=react_1.useRef(!1),startY=react_1.useRef(0),el=react_1.useRef(null),handleMouseMove=react_1.useCallback((function(e){if(el.current){var diff=Math.max(e.pageY-startY.current,minTop);null==onDrag||onDrag(diff),el.current.style.top=diff+"px"}}),[]),handleMouseDown=react_1.useCallback((function(e){var _a,_b;dragging.current=!0;var top=(null===(_a=el.current)||void 0===_a?void 0:_a.style.top)?parseInt(null===(_b=el.current)||void 0===_b?void 0:_b.style.top):0;startY.current=e.pageY-top,document.addEventListener("mousemove",handleMouseMove),document.addEventListener("mouseup",handleMouseUp)}),[]),handleMouseUp=react_1.useCallback((function(){dragging.current=!1,document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp)}),[]);return react_1.default.createElement("div",{onMouseDown:handleMouseDown,ref:el,style:{userSelect:"none",height:4,position:"absolute",left:0,marginTop:-4,top:top,right:0,zIndex:1,cursor:"ns-resize"}})}},991:function(module,exports,__webpack_require__){"use strict";__webpack_require__(33),__webpack_require__(8);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var Workbook_1=__importDefault(__webpack_require__(458));__exportStar(__webpack_require__(458),exports),exports.default=Workbook_1.default},994:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var Grid_1=__importDefault(__webpack_require__(995));exports.default=Grid_1.default},995:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(30),__webpack_require__(134),__webpack_require__(55),__webpack_require__(205),__webpack_require__(25),__webpack_require__(86),__webpack_require__(38),__webpack_require__(20),__webpack_require__(13),__webpack_require__(49),__webpack_require__(96),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(33),__webpack_require__(8),__webpack_require__(32),__webpack_require__(10),__webpack_require__(164),__webpack_require__(19),__webpack_require__(87),__webpack_require__(16),__webpack_require__(118),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),grid_1=__importStar(__webpack_require__(7)),grid_2=__webpack_require__(7),core_1=__webpack_require__(62),constants_1=__webpack_require__(56),HeaderCell_1=__importDefault(__webpack_require__(996)),Cell_1=__importDefault(__webpack_require__(303)),styled_1=__webpack_require__(120),Editor_1=__importDefault(__webpack_require__(460)),FilterComponent_1=__importDefault(__webpack_require__(1003)),FilterIcon_1=__webpack_require__(304),ListArrow_1=__webpack_require__(459),Tooltip_1=__importDefault(__webpack_require__(462)),helpers_1=__webpack_require__(209),EMPTY_ARRAY=[],EMPTY_OBJECT={},defaultFormulaState={newSelectionMode:"modify",showCellSuggestion:!1},SheetGrid=react_1.memo(react_1.forwardRef((function(props,forwardedRef){var _a,theme=props.theme,_props$minColumnWidth=props.minColumnWidth,minColumnWidth=void 0===_props$minColumnWidth?constants_1.DEFAULT_COLUMN_WIDTH:_props$minColumnWidth,_props$minRowHeight=props.minRowHeight,minRowHeight=void 0===_props$minRowHeight?constants_1.DEFAULT_ROW_HEIGHT:_props$minRowHeight,_props$rowCount=props.rowCount,initialRowCount=void 0===_props$rowCount?1e3:_props$rowCount,_props$columnCount=props.columnCount,initialColumnCount=void 0===_props$columnCount?1e3:_props$columnCount,width=props.width,height=props.height,_props$CellRenderer=props.CellRenderer,CellRenderer=void 0===_props$CellRenderer?Cell_1.default:_props$CellRenderer,_props$HeaderCellRend=props.HeaderCellRenderer,HeaderCellRenderer=void 0===_props$HeaderCellRend?HeaderCell_1.default:_props$HeaderCellRend,cells=props.cells,onChange=props.onChange,onFill=props.onFill,onSheetChange=props.onSheetChange,initialActiveCell=props.activeCell,_props$selections=props.selections,initialSelections=void 0===_props$selections?EMPTY_ARRAY:_props$selections,selectedSheet=props.selectedSheet,onScroll=props.onScroll,scrollState=props.scrollState,onActiveCellChange=props.onActiveCellChange,onActiveCellValueChange=props.onActiveCellValueChange,onDelete=props.onDelete,formatter=props.formatter,onResize=props.onResize,_props$columnSizes=props.columnSizes,columnSizes=void 0===_props$columnSizes?EMPTY_OBJECT:_props$columnSizes,_props$rowSizes=props.rowSizes,rowSizes=void 0===_props$rowSizes?EMPTY_OBJECT:_props$rowSizes,mergedCells=props.mergedCells,_props$frozenRows=props.frozenRows,userFrozenRows=void 0===_props$frozenRows?0:_props$frozenRows,_props$frozenColumns=props.frozenColumns,userFrozenColumns=void 0===_props$frozenColumns?0:_props$frozenColumns,onKeyDown=props.onKeyDown,_props$hiddenColumns=props.hiddenColumns,userHiddenColumns=void 0===_props$hiddenColumns?EMPTY_ARRAY:_props$hiddenColumns,_props$hiddenRows=props.hiddenRows,userHiddenRows=void 0===_props$hiddenRows?EMPTY_ARRAY:_props$hiddenRows,_props$filterViews=props.filterViews,filterViews=void 0===_props$filterViews?EMPTY_ARRAY:_props$filterViews,onPaste=props.onPaste,onCut=props.onCut,onInsertRow=props.onInsertRow,onInsertColumn=props.onInsertColumn,onDeleteColumn=props.onDeleteColumn,onDeleteRow=props.onDeleteRow,showGridLines=props.showGridLines,_props$CellEditor=props.CellEditor,CellEditor=void 0===_props$CellEditor?Editor_1.default:_props$CellEditor,selectionPolicy=props.selectionPolicy,onSelectionChange=props.onSelectionChange,selectionMode=props.selectionMode,isLightMode=props.isLightMode,onChangeFilter=props.onChangeFilter,_props$scale=props.scale,scale=void 0===_props$scale?1:_props$scale,_props$selectionTopBo=props.selectionTopBound,selectionTopBound=void 0===_props$selectionTopBo?1:_props$selectionTopBo,_props$selectionLeftB=props.selectionLeftBound,selectionLeftBound=void 0===_props$selectionLeftB?1:_props$selectionLeftB,ContextMenu=props.ContextMenu,_props$Tooltip=props.Tooltip,Tooltip=void 0===_props$Tooltip?Tooltip_1.default:_props$Tooltip,snap=props.snap,locked=props.locked,_props$rowHeaderWidth=props.rowHeaderWidth,rowHeaderWidth=void 0===_props$rowHeaderWidth?constants_1.ROW_HEADER_WIDTH:_props$rowHeaderWidth,_props$columnHeaderHe=props.columnHeaderHeight,columnHeaderHeight=void 0===_props$columnHeaderHe?constants_1.COLUMN_HEADER_HEIGHT:_props$columnHeaderHe,gridLineColor=props.gridLineColor,sheetName=props.sheetName,onChangeSelectedSheet=props.onChangeSelectedSheet,onCopy=props.onCopy,_props$selectionBackg=props.selectionBackgroundColor,selectionBackgroundColor=void 0===_props$selectionBackg?"rgb(14, 101, 235, 0.1)":_props$selectionBackg,_props$selectionBorde=props.selectionBorderColor,selectionBorderColor=void 0===_props$selectionBorde?"#1a73e8":_props$selectionBorde,_props$isFormulaMode=props.isFormulaMode,isFormulaMode=void 0!==_props$isFormulaMode&&_props$isFormulaMode,setFormulaMode=props.setFormulaMode,_props$supportedFormu=props.supportedFormulas,supportedFormulas=void 0===_props$supportedFormu?EMPTY_ARRAY:_props$supportedFormu,onEditorKeyDown=props.onEditorKeyDown,isFormulaInputActive=(props.gridBackgroundColor,props.isFormulaInputActive),_props$formulaState=(props.children,props.formulaState),formulaState=void 0===_props$formulaState?defaultFormulaState:_props$formulaState,onChangeFormulaState=props.onChangeFormulaState,onCellEditorFocus=props.onCellEditorFocus,onFormulaBarUpdateSelections=props.onFormulaBarUpdateSelections,focusFormulaBar=props.focusFormulaBar,rest=_objectWithoutProperties(props,["theme","minColumnWidth","minRowHeight","rowCount","columnCount","width","height","CellRenderer","HeaderCellRenderer","cells","onChange","onFill","onSheetChange","activeCell","selections","selectedSheet","onScroll","scrollState","onActiveCellChange","onActiveCellValueChange","onDelete","formatter","onResize","columnSizes","rowSizes","mergedCells","frozenRows","frozenColumns","onKeyDown","hiddenColumns","hiddenRows","filterViews","onPaste","onCut","onInsertRow","onInsertColumn","onDeleteColumn","onDeleteRow","showGridLines","CellEditor","selectionPolicy","onSelectionChange","selectionMode","isLightMode","onChangeFilter","scale","selectionTopBound","selectionLeftBound","ContextMenu","Tooltip","snap","locked","rowHeaderWidth","columnHeaderHeight","gridLineColor","sheetName","onChangeSelectedSheet","onCopy","selectionBackgroundColor","selectionBorderColor","isFormulaMode","setFormulaMode","supportedFormulas","onEditorKeyDown","gridBackgroundColor","isFormulaInputActive","children","formulaState","onChangeFormulaState","onCellEditorFocus","onFormulaBarUpdateSelections","focusFormulaBar"]),gridRef=react_1.useRef(null),isLockedRef=react_1.useRef(!1),rowCount=initialRowCount+1,columnCount=initialColumnCount+1,currentlyEditingSheetId=react_1.useRef(),currentlyEditingSheetName=react_1.useRef(),editorRef=react_1.useRef(null),editingCellRef=react_1.useRef(),isFormulaModeRef=react_1.useRef(!1),_react_1$useState2=_slicedToArray(react_1.useState([]),2),formulaSelections=_react_1$useState2[0],setFormulaSelections=_react_1$useState2[1],newSelectionMode=formulaState.newSelectionMode,showCellSuggestion=formulaState.showCellSuggestion,previousSelectedSheet=core_1.usePrevious(selectedSheet);react_1.useEffect((function(){isFormulaModeRef.current=isFormulaMode}),[isFormulaMode]);var internalRefs=react_1.useRef({rowCount:rowCount,columnCount:columnCount}),frozenRows=Math.max(1,userFrozenRows+1),frozenColumns=Math.max(1,userFrozenColumns+1),debounceScroll=react_1.useRef(),_react_1$useState4=_slicedToArray(react_1.useState(null),2),contextMenuProps=_react_1$useState4[0],setContextMenuProps=_react_1$useState4[1],borderStyles=react_1.useMemo((function(){return filterViews.map((function(filter){return{bounds:filter.bounds,style:{strokeWidth:1,stroke:"green"}}}))}),[filterViews]);react_1.useEffect((function(){return debounceScroll.current=onScroll?grid_2.debounce(onScroll,500):void 0,function(){debounceScroll.current=void 0}}),[]),react_1.useEffect((function(){isLockedRef.current=locked}),[locked]),react_1.useEffect((function(){internalRefs.current={rowCount:rowCount,columnCount:columnCount}}),[rowCount,columnCount]);var isCellRowHeader=react_1.useCallback((function(rowIndex){return 0===rowIndex}),[]),isCellColumnHeader=react_1.useCallback((function(columnIndex){return 0===columnIndex}),[]),filterHeaderCells=react_1.useMemo((function(){return filterViews.reduce((function(acc,filter,index){for(var bounds=filter.bounds,i=bounds.left;i<=bounds.right;i++)acc[grid_2.cellIdentifier(bounds.top,i)]=index;return acc}),{})}),[filterViews]),columnsWithFilter=react_1.useMemo((function(){return filterViews.reduce((function(acc,filter){for(var bounds=filter.bounds,i=bounds.left;i<=bounds.right;i++)acc.push(i);return acc}),[])}),[filterViews]),rowFilterRange=react_1.useMemo((function(){return filterViews.reduce((function(acc,_ref,index){var bounds=_ref.bounds;return acc[index]=[bounds.top,bounds.bottom],acc}),{})}),[filterViews]),columnHasFilter=react_1.useCallback((function(columnIndex){return columnsWithFilter.includes(columnIndex)}),[columnsWithFilter]),rowHasFilter=react_1.useCallback((function(rowIndex){for(var i in rowFilterRange){var _rowFilterRange$i=_slicedToArray(rowFilterRange[i],2),min=_rowFilterRange$i[0],max=_rowFilterRange$i[1];if(rowIndex>=min&&rowIndex<=max)return!0}return!1}),[rowFilterRange]);react_1.useImperativeHandle(forwardedRef,(function(){var _a,_b,_c,_d,_e,_f,_g;return{getNextFocusableCell:getNextFocusableCell,setActiveCell:setActiveCell,setSelections:setSelections,focus:function focus(){var _a;return null===(_a=gridRef.current)||void 0===_a?void 0:_a.focus()},getEditingCell:function getEditingCell(){return editingCellRef.current},getEditingSheetId:function getEditingSheetId(){return currentlyEditingSheetId.current},resetAfterIndices:null===(_a=gridRef.current)||void 0===_a?void 0:_a.resetAfterIndices,makeEditable:makeEditable,setEditorValue:setValue,hideEditor:hideEditor,submitEditor:submitEditor,cancelEditor:cancelEditor,resizeColumns:null===(_b=gridRef.current)||void 0===_b?void 0:_b.resizeColumns,resizeRows:null===(_c=gridRef.current)||void 0===_c?void 0:_c.resizeRows,getCellBounds:null===(_d=gridRef.current)||void 0===_d?void 0:_d.getCellBounds,getScrollPosition:null===(_e=gridRef.current)||void 0===_e?void 0:_e.getScrollPosition,getCellCoordsFromOffset:null===(_f=gridRef.current)||void 0===_f?void 0:_f.getCellCoordsFromOffset,getCellOffsetFromCoords:null===(_g=gridRef.current)||void 0===_g?void 0:_g.getCellOffsetFromCoords}}));var _getValue=react_1.useCallback((function(cell){var _a,_b;if(cell){var rowIndex=cell.rowIndex,columnIndex=cell.columnIndex,isRowHeader=isCellRowHeader(rowIndex),isColumnHeader=isCellColumnHeader(columnIndex),cellId=grid_2.cellIdentifier(rowIndex,columnIndex),isFilterHeader=void 0!==filterHeaderCells[cellId];return isRowHeader?{text:constants_1.number2Alpha(columnIndex-1),fontSize:10}:isColumnHeader?{text:rowIndex,fontSize:10}:isFilterHeader?Object.assign({},null===(_a=cells[rowIndex])||void 0===_a?void 0:_a[columnIndex],{bold:!0}):null===(_b=cells[rowIndex])||void 0===_b?void 0:_b[columnIndex]}}),[cells,filterHeaderCells]),getValueRef=react_1.useRef(_getValue);react_1.useEffect((function(){getValueRef.current=_getValue}),[_getValue]);var getValueText=react_1.useCallback((function(cell){var _a;return null===(_a=_getValue(cell))||void 0===_a?void 0:_a.text}),[_getValue]),getDisplayText=react_1.useCallback((function(cellConfig){var _a,datatype=null==cellConfig?void 0:cellConfig.datatype,isFormula="formula"===datatype,textValue=isFormula?null!==(_a=null==cellConfig?void 0:cellConfig.error)&&void 0!==_a?_a:null==cellConfig?void 0:cellConfig.result:null==cellConfig?void 0:cellConfig.text,effectiveType=isFormula?null==cellConfig?void 0:cellConfig.resultType:datatype,formattedValue=formatter?formatter(textValue,effectiveType,cellConfig):textValue;return void 0!==formattedValue?grid_1.castToString(formattedValue):formattedValue}),[]),hiddenFilterRows=react_1.useMemo((function(){for(var _a,rows={},i=0;i<filterViews.length;i++){var filterView=filterViews[i],bounds=filterView.bounds,filters=filterView.filters;for(var columnIndex in filters)for(var values=filters[columnIndex].values,k=bounds.top+1;k<=bounds.bottom;k++){var cell={rowIndex:k,columnIndex:parseInt(columnIndex)},cellConfig=_getValue(cell),value=null!==(_a=null==cellConfig?void 0:cellConfig.text)&&void 0!==_a?_a:"";values.includes(value)||(rows[k]=!0)}}return rows}),[filterViews]),hiddenRows=react_1.useMemo((function(){return userHiddenRows.reduce((function(acc,item){return acc[item]=!0,acc}),hiddenFilterRows)}),[hiddenFilterRows,userHiddenRows]),hiddenColumns=react_1.useMemo((function(){return userHiddenColumns.reduce((function(acc,item){return acc[item]=!0,acc}),{})}),[userHiddenColumns]),isHiddenRow=react_1.useCallback((function(rowIndex){return hiddenRows[rowIndex]}),[hiddenRows,selectionMode]),isHiddenColumn=react_1.useCallback((function(columnIndex){return hiddenColumns[columnIndex]}),[hiddenColumns]),_grid_1$useTouch=grid_1.useTouch({gridRef:gridRef}),isTouchDevice=_grid_1$useTouch.isTouchDevice,scrollToTouch=_grid_1$useTouch.scrollTo,scrollToTopTouch=_grid_1$useTouch.scrollToTop,_grid_1$useSizer=grid_1.useSizer({gridRef:gridRef,frozenRows:frozenRows,scale:scale,minColumnWidth:10,isHiddenRow:isHiddenRow,isHiddenColumn:isHiddenColumn,getValue:function getValue(cell){var _a,_b,_c,cellConfig=_getValue(cell),spacing="list"===(null===(_a=null==cellConfig?void 0:cellConfig.dataValidation)||void 0===_a?void 0:_a.type)?ListArrow_1.LIST_ICON_DIM+5:0,fontSize=constants_1.pointToPixel(null!==(_b=null==cellConfig?void 0:cellConfig.fontSize)&&void 0!==_b?_b:constants_1.DEFAULT_FONT_SIZE),fontFamily=null!==(_c=null==cellConfig?void 0:cellConfig.fontFamily)&&void 0!==_c?_c:constants_1.DEFAULT_FONT_FAMILY;return Object.assign({},cellConfig,{fontSize:fontSize,fontFamily:fontFamily,spacing:spacing})},getText:getDisplayText,columnSizes:columnSizes,autoResize:!1,resizeOnScroll:!1}),getColumnWidth=_grid_1$useSizer.getColumnWidth,onViewChange=_grid_1$useSizer.onViewChange,getTextMetrics=_grid_1$useSizer.getTextMetrics,handleMouseDownSelection=react_1.useCallback((function(e,coords,startRef,endRef){if(gridRef.current){var _internalRefs$current=internalRefs.current,rowCount=_internalRefs$current.rowCount,columnCount=_internalRefs$current.columnCount,isShiftKey=e.nativeEvent.shiftKey,isMetaKey=e.nativeEvent.ctrlKey||e.nativeEvent.metaKey,isRowHeader=isCellRowHeader(coords.rowIndex),isColumnHeader=isCellColumnHeader(coords.columnIndex);if(isRowHeader&&isColumnHeader)return selectAll(),!1;if(isRowHeader||isColumnHeader){var actualFrozenRows=frozenRows-1,actualFrozenColumns=frozenColumns-1,start=isColumnHeader?Object.assign({},coords,{columnIndex:selectionLeftBound}):Object.assign({},coords,{rowIndex:selectionTopBound}),end=isColumnHeader?Object.assign({},coords,{columnIndex:columnCount-1}):Object.assign({},coords,{rowIndex:rowCount-1}),_gridRef$current$getV=gridRef.current.getViewPort(),visibleRowStartIndex=_gridRef$current$getV.visibleRowStartIndex,visibleColumnStartIndex=_gridRef$current$getV.visibleColumnStartIndex,_activeCell=isColumnHeader?Object.assign({},coords,{columnIndex:actualFrozenColumns>=selectionLeftBound?selectionLeftBound:visibleColumnStartIndex}):Object.assign({},coords,{rowIndex:actualFrozenRows>=selectionTopBound?selectionTopBound:visibleRowStartIndex});return isShiftKey?modifySelection(end):isMetaKey?(appendSelection(start,end),setActiveCellState(_activeCell),gridRef.current.scrollToItem(_activeCell)):(clearSelections(),startRef.current=start,endRef.current=start,modifySelection(end),setActiveCellState(_activeCell),gridRef.current.scrollToItem(_activeCell)),!1}}}),[frozenRows,frozenColumns,mergedCells]),handleMouseMoveSelection=react_1.useCallback((function(_,coords,startRef,endRef){var _a,_b,_c,_d,_e,_internalRefs$current2=internalRefs.current,rowCount=_internalRefs$current2.rowCount,columnCount=_internalRefs$current2.columnCount,isRowHeader=(null===(_a=startRef.current)||void 0===_a?void 0:_a.rowIndex)===selectionTopBound&&(null===(_b=endRef.current)||void 0===_b?void 0:_b.rowIndex)===rowCount-1,isColumnHeader=(null===(_c=startRef.current)||void 0===_c?void 0:_c.columnIndex)===selectionLeftBound&&(null===(_d=endRef.current)||void 0===_d?void 0:_d.columnIndex)===columnCount-1;if(isRowHeader&&isColumnHeader)return!1;if(isRowHeader||isColumnHeader){var end=isRowHeader?Object.assign({},coords,{rowIndex:rowCount-1}):Object.assign({},coords,{columnIndex:columnCount-1});return modifySelection(end),null===(_e=gridRef.current)||void 0===_e||_e.scrollToItem({rowIndex:isRowHeader?void 0:coords.rowIndex,columnIndex:isColumnHeader?void 0:coords.columnIndex}),!1}}),[]),_grid_1$useSelection=grid_1.useSelection({newSelectionMode:isFormulaMode?newSelectionMode:"clear",selectionPolicy:selectionPolicy,selectionTopBound:selectionTopBound,selectionLeftBound:selectionLeftBound,initialActiveCell:initialActiveCell,initialSelections:initialSelections,gridRef:gridRef,rowCount:rowCount,columnCount:columnCount,onFill:onFill,isHiddenRow:isHiddenRow,isHiddenColumn:isHiddenColumn,mergedCells:mergedCells,getValue:getValueText,mouseDownInterceptor:handleMouseDownSelection,mouseMoveInterceptor:handleMouseMoveSelection,canSelectionSpanMergedCells:function canSelectionSpanMergedCells(start,end){var _internalRefs$current3=internalRefs.current,rowCount=_internalRefs$current3.rowCount,columnCount=_internalRefs$current3.columnCount;return(start.rowIndex!==selectionTopBound||end.rowIndex!==rowCount-1)&&(start.columnIndex!==selectionLeftBound||end.columnIndex!==columnCount-1)}}),gridSelections=_grid_1$useSelection.selections,activeCell=_grid_1$useSelection.activeCell,setActiveCell=_grid_1$useSelection.setActiveCell,setActiveCellState=_grid_1$useSelection.setActiveCellState,setSelections=_grid_1$useSelection.setSelections,modifySelection=_grid_1$useSelection.modifySelection,appendSelection=(_grid_1$useSelection.newSelection,_grid_1$useSelection.clearLastSelection,_grid_1$useSelection.appendSelection),selectAll=_grid_1$useSelection.selectAll,clearSelections=_grid_1$useSelection.clearSelections,selectionProps=_objectWithoutProperties(_grid_1$useSelection,["selections","activeCell","setActiveCell","setActiveCellState","setSelections","modifySelection","newSelection","clearLastSelection","appendSelection","selectAll","clearSelections"]),focusEditor=react_1.useCallback((function(){var _a;isFormulaInputActive?null==focusFormulaBar||focusFormulaBar():null===(_a=editorRef.current)||void 0===_a||_a.focus()}),[isFormulaInputActive]),updateFormulaEditor=react_1.useCallback((function(sel,newSelectionMode){var _a,_b,name=constants_1.sanitizeSheetName(selectedSheet!==currentlyEditingSheetId.current?sheetName:void 0);isFormulaInputActive?null==onFormulaBarUpdateSelections||onFormulaBarUpdateSelections(name,sel,newSelectionMode):null===(_b=null===(_a=editorRef.current)||void 0===_a?void 0:_a.updateSelection)||void 0===_b||_b.call(_a,name,sel,newSelectionMode)}),[selectedSheet,sheetName,isFormulaInputActive]),updateFormulaEditorThrottle=react_1.useRef();react_1.useEffect((function(){updateFormulaEditorThrottle.current=grid_1.throttle(updateFormulaEditor,60)}),[updateFormulaEditor,selectedSheet,sheetName,isFormulaInputActive]),react_1.useEffect((function(){var _a;isFormulaMode&&(null===(_a=updateFormulaEditorThrottle.current)||void 0===_a||_a.call(updateFormulaEditorThrottle,gridSelections[gridSelections.length-1],formulaState.newSelectionMode))}),[gridSelections]);var selections=isFormulaMode?formulaSelections:gridSelections,_grid_1$useCopyPaste=grid_1.useCopyPaste({gridRef:gridRef,selections:selections,activeCell:activeCell,getValue:_getValue,getText:getDisplayText,onPaste:onPaste,onCut:onCut,onCopy:onCopy}),copy=_grid_1$useCopyPaste.copy,paste=_grid_1$useCopyPaste.paste,cut=_grid_1$useCopyPaste.cut,handleChangeFilter=react_1.useCallback((function(filterIndex,columnIndex,filter){null==onChangeFilter||onChangeFilter(filterIndex,columnIndex,filter),hideFilter()}),[]),headerSelections=react_1.useMemo((function(){for(var sel={rows:{},cols:{}},i=0;i<selections.length;i++){var bounds=selections[i].bounds,isFullColSelected=bounds.top===selectionTopBound&&bounds.bottom===rowCount-1,isFullRowSelected=bounds.left===selectionLeftBound&&bounds.right===columnCount-1;if(isFullColSelected)for(var j=bounds.left;j<=bounds.right;j++)sel.cols[j]=!0;if(isFullRowSelected)for(var _j=bounds.top;_j<=bounds.bottom;_j++)sel.rows[_j]=!0}return sel}),[selections,rowCount,selectionTopBound,selectionLeftBound,columnCount]),isHeaderSelected=react_1.useCallback((function(index,type){return headerSelections[type][index]}),[headerSelections]),_grid_1$useFilter=grid_1.useFilter({frozenRows:frozenRows,frozenColumns:frozenColumns,gridRef:gridRef,getFilterComponent:function getFilterComponent(){return function(props){return react_1.default.createElement(FilterComponent_1.default,Object.assign({},props,{onChange:handleChangeFilter,onCancel:hideFilter}))}},getValue:getValueText}),filterComponent=_grid_1$useFilter.filterComponent,showFilter=_grid_1$useFilter.showFilter,hideFilter=_grid_1$useFilter.hideFilter,handleFilterClick=react_1.useCallback((function(cell){var _a,filterIndex=filterViews.findIndex((function(views){return views.bounds.top===cell.rowIndex})),filterView=filterViews[filterIndex],currentFilter=null===(_a=null==filterView?void 0:filterView.filters)||void 0===_a?void 0:_a[cell.columnIndex];filterView&&showFilter(cell,filterIndex,filterView,currentFilter)}),[filterViews,frozenRows,frozenColumns]),handleAdjustColumn=react_1.useCallback((function(columnIndex){var width=getColumnWidth(columnIndex)+(columnHasFilter(columnIndex)?FilterIcon_1.FILTER_ICON_DIM:0);null==onResize||onResize("x",columnIndex,width)}),[_getValue,hiddenRows,frozenRows,hiddenColumns,scale]);react_1.useEffect((function(){var _a;0!==(null==activeCell?void 0:activeCell.rowIndex)&&0!==(null==activeCell?void 0:activeCell.columnIndex)&&(isFormulaMode||null==onActiveCellChange||onActiveCellChange(activeCell,null===(_a=_getValue(activeCell))||void 0===_a?void 0:_a.text))}),[activeCell]),react_1.useEffect((function(){isFormulaMode||(null==onSheetChange||onSheetChange({activeCell:activeCell,selections:selections}),null==onSelectionChange||onSelectionChange(activeCell,selections))}),[selections,activeCell,isFormulaMode]),react_1.useEffect((function(){var _a,_b,_c,_d;void 0!==previousSelectedSheet&&previousSelectedSheet!==selectedSheet&&(scrollState?isTouchDevice?scrollToTouch(scrollState):null===(_a=gridRef.current)||void 0===_a||_a.scrollTo(scrollState):isTouchDevice?scrollToTopTouch():null===(_b=gridRef.current)||void 0===_b||_b.scrollToTop(),null===(_c=gridRef.current)||void 0===_c||_c.resetAfterIndices({rowIndex:0,columnIndex:0},!1),setActiveCell(initialActiveCell,!1),setSelections(initialSelections),hideFilter(),null===(_d=gridRef.current)||void 0===_d||_d.focus(),isFormulaMode?focusEditor():hideEditor())}),[selectedSheet]);var restoreSelections=react_1.useCallback((function(){var len=formulaSelections.length;setSelections((function(prev){var newLen=prev.length-len;return prev.filter((function(_,idx){return idx<newLen}))}))}),[formulaSelections]),handleSubmit=react_1.useCallback((function(value,cell,nextActiveCell){var _a,_b;if(void 0!==currentlyEditingSheetId.current){if(isFormulaMode&&(null==onChangeSelectedSheet||onChangeSelectedSheet(currentlyEditingSheetId.current)),null==onChange||onChange(currentlyEditingSheetId.current,value,cell),nextActiveCell&&setActiveCell(nextActiveCell,!0),!(null===(_a=gridRef.current)||void 0===_a?void 0:_a.isMergedCell(cell))&&!isFormulaMode){var rowIndex=cell.rowIndex,_height=null!==(_b=rowSizes[rowIndex])&&void 0!==_b?_b:Math.max(minRowHeight,(getTextMetrics(value).height+constants_1.DEFAULT_CELL_PADDING)/scale);_height!==minRowHeight&&(null==onResize||onResize("y",rowIndex,_height))}null==setFormulaMode||setFormulaMode(!1),isFormulaMode&&restoreSelections(),editingCellRef.current=void 0}}),[selectedSheet,scale,rowSizes,isFormulaMode,formulaSelections]),handleEditorCancel=react_1.useCallback((function(e){isFormulaModeRef.current&&(void 0!==currentlyEditingSheetId.current&&(null==onChangeSelectedSheet||onChangeSelectedSheet(currentlyEditingSheetId.current)),editingCellRef.current&&(null==e?void 0:e.nativeEvent.keyCode)===grid_1.KeyCodes.Escape&&setActiveCell(editingCellRef.current),null==setFormulaMode||setFormulaMode(!1),restoreSelections()),editingCellRef.current=void 0}),[isFormulaMode,formulaSelections]),_grid_1$useTooltip=grid_1.useTooltip({getTooltip:function getTooltip(cell){var _a,content,cellConfig=_getValue(cell),isValid=null===(_a=null==cellConfig?void 0:cellConfig.valid)||void 0===_a||_a,datatype=null==cellConfig?void 0:cellConfig.datatype,resultType=null==cellConfig?void 0:cellConfig.resultType,hasError=!!(null==cellConfig?void 0:cellConfig.error),hasTooltip=null==cellConfig?void 0:cellConfig.tooltip,isHyperLink="hyperlink"===datatype||"hyperlink"===resultType;if(!(!1===isValid||!0===hasError||isHyperLink||hasTooltip))return null;if(!1===isValid){var validation=null==cellConfig?void 0:cellConfig.dataValidation;content=null==validation?void 0:validation.prompt}else hasError&&(content=(null==cellConfig?void 0:cellConfig.errorMessage)||(null==cellConfig?void 0:cellConfig.error));hasTooltip&&(content=null==cellConfig?void 0:cellConfig.tooltip);var variant=!1===isValid?"invalid":hasError?"error":void 0,position=isHyperLink?"bottom":"right";return function(props){return react_1.default.createElement(Tooltip,Object.assign({},props,cellConfig,{position:position,content:content,variant:variant}))}},gridRef:gridRef}),tooltipComponent=_grid_1$useTooltip.tooltipComponent,tooltipProps=_objectWithoutProperties(_grid_1$useTooltip,["tooltipComponent"]),handleActiveCellValueChange=react_1.useCallback((function(value,cell){null==onActiveCellValueChange||onActiveCellValueChange(value,cell);var isFormula=constants_1.isAFormula(value);if(null==setFormulaMode||setFormulaMode(!!isFormula),isFormula){var sel=helpers_1.getSelectionsFromInput(value,currentlyEditingSheetName.current);setFormulaSelections(sel)}}),[sheetName]),handleFormulaChange=react_1.useCallback((function(props){null==onChangeFormulaState||onChangeFormulaState(props)}),[]),_grid_1$useEditable=grid_1.useEditable({onBeforeEdit:function onBeforeEdit(cell){editingCellRef.current&&editingCellRef.current.rowIndex!==cell.rowIndex&&editingCellRef.current.columnIndex!==cell.columnIndex&&clearSelections(),currentlyEditingSheetName.current=sheetName,currentlyEditingSheetId.current=selectedSheet,editingCellRef.current=cell},hideOnBlur:!isFormulaMode||!formulaState.showCellSuggestion,onKeyDown:function onKeyDown(e){var isAltKey=e.altKey;null==onEditorKeyDown||onEditorKeyDown(e),isFormulaMode&&showCellSuggestion&&grid_1.isArrowKey(e.nativeEvent.which)&&!isAltKey&&selectionProps.onKeyDown(e)},editorProps:function editorProps(){return{selectedSheetName:sheetName,isFormulaMode:isFormulaMode,supportedFormulas:supportedFormulas,onFormulaChange:handleFormulaChange,onFocus:onCellEditorFocus}},getEditor:function getEditor(cell){var _a,_b,_c,config=_getValue(cell),type=constants_1.getEditorType(null===(_a=null==config?void 0:config.dataValidation)||void 0===_a?void 0:_a.type),options=null===(_b=null==config?void 0:config.dataValidation)||void 0===_b?void 0:_b.formulae,horizontalAlign=null!==(_c=null==config?void 0:config.horizontalAlign)&&void 0!==_c?_c:"number"===(null==config?void 0:config.datatype)&&!(null==config?void 0:config.plaintext)&&"right",address=constants_1.cellToAddress(cell);return function(props){return react_1.default.createElement(CellEditor,Object.assign({},props,{ref:editorRef,background:null==config?void 0:config.fill,color:null==config?void 0:config.color,fontSize:null==config?void 0:config.fontSize,fontFamily:null==config?void 0:config.fontFamily,bold:null==config?void 0:config.bold,underline:null==config?void 0:config.underline,horizontalAlign:horizontalAlign,scale:scale,wrap:null==config?void 0:config.wrap,editorType:type,options:options,sheetName:sheetName,address:address}))}},frozenRows:frozenRows,frozenColumns:frozenColumns,isHiddenRow:isHiddenRow,isHiddenColumn:isHiddenColumn,gridRef:gridRef,selections:selections,activeCell:activeCell,rowCount:rowCount,columnCount:columnCount,selectionTopBound:selectionTopBound,selectionLeftBound:selectionLeftBound,onSubmit:handleSubmit,onCancel:handleEditorCancel,getValue:getValueText,onChange:handleActiveCellValueChange,canEdit:function canEdit(cell){var _a;return!0!==isLockedRef.current&&(0!==cell.rowIndex&&0!==cell.columnIndex&&!(null===(_a=_getValue(cell))||void 0===_a?void 0:_a.locked))},onDelete:onDelete}),editorComponent=_grid_1$useEditable.editorComponent,isEditInProgress=_grid_1$useEditable.isEditInProgress,nextFocusableCell=_grid_1$useEditable.nextFocusableCell,makeEditable=_grid_1$useEditable.makeEditable,setValue=_grid_1$useEditable.setValue,hideEditor=_grid_1$useEditable.hideEditor,submitEditor=_grid_1$useEditable.submitEditor,cancelEditor=_grid_1$useEditable.cancelEditor,editableProps=(_grid_1$useEditable.showEditor,_grid_1$useEditable.editingCell,_objectWithoutProperties(_grid_1$useEditable,["editorComponent","isEditInProgress","nextFocusableCell","makeEditable","setValue","hideEditor","submitEditor","cancelEditor","showEditor","editingCell"])),eventRefs=react_1.useRef({selectionProps:{onMouseDown:selectionProps.onMouseDown,onKeyDown:selectionProps.onKeyDown},editableProps:{onMouseDown:editableProps.onMouseDown,onKeyDown:editableProps.onKeyDown}});react_1.useEffect((function(){eventRefs.current={selectionProps:{onMouseDown:selectionProps.onMouseDown,onKeyDown:selectionProps.onKeyDown},editableProps:{onMouseDown:editableProps.onMouseDown,onKeyDown:editableProps.onKeyDown}}}));var getNextFocusableCell=react_1.useCallback((function(cell,direction){return nextFocusableCell(cell,direction)}),[hiddenRows,hiddenColumns]),columnWidth=react_1.useCallback((function(columnIndex){var _a;return hiddenColumns[columnIndex]?0:0===columnIndex?rowHeaderWidth:null!==(_a=columnSizes[columnIndex])&&void 0!==_a?_a:minColumnWidth}),[minColumnWidth,columnSizes,selectedSheet,rowHeaderWidth]),rowHeight=react_1.useCallback((function(rowIndex){var _a;return hiddenRows[rowIndex]?0:0===rowIndex?columnHeaderHeight:null!==(_a=rowSizes[rowIndex])&&void 0!==_a?_a:minRowHeight}),[minRowHeight,hiddenRows,rowSizes,selectedSheet,columnHeaderHeight]),contextWrapper=react_1.useCallback((function(children){return react_1.default.createElement(core_1.ThemeProvider,{theme:theme},react_1.default.createElement(core_1.ColorModeProvider,null,children))}),[theme]),selectedRowsAndCols=react_1.useMemo((function(){var _a,_b,activeCellBounds=activeCell&&gridRef.current?[{bounds:null===(_b=null===(_a=gridRef.current)||void 0===_a?void 0:_a.getCellBounds)||void 0===_b?void 0:_b.call(_a,activeCell)}]:[];return[].concat(selections,activeCellBounds).reduce((function(acc,_ref2){for(var bounds=_ref2.bounds,i=bounds.left;i<=bounds.right;i++)acc.cols.push(i);for(var _i2=bounds.top;_i2<=bounds.bottom;_i2++)acc.rows.push(_i2);return acc}),{rows:[],cols:[]})}),[selections,activeCell,null===(_a=gridRef.current)||void 0===_a?void 0:_a.getCellBounds]),isRowSelected=react_1.useCallback((function(rowIndex){return"cell"!==selectionMode&&(("row"===selectionMode||"both"===selectionMode)&&((null==activeCell?void 0:activeCell.rowIndex)===rowIndex||selectedRowsAndCols.rows.includes(rowIndex)))}),[selectedRowsAndCols,activeCell,selectionMode]),isColumnSelected=react_1.useCallback((function(columnIndex){return"cell"!==selectionMode&&(("column"===selectionMode||"both"===selectionMode)&&((null==activeCell?void 0:activeCell.columnIndex)===columnIndex||selectedRowsAndCols.cols.includes(columnIndex)))}),[selectedRowsAndCols,activeCell,selectionMode]),isHiddenCell=react_1.useCallback((function(rowIndex,columnIndex){var rowSelected=isRowSelected(rowIndex),columnSelected=isColumnSelected(columnIndex);if(rowSelected||columnSelected)return!1;var isRowHeader=isCellRowHeader(rowIndex),isColumnHeader=isCellColumnHeader(columnIndex);return!isRowHeader&&!isColumnHeader&&void 0===_getValue({rowIndex:rowIndex,columnIndex:columnIndex})}),[_getValue,selectionMode,selectedRowsAndCols]),handleEdit=react_1.useCallback((function(cell){makeEditable(cell)}),[frozenRows,frozenColumns,selectedSheet]),handleCheck=react_1.useCallback((function(cell,checked){var _a,_b,_c,cellConfig=getValueRef.current(cell),type=null===(_a=null==cellConfig?void 0:cellConfig.dataValidation)||void 0===_a?void 0:_a.type,formulae=null!==(_c=null===(_b=null==cellConfig?void 0:cellConfig.dataValidation)||void 0===_b?void 0:_b.formulae)&&void 0!==_c?_c:constants_1.DEFAULT_CHECKBOX_VALUES;if(type){var text=formulae[checked?0:1];null==onChange||onChange(selectedSheet,text,cell),null==onActiveCellValueChange||onActiveCellValueChange(text,cell)}else console.error("Type is not specified. Cell Config should contain a dataValidation object",cellConfig)}),[selectedSheet]),itemRenderer=react_1.useCallback((function(props){var _a,_b,rowIndex=props.rowIndex,columnIndex=props.columnIndex,cell={rowIndex:rowIndex,columnIndex:columnIndex},isRowHeader=isCellRowHeader(rowIndex),isColumnHeader=isCellColumnHeader(columnIndex);if(isRowHeader||isColumnHeader){var isHeaderActive=!(!isRowHeader&&!isColumnHeader)&&(isRowHeader?selectedRowsAndCols.cols.includes(columnIndex):selectedRowsAndCols.rows.includes(rowIndex)),isFilteredColumn=columnHasFilter(columnIndex),isFilteredRow=rowHasFilter(rowIndex),_isSelected=isHeaderSelected(isRowHeader?columnIndex:rowIndex,isRowHeader?"cols":"rows");return react_1.default.createElement(HeaderCellRenderer,Object.assign({},props,{isLightMode:isLightMode,isActive:isHeaderActive,onResize:onResize,onAdjustColumn:handleAdjustColumn,theme:theme,scale:scale,isFiltered:isFilteredColumn||isFilteredRow,isSelected:_isSelected}))}var rowSelected=isRowSelected(rowIndex),columnSelected=isColumnSelected(columnIndex),isSelected=rowSelected||columnSelected,filterIndex=filterHeaderCells[grid_2.cellIdentifier(rowIndex,columnIndex)],showFilter=void 0!==filterIndex,cellConfig=_getValue(cell),isFilterActive=void 0!==filterIndex&&!!(null===(_b=null===(_a=null==filterViews?void 0:filterViews[filterIndex])||void 0===_a?void 0:_a.filters)||void 0===_b?void 0:_b[columnIndex]);return react_1.default.createElement(CellRenderer,Object.assign({},props,cellConfig,{cellConfig:cellConfig,isLightMode:isLightMode,formatter:formatter,showStrokeOnFill:showGridLines,isSelected:isSelected,showFilter:showFilter,isFilterActive:isFilterActive,onFilterClick:handleFilterClick,scale:scale,onEdit:handleEdit,onCheck:handleCheck}))}),[_getValue,selectedRowsAndCols,activeCell,showGridLines,selectionMode,isLightMode,theme,scale,filterHeaderCells,CellRenderer,HeaderCellRenderer]),overlayRenderer=react_1.useCallback((function(props){var rowIndex=props.rowIndex,columnIndex=props.columnIndex,cellConfig=_getValue({rowIndex:rowIndex,columnIndex:columnIndex});return grid_1.CellOverlayRenderer(Object.assign({},props,cellConfig))}),[_getValue,selectedRowsAndCols,activeCell,hiddenRows,hiddenColumns]),handleScroll=react_1.useCallback((function(scrollState){var _a,_b;null===(_a=editableProps.onScroll)||void 0===_a||_a.call(editableProps,scrollState),null===(_b=debounceScroll.current)||void 0===_b||_b.call(debounceScroll,scrollState)}),[selectedSheet]),showContextMenu=react_1.useCallback((function(e){var _a;e.preventDefault();var left=e.clientX,top=e.clientY,pos=null===(_a=gridRef.current)||void 0===_a?void 0:_a.getRelativePositionFromOffset(left,top);if(pos){var x=pos.x,y=pos.y;setContextMenuProps({left:x,top:y})}}),[]),handleMouseDown=react_1.useCallback((function(e){var isMetaKey=e.nativeEvent.ctrlKey||e.nativeEvent.metaKey;isFormulaMode&&isMetaKey&&(null==onChangeFormulaState||onChangeFormulaState({newSelectionMode:"append"})),eventRefs.current.selectionProps.onMouseDown(e),eventRefs.current.editableProps.onMouseDown(e),hideContextMenu(),hideFilter()}),[_getValue,selectedSheet,activeCell,selections,isFormulaMode]),handleKeyDown=react_1.useCallback((function(e){null==onKeyDown||onKeyDown(e,activeCell,selections),e.isDefaultPrevented()||(eventRefs.current.selectionProps.onKeyDown(e),eventRefs.current.editableProps.onKeyDown(e))}),[_getValue,selectedSheet,activeCell,selections]),selectionRenderer=react_1.useCallback((function(props){var type=props.type,key=props.key,isFill="fill"===type,isActiveCell="activeCell"===type;if(isFormulaMode&&"selection"===type&&selections[key].sheet!==sheetName)return null;var stroke=isFill?"gray":isFormulaMode?isActiveCell?selections.length>0?"transparent":selectionBorderColor:helpers_1.getSelectionColorAtIndex(key):selectionBorderColor,fillOpacity=isFill?0:isFormulaMode?.1:1,fill=isFill||isActiveCell?"transparent":isFormulaMode?helpers_1.getSelectionColorAtIndex(key):selectionBackgroundColor,strokeWidth=isFill?1:isFormulaMode||isActiveCell?2:1,strokeStyle=isFill?"dashed":isFormulaMode?isActiveCell&&0===selections.length?"solid":"dashed":"solid";return react_1.default.createElement(grid_1.Selection,Object.assign({},props,{stroke:stroke,fill:fill,strokeWidth:strokeWidth,strokeStyle:strokeStyle,fillOpacity:fillOpacity}))}),[sheetName,isFormulaMode,selections,selectionBorderColor,selectionBackgroundColor]),hideContextMenu=react_1.useCallback((function(){var _a;setContextMenuProps(null),null===(_a=gridRef.current)||void 0===_a||_a.focus()}),[]),fillhandleBorderColor=isLightMode?"white":constants_1.DARK_MODE_COLOR_LIGHT,finalGridLineColor=gridLineColor||(isLightMode?constants_1.CELL_BORDER_COLOR:null==theme?void 0:theme.colors.gray[600]),shadowStroke=isLightMode?constants_1.HEADER_BORDER_COLOR:null==theme?void 0:theme.colors.gray[600],shadowSettings=react_1.useMemo((function(){return{stroke:shadowStroke}}),[shadowStroke]);return react_1.default.createElement(styled_1.GridWrapper,null,react_1.default.createElement(grid_1.default,Object.assign({},rest,{snap:snap,scale:scale,isHiddenRow:isHiddenRow,isHiddenCell:isHiddenCell,enableCellOverlay:!0,shadowSettings:shadowSettings,showFrozenShadow:!0,gridLineColor:finalGridLineColor,showGridLines:showGridLines,ref:gridRef,rowCount:rowCount,columnCount:columnCount,columnWidth:columnWidth,rowHeight:rowHeight,width:width,height:height,itemRenderer:itemRenderer,overlayRenderer:overlayRenderer,wrapper:contextWrapper,selections:selections,activeCell:activeCell,fillhandleBorderColor:fillhandleBorderColor,showFillHandle:!isEditInProgress,mergedCells:mergedCells,borderStyles:borderStyles,frozenRows:frozenRows,frozenColumns:frozenColumns},selectionProps,editableProps,tooltipProps,{onMouseDown:handleMouseDown,onKeyDown:handleKeyDown,onScroll:handleScroll,onContextMenu:showContextMenu,onViewChange:onViewChange,selectionRenderer:selectionRenderer})),editorComponent,void 0!==ContextMenu&&contextMenuProps&&react_1.default.createElement(ContextMenu,Object.assign({onRequestClose:hideContextMenu,activeCell:activeCell,selections:selections,onCopy:copy,onPaste:paste,onCut:cut,onInsertRow:onInsertRow,onInsertColumn:onInsertColumn,onDeleteColumn:onDeleteColumn,onDeleteRow:onDeleteRow},contextMenuProps)),filterComponent,tooltipComponent)})));exports.default=SheetGrid},996:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var HeaderCell_1=__importDefault(__webpack_require__(997));exports.default=HeaderCell_1.default},997:function(module,exports,__webpack_require__){"use strict";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_require__(9),__webpack_require__(15),__webpack_require__(17),__webpack_require__(25),__webpack_require__(38),__webpack_require__(20),__webpack_require__(13),__webpack_require__(23),__webpack_require__(18),__webpack_require__(24),__webpack_require__(26),__webpack_require__(33),__webpack_require__(8),__webpack_require__(32),__webpack_require__(10),__webpack_require__(19),__webpack_require__(16),__webpack_require__(21);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__(1)),grid_1=__webpack_require__(7),constants_1=__webpack_require__(56),react_konva_1=__webpack_require__(14),DraggableRect=react_1.memo((function(props){var _props$axis=props.axis,axis=void 0===_props$axis?"x":_props$axis,_props$x=props.x,x=void 0===_props$x?0:_props$x,_props$y=props.y,y=void 0===_props$y?0:_props$y,_props$height=props.height,height=void 0===_props$height?0:_props$height,_props$width=props.width,width=void 0===_props$width?0:_props$width,columnIndex=props.columnIndex,rowIndex=props.rowIndex,onResize=props.onResize,_props$parentX=props.parentX,parentX=void 0===_props$parentX?0:_props$parentX,_props$parentY=props.parentY,parentY=void 0===_props$parentY?0:_props$parentY,showResizer=props.showResizer,_props$scale=props.scale,scale=void 0===_props$scale?1:_props$scale,parentWidth=props.parentWidth,parentHeight=props.parentHeight,rest=_objectWithoutProperties(props,["axis","x","y","height","width","columnIndex","rowIndex","onResize","parentX","parentY","showResizer","scale","parentWidth","parentHeight"]),index=react_1.useMemo((function(){return"x"===axis?columnIndex:rowIndex}),[axis]),dragStartPos=react_1.useRef(),dragStartDim=react_1.useRef();return react_1.default.createElement(react_konva_1.Rect,Object.assign({perfectDrawEnabled:!1,fill:showResizer?"#4C90FD":"transparent",draggable:!0,strokeScaleEnabled:!1,shadowForStrokeEnable:!1,hitStrokeWidth:5,onMouseDown:function onMouseDown(e){return e.evt.stopPropagation()},dragBoundFunc:function dragBoundFunc(pos){return void 0===dragStartPos.current||void 0===dragStartDim.current?pos:{x:"y"===axis?0:Math.max(dragStartPos.current-dragStartDim.current+5,pos.x),y:"x"===axis?0:Math.max(dragStartPos.current-dragStartDim.current+5,pos.y)}},onDragMove:function onDragMove(e){var node=e.target,dimension="x"===axis?node.x()-parentX+5:node.y()-parentY+5;null==onResize||onResize(axis,index,dimension/scale)},onTouchStart:function onTouchStart(e){e.evt.stopPropagation()},onDragStart:function onDragStart(e){var clientRect=e.currentTarget.getClientRect();dragStartPos.current="x"===axis?clientRect.x:clientRect.y,dragStartDim.current="x"===axis?parentWidth:parentHeight},x:x,y:y,width:width,height:height},rest))})),HeaderCell=react_1.memo((function(props){var _react_1$useState2=_slicedToArray(react_1.useState(!1),2),showResizer=_react_1$useState2[0],setShowResizer=_react_1$useState2[1],rowIndex=props.rowIndex,columnIndex=props.columnIndex,isActive=props.isActive,_props$x2=props.x,x=void 0===_props$x2?0:_props$x2,_props$y2=props.y,y=void 0===_props$y2?0:_props$y2,_props$width2=props.width,width=void 0===_props$width2?0:_props$width2,_props$height2=props.height,height=void 0===_props$height2?0:_props$height2,isLightMode=props.isLightMode,theme=props.theme,onResize=props.onResize,onAdjustColumn=props.onAdjustColumn,_props$scale2=props.scale,scale=void 0===_props$scale2?1:_props$scale2,isFiltered=props.isFiltered,isSelected=props.isSelected,rest=_objectWithoutProperties(props,["onResize","onAdjustColumn","scale","isFiltered","isSelected"]),isCorner=rowIndex===columnIndex,value=isCorner?"":0===rowIndex?constants_1.number2Alpha(columnIndex-1):rowIndex.toString(),isRowHeader=0===rowIndex,fill=isLightMode?isFiltered?isSelected?"#198039":"#E6F4EA":isSelected?"#5F6268":isActive?"#E9EAED":"#F8F9FA":isActive?theme.colors.gray[700]:constants_1.DARK_MODE_COLOR,textColor=isSelected||!isLightMode?"white":"#333",stroke=isLightMode?constants_1.HEADER_BORDER_COLOR:theme.colors.gray[600],axis=isRowHeader?"x":"y",cursor="x"===axis?"e-resize":"n-resize",handleMouseEnter=react_1.useCallback((function(){document.body.style.cursor=cursor,setShowResizer(!0)}),[]),handleMouseLeave=react_1.useCallback((function(){document.body.style.cursor="default",setShowResizer(!1)}),[]),fontSize=10*scale;return react_1.default.createElement(grid_1.Cell,Object.assign({},rest,{x:x,y:y,fill:fill,align:"center",value:value,textColor:textColor,stroke:stroke,fontSize:fontSize}),isCorner?null:react_1.default.createElement(DraggableRect,{parentWidth:width,parentHeight:height,parentX:x,parentY:y,x:isRowHeader?x+width-5:x,y:isRowHeader?y:y+height-5,width:isRowHeader?5:width,height:isRowHeader?height:5,axis:axis,rowIndex:rowIndex,columnIndex:columnIndex,onResize:onResize,onDblClick:function handleAdjustColumn(){return null==onAdjustColumn?void 0:onAdjustColumn(columnIndex)},showResizer:showResizer,onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave,scale:scale}))}));exports.default=HeaderCell},998:function(module,exports,__webpack_require__){"use strict";function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}__webpack_require__(9),__webpack_require__(30),__webpack_require__(134),__webpack_require__(38),__webpack_require__(26),__webpack_require__(33),__webpack_require__(8),__webpack_require__(32),__webpack_require__(118),__webpack_require__(297);var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function get(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ErrorTag=void 0;var react_1=__importStar(__webpack_require__(1)),grid_1=__webpack_require__(7),constants_1=__webpack_require__(56),types_1=__webpack_require__(121),react_konva_1=__webpack_require__(14),FilterIcon_1=__importDefault(__webpack_require__(999)),ListArrow_1=__importDefault(__webpack_require__(1e3)),Checkbox_1=__importDefault(__webpack_require__(1001)),FilterIcon_2=__webpack_require__(304),Cell=react_1.memo((function(props){var _a,_b,datatype=props.datatype,formatter=props.formatter,isLightMode=props.isLightMode,dataValidation=(props.stroke,props.strokeTopColor,props.strokeRightColor,props.strokeBottomColor,props.strokeLeftColor,props.strokeDash,props.strokeTopDash,props.strokeRightDash,props.strokeBottomDash,props.strokeLeftDash,props.strokeWidth,props.strokeTopWidth,props.strokeRightWidth,props.strokeBottomWidth,props.strokeLeftWidth,props.lineCap,props.format,props.currencySymbol,props.dataValidation),cellConfig=props.cellConfig,_props$fontSize=(props.formulaRange,props.fontSize),fontSizePt=void 0===_props$fontSize?constants_1.DEFAULT_FONT_SIZE:_props$fontSize,cellProps=_objectWithoutProperties(props,["stroke","strokeTopColor","strokeRightColor","strokeBottomColor","strokeLeftColor","strokeDash","strokeTopDash","strokeRightDash","strokeBottomDash","strokeLeftDash","strokeWidth","strokeTopWidth","strokeRightWidth","strokeBottomWidth","strokeLeftWidth","lineCap","format","currencySymbol","dataValidation","cellConfig","formulaRange","fontSize"]),fontSize=react_1.useMemo((function(){return constants_1.pointToPixel(fontSizePt)}),[fontSizePt]),validatorType=null==dataValidation?void 0:dataValidation.type,checked="boolean"===validatorType&&props.text===(null===(_a=null==dataValidation?void 0:dataValidation.formulae)||void 0===_a?void 0:_a[0]),isFormula="formula"===datatype,textValue=isFormula?null!==(_b=props.error)&&void 0!==_b?_b:props.result:props.text,effectiveType=isFormula?props.resultType:datatype,text=formatter?formatter(textValue,effectiveType,cellConfig):grid_1.castToString(textValue);return react_1.default.createElement(DefaultCell,Object.assign({isLightMode:isLightMode},cellProps,{fontSize:fontSize,text:text,type:validatorType,checked:checked}))})),DefaultCell=react_1.memo((function(props){var _props$x=props.x,x=void 0===_props$x?0:_props$x,_props$y=props.y,y=void 0===_props$y?0:_props$y,_props$width=props.width,width=void 0===_props$width?0:_props$width,_props$height=props.height,height=void 0===_props$height?0:_props$height,isMergedCell=props.isMergedCell,fill=props.fill,datatype=props.datatype,userColor=props.color,italic=props.italic,bold=props.bold,horizontalAlign=props.horizontalAlign,_props$verticalAlign=props.verticalAlign,verticalAlign=void 0===_props$verticalAlign?"bottom":_props$verticalAlign,underline=props.underline,strike=props.strike,fontFamily=props.fontFamily,_props$padding=props.padding,padding=void 0===_props$padding?3:_props$padding,fontSize=props.fontSize,_props$wrap=props.wrap,wrap=void 0===_props$wrap?"none":_props$wrap,_props$lineHeight=props.lineHeight,lineHeight=void 0===_props$lineHeight?1:_props$lineHeight,isLightMode=props.isLightMode,_props$showStrokeOnFi=props.showStrokeOnFill,showStrokeOnFill=void 0===_props$showStrokeOnFi||_props$showStrokeOnFi,isSelected=props.isSelected,_props$selectionFill=props.selectionFill,selectionFill=void 0===_props$selectionFill?"rgb(14, 101, 235, 0.1)":_props$selectionFill,_props$loadingText=props.loadingText,loadingText=void 0===_props$loadingText?"Loading":_props$loadingText,plaintext=props.plaintext,showFilter=props.showFilter,isFilterActive=props.isFilterActive,onFilterClick=props.onFilterClick,_props$scale=props.scale,scale=void 0===_props$scale?1:_props$scale,rotation=props.rotation,valid=props.valid,validatorType=props.type,onEdit=props.onEdit,checked=props.checked,onCheck=props.onCheck,error=props.error,image=props.image,resultType=props.resultType,text=props.loading?loadingText:props.text,isBoolean="boolean"===validatorType,textWrap="wrap"===wrap?"word":"none",textDecoration="".concat(underline?types_1.TEXT_DECORATION.UNDERLINE+" ":"").concat(strike?types_1.TEXT_DECORATION.STRIKE:""),userFill=isSelected?selectionFill:fill,fontWeight=bold?types_1.FONT_WEIGHT.BOLD:types_1.FONT_WEIGHT.NORMAL,fontStyle=italic?types_1.FONT_STYLE.ITALIC:types_1.FONT_STYLE.NORMAL,textStyle="".concat(fontWeight," ").concat(fontStyle),vAlign=verticalAlign,hasError=!!error,hAlign=void 0===horizontalAlign?hasError?"center":"number"!==datatype&&"number"!==resultType&&"date"!==datatype&&"date"!==resultType||plaintext?"left":"right":horizontalAlign,defaultFill=isLightMode?"white":constants_1.DARK_MODE_COLOR_LIGHT,textColor=userColor||(isLightMode?"black":"white"),showRect=!grid_1.isNull(userFill)||isMergedCell,hasFill=!grid_1.isNull(userFill)||isSelected,hasText=!grid_1.isNull(text),showArrow="list"===validatorType,isInValid=!1===valid,showTag=isInValid||hasError,textWidth=showFilter||showArrow?width-FilterIcon_2.FILTER_ICON_DIM-1:width-1,fillFunc=react_1.useCallback((function(context,shape){context.beginPath(),context.setAttr("fillStyle",userFill||defaultFill),context.fillRect(1,1,shape.width()-1,shape.height()-1),hasFill&&(context.setAttr("strokeStyle",showStrokeOnFill?constants_1.luminance(userFill,-20):userFill),context.strokeRect(.5,.5,shape.width(),shape.height()))}),[hasFill,userFill,isSelected,defaultFill]);return react_1.default.createElement(react_1.default.Fragment,null,showRect?react_1.default.createElement(react_konva_1.Shape,{visible:showRect,x:x,y:y,width:width,height:height,sceneFunc:fillFunc}):null,isBoolean&&!isInValid?react_1.default.createElement(Checkbox_1.default,{x:x,y:y,width:width,height:height,checked:checked,onChange:onCheck,rowIndex:props.rowIndex,columnIndex:props.columnIndex}):hasText?react_1.default.createElement(react_konva_1.Text,{visible:hasText,x:x+1,y:y+1.5,height:height,width:textWidth,text:text,fill:textColor,verticalAlign:vAlign,align:hAlign,fontFamily:fontFamily,fontStyle:textStyle,textDecoration:textDecoration,padding:padding,wrap:textWrap,fontSize:fontSize*scale,lineHeight:lineHeight,hitStrokeWidth:0,perfectDrawEnabled:!1,listening:!1,rotation:rotation}):null,image?react_1.default.createElement(grid_1.Image,{x:x,y:y,spacing:1,width:width,height:height,url:image}):null,showFilter?react_1.default.createElement(FilterIcon_1.default,{isActive:isFilterActive,onClick:onFilterClick,rowIndex:props.rowIndex,columnIndex:props.columnIndex,x:x,y:y,height:height,width:width}):showArrow?react_1.default.createElement(ListArrow_1.default,{onClick:onEdit,rowIndex:props.rowIndex,columnIndex:props.columnIndex,x:x,y:y,height:height,width:width}):null,showTag?react_1.default.createElement(exports.ErrorTag,{color:isInValid?constants_1.INVALID_COLOR:constants_1.ERROR_COLOR,x:x+width-6.5,y:y+1}):null)}));exports.ErrorTag=function(_ref){var x=_ref.x,y=_ref.y,_ref$color=_ref.color,color=void 0===_ref$color?constants_1.INVALID_COLOR:_ref$color;return react_1.default.createElement(react_konva_1.Shape,{x:x,y:y,sceneFunc:function sceneFunc(context){context.beginPath(),context.setAttr("fillStyle",color),context.moveTo(0,0),context.lineTo(6.5,0),context.lineTo(6.5,6.5),context.closePath(),context.fill()}})},exports.default=Cell},999:function(module,exports,__webpack_require__){"use strict";__webpack_require__(8);var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var FilterIcon_1=__importDefault(__webpack_require__(304));exports.default=FilterIcon_1.default}},[[488,1,2]]]);
//# sourceMappingURL=main.68e3e18a312c3324a939.bundle.js.map